var e={1735:(e,t,n)=>{n.d(t,{J:()=>s});var o,i=n(4059),r=n(3278),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class s{static incrementConcept(e){try{e&&(this.conceptsData[e]=(this.conceptsData[e]||0)+1)}catch(e){console.error("Failed on increment concept")}}static incrementConnection(e){try{e&&(this.connectionsData[e]=(this.connectionsData[e]||0)+1)}catch(e){console.error("Failed on increment connection")}}static getTopConcepts(e){return Object.entries(this.conceptsData).map((([e,t])=>[parseInt(e),t])).sort(((e,t)=>t[1]-e[1])).slice(0,e)}static getTopConnections(e){return Object.entries(this.connectionsData).map((([e,t])=>[parseInt(e),t])).sort(((e,t)=>t[1]-e[1])).slice(0,e)}static saveDataToLocalStorage(){const e={concepts:this.conceptsData,connections:this.connectionsData};null===localStorage||void 0===localStorage||localStorage.setItem(this.accessData,JSON.stringify(e))}static loadDataFromLocalStorage(){const e=null===localStorage||void 0===localStorage?void 0:localStorage.getItem(this.accessData);if(e){const t=JSON.parse(e);this.conceptsData=t.concepts||{},this.connectionsData=t.connections||{}}}static sendToServer(){return c(this,void 0,void 0,(function*(){try{yield this.syncToServer()}catch(e){console.error("Failed to process Access Tracker Sync with Server")}}))}static syncToServer(){return c(this,void 0,void 0,(function*(){try{if(!Object.keys(this.conceptsData).length&&!Object.keys(this.connectionsData).length)return;const e=r.b.BearerAccessToken;if(!e)return;const t=this.conceptsData&&Object.keys(this.conceptsData).length>0?this.conceptsData:{},n=this.connectionsData&&Object.keys(this.connectionsData).length>0?this.connectionsData:{},o=yield fetch(i.BaseUrl.PostPrefetchConceptConnections(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({concepts:t,connections:n})});if(!o.ok)throw new Error("Failed to sync data to the server.");yield o.json(),this.conceptsData={},this.connectionsData={},this.setNextSyncTime()}catch(e){console.error("Sync error:",e)}}))}static setNextSyncTime(){this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS}static startAutoSync(){setInterval((()=>{const e=Date.now();this.nextSyncTime&&e>=this.nextSyncTime&&this.syncNow().catch(console.error)}),6e4)}static syncNow(){return c(this,void 0,void 0,(function*(){try{this.activateStatus?yield this.syncToServer():console.warn("Access Tracker inactive.")}catch(e){console.error("Error on sync access tracker")}}))}static GetSuggestedConcepts(e){return c(this,void 0,void 0,(function*(){try{const t=r.b.BearerAccessToken,n=new URL(i.BaseUrl.GetSuggestedConcepts());void 0!==e&&n.searchParams.append("top",e.toString());const o=yield fetch(n.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!o.ok){const e=yield o.text();throw new Error(`Failed to load concepts: ${o.status} ${o.statusText}. Details: ${e}`)}const c=(yield o.json())||[];return yield this.addConceptToBinaryTree(c.data),c}catch(e){throw e instanceof Error?(console.error("Error fetching suggested concepts:",e.message),new Error("Unable to fetch suggested concepts. Please try again later.")):(console.error("An unexpected error occurred:",e),new Error("An unexpected error occurred while fetching suggested concepts."))}}))}static GetSuggestedConnections(e){return c(this,void 0,void 0,(function*(){try{const t=r.b.BearerAccessToken,n=new URL(i.BaseUrl.GetSuggestedConnections());void 0!==e&&n.searchParams.append("top",e.toString());const o=yield fetch(n.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!o.ok){const e=yield o.text();throw new Error(`Failed to load connections: ${o.status} ${o.statusText}. Details: ${e}`)}const c=(yield o.json())||[];return yield this.addConnectionToBinaryTree(c.data),c}catch(e){throw e instanceof Error?(console.error("Error fetching suggested Connections:",e.message),new Error("Unable to fetch suggested connections. Please try again later.")):(console.error("An unexpected error occurred:",e),new Error("An unexpected error occurred while fetching suggested Connections."))}}))}static addConceptToBinaryTree(e){return c(this,void 0,void 0,(function*(){try{e.forEach((e=>{i.ConceptsData.AddConcept(e)}))}catch(e){console.error("Error on adding Concepts Data into tree")}}))}static addConnectionToBinaryTree(e){return c(this,void 0,void 0,(function*(){try{e.forEach((e=>{i.ConnectionData.AddConnection(e)}))}catch(e){console.error("Error on adding Connections Data into tree")}}))}}o=s,s.conceptsData={},s.connectionsData={},s.SYNC_INTERVAL_MS=12e4,s.nextSyncTime=Date.now(),s.activateStatus=!1,s.accessData="Access Data",o.startAutoSync()},1167:(e,t,n)=>{n.d(t,{Y:()=>a});var o=n(9581),i=n(3518),r=n(4059),c=n(1863),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){return s(this,void 0,void 0,(function*(){const t=r.Logger.logfunction("CreateTheConceptApi",e);let n=(0,r.CreateDefaultConcept)();try{var s=(0,i.Xr)();const a=yield fetch(o.B.CreateTheConceptUrl(),{method:"POST",headers:s,body:JSON.stringify(e)});if(!a.ok)throw(0,c.ry)(a),new Error(`Error! status: ${a.status}`);return n=yield a.json(),r.Logger.logUpdate(t),n}catch(e){e instanceof Error?console.log("Create the concept api error message: ",e.message):console.log("Create the concept api unexpected error: ",e),(0,c.Mb)(e,o.B.CreateTheConceptUrl()),(0,c.ey)(t,"CreateTheConceptApi",e)}}))}},2:(e,t,n)=>{n.d(t,{s:()=>d});var o=n(8286),i=n(9581),r=n(1412),c=n(3518),s=n(1863),a=n(4059),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){var t=arguments;return l(this,void 0,void 0,(function*(){const n=a.Logger.logfunction("GetAllConnectionsOfComposition",t);var i=[];if(0==(i=yield o.d.GetConnectionsOfConcept(e)).length)i=yield u(e);else{var c=yield u(e);(0,r.e)(c,i),i=c}return a.Logger.logUpdate(n),i}))}function u(e){var t=arguments;return l(this,void 0,void 0,(function*(){const n=a.Logger.logfunction("GetAllConnectionsOfCompositionOnline",t);var r=[];try{(0,c.Xr)("application/json");const t=new Headers,d=new FormData;d.append("composition_id",e.toString());const u=yield fetch(i.B.GetAllConnectionsOfCompositionUrl(),{method:"POST",headers:t,body:d});if(console.log("this is getting connection from online",i.B.GetAllConnectionsOfCompositionUrl(),e),!u.ok)throw(0,s.ry)(u),new Error(`Error! status: ${u.status}`);const h=yield u.json();for(var l=0;l<h.length;l++)o.d.AddConnection(h[l]),r.push(h[l]);return a.Logger.logUpdate(n),r}catch(e){e instanceof Error?console.log("Get all connection of composition error : ",e.message):console.log("Get all connection of composition error : ",e),(0,s.Mb)(e,i.B.GetAllConnectionsOfCompositionUrl()),(0,s.ey)(n,"GetAllConnectionsOfCompositionOnline",e)}}))}},8642:(e,t,n)=>{n.d(t,{Y:()=>h});var o=n(8286),i=n(9581),r=n(4364),c=n(5284),s=n(1412),a=n(3518),l=n(1863),d=n(4059),u=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function h(){var e=arguments;return u(this,arguments,void 0,(function*(t=[]){const n=d.Logger.logfunction("GetAllConnectionsOfCompositionBulk",e)||{};if(d.serviceWorker){n.serviceWorker=!0;try{const e=yield(0,d.sendMessage)("GetAllConnectionsOfCompositionBulk",{composition_ids:t});return d.Logger.logUpdate(n),e.data}catch(e){console.error("GetAllConnectionsOfCompositionBulk sw error: ",e),(0,l.ey)(n,"GetAllConnectionsOfCompositionBulk",e),(0,d.handleServiceWorkerException)(e)}}var h=[];if(t.length<=0)return h;var p=yield(0,c.B)(t),f=yield function(){var e=arguments;return u(this,arguments,void 0,(function*(t=[]){const n=d.Logger.logfunction("GetAllConnectionsOfCompositionOnline",e);var r=[];try{var c=(0,a.Xr)();const e=yield fetch(i.B.GetAllConnectionsOfCompositionBulkUrl(),{method:"POST",headers:c,body:JSON.stringify(t)});if(e.ok){const t=yield e.json();for(var s=0;s<t.length;s++)o.d.AddConnection(t[s]),r.push(t[s])}else console.log("Get all connections of composition bulk error message: ","Cannot get response"),(0,l.ry)(e);return d.Logger.logUpdate(n),r}catch(e){e instanceof Error?console.log("Get all connections of composition bulk error message: ",e.message):console.log("Get all connections of composition bulk unexpected error: ",e),(0,l.Mb)(e,i.B.GetAllConnectionsOfCompositionBulkUrl()),(0,l.ey)(n,"GetAllConnectionsOfCompositionOnline",e)}}))}(t);return h=f,(0,s.e)(h,p),yield(0,r.s)(h),d.Logger.logUpdate(n),h}))}},8675:(e,t,n)=>{n.d(t,{l:()=>s});var o=n(1863),i=n(3518),r=n(4059),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e){var t=arguments;return c(this,void 0,void 0,(function*(){r.Logger.logfunction("GetAllLinkerConnectionsFromTheConcept",t);var n=[];try{(new Date).getTime();var c=(0,i.Xr)("application/x-www-form-urlencoded");const t=yield fetch(r.BaseUrl.GetAllLinkerConnectionOfConceptUrl()+`?conceptId=${e}`,{method:"GET",headers:c});if(t.ok){const e=yield t.json();for(var s=0;s<e.length;s++){var a=e[s];n.push(a)}}else console.log("Get all linker connection from the concepts error","cannot get respone"),(0,o.ry)(t)}catch(e){e instanceof Error?console.log("Get all linker connection from the concepts error: ",e.message):console.log("Get all linker connection from the concepts error(Unexpected): ",e),(0,o.Mb)(e,r.BaseUrl.GetAllLinkerConnectionOfConceptUrl())}return n}))}},6058:(e,t,n)=>{n.d(t,{W:()=>s});var o=n(1863),i=n(3518),r=n(4059),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e){var t=arguments;return c(this,void 0,void 0,(function*(){const n=r.Logger.logfunction("GetAllLinkerConnectionsToTheConcept",t);var c=[];try{(new Date).getTime();var s=(0,i.Xr)("application/x-www-form-urlencoded");const t=yield fetch(r.BaseUrl.GetAllLinkerConnectionToConceptUrl()+`?conceptId=${e}`,{method:"GET",headers:s});if(t.ok){const e=yield t.json();for(var a=0;a<e.length;a++){var l=e[a];c.push(l)}r.Logger.logUpdate(n)}else console.log("Get all linker connection To the concepts error","cannot get respone"),(0,o.ry)(t)}catch(e){e instanceof Error?console.log("Get all linker connection To the concepts error: ",e.message):console.log("Get all linker connection To the concepts error(Unexpected): ",e),(0,o.Mb)(e,r.BaseUrl.GetAllLinkerConnectionToConceptUrl()),(0,o.ey)(n,"GetAllLinkerConnectionsToTheConcept",e)}return c}))}},2803:(e,t,n)=>{n.d(t,{x:()=>a});var o=n(8286),i=n(9581),r=n(1863),c=n(4059),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e,t,n){var a=arguments;return s(this,void 0,void 0,(function*(){const s=c.Logger.logfunction("GetCompositionConnectionsBetweenTwoConcepts",a)||{};var l=[];try{if(c.serviceWorker){s.serviceWorker=!0;try{const o=yield(0,c.sendMessage)("GetCompositionConnectionsBetweenTwoConcepts",{ofConceptId:e,toConcept:t,mainKey:n});return c.Logger.logUpdate(s),o.data}catch(e){console.error("GetCompositionConnectionsBetweenTwoConcepts sw error: ",e),(0,r.ey)(s,"GetCompositionConnectionsBetweenTwoConcepts",e),(0,c.handleServiceWorkerException)(e)}}var d=new FormData;d.append("ofConceptId",e.toString()),d.append("mainKey",n.toString()),d.append("toConceptId",t.toString());const a=yield fetch(i.B.GetCompositionConnectionBetweenTwoConceptsUrl(),{method:"POST",body:d,redirect:"follow"});if(a.ok){const e=yield a.json();for(var u=0;u<e.length;u++)o.d.AddConnection(e[u]),l.push(e[u]);c.Logger.logUpdate(s)}else console.log("Get composition connection between two concepts",a.status),(0,r.ry)(a)}catch(e){e instanceof Error?console.log("Get composition connection between two concepts error message: ",e.message):console.log("Get composition connection between two concepts unexpected error: ",e),(0,r.Mb)(e,i.B.GetCompositionConnectionBetweenTwoConceptsUrl()),(0,r.ey)(s,"GetCompositionConnectionsBetweenTwoConcepts",e)}return l}))}},7139:(e,t,n)=>{n.d(t,{r:()=>d});var o=n(3026),i=n(9581),r=n(4059),c=n(1863),s=n(1596),a=n(3278),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){var t=arguments;return l(this,void 0,void 0,(function*(){const n=r.Logger.logfunction("GetConcept",t)||{};let d=(0,r.CreateDefaultConcept)();const u=new FormData;u.append("id",e.toString());try{if(r.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,r.sendMessage)("GetConcept",{id:e});return r.Logger.logUpdate(n),t.data}catch(e){console.error("GetConcept sw error: ",e),(0,c.ey)(n,"GetConcept",e),(0,r.handleServiceWorkerException)(e)}}if(0==e||null==e||null==e)return d;var h=yield o.I.GetConcept(e);let t=o.I.GetNpc(e);if(0!=h.id||t)return r.Logger.logUpdate(n),h;{let t;const h={method:"POST",body:u,headers:{Authorization:"Bearer "+a.b.BearerAccessToken}};try{console.log("this is the url",i.B.GetConceptUrl()),t=yield fetch(i.B.GetConceptUrl(),h)}catch(e){t=yield(0,s.g)(h,"/api/getConcept")}return yield function(e,t,n,i){return l(this,void 0,void 0,(function*(){return e.ok?(t=yield e.json()).id>0?o.I.AddConcept(t):o.I.AddNpc(i):(console.log("Get the concept error",e.status),(0,c.ry)(e)),r.Logger.logUpdate(n),t}))}(t,d,n,e)}}catch(e){e instanceof Error?console.log("Get the concept error message: ",e.message):console.log("Get the concept unexpected error: ",e),(0,c.Mb)(e,i.B.GetConceptUrl()),(0,c.ey)(n,"GetConcept",e)}}))}},1239:(e,t,n)=>{n.d(t,{I:()=>u,r:()=>d});var o=n(3026),i=n(9581),r=n(3518),c=n(1863),s=n(4059),a=n(1596),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){return l(this,void 0,void 0,(function*(){const t=s.Logger.logfunction("GetConceptBulk",[e.length])||{};let n=[],d=((new Date).getTime(),performance.now()),u=Array.from(new Set(e));try{if(s.serviceWorker){t.serviceWorker=!0;try{const n=yield(0,s.sendMessage)("GetConceptBulk",{passedConcepts:e});return s.Logger.logUpdate(t),n.data}catch(e){console.error("GetConceptBulk sw error: ",e),(0,c.ey)(t,"GetConceptBulk",e),(0,s.handleServiceWorkerException)(e)}}if(u.length>0){let h=[];for(let e=0;e<u.length;e++)if(!o.I.GetNpc(u[e])){let t=yield o.I.GetConcept(u[e]);0==t.id?h.push(u[e]):n.push(t)}if(0==h.length)return s.Logger.logfunction(t),n;{let u;const p={method:"POST",headers:(0,r.Xr)(),body:JSON.stringify(h)};try{u=yield fetch(i.B.GetConceptBulkUrl(),p)}catch(e){u=yield(0,a.g)(p,"/api/get_concept_bulk")}yield function(e,t,n,i,r){return l(this,void 0,void 0,(function*(){if(e.ok){let t=yield e.json();if(t.length>0)for(let e=0;e<t.length;e++){let i=t[e];o.I.AddConcept(i),n.push(i)}console.log("added the concepts"),s.Logger.logUpdate(i)}else console.log("Get Concept Bulk error",e.status),s.Logger.logError(r,"unknown","read","unknown",void 0,e.status,e,"GetConceptBulk",[t],"unknown",void 0),(0,c.ry)(e)}))}(u,e,n,t,d)}}}catch(n){n instanceof Error?console.log("Get Concept Bulk  error message: ",n.message):console.log("Get Concept Bulk  unexpected error: ",n),s.Logger.logError(d,"unknown","read","unknown",void 0,500,n,"GetConceptBulk",[e],"unknown",void 0),(0,c.Mb)(n,i.B.GetConceptBulkUrl()),(0,c.ey)(t,"GetConceptBulk",n)}return n}))}function u(e){return l(this,void 0,void 0,(function*(){const t=[];if(e.length>0){const n={"Content-Type":"application/json"};try{const r=yield fetch(i.B.GetConceptBulkUrl(),{method:"POST",headers:n,body:JSON.stringify(e)});if(r.ok){const e=yield r.json();if(e.length>0)for(let n=0;n<e.length;n++){const i=e[n];t.push(i),o.I.AddConcept(i)}}else console.log("bulk concept getter api error: ",r.status),(0,c.ry)(r)}catch(e){e instanceof Error?console.log("bulk concept getter api error: ",e.message):console.log("bulk concept getter api error: ",e),(0,c.Mb)(e,i.B.GetConceptBulkUrl())}}return t}))}},4402:(e,t,n)=>{n.d(t,{A:()=>d});var o=n(3026),i=n(9581),r=n(3518),c=n(1863),s=n(4059),a=n(7876),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e,t){var n=arguments;return l(this,void 0,void 0,(function*(){const l=s.Logger.logfunction("GetConceptByCharacterAndType",n);try{if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetConceptByCharacterAndType",{characterValue:e,typeId:t})).data}catch(e){console.error("GetConceptByCharacterAndType sw error: ",e),(0,s.handleServiceWorkerException)(e)}let n=yield o.I.GetConceptByCharacterAndTypeLocal(e,t);if(null==n||0==n.id){var d={character_value:`${e}`,type_id:t},u=JSON.stringify(d),h=(0,r.Xr)();const s=yield fetch(i.B.GetConceptByCharacterAndTypeUrl(),{method:"POST",headers:h,body:u});if(s.ok){let e=yield s.json();n=e,(0,a.K)(n).then((e=>{o.I.AddConcept(n)}))}else(0,c.ry)(s),console.log("This is the concept by type and character error",s.status)}return s.Logger.logUpdate(l),n}catch(e){e instanceof Error?console.log(" This is the concept by type and character error message: ",e.message):console.log(" This is the concept by type and character unexpected error: ",e),(0,c.Mb)(e,i.B.GetConceptByCharacterAndTypeUrl()),(0,c.ey)(l,"GetConceptByCharacterAndType",e)}}))}},8146:(e,t,n)=>{n.d(t,{Y:()=>l});var o=n(3026),i=n(9581),r=n(4059),c=n(1863),s=n(7876),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e){var t=arguments;return a(this,void 0,void 0,(function*(){const n=r.Logger.logfunction("GetConceptByCharacterValue",t);let a=(0,r.CreateDefaultConcept)();try{const t=new FormData;t.append("character_value",e);const l=yield fetch(i.B.GetConceptByCharacterValueUrl(),{method:"POST",body:t});l.ok?(a=yield l.json(),a.id>0&&(0,s.K)(a).then((e=>{o.I.AddConcept(a)})),r.Logger.logUpdate(n)):((0,c.ry)(l),console.log("Error in Getting concept by character value Error",l.status))}catch(e){e instanceof Error?console.log("Error in Getting concept by character value error message: ",e):console.log("Error in Getting concept by character value unexpected error: ",e),(0,c.Mb)(e,i.B.GetConceptByCharacterValueUrl()),(0,c.ey)(n,"GetConceptByCharacterValue",e)}return a}))}},7467:(e,t,n)=>{n.d(t,{j:()=>u});var o=n(8286),i=n(9581),r=n(4364),c=n(3518),s=n(1863),a=n(4059),l=n(1596),d=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function u(){return d(this,arguments,void 0,(function*(e=[]){const t=a.Logger.logfunction("GetConnectionBulk",e.length)||{};let n=[];try{if(a.serviceWorker){t.serviceWorker=!0;try{const n=yield(0,a.sendMessage)("GetConnectionBulk",{connectionIds:e});return a.Logger.logUpdate(t),n.data}catch(e){console.error("GetConnectionBulk sw error: ",e),(0,s.ey)(t,"GetConnectionBulk",e),(0,a.handleServiceWorkerException)(e)}}if(e.length>0){let r=[];for(let t=0;t<e.length;t++)if(!o.d.GetNpConn(e[t])){let i=yield o.d.GetConnection(e[t]);0==i.id?r.push(e[t]):n.push(i)}if(0==r.length)return a.Logger.logUpdate(t),n;{let e;const u={method:"POST",headers:(0,c.Xr)(),body:JSON.stringify(r)};try{e=yield fetch(i.B.GetConnectionBulkUrl(),u)}catch(t){e=yield(0,l.g)(u,"/api/get_connection_bulk")}yield function(e,t,n){return d(this,void 0,void 0,(function*(){if(e.ok){const n=yield e.json();if(n.length>0)for(let e=0;e<n.length;e++){let i=n[e];t.push(i),o.d.AddConnection(i)}}else(0,s.ey)(n,"GetConnectionBulk",e.status),(0,s.ry)(e),console.log("Get Connection Bulk error",e.status)}))}(e,n,t),a.Logger.logUpdate(t)}}}catch(e){e instanceof Error?console.log("Get Connection Bulk error message: ",e):console.log("Get Connection Bulk unexpected error: ",e),(0,s.ey)(t,"GetConnectionBulk",e),(0,s.Mb)(e,i.B.GetConnectionBulkUrl())}return yield(0,r.s)(n),n}))}},2832:(e,t,n)=>{n.d(t,{j:()=>a});var o=n(4059),i=n(9581),r=n(1863),c=n(3518),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){var t=arguments;return s(this,arguments,void 0,(function*(e,n=""){const s=o.Logger.logfunction("SearchLinkMultipleApi",t);let a=performance.now();var l=(0,c.ab)("application/json",n);const d=i.B.SearchLinkMultipleAllApiUrl(),u=JSON.stringify(e);try{const t=yield fetch(d,{method:"POST",headers:l,body:u});if(t.ok){let e=yield t.json();return o.Logger.logUpdate(s),e}return(0,r.ry)(t),console.log("This is the searching multiple error",t.status),o.Logger.logError(a,"unknown","search","unknown",void 0,t.status,t,"SearchLinkMultipleApi",[e,n],"unknown",void 0),[]}catch(t){console.log("This is the searching multiple error",t),o.Logger.logError(a,"unknown","search","unknown",void 0,500,t,"SearchLinkMultipleApi",[e,n],"unknown",void 0),(0,r.Mb)(t,d),(0,r.ey)(s,"SearchLinkMultipleApi",t)}}))}},3130:(e,t,n)=>{n.d(t,{BG:()=>a,SL:()=>l,XZ:()=>s,ZJ:()=>r,iw:()=>c,pU:()=>d,y0:()=>i,yv:()=>o});const o=1,i=2,r=3,c=4,s=5,a=6,l=7,d=8},9635:(e,t,n)=>{n.d(t,{x:()=>o});const o=new BroadcastChannel("Freeschema_mftsccs_browser_channel")},9581:(e,t,n)=>{n.d(t,{B:()=>o});class o{static setRandomizer(e){console.log("set randomizer",e),this.BASE_RANDOMIZER=e}static getRandomizer(){return this.BASE_RANDOMIZER}static GetConceptUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/getConcept":this.NODE_CACHE_URL+"/api/getConcept"}static GetConnectionUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get-connection-by-id":this.NODE_CACHE_URL+"/api/get-connection-by-id"}static GetConceptBulkUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get_concept_bulk":this.NODE_CACHE_URL+"/api/get_concept_bulk"}static GetConnectionBulkUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get_connection_bulk":this.NODE_CACHE_URL+"/api/get_connection_bulk"}static GetAllConceptsOfUserUrl(){return this.BASE_URL+"/api/get_all_concepts_of_user"}static GetAllConnectionsOfUserUrl(){return this.BASE_URL+"/api/get_all_connections_of_user"}static GetAllConnectionsOfCompositionUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition"}static GetAllConnectionsOfCompositionBulkUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition_bulk"}static GetConceptByCharacterValueUrl(){return this.BASE_URL+"/api/get_concept_by_character_value"}static GetConceptByCharacterAndTypeUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_type"}static GetConceptByCharacterAndCategoryUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category"}static GetConceptByCharacterAndCategoryDirectUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category_direct"}static GetCharacterByCharacterUrl(){return this.BASE_URL+"/api/get_character_by_character"}static GetAllConceptsByTypeUrl(){return this.BASE_URL+"/api/get_all_concepts_by_type"}static GetAllConnectionsOfConceptUrl(){return this.BASE_URL+"/api/get-link-connections"}static GetAllConnectionsToConceptUrl(){return this.BASE_URL+"/api/get-link-reverse-connections"}static GetAllAiData(){return this.BASE_URL+"/api/get-preloaded-concepts"}static getAppConfig(){return this.NODE_URL+"/api/v1/config"}static PostPrefetchConceptConnections(){return this.NODE_URL+"/api/v1/access-tracker/sync-access-tracker"}static GetSuggestedConcepts(){return this.NODE_URL+"/api/v1/access-tracker/list-concepts-file"}static GetSuggestedConnections(){return this.NODE_URL+"/api/v1/access-tracker/list-connections-file"}static PostLogger(){return this.LOG_SERVER+"/api/logger"}static GetAllPrefetchConnectionsUrl(){return this.BASE_URL+"/api/get_all_connections_of_user?inpage=500"}static GetAllLinkerConnectionOfConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-from-concept"}static GetAllLinkerConnectionToConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-to-concept"}static DeleteConceptUrl(){return this.BASE_URL+"/api/delete_concept"}static DeleteUserUrl(){return this.BASE_URL+"/api/deleteuser"}static RecursiveSearchUrl(){return this.BASE_URL+"/api/recursivesearch-concept-connection"}static SearchLinkMultipleAllApiUrl(){return this.BASE_URL+"/api/Connection/search-link-multiple-all-ccs"}static MakeTheNameInBackendUrl(){return this.BASE_URL+"/api/make-name-from-frontend"}static SearchAllTypeWithLinker(e=!0){return e?this.BASE_URL+"/api/search-all-with-linker-ccs":this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static LoginUrl(){return this.BASE_URL+"/api/auth/login"}static SignupUrl(){return this.BASE_URL+"/api/auth/signup"}static GetCompositionConnectionBetweenTwoConceptsUrl(){return this.BASE_URL+"/api/get-composition-connection-between-two-concepts"}static SearchCompositionsUrl(){return this.BASE_URL+"/api/search-compositions"}static SearchLinkMultipleAll(){return this.BASE_URL+"/api/Connection/search-link-multiple-all"}static CreateSessionId(){return this.BASE_URL+"/api/create-session-id-remote"}static CreateSessionVisitUrl(){return this.BASE_URL+"/api/create-remote-session-visit"}static ViewInternalDataUrl(){return this.BASE_URL+"/api/view-api-internal-data-ccs-id-bulk"}static SearchInternalWithAuthenticatedCcsUrl(){return this.BASE_URL+"/api/search-composition-internal-authenticated-ccs"}static SearchInternalWithCcsUrl(){return this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static CreateGhostConceptApiUrl(e=!0){return e?o.NODE_URL+"/api/v1/local-concepts":o.NODE_URL+"/api/v1/local-concepts-without-auth"}static CreateGhostConnectionApiUrl(){return o.NODE_URL+"/api/v1/local-connections"}static GetRealConceptById(){return o.NODE_URL+"/api/v1/local-concepts-translate"}static GetReservedIdUrl(){return this.BASE_URL+"/api/get_reserved_ids"}static GetReservedConnectionIdUrl(){return this.BASE_URL+"/api/get_reserved_connection_ids"}static CreateTheTextDataUrl(){return this.BASE_URL+"/api/create_text_data"}static CreateTheCharacterDataUrl(){return this.BASE_URL+"/api/create_character_data"}static CreateTheConceptUrl(){return this.BASE_URL+"/api/create_the_concept"}static CreateTheConnectionUrl(){return this.BASE_URL+"/api/create_the_connection"}static CreateTheConnectionNewUrl(){return this.BASE_URL+"/api/create_the_connection_new"}static MakeTheTypeConceptUrl(){return this.BASE_URL+"/api/make_the_type_concept"}static DeleteTheConnectionUrl(){return this.BASE_URL+"/api/delete_connection"}static DeleteTheConnectionBulkUrl(){return this.BASE_URL+"/api/delete_connection_bulk"}static FreeschemaQueryUrl(){return this.BASE_URL+"/api/freeschema-query"}static uploadImageUrl(){return this.BASE_URL+"/api/Image/UploadImage"}static uploadFileUrl(){return this.BASE_URL+"/api/Image/UploadFile"}static sendMail(){return this.BASE_URL+"/api/sendmail"}static sendBulkMail(){return this.BASE_URL+"/api/sendmail/bulk"}static getWidgetData(){return this.BASE_URL+"/api/get-widget"}static getLatestWidgetData(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&"string"==typeof this.NODE_CACHE_URL&&""===this.NODE_CACHE_URL.trim()?this.BASE_URL+"/api/get-latest-widget":this.NODE_CACHE_URL+"/api/get-latest-widget"}static getConnectionsByTypes(){return this.BASE_URL+"/api/get-connection-by-types"}static CreatePrototypeUrl(){return this.BASE_URL+"/api/create-prototype"}}o.BASE_URL="https://localhost:7053/",o.NODE_CACHE_URL="",o.AI_URL="https://ai.freeschema.com",o.MQTT_URL="192.168.1.249",o.NODE_URL="http://localhost:5001",o.LOG_SERVER="https://logdev.freeschema.com",o.BASE_APPLICATION="",o.DOCUMENTATION_WIDGET=0,o.FLAGS={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1},o.BASE_RANDOMIZER=999},6963:(e,t,n)=>{n.d(t,{f:()=>c});var o=n(205),i=n(6731),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{static waitForDataToLoad(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isCharacterLoaded)return e("done");setTimeout(c.checkFlag,1e3,e)}static addNodeToTree(e){return r(this,void 0,void 0,(function*(){return null==this.characterRoot?(this.characterRoot=e,this.characterRoot):(this.characterRoot=this.characterRoot.addCharacterNode(e,this.characterRoot,this.characterRoot.height),this.characterRoot)}))}static removeNodeByCharacter(e,t){return r(this,void 0,void 0,(function*(){this.characterRoot&&this.characterRoot.removeNodeWithVariants(this.characterRoot,e,t)}))}static countNumberOfNodes(){return this.characterRoot?this.characterRoot.countNodeBelow(this.characterRoot):0}static addConceptToTree(e){if(""!=e.characterValue){var t=new i.b(e.characterValue,e,null,null);this.addNodeToTree(t)}}static getNodeFromTree(e){return this.characterRoot?this.characterRoot.getCharacterFromNode(e,this.characterRoot):this.characterRoot}static getNodeFromTreeUpdated(e){return this.characterRoot?this.characterRoot.getCharacterFromNode(e,this.characterRoot):this.characterRoot}static getCharacterAndTypeFromTree(e,t){return r(this,void 0,void 0,(function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndType(e,t,this.characterRoot):this.characterRoot}))}static getCharacterAndCategoryFromTree(e,t){return r(this,void 0,void 0,(function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndCategory(e,t,this.characterRoot):this.characterRoot}))}static removeConceptCharacter(e){this.characterRoot&&(this.characterRoot=this.characterRoot.removeNode(this.characterRoot,e))}}c.characterRoot=null},2202:(e,t,n)=>{n.d(t,{W:()=>a});var o=n(6963),i=n(6731),r=n(205),c=n(4059),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static waitForDataToLoad(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(r.B.isDataLoaded)return e("done");setTimeout(a.checkFlag,1e3,e)}static addConceptToTree(e){let t=new i.b(e.id,e,null,null),n=new i.b(e.characterValue,e,null,null);o.f.addNodeToTree(n),this.addNodeToTree(t)}static getNodeFromTree(e){return s(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static removeNodeFromTree(e){return s(this,void 0,void 0,(function*(){if(this.root){let t=new Event(`${e}`);console.log("this is the fired event after delete",t),(0,c.dispatchIdEvent)(e),this.root=this.root.removeNode(this.root,e)}}))}static getConceptListFromIds(e,t,n){return s(this,void 0,void 0,(function*(){this.root&&this.root.checkIfIdsInNode(this.root,e,t,n)}))}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}a.root=null},5457:(e,t,n)=>{n.d(t,{c:()=>a});var o=n(4059),i=n(7282),r=n(205);class c{constructor(e,t){this.value=[],this.height=1,this.key=e,this.value.push(t),this.leftNode=null,this.rightNode=null,this.currentNode=null}addType(e,t,n){var i,r,s,a;if(null==e)return(0,o.dispatchIdEvent)(t,{detail:n}),new c(t,n);if(t<e.key)e.leftNode=this.addType(e.leftNode,t,n);else{if(!(t>e.key))return e.value.includes(n)||((0,o.dispatchIdEvent)(t,{detail:n}),e.value.push(n)),e;e.rightNode=this.addType(e.rightNode,t,n)}e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1;const l=this.getBalanceFactor(e);return l>1&&t<(null===(i=e.leftNode)||void 0===i?void 0:i.key)?this.rightRotate(e):l<-1&&t>(null===(r=e.rightNode)||void 0===r?void 0:r.key)?this.leftRotate(e):l>1&&t>(null===(s=e.leftNode)||void 0===s?void 0:s.key)?(e.leftNode=this.leftRotate(e.leftNode),this.rightRotate(e)):l<-1&&t<(null===(a=e.rightNode)||void 0===a?void 0:a.key)?(e.rightNode=this.rightRotate(e.rightNode),this.leftRotate(e)):e}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}removeNodeWithVariants(e,t,n){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNodeWithVariants(e.leftNode,t,n),e;if(e.key<t)return e.rightNode=this.removeNodeWithVariants(e.rightNode,t,n),e;if(e.value.length>0)for(let t=0;t<e.value.length;t++)if(n==e.value[t])return e.value.splice(t,1),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.currentNode=t.currentNode,e.rightNode=this.removeNodeWithVariants(e.rightNode,t.key,n),e}}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{static addType(e){return s(this,void 0,void 0,(function*(){return null==this.root?(this.root=e,new CustomEvent(`${e.key}`,{detail:e.value[0]}),(0,o.dispatchIdEvent)(e.key,{detail:e.value[0]}),this.root):(this.root=this.root.addType(this.root,e.key,e.value[0]),this.root)}))}static addConceptToTree(e){if(0!=e.typeId){let t=new c(e.typeId,e.id);this.addType(t)}}static removeTypeConcept(e,t){this.root&&(this.root=this.root.removeNodeWithVariants(this.root,e,t))}static getNodeFromTreeNew(e){return this.root?this.root.getFromNode(e,this.root):this.root}static getTypeVariantsFromTreeNew(e){return s(this,void 0,void 0,(function*(){let t=this.getNodeFromTreeNew(e),n=[],i=[];if(t){n=t.value;for(let e=0;e<n.length;e++){let t=!1;for(let o=0;o<i.length;o++)i[o].id==n[e]&&(t=!0);t||i.push(yield(0,o.GetTheConcept)(n[e]))}}return i}))}static waitForDataToLoad(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(r.B.isTypeLoaded)return e("done");setTimeout(a.checkFlag,1e3,e)}static getTypeVariantsFromTreeWithUserIdNew(e,t){return s(this,void 0,void 0,(function*(){let n=[],o=yield this.getTypeVariantsFromTreeNew(e);console.log("these are all the concepts",o);for(let e=0;e<o.length;e++)o[e].userId==t&&n.push(o[e]);return n}))}static getTypeVariantsWithCharacterValueNew(e,t){return s(this,void 0,void 0,(function*(){let n=yield this.getTypeVariantsFromTreeNew(t);console.log("this is all the concepts for character",n);let o=(0,i.o)();for(let t=0;t<n.length;t++)n[t].characterValue==e&&(o=n[t]);return o}))}static countNumberOfNodes(){return this.typeRoot?this.typeRoot.countNodeBelow(this.typeRoot):0}}a.typeRoot=null,a.root=null},2615:(e,t,n)=>{n.d(t,{j:()=>i});var o=n(4059);class i{constructor(e,t,n,i,r,c,s,a=!1,l,d,u){this.count=0,this.typeCharacter="",this.referent=null,this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=o.BaseUrl.getRandomizer(),this.x=0,this.y=0,this.id=e,this.userId=t,this.typeId=n,this.ghostId=e,this.categoryId=i,this.referentId=r,this.characterValue=`${c}`,this.accessId=s,this.typeCharacter=u,this.type=null,this.isNew=a,this.entryTimeStamp=l,this.updatedTimeStamp=d}getType(){console.log(this.typeId)}}},3026:(e,t,n)=>{n.d(t,{I:()=>f});var o=n(3655),i=n(2202),r=n(6963),c=n(5457),s=n(7282),a=n(4059);class l{constructor(e,t,n,o){this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}addNode(e,t,n){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.rightNode=this.removeNode(e.rightNode,t.key),e}}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var d=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class u{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addWidgetToTree(e){let t=new l(e.widgetId,e,null,null);this.addNodeToTree(t)}static getNodeFromTree(e){return d(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static removeNodeFromTree(e){return d(this,void 0,void 0,(function*(){this.root&&(this.root=this.root.removeNode(this.root,e))}))}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}u.root=null;class h{constructor(){this.widgetId=0,this.mainId=0,this.conceptIds=[],this.linkers=[],this.reverse=[],this.mainCompositionIds=[],this.countinfo=[]}}var p=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class f{constructor(){this.name="conceptsArray"}static CheckContains(e){for(var t=!1,n=0;n<this.conceptsArray.length;n++)this.conceptsArray[n].id==e.id&&(t=!0);return t}static AddNpc(e){this.NPC.includes(e)||(this.NPC.length>10&&(this.NPC=[]),this.NPC.push(e))}static GetNpc(e){return!!this.NPC.includes(e)}static AddConceptToStorage(e){e.id>0&&(0,o.kH)("concept",e)}static GetConceptBulkData(e,t,n){return p(this,void 0,void 0,(function*(){yield i.W.getConceptListFromIds(e,t,n)}))}static AddWidget(e){if(a.serviceWorker)try{(0,a.sendMessage)("ConceptsData__AddWidget",{widgetDetails:e})}catch(e){console.error("Concept Data, Add Widget sw error: ",e),(0,a.handleServiceWorkerException)(e)}e.widgetId>0&&u.addWidgetToTree(e)}static AddConcept(e){if(a.serviceWorker)try{(0,a.sendMessage)("ConceptsData__AddConcept",{concept:e})}catch(e){console.error("Concept Data, Add Concpet sw error: ",e),(0,a.handleServiceWorkerException)(e)}e.id>0&&(i.W.addConceptToTree(e),c.c.addConceptToTree(e))}static AddConceptToMemory(e){e.id>0&&(i.W.addConceptToTree(e),c.c.addConceptToTree(e))}static AddConceptTemporary(e){var t=this.CheckContains(e);this.conceptDictionary[e.id]=e,t&&this.RemoveConcept(e),this.conceptsArray.push(e)}static RemoveConcept(e){for(var t=0;t<this.conceptsArray.length;t++)this.conceptsArray[t].id==e.id&&this.conceptsArray.splice(t,1);(0,o.wh)("concept",e.id)}static GetWidget(e){return p(this,void 0,void 0,(function*(){let t=new h;if(a.serviceWorker)try{return(yield(0,a.sendMessage)("ConceptsData__GetWidget",{id:e})).data}catch(e){console.error("Concept Data, Get Widget sw error: ",e),(0,a.handleServiceWorkerException)(e)}let n=yield u.getNodeFromTree(e);return null!=n&&(t=n.value),t}))}static RemoveWidget(e){return p(this,void 0,void 0,(function*(){if(a.serviceWorker)try{return(yield(0,a.sendMessage)("ConceptsData__RemoveWidget",{id:e})).data}catch(e){console.error("Concept Data, Remove Widget sw error: ",e),(0,a.handleServiceWorkerException)(e)}yield u.removeNodeFromTree(e)}))}static GetConcept(e){return p(this,void 0,void 0,(function*(){if(a.serviceWorker)try{return(yield(0,a.sendMessage)("ConceptsData__GetConcept",{id:e})).data}catch(e){console.error("Concept Data, Get Concpet sw error: ",e),(0,a.handleServiceWorkerException)(e)}if(0==e||null==e||null==e)return(0,s.o)();var t=(0,s.o)(),n=yield i.W.getNodeFromTree(e);if(null==n?void 0:n.value){var o=n.value;o&&(t=o)}return t}))}static GetConceptByCharacter(e){return p(this,void 0,void 0,(function*(){var t=(0,s.o)(),n=r.f.getNodeFromTree(e);return n&&(t=n.value),t}))}static GetConceptByCharacterUpdated(e){return p(this,void 0,void 0,(function*(){var t=(0,s.o)(),n=r.f.getNodeFromTree(e);return n&&(t=n.value),t}))}static GetConceptByCharacterAndTypeLocal(e,t){return p(this,void 0,void 0,(function*(){return(0,s.o)(),yield c.c.getTypeVariantsWithCharacterValueNew(e,t)}))}static GetConceptByCharacterAndCategoryLocal(e,t){return p(this,void 0,void 0,(function*(){var n=(0,s.o)(),o=yield r.f.getCharacterAndCategoryFromTree(e,t);return o&&(n=o.value),n}))}static GetConceptsByTypeId(e){let t=[];for(var n=0;n<this.conceptsArray.length;n++)this.conceptsArray[n].typeId==e&&t.push(this.conceptsArray[n]);return t}static GetConceptsByTypeIdAndUser(e,t){var n=arguments;return p(this,void 0,void 0,(function*(){if(a.Logger.logfunction("ConceptsData.GetConceptsByTypeIdAndUser",n),a.serviceWorker)try{return(yield(0,a.sendMessage)("ConceptsData__GetConceptsByTypeIdAndUser",{typeId:e,userId:t})).data}catch(e){console.error("Concept Data, Get Concpet sw error:",e),(0,a.handleServiceWorkerException)(e)}let o=[];return o=yield c.c.getTypeVariantsFromTreeWithUserIdNew(e,t),o}))}static GetBinaryCharacterTree(){return r.f.characterRoot}getName(){return this.name}}f.conceptsArray=[],f.NPC=[],f.conceptDictionary=[]},2155:(e,t,n)=>{n.d(t,{N:()=>r});var o=n(7282),i=n(9581);class r{constructor(e=0,t,n,r,c,s,a){this.count=0,this.isTemp=!1,this.toUpdate=!1,this.applicationId=i.B.getRandomizer(),this.type=(0,o.o)(),this.ofConcept=(0,o.o)(),this.toConcept=(0,o.o)(),this.id=e,this.ofTheConceptId=t,this.toTheConceptId=n,this.userId=r,this.typeId=c,this.ghostId=e,this.orderId=s,this.accessId=a,this.entryTimeStamp=(0,o.Y)(new Date),this.terminationDateTime=new Date,this.localSyncTime=new Date,this.typeCharacter=""}}},5239:(e,t,n)=>{n.d(t,{O:()=>s});var o=n(205),i=n(4059);class r{constructor(e,t,n,o){this.leftNode=null,this.rightNode=null,this.variants=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o,this.currentNode=null}addCurrentNode(e,t){return null==t?t=e:(e.value.typeId!=t.value.typeId&&(t.currentNode=this.addCurrentNode(e,t.currentNode)),t)}addCurrentNodeType(e,t){if(null==t)return e;let n=!1;e.value.id==t.value.id&&(n=!0);for(let o=0;o<t.variants.length;o++)t.variants[o].value.id==e.value.id&&(n=!0);return n||t.variants.push(e),t}getMax(e,t){return e>t?e:t}addNode(e,t,n){if(null==t)return(0,i.dispatchIdEvent)(e.value.ofTheConceptId),e;let o=t.leftNode,r=t.rightNode;if(e.key<t.key)t.leftNode=this.addNode(e,o,n);else{if(!(e.key>t.key))return t;t.rightNode=this.addNode(e,r,n)}t.height=1+this.getMax(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let c=this.getBalanceFactor(t);if(c>1&&t.leftNode){if(this.getBalanceFactor(t.leftNode)>=0)return this.rightRotate(t);if(this.getBalanceFactor(t.leftNode)<0)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(c<-1&&t.rightNode){if(this.getBalanceFactor(t.rightNode)<=0)return this.leftRotate(t);if(this.getBalanceFactor(t.rightNode)>0)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}addTypeNode(e,t,n){if(0!=e.value.typeId){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addTypeNode(e,o,n);else{if(!(t.key<e.key))return t.key==e.key&&0!=t.key&&t.addCurrentNodeType(e,t),t;t.rightNode=this.addTypeNode(e,i,n)}t.height=1+this.getMax(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key){return this.rightRotate(t)}if(e.key>t.leftNode.key){return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key){return this.leftRotate(t)}if(e.key<t.rightNode.key){return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=this.getMax(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=this.getMax(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}throw console.log("this is the error in right rotation",e,t),new Error("Cannot perform right rotation: left node is null.")}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=this.getMax(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=this.getMax(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}throw console.log("this is the error in left rotation",e,t),new Error("Cannot perform left rotation: right node is null.")}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){try{if(t)return e==t.key?(t.value.count?t.value.count++:t.value.count=1,t):e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t}catch(n){console.log("this is the exception",e,t,null==t?void 0:t.leftNode,null==t?void 0:t.rightNode)}return t}getCharacterFromNode(e,t){return t?e==t.key?t:e<t.key?this.getCharacterFromNode(e,t.leftNode):e>t.key?this.getCharacterFromNode(e,t.rightNode):t:t}checkIfIdsInNode(e,t,n,o){if(e){if(t.includes(e.key)){n.push(e.value);let o=t.indexOf(e.key);t.splice(o,1)}e.leftNode&&this.checkIfIdsInNode(e.leftNode,t,n,o),e.rightNode&&this.checkIfIdsInNode(e.rightNode,t,n,o)}}traverse(e){let t=0;return e&&(t+=1,(null==e?void 0:e.leftNode)&&(t+=this.traverse(e.leftNode)),e.rightNode&&(t+=this.traverse(e.rightNode))),t}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(new Event(`${e.value.ofTheConceptId}`),(0,i.dispatchIdEvent)(e.value.ofTheConceptId),null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNode(e.rightNode,t.key),e}}removeNodeWithVariants(e,t,n){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNodeWithVariants(e.leftNode,t,n),e;if(e.key<t)return e.rightNode=this.removeNodeWithVariants(e.rightNode,t,n),e;if(e.variants.length>0)if(e.value.id==n){let t=e.variants[0];if(t)return e.value=t.value,e.key=t.key,e.currentNode=t.currentNode,e.variants.splice(0,1),e}else for(let t=0;t<e.variants.length;t++)if(n==e.variants[t].value.id)return e.variants.splice(t,1),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNodeWithVariants(e.rightNode,t.key,n),e}}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class s{static addNodeToTree(e){try{if(null==this.connectionroot)return this.connectionroot=e,this.connectionroot;this.connectionroot=this.connectionroot.addNode(e,this.connectionroot,this.connectionroot.height)}catch(e){throw console.log("This is the error in making the tree",e),e}}static addConnectionToTree(e){let t=new r(e.id,e,null,null);this.addNodeToTree(t)}static traverse(){var e;return null===(e=this.connectionroot)||void 0===e?void 0:e.traverse(this.connectionroot)}static waitForDataToLoad(){return c(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isConnectionLoaded)return e("done");setTimeout(s.checkFlag,1e3,e)}static removeNodeFromTree(e){return c(this,void 0,void 0,(function*(){this.connectionroot&&(this.connectionroot=this.connectionroot.removeNode(this.connectionroot,e))}))}static getNodeFromTree(e){return c(this,void 0,void 0,(function*(){try{return this.connectionroot?this.connectionroot.getFromNode(e,this.connectionroot):this.connectionroot}catch(t){console.log("this is the getNodeFromTree",e,this.connectionroot)}}))}static getConnectionListFromIds(e,t,n){return c(this,void 0,void 0,(function*(){this.connectionroot&&this.connectionroot.checkIfIdsInNode(this.connectionroot,e,t,n)}))}}s.connectionroot=null},991:(e,t,n)=>{n.d(t,{H:()=>s});var o=n(4059),i=n(3996);class r extends i.i{constructor(e,t,n,o){super(e,t,n,o),this.key="",this.value=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}addNode(e,t,n){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(this.getBalanceFactor(t.leftNode)>=0)return this.rightRotate(t);if(this.getBalanceFactor(t.leftNode)<0)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(this.getBalanceFactor(t.rightNode)<=0)return this.leftRotate(t);if(this.getBalanceFactor(t.rightNode)>0)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}}var c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class s{static CreateCompositionKey(e,t){return e}static GetConnectionByOfTheConceptAndTypeId(e,t){let n=this.CreateCompositionKey(e,t);if(this.node){let e=this.node.getFromNode(n,this.node);if(e)return e.value}return null}static addConnection(e){if(e.id>0){let t=this.CreateCompositionKey(e.ofTheConceptId,e.typeId);if(this.node){let n=this.node.getFromNode(t,this.node);if(n){let t=null==n?void 0:n.value;0==t.length&&(n.value=[]),t.includes(e.id)||t.push(e.id)}else{let n=[];n.push(e.id);let o=new r(t,n,null,null);this.addNodeToTree(o)}}else{let n=[];n.push(e.id);let o=new r(t,n,null,null);this.addNodeToTree(o)}new Event(`${t}`)}else console.log("cannot insert key id with  n 0 to the connection tree",e)}static addNodeToTree(e){return c(this,void 0,void 0,(function*(){return null==this.node?(this.node=e,console.log("this is type dispatch in connection",e),(0,o.dispatchIdEvent)(e.key),this.node):(this.node=this.node.addNode(e,this.node,this.node.height),this.node)}))}static removeNodeFromTree(e){return c(this,void 0,void 0,(function*(){this.node&&(this.node=this.node.removeNode(this.node,e))}))}}s.node=null},3996:(e,t,n)=>{n.d(t,{i:()=>o});class o{constructor(e,t,n,o){this.key="",this.value=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNode(e.rightNode,t.key),e}}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}},8286:(e,t,n)=>{n.d(t,{d:()=>f});var o=n(1735),i=n(4059),r=n(3655),c=n(1863),s=n(2155),a=n(5239),l=n(991),d=n(3996);class u extends d.i{constructor(e,t,n,o){super(e,t,n,o),this.key="",this.value=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}addNode(e,t,n){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}}class h{static CreateCompositionKey(e){return e}static addNodeToTree(e){return t=this,n=void 0,i=function*(){return null==this.connectionTypeRoot?(this.connectionTypeRoot=e,this.connectionTypeRoot):(this.connectionTypeRoot=this.connectionTypeRoot.addNode(e,this.connectionTypeRoot,this.connectionTypeRoot.height),this.connectionTypeRoot)},new((o=void 0)||(o=Promise))((function(e,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(c,s)}a((i=i.apply(t,n||[])).next())}));var t,n,o,i}static addConnectionToTree(e){if(e.id>0){let t=this.CreateCompositionKey(e.typeId);if(this.connectionTypeRoot){let n=this.connectionTypeRoot.getFromNode(t,this.connectionTypeRoot);if(n){let t=null==n?void 0:n.value;0==t.length&&(n.value=[]),t.includes(e.id)||t.push(e.id)}else{let n=[];n.push(e.id);let o=new u(t,n,null,null);this.addNodeToTree(o)}}else{let n=[];n.push(e.id);let o=new u(t,n,null,null);this.addNodeToTree(o)}}else console.log("cannot insert key id with  n 0 to the connection tree",e)}static GetConnectionByOfTheConceptAndTypeId(e,t){let n=this.CreateCompositionKey(t);if(this.connectionTypeRoot){let e=this.connectionTypeRoot.getFromNode(n,this.connectionTypeRoot);if(e)return e.value}return null}}h.connectionTypeRoot=null;var p=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class f{constructor(){this.name="Connection Array"}static CheckContains(e){let t=!1;for(let n=0;n<this.connectionArray.length;n++)this.connectionArray[n].id==e.id&&(t=!0);return t}static AddConnectionToStorage(e){(0,r.kH)("connection",e)}static AddNpConn(e){this.deletedConnections.includes(e)||this.deletedConnections.push(e)}static GetNpConn(e){return!!this.deletedConnections.includes(e)}static AddConnection(e){try{a.O.addConnectionToTree(e),h.addConnectionToTree(e),l.H.addConnection(e)}catch(e){throw console.log("this is the error in making the connection"),e}}static AddConnectionToMemory(e){e.isTemp||(a.O.addConnectionToTree(e),h.addConnectionToTree(e),l.H.addConnection(e))}static AddToDictionary(e){this.connectionDictionary[e.id]=e}static RemoveConnection(e){0!=e.id&&((0,r.wh)("connection",e.id),a.O.removeNodeFromTree(e.id),l.H.removeNodeFromTree(e.id))}static GetConnectionTypeOfTree(){l.H.node}static GetConnectionByOfTheConceptAndType(e,t){return p(this,void 0,void 0,(function*(){try{if(i.serviceWorker)try{return(yield(0,i.sendMessage)("ConnectionData__GetConnectionByOfTheConceptAndType",{ofTheConceptId:e,typeId:t})).data}catch(e){console.error("GetConnectionByOfTheConceptAndType sw error: ",e),(0,i.handleServiceWorkerException)(e)}return l.H.GetConnectionByOfTheConceptAndTypeId(e,t)||[]}catch(e){return console.log("this is the error in GetConnectionByOfTheConceptAndType",e),[]}}))}static GetConnectionByOfType(e,t){const n=i.Logger.logfunction("ConnectionData.GetConnectionByOfType",arguments);let o=h.GetConnectionByOfTheConceptAndTypeId(e,t);return o?(i.Logger.logUpdate(n),o):(i.Logger.logUpdate(n),[])}static GetConnectionTree(){return a.O.connectionroot}static GetConnectionTypeTree(){return h.connectionTypeRoot}static GetConnectionBulkData(e,t,n){return p(this,void 0,void 0,(function*(){yield a.O.getConnectionListFromIds(e,t,n)}))}static GetConnection(e){return p(this,void 0,void 0,(function*(){o.J.incrementConnection(e);let t=new s.N(0,0,0,0,0,0,0);try{if(i.serviceWorker)try{return(yield(0,i.sendMessage)("ConnectionData__GetConnection",{id:e})).data}catch(e){console.error("GetConnection sw error: ",e),(0,i.handleServiceWorkerException)(e)}let n=yield a.O.getNodeFromTree(e);if(null==n?void 0:n.value){let e=n.value;e&&(t=e)}return t}catch(e){return console.log("this is the error in GetConnection",e),t}}))}static GetConnectionsOfCompositionLocal(e){var t=arguments;return p(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("ConnectionData.GetConnectionsOfCompositionLocal",t)||{};let o=[];try{if(i.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,i.sendMessage)("ConnectionData__GetConnectionsOfCompositionLocal",{id:e});return i.Logger.logUpdate(n),t.data}catch(e){console.error("GetConnectionsOfCompositionLocal sw error: ",e),(0,c.ey)(n,"GetConnectionsOfCompositionLocal",e),(0,i.handleServiceWorkerException)(e)}}let t=[];t=f.GetConnectionByOfType(e,e);for(let e=0;e<t.length;e++){let r=yield a.O.getNodeFromTree(t[e]);r&&o.push(r.value),i.Logger.logUpdate(n)}}catch(t){console.log("this is the error GetConnectionsOfCompositionLocal",e,o),(0,c.ey)(n,"ConnectionData.GetConnectionsOfCompositionLocal",t)}return o}))}static GetConnectionsOfConcept(e){return p(this,void 0,void 0,(function*(){let t=[],n=[];try{if(i.serviceWorker)try{return(yield(0,i.sendMessage)("ConnectionData__GetConnectionsOfConcept",{id:e})).data}catch(e){console.error("GetConnectionsOfConcept sw error: ",e),(0,i.handleServiceWorkerException)(e)}t=yield f.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<t.length;e++){let o=yield a.O.getNodeFromTree(t[e]);o&&n.push(o.value)}return n}catch(e){return console.log("this is the error in GetConnectionsOfConcept",e),n}}))}getName(){return this.name}}f.deletedConnections=[],f.connectionArray=[],f.connectionDictionary=[]},276:(e,t,n)=>{n.d(t,{y:()=>o});class o{constructor(){this.conceptId=0,this.connectionTypeId=0,this.connectionType="",this.count=0}}},205:(e,t,n)=>{n.d(t,{B:()=>o});class o{}o.isTypeLoaded=!1,o.isCharacterLoaded=!1,o.isDataLoaded=!1,o.isLocalDataLoaded=!1,o.isLocalCharacterLoaded=!1,o.isLocalTypeLoaded=!1,o.isConnectionLoaded=!1,o.isConnectionTypeLoaded=!1,o.isLocalConnectionLoaded=!1},2515:(e,t,n)=>{n.d(t,{x:()=>o});class o{constructor(e,t,n,o){this.variants=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o,this.currentNode=null}addCurrentNode(e,t){return null==t?t=e:(e.value.typeId!=t.value.typeId&&(t.currentNode=this.addCurrentNode(e,t.currentNode)),t)}addCurrentNodeType(e,t){if(null==t)return e;var n=!1;for(let o=0;o<t.variants.length;o++)t.variants[o].value.id==e.value.id&&(n=!0);return n||t.variants.push(e),t}addNode(e,t,n){if(null==t)return e;var o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}addCharacterNode(e,t,n){if(""!=e.value.characterValue){if(null==t)return e;var o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addCharacterNode(e,o,n);else{if(!(t.key<e.key))return t.key==e.key&&""!=t.key&&t.value.id!=e.value.id&&t.addCurrentNodeType(e,t),t;t.rightNode=this.addCharacterNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}return t}addTypeNode(e,t,n){if(0!=e.value.typeId){if(null==t)return e;var o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addTypeNode(e,o,n);else{if(!(t.key<e.key))return t.key==e.key&&0!=t.key&&t.value.id!=e.value.id&&t.addCurrentNodeType(e,t),t;t.rightNode=this.addTypeNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}updateNodeSyncStatus(e,t,n){if(n){if(e==n.key){let e=n.value;return e.isSynced=t,n.value=e,n}return e<n.key?this.updateNodeSyncStatus(e,t,n.leftNode):e>n.key?this.updateNodeSyncStatus(e,t,n.rightNode):n}return n}getCharacterFromNode(e,t){return t?e==t.key?t:e<t.key?this.getCharacterFromNode(e,t.leftNode):e>t.key?this.getCharacterFromNode(e,t.rightNode):t:t}getFromNodeWithCharacterAndType(e,t,n){if(e=`${e}`,n){if(e==n.key){if(e==n.value.characterValue&&t==n.value.typeId)return n;for(let e=0;e<n.variants.length;e++)if(n.variants[e].value.typeId==t)return n.variants[e]}else{if(e<n.key)return this.getFromNodeWithCharacterAndType(e,t,n.leftNode);if(e>n.key)return this.getFromNodeWithCharacterAndType(e,t,n.rightNode)}return null}return n}getFromNodeWithCharacterAndCategory(e,t,n){if(e=`${e}`,n){if(e==n.key){if(e==n.value.characterValue&&t==n.value.categoryId)return n;for(let e=0;e<n.variants.length;e++)if(n.variants[e].value.categoryId==t)return n.variants[e]}else{if(e<n.key)return this.getFromNodeWithCharacterAndCategory(e,t,n.leftNode);if(e>n.key)return this.getFromNodeWithCharacterAndCategory(e,t,n.rightNode)}return null}return n}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}var n=this.inOrderSuccessor(e.rightNode);return e.value=n.value,e.key=n.key,e.variants=n.variants,e.currentNode=n.currentNode,e.rightNode=this.removeNode(e.rightNode,n.key),e}removeNodeWithVariants(e,t,n){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNodeWithVariants(e.leftNode,t,n),e;if(e.key<t)return e.rightNode=this.removeNodeWithVariants(e.rightNode,t,n),e;if(e.variants.length>0)if(e.value.id==n){var o=e.variants[0];if(o)return e.value=o.value,e.key=o.key,e.currentNode=o.currentNode,e.variants.splice(0,1),e}else for(let t=0;t<e.variants.length;t++)if(n==e.variants[t].value.id)return e.variants.splice(t,1),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}var i=this.inOrderSuccessor(e.rightNode);return e.value=i.value,e.key=i.key,e.variants=i.variants,e.currentNode=i.currentNode,e.rightNode=this.removeNodeWithVariants(e.rightNode,i.key,n),e}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}},9736:(e,t,n)=>{n.d(t,{v:()=>C});var o=n(205),i=n(2515),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addConceptToTree(e){var t=new i.x(e.id,e,null,null);new i.x(e.characterValue,e,null,null),this.addNodeToTree(t)}static waitForDataToLoad(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isLocalDataLoaded)return e("done");setTimeout(c.checkFlag,1e3,e)}static getNodeFromTree(e){return r(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static getCharacterAndTypeFromTree(e,t){return this.root?this.root.getFromNodeWithCharacterAndType(e,t,this.root):this.root}static updateSyncStatus(e){return this.root?this.root.updateNodeSyncStatus(e,!0,this.root):this.root}static removeNodeFromTree(e){return r(this,void 0,void 0,(function*(){this.root&&(this.root=this.root.removeNode(this.root,e))}))}}c.root=null;var s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{static waitForDataToLoad(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isLocalCharacterLoaded)return e("done");setTimeout(a.checkFlag,1e3,e)}static addNodeToTree(e){return s(this,void 0,void 0,(function*(){return null==this.LocalCharacterRoot?(this.LocalCharacterRoot=e,this.LocalCharacterRoot):(this.LocalCharacterRoot=this.LocalCharacterRoot.addCharacterNode(e,this.LocalCharacterRoot,this.LocalCharacterRoot.height),this.LocalCharacterRoot)}))}static addConceptToTree(e){if(""!=e.characterValue){var t=new i.x(e.characterValue,e,null,null);this.addNodeToTree(t)}}static getNodeFromTree(e){return this.LocalCharacterRoot?this.LocalCharacterRoot.getCharacterFromNode(e,this.LocalCharacterRoot):this.LocalCharacterRoot}static getCharacterAndTypeFromTree(e,t){return s(this,void 0,void 0,(function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndType(e,t,this.LocalCharacterRoot):this.LocalCharacterRoot}))}static getCharacterAndCategoryFromTree(e,t){return s(this,void 0,void 0,(function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndCategory(e,t,this.LocalCharacterRoot):this.LocalCharacterRoot}))}static removeConceptType(e,t){this.LocalCharacterRoot&&(this.LocalCharacterRoot=this.LocalCharacterRoot.removeNodeWithVariants(this.LocalCharacterRoot,e,t))}}a.LocalCharacterRoot=null;var l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class d{static addNodeToTree(e){return l(this,void 0,void 0,(function*(){return null==this.LocalTypeRoot?(this.LocalTypeRoot=e,this.LocalTypeRoot):(this.LocalTypeRoot=this.LocalTypeRoot.addTypeNode(e,this.LocalTypeRoot,this.LocalTypeRoot.height),this.LocalTypeRoot)}))}static addConceptToTree(e){if(0!=e.typeId){var t=new i.x(e.typeId,e,null,null);this.addNodeToTree(t)}}static removeConceptType(e,t){this.LocalTypeRoot&&(this.LocalTypeRoot=this.LocalTypeRoot.removeNodeWithVariants(this.LocalTypeRoot,e,t))}static getNodeFromTree(e){return this.LocalTypeRoot?this.LocalTypeRoot.getFromNode(e,this.LocalTypeRoot):this.LocalTypeRoot}static getTypeVariantsFromTree(e){var t=this.getNodeFromTree(e),n=[];if(t){n.push(null==t?void 0:t.value);for(let e=0;e<t.variants.length;e++)n.push(t.variants[e].value);return n}}static waitForDataToLoad(){return l(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isLocalTypeLoaded)return e("done");setTimeout(d.checkFlag,1e3,e)}static getTypeVariantsFromTreeWithUserId(e,t){return l(this,void 0,void 0,(function*(){var n=[],o=this.getNodeFromTree(e);if(o){console.log("this is the node to type",o),o.value.userId!=t&&999!=o.value.userId||n.push(null==o?void 0:o.value);for(let e=0;e<o.variants.length;e++)o.variants[e].value.userId!=t&&999!=o.value.userId||n.push(o.variants[e].value)}return n}))}}d.LocalTypeRoot=null;var u=n(6416),h=n(3026),p=n(7820),f=n(4864),v=n(628),y=n(4059),g=n(3278),m=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class C{constructor(){this.name="conceptsArray"}static AddConcept(e){0!=e.id&&(c.addConceptToTree(e),a.addConceptToTree(e),d.addConceptToTree(e),this.localconceptsArray.push(e))}static AddPermanentConcept(e){0!=e.id&&(c.removeNodeFromTree(e.ghostId),a.removeConceptType(e.characterValue,e.ghostId),d.removeConceptType(e.typeId,e.ghostId),p.G.addConceptToTree(e),h.I.AddConcept(e),(0,y.AddGhostConcept)(e,e.userId,g.b.sessionId))}static RemoveConcept(e){return m(this,void 0,void 0,(function*(){try{0!=e.id&&(c.removeNodeFromTree(e.ghostId),a.removeConceptType(e.characterValue,e.ghostId),d.removeConceptType(e.typeId,e.ghostId))}catch(e){throw e}}))}static RemoveConceptById(e){return m(this,void 0,void 0,(function*(){try{let t=yield C.GetConcept(e);0!=t.id&&(c.removeNodeFromTree(e),a.removeConceptType(t.characterValue,t.ghostId),d.removeConceptType(t.typeId,t.ghostId),v.H.RemoveConcept(t))}catch(e){throw e}}))}static AddConceptToMemory(e){0!=e.id&&(c.addConceptToTree(e),a.addConceptToTree(e),d.addConceptToTree(e))}static GetConcept(e){return m(this,void 0,void 0,(function*(){var t=(0,u.u)(),n=yield c.getNodeFromTree(e);if(null==n?void 0:n.value){var o=n.value;o&&(t=o)}return t}))}static UpdateConceptSyncStatus(e){return m(this,void 0,void 0,(function*(){c.updateSyncStatus(e)}))}static GetConceptByGhostId(e){return m(this,void 0,void 0,(function*(){var t=(0,u.u)(),n=yield p.G.getNodeFromTree(e);if(null==n?void 0:n.value){var o=n.value;o&&(t=o)}return t}))}static GetConceptByCharacter(e){return m(this,void 0,void 0,(function*(){var t=(0,u.u)(),n=a.getNodeFromTree(e);return n&&(t=n.value),t}))}static GetConceptByCharacterAndTypeLocal(e,t){return m(this,void 0,void 0,(function*(){var n=(0,u.u)(),o=yield a.getCharacterAndTypeFromTree(e,t);return o&&(n=o.value),n}))}static GetConceptByCharacterAndCategoryLocal(e,t){return m(this,void 0,void 0,(function*(){var n=(0,u.u)(),o=yield a.getCharacterAndCategoryFromTree(e,t);return o&&(n=o.value),n}))}static GetConceptsByTypeId(e){let t=[];for(var n=0;n<this.localconceptsArray.length;n++)this.localconceptsArray[n].typeId==e&&t.push(this.localconceptsArray[n]);return t}static GetConceptsByTypeIdAndUser(e,t){return m(this,void 0,void 0,(function*(){let n=[];return n=yield d.getTypeVariantsFromTreeWithUserId(e,t),n}))}static ClearData(){return m(this,void 0,void 0,(function*(){this.localconceptsArray=[],f.G.connectionArray=[]}))}getName(){return this.name}}C.localconceptsArray=[]},4864:(e,t,n)=>{n.d(t,{G:()=>a});var o=n(2155),i=n(8286),r=n(205),c=n(628),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{constructor(){this.name="Connection Array"}static CheckContains(e){for(var t=!1,n=0;n<this.connectionArray.length;n++)this.connectionArray[n].id==e.id&&(t=!0);return t}static AddConnection(e){this.CheckContains(e)&&this.RemoveConnection(e),e.id,this.connectionArray.push(e)}static AddConnectionToMemory(e){this.CheckContains(e)&&this.RemoveConnection(e),this.connectionArray.push(e)}static AddToDictionary(e){this.connectionDictionary[e.id]=e}static RemoveConnection(e){for(var t=0;t<this.connectionArray.length;t++)this.connectionArray[t].id==e.id&&this.connectionArray.splice(t,1);e.id}static RemoveConnectionById(e){for(var t=0;t<this.connectionArray.length;t++)this.connectionArray[t].id==e&&this.connectionArray.splice(t,1);c.H.RemoveConnectionById(e)}static AddPermanentConnection(e){e.id>0&&i.d.AddConnection(function(e){let t=new o.N(0,0,0,0,0,0,0);return t.ofTheConceptId=e.ofTheConceptId,t.toTheConceptId=e.toTheConceptId,t.typeId=e.typeId,t.orderId=e.orderId,t.id=e.id,t}(e))}static GetConnection(e){var t;t=null;for(var n=0;n<this.connectionArray.length;n++)this.connectionArray[n].id==e&&(t=this.connectionArray[n]);return t}static waitForDataToLoad(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(r.B.isLocalConnectionLoaded)return e("done");setTimeout(a.checkFlag,1e3,e)}static GetConnectionsOfCompositionLocal(e){return s(this,void 0,void 0,(function*(){var t=[];try{for(var n=0;n<this.connectionArray.length;n++)this.connectionArray[n].typeId==e&&t.push(this.connectionArray[n]);return t}catch(e){return t}}))}static GetConnectionOfCompositionAndTypeLocal(e,t){return s(this,void 0,void 0,(function*(){var n=[];try{for(var o=0;o<this.connectionArray.length;o++)this.connectionArray[o].typeId==e&&this.connectionArray[o].ofTheConceptId==t&&n.push(this.connectionArray[o]);return n}catch(e){return n}}))}getName(){return this.name}}a.connectionArray=[],a.connectionDictionary=[]},7820:(e,t,n)=>{n.d(t,{G:()=>c});var o=n(205),i=n(2515),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addConceptToTree(e){var t=new i.x(e.ghostId,e,null,null);this.addNodeToTree(t)}static waitForDataToLoad(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(o.B.isLocalDataLoaded)return e("done");setTimeout(c.checkFlag,1e3,e)}static getNodeFromTree(e){return r(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static removeNodeFromTree(e){return r(this,void 0,void 0,(function*(){this.root&&(this.root=this.root.removeNode(this.root,e))}))}}c.root=null},5257:(e,t,n)=>{n.d(t,{R:()=>c});var o=n(9003),i=n(3075),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{static AddConceptId(e){this.localId=e.value,(0,o.kH)("localid",e)}static getConceptId(){return r(this,void 0,void 0,(function*(){try{if(this.localId){if(this.ReservedLocalId.length<5){yield(0,i.EO)().then((()=>{let e=this.localId;for(let t=1;t<10;t++){let n=this.localId-t;this.ReservedLocalId.push(n),e=n}this.AddConceptId({id:0,value:e})})).catch((e=>(console.log(" getid: cannot get the id from indexdb"),-Math.floor(1e8*Math.random()))));let e=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),e}{let e=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),e}}return yield(0,i.EO)().then((()=>{let e=this.localId;for(let t=1;t<10;t++){let n=this.localId-t;this.ReservedLocalId.push(n),e=n}this.AddConceptId({id:0,value:e})})),this.getConceptId()}catch(e){return console.log(" getid: this is the eror in concept",e),-Math.floor(1e8*Math.random())}}))}static AddConnectionId(e){this.localConnectionId=e.value}static getConnectionId(){return r(this,void 0,void 0,(function*(){try{if(this.localConnectionId){if(this.ReservedConnectionId.length<5){yield(0,i.xd)().then((()=>{let e=this.localConnectionId;for(let t=1;t<10;t++){let n=this.localConnectionId-t;this.ReservedConnectionId.push(n),e=n}})).catch((e=>(console.log("this is the new event",e),-Math.floor(1e8*Math.random()))));let e=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),e}{let e=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),e}}return yield(0,i.xd)().then((()=>{let e=this.localConnectionId;for(let t=1;t<10;t++){let n=this.localConnectionId-t;this.ReservedConnectionId.push(n),e=n}this.AddConnectionId({id:1,value:e})})),this.getConnectionId()}catch(e){return-Math.floor(1e8*Math.random())}}))}}c.ReservedLocalId=[],c.ReservedConnectionId=[]},628:(e,t,n)=>{n.d(t,{H:()=>v});var o=n(9581),i=n(3278),r=n(4059),c=n(1863),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const a=(e,t,...n)=>s(void 0,[e,t,...n],void 0,(function*(e,t,n=!0){let r={concepts:[],connections:[]};try{const s=new Headers;let a={concepts:e,connections:t};s.set("Content-Type","application/json"),s.set("Authorization","Bearer "+i.b.BearerAccessToken),s.set("Accept","application/json"),s.set("X-Session-Id",i.b.sessionId.toString()),s.set("Randomizer",o.B.getRandomizer().toString());const l=yield fetch(o.B.CreateGhostConceptApiUrl(n),{method:"POST",headers:s,body:JSON.stringify(a)});if(!l.ok)throw(0,c.ry)(l),new Error(`Error! status: ${l.status}`);const d=yield l.json();return r.concepts=d.concepts,r.connections=d.connections,r}catch(e){throw e instanceof Error?console.log("Create the concept api error message: ",e.message):console.log("Create the concept api unexpected error: ",e),e}}));function l(e,t){const n=[];for(let o=0;o<e.length;o+=t){const i=e.slice(o,o+t);n.push(i)}return n}const d=(...e)=>s(void 0,[...e],void 0,(function*(e=[]){return yield Promise.all(e.map((e=>{let t=JSON.parse(JSON.stringify(e));return delete t.type,delete t.ofConcept,delete t.toConcept,t})))}));var u=n(9003),h=n(9736),p=n(4864),f=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class v{static CheckContains(e){for(var t=!1,n=0;n<this.conceptsSyncArray.length;n++)this.conceptsSyncArray[n].id==e.id&&(t=!0);return t}static SyncDataDelete(e){for(var t=0;t<this.conceptsSyncArray.length;t++)e==this.conceptsSyncArray[t].id&&this.conceptsSyncArray.splice(t,1);for(t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].ofTheConceptId!=e&&this.connectionSyncArray[t].toTheConceptId!=e&&this.connectionSyncArray[t].typeId!=e||this.connectionSyncArray.splice(t,1)}static CheckContainsConnection(e){for(var t=!1,n=0;n<this.connectionSyncArray.length;n++)this.connectionSyncArray[n].id==e.id&&(t=!0);return t}static AddConcept(e){try{let t=!1;0!=v.CheckIfTheConceptIdExists(e.id,this.conceptsSyncArray).id&&(t=!0),t||this.conceptsSyncArray.push(e)}catch(e){throw e}}static RemoveConcept(e){for(var t=0;t<this.conceptsSyncArray.length;t++)this.conceptsSyncArray[t].id==e.id&&this.conceptsSyncArray.splice(t,1)}static SyncDataOnlineWithoutAuth(e,t){return f(this,arguments,void 0,(function*(e,t,n=!1){return v.SyncDataOnline(e,t,n)}))}static SyncDataOnline(e,t){return f(this,arguments,void 0,(function*(e,t,n=!0){let o=performance.now();console.log("syncing...",e,t,"aa: ",this.conceptsSyncArray,this.connectionSyncArray,!!r.serviceWorker,n),setTimeout((()=>{console.log("syncing...",e,t,"aa: ",this.conceptsSyncArray,this.connectionSyncArray,!!r.serviceWorker,n)}),5e3);try{if(r.serviceWorker)try{return console.log("syncing in the service worker",e,n),(yield(0,r.sendMessage)("LocalSyncData__SyncDataOnline",{transactionId:e,withAuth:n})).data}catch(e){console.error("LocalSyncData__SyncDataOnline sw error: ",e),(0,r.handleServiceWorkerException)(e)}console.log("syncing in the without service worker syncing",e,n);let o=[],i=[];if(e&&this.transactionCollections.some((t=>t.id==e))){const t=this.transactionCollections.find((t=>t.id==e));if(this.transactionCollections=this.transactionCollections.filter((t=>t.id!=e)),this.transactionCollections=this.transactionCollections.filter((e=>new Date(e.createdDate).getTime()>(new Date).getTime()-6048e5)),!t)return;o=t.data.concepts.slice(),i=t.data.connections.slice()}else Array.isArray(null==t?void 0:t.concepts)&&Array.isArray(null==t?void 0:t.connections)?(console.log("this is the concepts and connections array",null==t?void 0:t.concepts,null==t?void 0:t.connections),o=t.concepts.slice(),i=t.connections.slice(),console.log("this is the concepts and connections array",o,i),this.conceptsSyncArray=this.conceptsSyncArray.filter((e=>{const n=t.concepts.some((t=>e.id==t.id||e.ghostId==t.ghostId));return n||console.warn(`Concept not found in sync array: ${e.id||e.ghostId}`),n})),this.connectionSyncArray=this.connectionSyncArray.filter((e=>{const n=t.connections.some((t=>e.id==t.id||e.ghostId==t.ghostId));return n||console.warn(`Connection not found in sync array: ${e.id||e.ghostId}`),n}))):(console.warn("Syncing this way has been Depreceted in service worker."),console.info("Only if serive worker is not running"),o=this.conceptsSyncArray.slice()||[],i=this.connectionSyncArray.slice()||[],this.connectionSyncArray=[],this.conceptsSyncArray=[]);console.log("syncing... inside the syncer",n);let u=[];for(let e=0;e<o.length;e++)u.push(o[e]),yield h.v.UpdateConceptSyncStatus(o[e].id);console.log("syncing... inside the syncer 2",n,o),yield this.UpdateConceptListToIncludeRelatedConcepts(i,u);let f=yield function(e,t){return s(this,arguments,void 0,(function*(e,t,n=!0){const o=r.Logger.logfunction("CreateTheGhostConceptApi",[e.length,t.length]);try{const i=1e3;let c={concepts:[],connections:[]};const s=yield d(e),u=yield d(t);if(e.length+t.length<=2*i){const e=yield a(s,u,n);return Array.isArray(null==e?void 0:e.concepts)&&(c.concepts=[...c.concepts,...e.concepts]),Array.isArray(null==e?void 0:e.connections)&&(c.connections=[...c.connections,...e.connections]),r.Logger.logUpdate(o),c}const h=l(s,i),p=l(u,i),f=[],v=[];console.log("This is the with auth in syncing",n);for(let e=0;e<h.length;e++){const t=h[e];f.push(a(t,[],n))}const y=yield Promise.all(f);for(let e=0;e<y.length;e++){const t=y[e];Array.isArray(null==t?void 0:t.concepts)&&(c.concepts=[...c.concepts,...t.concepts]),Array.isArray(null==t?void 0:t.connections)&&(c.connections=[...c.connections,...t.connections])}for(let e=0;e<p.length;e++){const t=p[e];v.push(a([],t,n))}const g=yield Promise.all(v);for(let e=0;e<g.length;e++){const t=g[e];Array.isArray(null==t?void 0:t.concepts)&&(c.concepts=[...c.concepts,...t.concepts]),Array.isArray(null==t?void 0:t.connections)&&(c.connections=[...c.connections,...t.connections])}return r.Logger.logUpdate(o),c}catch(e){throw console.log(e),(0,c.ey)(o,"CreateTheGhostConceptApi",e),e}}))}(u,i,n);console.log("syncing... inside the syncer 3",n);let v=f.concepts,y=f.connections;for(let e=0;e<v.length;e++)h.v.AddPermanentConcept(v[e]);for(let e=0;e<y.length;e++)p.G.AddPermanentConnection(y[e]);return o}catch(e){throw r.Logger.logError(o,"unknown",void 0,"unknown",void 0,500,e,"SyncDataOnline",[],"unknown",void 0),e}}))}static ConvertGhostIdsInConnections(e){var t,n,o;for(let i=0;i<e.length;i++){let r=e[i].ofTheConceptId,c=e[i].toTheConceptId,s=e[i].typeId,a=null!==(t=v.ghostIdMap.get(r))&&void 0!==t?t:r,l=null!==(n=v.ghostIdMap.get(c))&&void 0!==n?n:c,d=null!==(o=v.ghostIdMap.get(s))&&void 0!==o?o:s;e[i].ofTheConceptId=a,e[i].toTheConceptId=l,e[i].typeId=d}}static UpdateConceptListToIncludeRelatedConcepts(e,t){return f(this,void 0,void 0,(function*(){for(let n=0;n<e.length;n++){let o=e[n].ofTheConceptId,i=e[n].toTheConceptId,r=e[n].typeId;if(o<0){let i=this.CheckIfTheConceptIdExists(o,t);0==i.id&&(i=yield h.v.GetConceptByGhostId(o),0!=i.id?i.id!=i.ghostId&&(e[n].ofTheConceptId=i.id):(i=yield h.v.GetConcept(o),this.AddConceptIfDoesNotExist(i,t)))}if(i<0){let o=this.CheckIfTheConceptIdExists(i,t);0==o.id&&(o=yield h.v.GetConceptByGhostId(i),0!=o.id?o.id!=o.ghostId&&(e[n].toTheConceptId=o.id):(o=yield h.v.GetConcept(i),this.AddConceptIfDoesNotExist(o,t)))}if(r<0){let o=this.CheckIfTheConceptIdExists(r,t);0==o.id&&(o=yield h.v.GetConceptByGhostId(r),0!=o.id?o.id!=o.ghostId&&(e[n].typeId=o.id):(o=yield h.v.GetConcept(r),this.AddConceptIfDoesNotExist(o,t)))}}}))}static AddConceptIfDoesNotExist(e,t=[]){let n=!1;for(let o=0;o<t.length;o++)e.ghostId==t[o].ghostId&&(n=!0);n||t.push(e)}static CheckIfTheConceptIdExists(e,t=[]){let n=(0,r.CreateDefaultLConcept)();for(let o=0;o<t.length;o++)e!=t[o].ghostId&&e!=t[o].id||(n=t[o]);return n}static AddConnection(e){this.connectionSyncArray.push(e)}static RemoveConnection(e){for(var t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].id==e.id&&this.connectionSyncArray.splice(t,1)}static RemoveConnectionById(e){for(var t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].id==e&&this.connectionSyncArray.splice(t,1)}static syncDataLocalDb(){return f(this,void 0,void 0,(function*(){if(this.conceptsSyncArray.length>0){for(let e=0;e<this.conceptsSyncArray.length;e++)(0,u.kH)("localconcept",this.conceptsSyncArray[e]);this.conceptsSyncArray=[]}if(this.connectionSyncArray.length>0){for(let e=0;e<this.connectionSyncArray.length;e++)(0,u.kH)("localconnection",this.connectionSyncArray[e]);this.connectionSyncArray=[]}return"done"}))}static initializeTransaction(e){return f(this,void 0,void 0,(function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__initializeTransaction",{transactionId:e})).data}catch(e){console.error("LocalSyncData__initializeTransaction sw error: ",e),(0,r.handleServiceWorkerException)(e)}if(this.transactionCollections.some((t=>t.id==e)))return;this.transactionCollections.push({id:e,data:{concepts:[],connections:[]},createdDate:(new Date).toISOString()})}catch(e){console.log("error in initializeTransaction",e)}}))}static markTransactionActions(e,t){return f(this,void 0,void 0,(function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__markTransactionActions",{transactionId:e,actions:t})).data}catch(e){console.error("LocalSyncData__markTransactionActions sw error: ",e),(0,r.handleServiceWorkerException)(e)}this.transactionCollections=this.transactionCollections.map((n=>n.id==e?Object.assign(Object.assign({},n),{data:JSON.parse(JSON.stringify(t))}):n)),this.conceptsSyncArray=this.conceptsSyncArray.filter((e=>!t.concepts.some((t=>t.id==e.id||t.ghostId==e.id)))),this.connectionSyncArray=this.connectionSyncArray.filter((e=>!t.connections.some((t=>t.id==e.id||t.ghostId==e.id))))}catch(e){console.log("error in markTransactionActions",e)}}))}static rollbackTransaction(e,t){return f(this,void 0,void 0,(function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__rollbackTransaction",{transactionId:e,actions:t})).data}catch(e){console.error("LocalSyncData__rollbackTransaction sw error: ",e),(0,r.handleServiceWorkerException)(e)}if(this.transactionCollections.some((t=>t.id==e)))return;this.transactionCollections=this.transactionCollections.filter((t=>t.id!=e))}catch(e){console.log("LocalSyncData, roll",e)}}))}}v.conceptsSyncArray=[],v.connectionSyncArray=[],v.ghostIdMap=new Map,v.transactionCollections=[]},6731:(e,t,n)=>{n.d(t,{b:()=>o});class o{constructor(e,t,n,o){this.variants=[],this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o,this.currentNode=null}addCurrentNode(e,t){return null==t?t=e:(e.value.typeId!=t.value.typeId&&(t.currentNode=this.addCurrentNode(e,t.currentNode)),t)}addCurrentNodeType(e,t){if(null==t)return e;let n=!1;for(let o=0;o<t.variants.length;o++)t.variants[o].value.id==e.value.id&&(n=!0);return n||t.variants.push(e),t}addNode(e,t,n){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}checkIfIdsInNode(e,t,n,o){if(e){if(t.includes(e.key)){n.push(e.value);let o=t.indexOf(e.key);t.splice(o,1)}e.leftNode&&this.checkIfIdsInNode(e.leftNode,t,n,o),e.rightNode&&this.checkIfIdsInNode(e.rightNode,t,n,o)}}addCharacterNode(e,t,n){if(""!=e.value.characterValue){if(null==t)return e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addCharacterNode(e,o,n);else{if(!(t.key<e.key))return t.key==e.key&&""!=t.key&&t.value.id!=e.value.id&&t.addCurrentNodeType(e,t),t;t.rightNode=this.addCharacterNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key){return this.rightRotate(t)}if(e.key>t.leftNode.key){return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key){return this.leftRotate(t)}if(e.key<t.rightNode.key){return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}}return t}addTypeNode(e,t,n){if(0!=e.value.typeId){if(null==t)return console.log("adding the type node to the tree",e),e;let o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addTypeNode(e,o,n);else{if(!(t.key<e.key))return console.log("adding the type node to the tree down",e),t.key==e.key&&0!=t.key&&t.value.id!=e.value.id&&t.addCurrentNodeType(e,t),console.log("adding the type node to the tree last",t),t;t.rightNode=this.addTypeNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key){return this.rightRotate(t)}if(e.key>t.leftNode.key){return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key){return this.leftRotate(t)}if(e.key<t.rightNode.key){return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}}}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}getCharacterFromNode(e,t){return t?e==t.key?t:e<t.key?this.getCharacterFromNode(e,t.leftNode):e>t.key?this.getCharacterFromNode(e,t.rightNode):t:t}getCharacterFromNodeUpdated(e,t){var n;return t?e==t.key||51==(null===(n=t.value)||void 0===n?void 0:n.typeId)?t:e<t.key?this.getCharacterFromNode(e,t.leftNode):e>t.key?this.getCharacterFromNode(e,t.rightNode):t:t}getFromNodeWithCharacterAndType(e,t,n){if(e=`${e}`,n){if(e==n.key){if(e==n.value.characterValue&&t==n.value.typeId)return n;for(let e=0;e<n.variants.length;e++)if(n.variants[e].value.typeId==t)return n.variants[e]}else{if(e<n.key)return this.getFromNodeWithCharacterAndType(e,t,n.leftNode);if(e>n.key)return this.getFromNodeWithCharacterAndType(e,t,n.rightNode)}return null}return n}getFromNodeWithCharacterAndCategory(e,t,n){if(e=`${e}`,n){if(e==n.key){if(e==n.value.characterValue&&t==n.value.categoryId)return n;for(let e=0;e<n.variants.length;e++)if(n.variants[e].value.categoryId==t)return n.variants[e]}else{if(e<n.key)return this.getFromNodeWithCharacterAndCategory(e,t,n.leftNode);if(e>n.key)return this.getFromNodeWithCharacterAndCategory(e,t,n.rightNode)}return null}return n}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNode(e.rightNode,t.key),e}}removeNodeWithVariants(e,t,n){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNodeWithVariants(e.leftNode,t,n),e;if(e.key<t)return e.rightNode=this.removeNodeWithVariants(e.rightNode,t,n),e;if(e.variants.length>0)if(e.value.id==n){let t=e.variants[0];if(t)return e.value=t.value,e.key=t.key,e.currentNode=t.currentNode,e.variants.splice(0,1),e}else for(let t=0;t<e.variants.length;t++)if(n==e.variants[t].value.id)return e.variants.splice(t,1),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}{let t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.variants=t.variants,e.currentNode=t.currentNode,e.rightNode=this.removeNodeWithVariants(e.rightNode,t.key,n),e}}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}},5976:(e,t,n)=>{n.d(t,{p:()=>l,B:()=>a});var o=n(9581),i=n(3518),r=n(1863),c=n(4059),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a{static getId(){return s(this,void 0,void 0,(function*(){this.ids.length<5&&(yield function(){var e,t,n,s,l=arguments;return e=this,t=void 0,s=function*(){const e=c.Logger.logfunction("GetReservedIds",l);try{let t=(0,i.Xr)("application/x-www-form-urlencoded");const n=yield fetch(o.B.GetReservedIdUrl(),{method:"GET",headers:t});if(!n.ok)throw(0,r.ry)(n),new Error(`Error! status: ${n.status}`);const s=yield n.json();for(let e=0;e<s.length;e++)a.AddId(s[e]);c.Logger.logUpdate(e)}catch(t){t instanceof Error?console.log("get reserved ids error message: ",t.message):console.log("get reserved ids  unexpected error: ",t),(0,r.Mb)(t,o.B.GetReservedIdUrl()),(0,r.ey)(e,"GetReservedIds",t)}},new((n=void 0)||(n=Promise))((function(o,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}a((s=s.apply(e,t||[])).next())}))}());var e=this.ids[0];return this.ids.shift(),e}))}static AddId(e){this.ids.includes(e)||this.ids.push(e)}}a.ids=[];class l{static getId(){return s(this,void 0,void 0,(function*(){this.connectionIds.length<5&&(yield function(){var e,t,n,s,a=arguments;return e=this,t=void 0,s=function*(){const e=c.Logger.logfunction("GetReservedConnectionIds",a);try{let t=(0,i.Xr)("application/x-www-form-urlencoded");const n=yield fetch(o.B.GetReservedConnectionIdUrl(),{method:"GET",headers:t});if(!n.ok)throw(0,r.ry)(n),new Error(`Error! status: ${n.status}`);const s=yield n.json();for(let e=0;e<s.length;e++)l.AddId(s[e]);c.Logger.logUpdate(e)}catch(t){t instanceof Error?console.log("get reserved connection ids error message: ",t.message):console.log("get reserved connection ids  unexpected error: ",t),(0,r.Mb)(t,o.B.GetReservedConnectionIdUrl()),(0,r.ey)(e,"GetReservedConnectionIds",t)}},new((n=void 0)||(n=Promise))((function(o,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}a((s=s.apply(e,t||[])).next())}))}());var e=this.connectionIds[0];return this.connectionIds.shift(),e}))}static AddId(e){this.connectionIds.includes(e)||this.connectionIds.push(e)}}l.connectionIds=[]},7273:(e,t,n)=>{n.d(t,{z:()=>i});var o=n(9581);class i{constructor(e,t,n,i){this.url=o.B.BASE_URL,this.message=e,this.ok=t,this.status=n,this.data=i}getMessage(){return this.message}setMessage(e){return this.message=e,this}getStatus(){return this.status}setStatus(e){return this.status=e,this}getData(){return this.data}setData(e){return this.data=e,this}getOk(){return this.ok}setOk(e){return this.ok=e,this}getUrl(){return this.url}setUrl(e){return this.url=e,this}}},3278:(e,t,n)=>{n.d(t,{b:()=>o});class o{static setSession(e){e&&(o.sessionId=e)}}o.BearerAccessToken="",o.sessionId=998},2299:(e,t,n)=>{n.d(t,{B:()=>o});class o{constructor(e){this.id=1,this.isOnlineSync=!1,this.isOnlineSync=e}}},442:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(1167),i=n(2155),r=n(9581),c=n(3518),s=n(1863),a=n(3026),l=n(8286),d=n(4059);class u{static CheckContains(e){for(var t=!1,n=0;n<this.conceptsSyncArray.length;n++)this.conceptsSyncArray[n].id==e.id&&(t=!0);return t}static SyncDataDelete(e){for(var t=0;t<this.conceptsSyncArray.length;t++)e==this.conceptsSyncArray[t].id&&this.conceptsSyncArray.splice(t,1);for(t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].ofTheConceptId!=e&&this.connectionSyncArray[t].toTheConceptId!=e&&this.connectionSyncArray[t].typeId!=e||this.connectionSyncArray.splice(t,1)}static CheckContainsConnection(e){for(var t=!1,n=0;n<this.connectionSyncArray.length;n++)this.connectionSyncArray[n].id==e.id&&(t=!0);return t}static AddConcept(e){this.conceptsSyncArray.push(e)}static RemoveConcept(e){for(var t=0;t<this.conceptsSyncArray.length;t++)this.conceptsSyncArray[t].id==e.id&&this.conceptsSyncArray.splice(t,1)}static AddConnection(e){this.connectionSyncArray.push(e)}static RemoveConnection(e){for(var t=0;t<this.connectionSyncArray.length;t++)this.connectionSyncArray[t].id==e.id&&this.connectionSyncArray.splice(t,1)}static SyncDataOnline(){return e=this,t=void 0,u=function*(){if(d.serviceWorker)try{return(yield(0,d.sendMessage)("SyncData__SyncDataOnline",{})).data}catch(e){console.error("SyncData__SyncDataOnline sw error: ",e),(0,d.handleServiceWorkerException)(e)}for(let e=0;e<this.conceptsSyncArray.length;e++)a.I.AddConcept(this.conceptsSyncArray[e]);for(let e=0;e<this.connectionSyncArray.length;e++)l.d.AddConnection(this.connectionSyncArray[e]);if(this.conceptsSyncArray.length>0){let e=this.conceptsSyncArray.slice();this.conceptsSyncArray=[],(0,o.Y)(e)}if(this.connectionSyncArray.length>0){let e=this.connectionSyncArray.slice();this.connectionSyncArray=[],yield function(e){return t=this,n=void 0,a=function*(){let t=new i.N(0,0,0,0,0,0,0);try{var n=(0,c.Xr)(),o=JSON.stringify(e);const i=yield fetch(r.B.CreateTheConnectionUrl(),{method:"POST",headers:n,body:o});return i.ok?yield i.json():(console.log("Create the connection error message: ",i.status),(0,s.ry)(i)),t}catch(e){throw e instanceof Error?console.log("Create the connection error message: ",e.message):console.log(" Create the connection unexpected error: ",e),e}},new((o=void 0)||(o=Promise))((function(e,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function c(e){try{s(a.throw(e))}catch(e){i(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,c)}s((a=a.apply(t,n||[])).next())}));var t,n,o,a}(e)}return"done"},new((n=void 0)||(n=Promise))((function(o,i){function r(e){try{s(u.next(e))}catch(e){i(e)}}function c(e){try{s(u.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}s((u=u.apply(e,t||[])).next())}));var e,t,n,u}}u.conceptsSyncArray=[],u.connectionSyncArray=[]},9003:(e,t,n)=>{n.d(t,{S5:()=>l,kH:()=>u,qI:()=>a});var o=n(1863),i=n(4059),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};let c=10;class s{}function a(e){const t=i.Logger.logfunction("openDatabase",arguments);return new Promise((function(n,r){s.db&&(i.Logger.logUpdate(t),n(s.db));let l=i.BaseUrl.BASE_URL+"_FreeSchemaLocal"+i.BaseUrl.BASE_APPLICATION;const u=indexedDB.open(l,c);u.onupgradeneeded=e=>{var t=e.target.result,o="localconcept",r="localconnection",s="localid";console.log("this is the version upgrade",c),t.objectStoreNames.contains(o)&&t.deleteObjectStore(o),t.objectStoreNames.contains(r)&&t.deleteObjectStore(r),t.objectStoreNames.contains(s)&&t.deleteObjectStore(s),t.objectStoreNames.contains(o)||(t.createObjectStore(o,{keyPath:"id"}).transaction.oncomplete=e=>{}),t.objectStoreNames.contains(r)||(t.createObjectStore(r,{keyPath:"id"}).transaction.oncomplete=e=>{}),t.objectStoreNames.contains(s)||(t.createObjectStore(s,{keyPath:"id"}).transaction.oncomplete=e=>{d(s,{id:0,value:-100}),d(s,{id:1,value:-200}),d(s,{id:3,value:i.BaseUrl.getRandomizer()})}),n(t)},u.onerror=n=>{console.error("Why didn't you allow my web app to use IndexedDB?!",n),indexedDB.deleteDatabase(l),a(e),(0,o.ey)(t,"openDatabase",n),r(n)},u.onsuccess=function(e){var o=e.target;s.db=o.result,i.Logger.logUpdate(t),n(s.db)}}))}function l(e){var t=arguments;return r(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("getObjectsFromLocalIndexDb",t);return new Promise((function(t,r){a(e).then((o=>{var r=[],c=o.transaction(e,"readwrite").objectStore(e).getAll();c.onsuccess=()=>{const e=c.result;for(var o=0;o<e.length;o++)r.push(e[o]);i.Logger.logUpdate(n),t(r)}})).catch((e=>{let t={status:400,ok:!1,message:"Cannot get objects from database because you cannot open the Local database",data:e};(0,o.ey)(n,"getObjectsFromLocalIndexDb",t),r(t)}))}))}))}function d(e,t){const n=i.Logger.logfunction("storeToDatabase",[e,"localindexdb"]);return new Promise((function(r,c){a(e).then((s=>{const a=s.transaction(e,"readwrite").objectStore(e).add(t);a.onsuccess=e=>{i.Logger.logUpdate(n),r(t)},a.onerror=i=>{let r={status:400,ok:!1,message:"Cannot store to the Local database "+e,data:i,body:t};(0,o.ey)(n,"storeToDatabase",r),c(r)}})).catch((e=>{let t={status:400,ok:!1,message:"Cannot store to database because you cannot open the Local database",data:e};(0,o.ey)(n,"storeToDatabase",t),c(t)}))}))}function u(e,t){const n=i.Logger.logfunction("UpdateToDatabase",arguments);return new Promise((function(r,c){a(e).then((s=>{const a=s.transaction(e,"readwrite").objectStore(e).put(t);a.onsuccess=e=>{i.Logger.logUpdate(n),r(t)},a.onerror=i=>{let r={status:400,ok:!1,message:"Cannot Update to the Local database"+e,data:i,body:t};(0,o.ey)(n,"UpdateToDatabase",r),c(r)}})).catch((e=>{let t={status:400,ok:!1,message:"Cannot update to database because you cannot open the Local database",data:e};(0,o.ey)(n,"UpdateToDatabase",t),c(t)}))}))}},3655:(e,t,n)=>{n.d(t,{El:()=>h,b8:()=>u,kH:()=>d,qI:()=>l,wh:()=>p});var o=n(2299),i=n(9581),r=n(4059),c=n(1863);let s=10;class a{}function l(e){const t=r.Logger.logfunction("openDatabase",[e,"indexdb"]);return new Promise((function(n,o){a.db&&(r.Logger.logUpdate(t),n(a.db));let d=i.B.BASE_URL+"_FreeSchema"+i.B.BASE_APPLICATION;const u=indexedDB.open(d,s);console.log("this is the update version",s,u),u.onupgradeneeded=e=>{let o=e.target.result,i="concept",c="connection",a="settings";console.log("this is the version update for index",s),o.objectStoreNames.contains(i)&&o.deleteObjectStore(i),o.objectStoreNames.contains(c)&&o.deleteObjectStore(c),o.objectStoreNames.contains(a)&&o.deleteObjectStore(a),o.objectStoreNames.contains(i)||(o.createObjectStore(i,{keyPath:"id"}).transaction.oncomplete=e=>{}),o.objectStoreNames.contains(c)||(o.createObjectStore(c,{keyPath:"id"}).transaction.oncomplete=e=>{}),o.objectStoreNames.contains(a)||(o.createObjectStore(a,{keyPath:"id"}).transaction.oncomplete=e=>{}),r.Logger.logUpdate(t),n(o)},u.onerror=n=>{console.error("Why didn't you allow my web app to use IndexedDB?!",n),indexedDB.deleteDatabase(d),l(e),(0,c.ey)(t,"openDatabase",n),o(n)},u.onsuccess=function(e){let o=e.target;a.db=o.result,r.Logger.logUpdate(t),n(a.db)}}))}function d(e,t){const n=r.Logger.logfunction("UpdateToDatabase",[e,"indexdb"]);return new Promise((function(o,i){l(e).then((s=>{const a=s.transaction(e,"readwrite").objectStore(e).put(t);a.onsuccess=e=>{r.Logger.logUpdate(n),o(t)},a.onerror=o=>{let r={status:400,ok:!1,message:"Cannot Update to the database"+e,data:o,body:t};(0,c.ey)(n,"UpdateToDatabase",r),i(r)}})).catch((e=>{let t={status:400,ok:!1,message:"Cannot update to database because you cannot open the database",data:e};(0,c.ey)(n,"UpdateToDatabase",t),i(t)}))}))}function u(){const e=r.Logger.logfunction("GetLastSettingsFromDatabase",["indexdb"]);return new Promise((function(t,n){let i="settings";l(i).then((s=>{let a=s.transaction(i,"readwrite").objectStore(i).getAll();a.onsuccess=()=>{let n=new o.B(!1),i=a.result;for(let e=0;e<i.length;e++)n=i[e];r.Logger.logUpdate(e),t(n)},a.onerror=t=>{(0,c.ey)(e,"GetLastSettingsFromDatabase",t),n(t)}})).catch((t=>{let o={status:400,ok:!1,message:"Cannot get last object from database because you cannot open the database",data:t};(0,c.ey)(e,"GetLastSettingsFromDatabase",o),n(o)}))}))}function h(e){const t=r.Logger.logfunction("AiUpdateFlag",["indexdb"]);return new Promise((function(n,o){let i="settings";l(i).then((s=>{const a=s.transaction(i,"readwrite").objectStore(i).put(e);a.onsuccess=o=>{r.Logger.logUpdate(t),n(e)},a.onerror=n=>{let i={status:400,ok:!1,message:"Cannot update AI flag",data:n,body:e};(0,c.ey)(t,"AiUpdateFlag",i),o(i)}})).catch((e=>{let n={status:400,ok:!1,message:"Cannot update AI flag because you cannot open the database",data:e};(0,c.ey)(t,"AiUpdateFlag",n),o(n)}))}))}function p(e,t){const n=r.Logger.logfunction("removeFromDatabase",[e,"indexdb"]);return new Promise((function(o,i){l(e).then((s=>{const a=s.transaction(e,"readwrite").objectStore(e).delete(Number(t));a.onsuccess=function(e){r.Logger.logUpdate(n),o(t)},a.onerror=t=>{let o={status:400,ok:!1,message:"Cannot remove from the database"+e,data:t};(0,c.ey)(n,"removeFromDatabase",o),i(o)}})).catch((e=>{let o={status:400,ok:!1,message:"Cannot remove from the database because you cannot open the database",data:e,body:t};(0,c.ey)(n,"removeFromDatabase",o),i(o)}))}))}},4485:(e,t,n)=>{function o(e=[],t){var n,o;let i=[],r=null===(n=t.type)||void 0===n?void 0:n.characterValue;if((null==r?void 0:r.startsWith("the_"))||(r="the_"+r),Array.isArray(e))for(let n=0;n<e.length;n++){let c=null===(o=e[n].type)||void 0===o?void 0:o.characterValue;(null==c?void 0:c.startsWith("the_"))||(c="the_"+c),t.typeId!=e[n].typeId&&r!=c||i.push(e[n])}return i}function i(e=[],t){let n=[],o=t.typeCharacter;if((null==o?void 0:o.startsWith("the_"))||(o="the_"+o),Array.isArray(e))for(let i=0;i<e.length;i++){let r=e[i].typeCharacter;(null==r?void 0:r.startsWith("the_"))||(r="the_"+r),t.typeId!=e[i].typeId&&o!=r||n.push(e[i])}return n}function r(e=[],t){let n=[];if(Array.isArray(e)){const o=e.find((e=>e.toTheConceptId==t));o&&n.push(o);const i=e.find((e=>e.ofTheConceptId==t));i&&n.push(i)}return n}function c(e=[],t){let n=[];if(Array.isArray(e)){const o=e.find((e=>e.toTheConceptId==t));o&&n.push(o);const i=e.find((e=>e.ofTheConceptId==t));i&&n.push(i)}return n}n.d(t,{gt:()=>c,nm:()=>i,vo:()=>o,wS:()=>r}),n(2155),n(7282)},9934:(e,t,n)=>{function o(e,t){return-1===e.indexOf(t)&&e.push(t),e}n.d(t,{A:()=>o})},9700:(e,t,n)=>{n.d(t,{V:()=>l});var o,i=n(4059),r=n(3278),c=n(1863),s=n(3518),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class l{static startAutoSync(){this.autoSyncInterval?console.warn("Auto-sync is already running."):(this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS,setInterval((()=>{const e=Date.now();this.nextSyncTime&&e>=this.nextSyncTime&&(this.nextSyncTime=e+this.SYNC_INTERVAL_MS,this.sendPackageLogsToServer(),this.sendApplicationLogsToServer())}),3e4))}static stopAutoSync(){null!==this.autoSyncInterval&&(clearInterval(this.autoSyncInterval),this.autoSyncInterval=null,this.nextSyncTime=null)}static setLogLevel(e){this.logLevel=e}static shouldLog(e){return this.LOG_LEVELS.indexOf(e)>=this.LOG_LEVELS.indexOf(this.logLevel)}static formatLogData(e,t,n){const o=Object.assign({timestamp:(new Date).toISOString(),level:e,message:t},n);return this.packageLogsData.push(o),"ERROR"==e&&(this.sendPackageLogsToServer(),this.sendApplicationLogsToServer()),o}static log(e,t,n){if(this.logPackageActivationStatus)try{this.formatLogData(e,t,n||null)}catch(e){console.error("Error on Logger Log : ",e)}}static logUpdate(e){var t;try{if(!this.logPackageActivationStatus)return{};if(!e)return{};const n=Date.now();e.startTime=null!==(t=e.startTime)&&void 0!==t?t:n;const o=n-e.startTime;e.responseTime=`${o} ms`,1==!e.serviceWorker&&(e.serviceWorker=!1)}catch(t){(0,c.ey)(e,"Logger.logUpdate",t)}}static logfunction(e,...t){if(!this.logPackageActivationStatus)return{};const n=Date.now();let o=t;const c=i.BaseUrl.getRandomizer(),s=r.b.sessionId;let a={startTime:n,functionName:e,functionParameters:o,requestFrom:i.BaseUrl.BASE_APPLICATION,sessionId:s,applicationId:c};return this.formatLogData("INFO","function called",a)}static logError(e,t,n,o,i,c,s,a,l,d,u){try{const h=r.b.sessionId,p={startTime:e,userId:t,operationType:n,requestFrom:o,requestIP:i,responseStatus:c,responseTime:`${(performance.now()-e).toFixed(3)}ms`,responseSize:s?`${JSON.stringify(s).length}`:"0",sessionId:null==h?void 0:h.toString(),functionName:a,functionParameters:l,userAgent:d,conceptsUsed:u};this.formatLogData("ERROR",`Information logged for ${a}`,p)}catch(e){console.error("Error on logError")}}static logApplication(e,t,n){if(this.logApplicationActivationStatus)try{const o={timestamp:(new Date).toISOString(),level:e,message:t,data:n||null};this.applicationLogsData.push(o)}catch(e){console.error("Failed to log application activity:",e)}}static sendApplicationLogsToServer(){return a(this,void 0,void 0,(function*(){const e=this.applicationLogsData;try{if(0===e.length)return;this.applicationLogsData=[],r.b.BearerAccessToken;const t=50;let n=(0,s.Xr)(),o=0;for(;0!=e.length;){const r=e.slice(0,t),c=yield fetch(i.BaseUrl.PostLogger(),{method:"POST",headers:n,body:JSON.stringify({logType:this.appLogs,logData:r})});c.ok||(yield c.text()),e.splice(0,t),o+=t,o++}}catch(e){}}))}static sendPackageLogsToServer(){return a(this,void 0,void 0,(function*(){const e=this.packageLogsData;try{if(0===e.length)return;this.packageLogsData=[];const t=300;let n=0;for(;0!=e.length;){const o=e.slice(0,t);let r=(0,s.Xr)();const c=yield fetch(i.BaseUrl.PostLogger(),{method:"POST",headers:r,body:JSON.stringify({logType:this.mftsccsBrowser,logData:o})});if(!c.ok)return void(yield c.text());e.splice(0,t),n++}}catch(e){}}))}static saveLogToLocalStorage(e,t){try{if(void 0===typeof localStorage)return void console.warn("Local Storage type undefined");{const n=JSON.parse((null===localStorage||void 0===localStorage?void 0:localStorage.getItem(e))||"[]");n.push(t),null===localStorage||void 0===localStorage||localStorage.setItem(e,JSON.stringify(n))}}catch(e){console.error("Error on saving log in localstorage"),this.log("ERROR","Error while saving log in local storage")}}static clearLogsFromLocalStorage(e){void 0!==typeof localStorage?null===localStorage||void 0===localStorage||localStorage.removeItem(e):console.warn("localStorage is not available")}}o=l,l.logLevel="INFO",l.packageLogsData=[],l.applicationLogsData=[],l.LOG_LEVELS=["DEBUG","INFO","WARNING","ERROR"],l.SYNC_INTERVAL_MS=6e4,l.nextSyncTime=null,l.appLogs="app",l.mftsccsBrowser="mftsccs",l.logApplicationActivationStatus=!1,l.logPackageActivationStatus=!1,l.autoSyncInterval=null,o.startAutoSync()},1412:(e,t,n)=>{function o(e=[],t=[]){}n.d(t,{e:()=>o})},4698:(e,t,n)=>{n.d(t,{V:()=>a,w:()=>s});var o=n(7139),i=n(4059),r=n(276),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e=[]){let t=[];if(e.length>0)for(let n=0;n<e.length;n++){let o=l(e[n]);t.push(o)}return t}function a(e){var t=arguments;return c(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("GetConnectionTypeForCount",t);let r={};for(let t=0;t<e.length;t++){let n=yield(0,o.r)(e[t].connectionTypeId);e[t].connectionType=n.characterValue,r[e[t].conceptId]=e[t]}return i.Logger.logUpdate(n),r}))}function l(e){const t=e.split("_");if(3===t.length){let e=new r.y;return e.conceptId=Number(t[0]),e.connectionTypeId=Number(t[1]),e.count=Number(t[2]),e}throw new Error("Input string must contain exactly three parts separated by underscores.")}},1863:(e,t,n)=>{n.d(t,{ER:()=>c,Mb:()=>s,ey:()=>a,ry:()=>r});var o=n(4059),i=n(7273);function r(e){if(o.Logger.log("ERROR",e.statusText,{code:e.status,data:e.statusText}),401==e.status||406==e.status){let t=new i.z(e.statusText,!1,e.status,"");throw t.setUrl(e.url),t}if(500==e.status){let t=new i.z(e.statusText,!1,e.status,"");throw t.setUrl(e.url),t}}function c(e,t={}){if(o.Logger.log("ERROR",t.statusText,{code:e.status,data:e.status}),401==e.status||406==e.status){let n=new i.z(t.statusText,!1,e.status,"");throw n.setUrl(e.url),n}if(500==e.status){let n=new i.z(t.statusText,!1,e.status,"");throw n.setUrl(e.url),n}}function s(e,t=""){if(o.Logger.log("ERROR",e.message,{code:e.status,data:e.stack}),e.status){let n=new i.z(e.message,!1,e.status,e.stack);throw n.setUrl(t),n}{let n=new i.z(e.message,!1,500,e.stack);throw n.setUrl(t),n}}function a(e,t,n){var o;try{if(!e)return void console.error(`Error in ${t}: logData is undefined`);const i=Date.now();e.startTime=null!==(o=e.startTime)&&void 0!==o?o:i,e.responseTime=i-e.startTime+" ms",e.level="ERROR",e.errorMessage=(null==n?void 0:n.message)||"Unknown error occurred",console.error(`Error in function ${t}:`,n)}catch(e){console.error("Failed to handle package function error:",e)}}},1708:(e,t,n)=>{n.d(t,{Az:()=>h});var o=n(8146),i=n(3026),r=n(9581),c=n(3518),s=n(4059),a=n(1863),l=n(7876),d=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},u=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function h(e){return u(this,void 0,void 0,(function*(){const t=s.Logger.logfunction("GetConceptByCharacterAndCategory",e);let n=(0,s.CreateDefaultConcept)();if("the"==e)return n.id=1,n.typeId=5,n.characterValue="the",n;let p=(0,s.SplitStrings)(e);if(p.length>1){let t=1,o=yield h(p[0]);0!=o.id&&(t=o.id),n=yield function(e,t){var n=arguments;return u(this,void 0,void 0,(function*(){const o=s.Logger.logfunction("GetConceptByCharacterAndCategoryFromMemory",n);let u=yield s.ConceptsData.GetConceptByCharacterAndCategoryLocal(e,t);return 0==u.id&&(u=yield function(e,t){var n=arguments;return d(this,void 0,void 0,(function*(){const o=s.Logger.logfunction("GetConceptByCharacterAndCategoryDirectApi",n);let d=(0,s.CreateDefaultConcept)();try{var u=(0,c.Xr)("application/x-www-form-urlencoded");const n=yield fetch(r.B.GetConceptByCharacterAndCategoryDirectUrl(),{method:"POST",headers:u,body:`character_value=${e}&category_id=${t}`});if(n.ok){let e=yield n.json();d=e,(0,l.K)(d).then((()=>{i.I.AddConcept(d)}))}else console.log("This is the concept by category and character error",n.status),(0,a.ry)(n);s.Logger.logUpdate(o)}catch(e){e instanceof Error?console.log(" This is the concept by category and character error message: ",e.message):console.log(" This is the concept by category and character unexpected error: ",e),(0,a.Mb)(e,r.B.GetConceptByCharacterAndCategoryDirectUrl()),(0,a.ey)(o,"GetConceptByCharacterAndCategoryDirectApi",e)}return d}))}(e,t)),s.Logger.logUpdate(o),u}))}(e,t)}else p[0]==e&&(n=yield function(e){var t=arguments;return u(this,void 0,void 0,(function*(){const n=s.Logger.logfunction("GetConceptByCharacter",t);let i=yield s.ConceptsData.GetConceptByCharacterAndTypeLocal(e,51);return 0==i.id&&(i=yield(0,o.Y)(e)),s.Logger.logUpdate(n),i}))}(e));return s.Logger.logUpdate(t),n}))}},176:(e,t,n)=>{n.d(t,{F4:()=>c,P6:()=>a,dp:()=>s});var o=n(2155),i=n(7282),r=n(6416);function c(e){var t,n;const o=(0,r.u)();return o.id=e.id,o.ghostId=e.ghostId,o.userId=e.userId,o.accessId=e.accessId,o.categoryId=e.categoryId,o.characterValue=e.characterValue,o.entryTimeStamp=e.entryTimeStamp,o.typeId=e.typeId,o.type=e.type,o.isTemp=!1,o.typeCharacter=null!==(n=null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:"",o}function s(e){const t=(0,i.o)();return t.id=e.id,t.ghostId=e.ghostId,t.userId=e.userId,t.accessId=e.accessId,t.entryTimeStamp=e.entryTimeStamp,t.typeId=e.typeId,t.categoryId=e.categoryId,t}function a(e){const t=new o.N(0,0,0,0,0,0,0);return t.id=e.id,t.ghostId=e.ghostId,t.accessId=e.accessId,t.ofTheConceptId=e.ofTheConceptId,t.toTheConceptId=e.toTheConceptId,t.entryTimeStamp=e.entryTimeStamp,t.typeId=e.typeId,t.isTemp=!1,t}},5020:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(4059),i=n(3026),r=n(205),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(){return c(this,void 0,void 0,(function*(){try{let e=[];if(Array.isArray(e))for(let t=0;t<e.length;t++){let n=e[t];i.I.AddConceptToMemory(n)}r.B.isDataLoaded=!0,r.B.isCharacterLoaded=!0,r.B.isTypeLoaded=!0}catch(e){throw yield(0,o.DelayFunctionExecution)(2e3,s()),{message:"Cannot create Binary Tree Concept",ok:!1,status:400,data:e}}}))}},7282:(e,t,n)=>{n.d(t,{Y:()=>r,o:()=>i});var o=n(2615);function i(){let e=r(new Date),t=r(new Date);return new o.j(0,0,0,0,0,"0",0,!1,e,t,"0")}function r(e){const t=e.getMonth()+1,n=e.getDate(),o=e.getFullYear();let i=e.getHours();const r=e.getMinutes(),c=e.getSeconds(),s=i>=12?"PM":"AM";i%=12,i=i||12;const a=e=>e.toString().padStart(2,"0");return`${t}/${n}/${o} ${i}:${a(r)}:${a(c)} ${s}`}},1218:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(4059),i=n(7282),r=n(1666),c=n(8407),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){return s(this,arguments,void 0,(function*(e,t=null,n=null,s=null,l=null,d=null,u=null){if(o.serviceWorker)try{return(yield(0,o.sendMessage)("CreateTheComposition",{json:e,ofTheConceptId:t,ofTheConceptUserId:n,mainKey:s,userId:l,accessId:d,sessionInformationId:u})).data}catch(e){console.error("CreateTheComposition sw error: ",e),(0,o.handleServiceWorkerException)(e)}let h=null!=l?l:999,p=null!=d?d:4,f=null!=u?u:999,v=null!=s?s:0,y=(0,i.o)();for(const o in e)if("string"!=typeof e[o]&&"number"!=typeof e[o])if(null==t&&null==n){let t=v,n=yield(0,c.A)(o,"",!0,h,p,f);y=n,t=n.id,v=n.id,yield a(e[o],n.id,n.userId,t,l,d,u)}else{let i=null!=t?t:999,s=null!=n?n:999,g=v,m=yield(0,c.A)(o,"",!0,h,p,f);y=m,yield(0,r.q)(i,s,m.id,g),yield a(e[o],m.id,m.userId,g,l,d,u)}else{let i=null!=t?t:999,s=null!=n?n:10267,a=v,l=yield(0,c.A)(o,e[o].toString(),!1,h,p,f);yield(0,r.q)(i,s,l.id,a)}return y}))}},2212:(e,t,n)=>{n.d(t,{Ay:()=>l,N:()=>d});var o=n(1167),i=n(2615),r=n(5976),c=n(442),s=n(4059),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t,n,o,s,l,d){return a(this,void 0,void 0,(function*(){let a=yield r.B.getId(),u=new Date,h=new Date,p=new i.j(a,t,o,n,s,e,l,!0,u,h,d);return p.isTemp=!1,c.Y.AddConcept(p),p}))}function d(e,t,n,c,l,d,u){return a(this,void 0,void 0,(function*(){let a=yield r.B.getId(),h=new Date,p=new Date,f=new i.j(a,t,c,n,l,e,d,!1,h,p,u);return s.ConceptsData.AddConcept(f),(0,o.Y)([f]),f}))}},1666:(e,t,n)=>{n.d(t,{q:()=>c});var o=n(2155),i=n(442),r=n(1863);function c(e,t,n,c){var s=t,a=new o.N(0,e,n,s,c,1,4);if(e==n)return a.ofTheConceptId=0,a.toTheConceptId=1,a;try{a.isTemp=!0,a.id=Math.floor(1e8*Math.random()),i.Y.AddConnection(a)}catch(e){(0,r.Mb)(e)}return a}},4818:(e,t,n)=>{n.d(t,{m:()=>h,E:()=>p});var o=n(4059),i=n(1863),r=n(3518),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},s=n(9581),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},l=n(5239),d=n(4864),u=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function h(e){var t=arguments;return u(this,void 0,void 0,(function*(){const n=o.Logger.logfunction("DeleteConnectionById",t);if(o.serviceWorker)try{return(yield(0,o.sendMessage)("DeleteConnectionById",{id:e})).data}catch(e){console.error("DeleteConnectionById sw error: ",e),(0,o.handleServiceWorkerException)(e)}let c=!0;return e>0?(c=yield function(e){var t=arguments;return a(this,void 0,void 0,(function*(){const n=o.Logger.logfunction("DeleteTheConnection",t);let c=!1;try{const t=new FormData;t.append("id",e.toString());let a=(0,r.BZ)();const l=yield fetch(s.B.DeleteTheConnectionUrl(),{method:"POST",headers:a,body:t,redirect:"follow"});o.Logger.logUpdate(n),l.ok?c=(yield l.json()).success:(console.log("Delete connection error status: ",l.status),(0,i.ry)(l)),c&&o.ConnectionData.AddNpConn(e)}catch(e){e instanceof Error?console.log("Delete connection error message: ",e.message):console.log("Delete connection unexpected error: ",e),(0,i.Mb)(e,s.B.DeleteTheConnectionUrl()),(0,i.ey)(n,"DeleteTheConnection",e)}return c}))}(e),l.O.removeNodeFromTree(e)):d.G.RemoveConnectionById(e),o.Logger.logUpdate(n),c}))}function p(e){var t=arguments;return u(this,void 0,void 0,(function*(){const n=o.Logger.logfunction("DeleteConnectionByIdBulk",t);if(o.serviceWorker)try{return(yield(0,o.sendMessage)("DeleteConnectionByIdBulk",{ids:e})).data}catch(e){console.error("DeleteConnectionByIdBulk sw error: ",e),(0,o.handleServiceWorkerException)(e)}let s=yield function(e){var t=arguments;return c(this,void 0,void 0,(function*(){const n=o.Logger.logfunction("DeleteTheConnectionBulkApi",t);let c=!1;try{let t=(0,r.BZ)();t.append("Content-Type","application/json");const s=yield fetch(o.BaseUrl.DeleteTheConnectionBulkUrl(),{method:"POST",headers:t,body:JSON.stringify(e)});if(o.Logger.logUpdate(n),s.ok?c=(yield s.json()).success:(console.log("Delete connection Bulk Api error status: ",s.status),(0,i.ry)(s)),c)for(let t=0;t<e.length;t++){let n=e[t];o.ConnectionData.AddNpConn(n)}}catch(e){e instanceof Error?console.log("Delete connection Bulk Api error message: ",e.message):console.log("Delete connection Bulk Api unexpected error: ",e),(0,i.Mb)(e,o.BaseUrl.DeleteTheConnectionUrl()),(0,i.ey)(n,"DeleteTheConnectionBulkApi",e)}return c}))}(e);if(s)for(let t=0;t<e.length;t++){let n=e[t];n>0?l.O.removeNodeFromTree(n):d.G.RemoveConnectionById(n)}return o.Logger.logUpdate(n),s}))}},2289:(e,t,n)=>{n.d(t,{$S:()=>d,L0:()=>u,WC:()=>h});var o=n(8675),i=n(6058),r=n(4059),c=n(1863);n(3518);var s=n(1708),a=n(4818),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e,t){var n=arguments;return l(this,void 0,void 0,(function*(){const i=r.Logger.logfunction("DeleteConnectionByType",n)||{};if(r.serviceWorker){i.serviceWorker=!0;try{const n=yield(0,r.sendMessage)("DeleteConnectionByType",{id:e,linker:t});return r.Logger.logUpdate(i),n.data}catch(e){console.error("DeleteConnectionByType sw error: ",e),(0,c.ey)(i,"DeleteConnectionByType",e),(0,r.handleServiceWorkerException)(e)}}let s=yield(0,o.l)(e);for(let e=0;e<s.length;e++)r.ConnectionData.AddConnection(s[e]);let a=yield r.ConnectionData.GetConnectionsOfConcept(e),l=yield(0,r.GetConceptByCharacter)(t),d=[];for(let e=0;e<a.length;e++)a[e].typeId==l.id&&d.push(a[e]);let u=!1;for(let e=0;e<d.length;e++)u=yield(0,r.DeleteConnectionById)(d[e].id);return r.Logger.logUpdate(i),u}))}function u(e,t){var n=arguments;return l(this,void 0,void 0,(function*(){const i=r.Logger.logfunction("DeleteConnectionByTypeBulk",n)||{};if(r.serviceWorker){i.serviceWorker=!0;try{const n=yield(0,r.sendMessage)("DeleteConnectionByTypeBulk",{id:e,linkers:t});return r.Logger.logUpdate(i),n.data}catch(e){console.error("DeleteConnectionByTypeBulk sw error: ",e),(0,c.ey)(i,"DeleteConnectionByTypeBulk",e),(0,r.handleServiceWorkerException)(e)}}let l=yield(0,o.l)(e);for(let e=0;e<l.length;e++)r.ConnectionData.AddConnection(l[e]);let d=yield r.ConnectionData.GetConnectionsOfConcept(e),u=[];for(let e=0;e<t.length;e++){let n=t[e],o=yield(0,s.Az)(n);u.push(o)}let h=[];console.log("this is all the connections for deleting taken",d,u,t);for(let e=0;e<d.length;e++)for(let t=0;t<u.length;t++)d[e].typeId==u[t].id&&h.push(d[e].id);return console.log("these are the to delete",h),r.Logger.logUpdate(i),yield(0,a.E)(h)}))}function h(e,t){return l(this,arguments,void 0,(function*(e,t,n=!1){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetAllTheConnectionsByTypeAndOfTheConcept",{id:e,linker:t,reverse:n})).data}catch(e){console.error("GetAllTheConnectionsByTypeAndOfTheConcept sw error: ",e),(0,r.handleServiceWorkerException)(e)}let c=[];if(n){let n=yield(0,i.W)(e),o=yield(0,r.MakeTheTypeConceptApi)(t,999);for(let e=0;e<n.length;e++)n[e].typeId==o.id&&c.push(n[e])}else{let n=yield(0,o.l)(e);for(let e=0;e<n.length;e++)r.ConnectionData.AddConnection(n[e]);let i=yield r.ConnectionData.GetConnectionsOfConcept(e),s=yield(0,r.GetConceptByCharacter)(t);for(let e=0;e<i.length;e++)i[e].typeId==s.id&&c.push(i[e])}return c}))}},4364:(e,t,n)=>{n.d(t,{s:()=>c});var o=n(1239),i=n(4059),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function c(){return r(this,arguments,void 0,(function*(e=[]){const t=i.Logger.logfunction("FindConceptsFromConnections",[e.length]);let n=[];if(e.length>0){for(let t=0;t<e.length;t++)n.includes(e[t].ofTheConceptId)||n.push(e[t].ofTheConceptId),n.includes(e[t].toTheConceptId)||n.push(e[t].toTheConceptId),n.includes(e[t].typeId)||n.push(e[t].typeId);yield(0,o.r)(n)}i.Logger.logUpdate(t)}))}},5284:(e,t,n)=>{n.d(t,{B:()=>s});var o=n(4059),i=n(8286),r=n(1863),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(){return c(this,arguments,void 0,(function*(e=[]){const t=o.Logger.logfunction("FindConnectionsOfCompositionsBulkInMemory",[e.length])||{};let n=[];try{if(o.serviceWorker){t.serviceWorker=!0;try{const n=yield(0,o.sendMessage)("FindConnectionsOfCompositionsBulkInMemory",{composition_ids:e});return o.Logger.logUpdate(t),n.data}catch(e){console.error("FindConnectionsOfCompositionsBulkInMemory sw error: ",e),(0,r.ey)(t,"FindConnectionsOfCompositionsBulkInMemory",e),(0,o.handleServiceWorkerException)(e)}}for(let t=0;t<e.length;t++){let o=yield i.d.GetConnectionsOfConcept(e[t]);n.push(...o)}return o.Logger.logUpdate(t),n}catch(e){return console.error("FindConnectionsOfCompositionsBulkInMemory error: ",e),(0,r.ey)(t,"FindConnectionsOfCompositionsBulkInMemory",e),n}}))}},8939:(e,t,n)=>{n.d(t,{$N:()=>w,$V:()=>h,Ez:()=>I,JA:()=>C,Mb:()=>v,Nj:()=>f,PT:()=>T,RW:()=>m,XI:()=>g,ay:()=>u,hL:()=>d,kx:()=>y,re:()=>p,yz:()=>k,zN:()=>L});var o=n(7139),i=n(2),r=n(3026),c=n(8286),s=n(4059),a=n(1863),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){return l(this,void 0,void 0,(function*(){let t={connectionList:[],compositionList:[]};try{if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionById",{id:e})).data}catch(e){console.error("GetCompositionById error sw: ",e),(0,s.handleServiceWorkerException)(e)}let n=yield(0,i.s)(e);t.connectionList=n;for(let e=0;e<t.connectionList.length;e++)t.compositionList.includes(t.connectionList[e].ofTheConceptId)||t.compositionList.push(t.connectionList[e].ofTheConceptId);return t}catch(e){return console.error("GetCompositionById error: ",e),t}}))}function u(e,t,n){return l(this,void 0,void 0,(function*(){var i,c;let s={},a=yield r.I.GetConcept(e);0==a.id&&null!=e&&null!=e&&(a=yield(0,o.r)(e));let l=yield L(e,t,n);return s[null!==(c=null===(i=null==a?void 0:a.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:""]=l,s}))}function h(e,t,n){return l(this,void 0,void 0,(function*(){var i,c;let s={},a=yield r.I.GetConcept(e);0==a.id&&null!=e&&null!=e&&(a=yield(0,o.r)(e));let l=yield L(e,t,n);s[null!==(c=null===(i=null==a?void 0:a.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:""]=l;let d={};return d.created_at=a.entryTimeStamp,d.data=s,d.id=e,d}))}function p(e,t,n){return l(this,void 0,void 0,(function*(){var i,c;let s={},a=yield r.I.GetConcept(e);0==a.id&&null!=e&&null!=e&&(a=yield(0,o.r)(e));let l=yield A(a,t,n);return s[null!==(c=null===(i=null==a?void 0:a.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:""]=l,s}))}function f(e){return l(this,void 0,void 0,(function*(){var t,n;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetComposition",{id:e})).data}catch(e){console.error("GetComposition error sw: ",e),(0,s.handleServiceWorkerException)(e)}let c=[],a={};c=yield(0,i.s)(e);let l=[];for(let e=0;e<c.length;e++)l.includes(c[e].ofTheConceptId)||l.push(c[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(d=yield(0,o.r)(e));let u=yield L(e,c,l);return a[null!==(n=null===(t=null==d?void 0:d.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=u,a}))}function v(e){return l(this,void 0,void 0,(function*(){var t,n;let c=[],s={};c=yield(0,i.s)(e);let a=[];for(let e=0;e<c.length;e++)a.includes(c[e].ofTheConceptId)||a.push(c[e].ofTheConceptId);let l=yield r.I.GetConcept(e);0==l.id&&null!=e&&null!=e&&(l=yield(0,o.r)(e));let d=yield S(e,c,a);return s[null!==(n=null===(t=null==l?void 0:l.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=d,s}))}function y(e){return l(this,void 0,void 0,(function*(){var t,n;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionFromMemory",{id:e})).data}catch(e){console.error("GetCompositionFromMemory error sw: ",e),(0,s.handleServiceWorkerException)(e)}let i=[],a={};i=yield c.d.GetConnectionsOfCompositionLocal(e);let l=[];for(let e=0;e<i.length;e++)l.includes(i[e].ofTheConceptId)||l.push(i[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(d=yield(0,o.r)(e));let u=yield N(d,i,l);return a[null!==(n=null===(t=null==d?void 0:d.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=u,a}))}function g(e){return l(this,void 0,void 0,(function*(){var t,n;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionFromMemoryNormal",{id:e})).data}catch(e){console.error("GetCompositionFromMemoryNormal error sw: ",e),(0,s.handleServiceWorkerException)(e)}let i=[],a={};i=yield c.d.GetConnectionsOfCompositionLocal(e);let l=[];for(let e=0;e<i.length;e++)l.includes(i[e].ofTheConceptId)||l.push(i[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(d=yield(0,o.r)(e));let u=yield A(d,i,l);return a[null!==(n=null===(t=null==d?void 0:d.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=u,a}))}function m(e){var t=arguments;return l(this,void 0,void 0,(function*(){var n,i;const l=s.Logger.logfunction("GetCompositionWithIdFromMemory",t)||{};if(s.serviceWorker){l.serviceWorker=!0;try{const t=yield(0,s.sendMessage)("GetCompositionWithIdFromMemory",{id:e});return s.Logger.logUpdate(l),t.data}catch(e){console.error("GetCompositionWithIdFromMemory error sw: ",e),(0,a.ey)(l,"GetCompositionWithIdFromMemory",e),(0,s.handleServiceWorkerException)(e)}}let d={},u=[],h={};try{u=yield c.d.GetConnectionsOfCompositionLocal(e);let t=[];for(let e=0;e<u.length;e++)t.includes(u[e].ofTheConceptId)||t.push(u[e].ofTheConceptId);let s=yield r.I.GetConcept(e);0==s.id&&null!=e&&null!=e&&(s=yield(0,o.r)(e));let a=yield N(s,u,t);h[null!==(i=null===(n=null==s?void 0:s.type)||void 0===n?void 0:n.characterValue)&&void 0!==i?i:""]=a,d.created_at=s.entryTimeStamp,d.data=h,d.id=e}catch(t){console.log("this is the exception in GetCompositionWithIdFromMemory",e),(0,a.ey)(l,"GetCompositionWithIdFromMemory",t)}return s.Logger.logUpdate(l),d}))}function C(e,t){var n=arguments;return l(this,void 0,void 0,(function*(){var i,c;const l=s.Logger.logfunction("GetCompositionFromMemoryWithConnections",n)||{};if(s.serviceWorker){l.serviceWorker=!0;try{const n=yield(0,s.sendMessage)("GetCompositionFromMemoryWithConnections",{id:e,connectionList:t});return s.Logger.logUpdate(l),n.data}catch(e){console.error("GetCompositionFromMemoryWithConnections error sw: ",e),(0,a.ey)(l,"GetCompositionFromMemoryWithConnections",e),(0,s.handleServiceWorkerException)(e)}}let d={},u=[];for(let e=0;e<t.length;e++)u.includes(t[e].ofTheConceptId)||u.push(t[e].ofTheConceptId);let h=yield r.I.GetConcept(e);0==h.id&&null!=e&&null!=e&&(h=yield(0,o.r)(e));let p=yield N(h,t,u);d[null!==(c=null===(i=null==h?void 0:h.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:""]=p;let f={};return f.created_at=h.entryTimeStamp,f.data=d,f.id=e,s.Logger.logUpdate(l),f}))}function T(e,t){return l(this,void 0,void 0,(function*(){var n,i;const c=s.Logger.logfunction("GetCompositionWithIdFromMemoryFromConnection",[e])||{};if(s.serviceWorker){c.serviceWorker=!0;try{const t=yield(0,s.sendMessage)("GetCompositionWithIdFromMemory",{id:e});return s.Logger.logUpdate(c),t.data}catch(e){console.error("GetCompositionWithIdFromMemory error sw: ",e),(0,a.ey)(c,"GetCompositionWithIdFromMemoryFromConnection",e),(0,s.handleServiceWorkerException)(e)}}let l={},d=[];for(let e=0;e<t.length;e++)d.includes(t[e].ofTheConceptId)||d.push(t[e].ofTheConceptId);let u=yield r.I.GetConcept(e);0==u.id&&null!=e&&null!=e&&(u=yield(0,o.r)(e));let h=yield N(u,t,d);l[null!==(i=null===(n=null==u?void 0:u.type)||void 0===n?void 0:n.characterValue)&&void 0!==i?i:""]=h;let p={};return p.created_at=u.entryTimeStamp,p.data=l,p.id=e,s.Logger.logUpdate(c),p}))}function w(e){return l(this,void 0,void 0,(function*(){var t;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionWithIdFromMemoryNew",{id:e})).data}catch(e){console.error("GetCompositionWithIdFromMemoryNew error sw: ",e),(0,s.handleServiceWorkerException)(e)}let n=[],i={};n=yield c.d.GetConnectionsOfCompositionLocal(e);let a=[];for(let e=0;e<n.length;e++)a.includes(n[e].ofTheConceptId)||a.push(n[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(console.log("this concept you cannot find ",e),d=yield(0,o.r)(e)),(new Date).getTime();let u=yield function(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,o=[]){var i,r,c,a,l,d,u,h;let p={},f=e.id,v=((new Date).getTime(),null!==(r=null===(i=null==e?void 0:e.type)||void 0===i?void 0:i.characterValue)&&void 0!==r?r:"");if(!n.includes(f)){let t=v;return{[t]:null==e?void 0:e.characterValue}}if(o.includes(f))return"";o.push(f);for(let e=0;e<t.length;e++){let n=yield(0,s.GetTheConcept)(t[e].ofTheConceptId),o=yield(0,s.GetTheConcept)(t[e].toTheConceptId);t[e].ofConcept=n,t[e].toConcept=o;let i=n.id,r="the_",l=(null!==(a=null===(c=null==o?void 0:o.type)||void 0===c?void 0:c.characterValue)&&void 0!==a?a:"").replace(r,"");null!=p[i]&&null!=p[i]||(p[i]={}),p[i][l]=o.characterValue}let y={};for(let e=0;e<t.length;e++){let n=t[e].ofConcept,o=t[e].toConcept,i=null!==(d=null===(l=null==n?void 0:n.type)||void 0===l?void 0:l.characterValue)&&void 0!==d?d:"",r="the_",c=(null!==(h=null===(u=null==o?void 0:o.type)||void 0===u?void 0:u.characterValue)&&void 0!==h?h:"").replace(r,"");null!=y[n.id]&&null!=y[n.id]||(y[n.id]={});let s=y[n.id];null!=s[i]&&null!=s[i]||(s[i]={}),null!=p[t[e].ofTheConceptId]&&null!=p[t[e].toTheConceptId]?s[i][c]=p[o.id]:s[i][c]=o.characterValue}return y[e.id]}))}(d,n,a);null===(t=null==d?void 0:d.type)||void 0===t||t.characterValue,i=u;let h={};return h.created_at=d.entryTimeStamp,h.data=i,h.id=e,h}))}function I(e){return l(this,void 0,void 0,(function*(){var t,n;if(s.serviceWorker)try{return(yield(0,s.sendMessage)("GetCompositionWithIdAndDateFromMemory",{id:e})).data}catch(e){console.error("GetCompositionWithIdAndDateFromMemory error sw: ",e),(0,s.handleServiceWorkerException)(e)}let i=[],a={};i=yield c.d.GetConnectionsOfCompositionLocal(e);let l=[];for(let e=0;e<i.length;e++)l.includes(i[e].ofTheConceptId)||l.push(i[e].ofTheConceptId);let d=yield r.I.GetConcept(e);0==d.id&&null!=e&&null!=e&&(d=yield(0,o.r)(e));let u=yield L(e,i,l);a[null!==(n=null===(t=null==d?void 0:d.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=u;let h={};return h.data=a,h.id=e,h.created_at=d.entryTimeStamp,h}))}function k(e){var t=arguments;return l(this,void 0,void 0,(function*(){var n,c;const l=s.Logger.logfunction("GetCompositionWithId",t)||{};if(s.serviceWorker){l.serviceWorker=!0;try{const t=yield(0,s.sendMessage)("GetCompositionWithId",{id:e});return s.Logger.logUpdate(l),t.data}catch(e){console.error("GetCompositionWithId error sw: ",e),(0,a.ey)(l,"GetCompositionWithId",e),(0,s.handleServiceWorkerException)(e)}}let d=[],u={};d=yield(0,i.s)(e);let h=[];for(let e=0;e<d.length;e++)h.includes(d[e].ofTheConceptId)||h.push(d[e].ofTheConceptId);let p=yield r.I.GetConcept(e);0==p.id&&null!=e&&null!=e&&(p=yield(0,o.r)(e));let f=yield L(e,d,h);u[null!==(c=null===(n=null==p?void 0:p.type)||void 0===n?void 0:n.characterValue)&&void 0!==c?c:""]=f;let v={};return v.data=u,v.id=e,s.Logger.logUpdate(l),v}))}function N(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,i=[]){var c,s,a;let l={},d=[],u=e.id;if(null===(c=null==e?void 0:e.type)||void 0===c?void 0:c.characterValue,!n.includes(u))return null==e?void 0:e.characterValue;if(i.includes(u))return"";i.push(u);for(let e=0;e<t.length;e++)if(t[e].ofTheConceptId==u)if(u!=t[e].toTheConceptId){let c=t[e].toTheConceptId,u=yield r.I.GetConcept(c);if(null!=u&&0!=u.id||null==c||null==c||(u=yield(0,o.r)(c)),0!=u.id&&null==(null==u?void 0:u.type)){let e=u.typeId,t=yield r.I.GetConcept(e);u.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),u.type=t)}let h="the_",p=(null!==(a=null===(s=null==u?void 0:u.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"").replace(h,"");if(isNaN(Number(p))){if(p){const e=yield N(u,t,n,i);l[p]=e}}else{const e=yield N(u,t,n,i);d[p]=e,l=d}}else console.log("this is the faulty connection ",t[e]);return l}))}function A(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,i=[]){var c,a,l;const d=s.Logger.logfunction("recursiveFetchConceptNormal",[e]);(new Date).getTime();let u={},h=[],p=e.id;if(u.id=p,null===(c=null==e?void 0:e.type)||void 0===c?void 0:c.characterValue,!n.includes(p))return null==e?void 0:e.characterValue;if(i.includes(p))return"";i.push(p);for(let e=0;e<t.length;e++)if(t[e].ofTheConceptId==p)if(p!=t[e].toTheConceptId){let c=t[e].toTheConceptId,s=yield r.I.GetConcept(c);if(null!=s&&0!=s.id||null==c||null==c||(s=yield(0,o.r)(c)),0!=s.id&&null==(null==s?void 0:s.type)){let e=s.typeId,t=yield r.I.GetConcept(e);s.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),s.type=t)}let d="the_",p=(null!==(l=null===(a=null==s?void 0:s.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"").replace(d,"");if(isNaN(Number(p))){if(p){const e=yield N(s,t,n,i);u[p]=e}}else{const e=yield N(s,t,n,i);h[p]=e,u=h}}else console.log("this is the faulty connection ",t[e]);return s.Logger.logUpdate(d),u}))}function L(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,i=[]){var c,s,a;let l={},d=[];if(0==e)return null;let u=yield r.I.GetConcept(e);if(null!=u&&0!=u.id||null==e||null==e||(u=yield(0,o.r)(e)),0!=u.id&&null==u.type){let e=u.typeId,t=yield r.I.GetConcept(e);u.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),u.type=t)}if(null===(c=null==u?void 0:u.type)||void 0===c?void 0:c.characterValue,!n.includes(e))return null==u?void 0:u.characterValue;if(i.includes(e))return"";i.push(e);for(let c=0;c<t.length;c++)if((new Date).getTime(),t[c].ofTheConceptId==e)if(e!=t[c].toTheConceptId){let e=t[c].toTheConceptId,u=yield r.I.GetConcept(e);if(null!=u&&0!=u.id||null==e||null==e||(u=yield(0,o.r)(e)),0!=u.id&&null==(null==u?void 0:u.type)){let e=u.typeId,t=yield r.I.GetConcept(e);u.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),u.type=t)}let h="the_",p=(null!==(a=null===(s=null==u?void 0:u.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"").replace(h,"");if(isNaN(Number(p))){if(p){const o=yield L(e,t,n,i);l[p]=o}}else{const o=yield L(e,t,n,i);d[p]=o,l=d}}else console.log("this is the faulty connection ",t[c]);return l}))}function S(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,i=[]){var c,s,a;let l={},d=[];if(0==e)return null;let u=yield r.I.GetConcept(e);if(null!=u&&0!=u.id||null==e||null==e||(u=yield(0,o.r)(e)),0!=u.id&&null==u.type){let e=u.typeId,t=yield r.I.GetConcept(e);u.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),u.type=t)}if(null===(c=null==u?void 0:u.type)||void 0===c?void 0:c.characterValue,!n.includes(e))return null==u?void 0:u.characterValue;if(i.includes(e))return"";i.push(e),l.id=e;for(let i=0;i<t.length;i++)if(t[i].ofTheConceptId==e){let e=t[i].toTheConceptId,c=yield r.I.GetConcept(e);if(null!=c&&0!=c.id||null==e||null==e||(c=yield(0,o.r)(e)),c&&null==(null==c?void 0:c.type)){let e=c.typeId,t=yield r.I.GetConcept(e);c.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,o.r)(e),c.type=t)}let u="the_",h=(null!==(a=null===(s=null==c?void 0:c.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"").replace(u,"");if(isNaN(Number(h))){if(h){const o=yield S(e,t,n);l[h]=o}}else{const o=yield S(e,t,n);d[h]=o,l=d}}return l}))}},6687:(e,t,n)=>{n.d(t,{D:()=>w,MT:()=>T,Nt:()=>f,QL:()=>g,as:()=>v,cw:()=>u,dF:()=>d,hG:()=>y,km:()=>p,nr:()=>C,p8:()=>h,rv:()=>m});var o=n(8642),i=n(7467),r=n(4059),c=n(1863),s=n(5284),a=n(8939),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(){return l(this,arguments,void 0,(function*(e=[]){yield(0,o.Y)(e);let t=[];for(let n=0;n<e.length;n++){let o=yield(0,a.kx)(e[n]);t.push(o)}return t}))}function u(){return l(this,arguments,void 0,(function*(e=[]){yield(0,o.Y)(e);let t=[];for(let n=0;n<e.length;n++){let o=yield(0,a.RW)(e[n]);t.push(o)}return t}))}function h(){return l(this,arguments,void 0,(function*(e=[],t=[]){const n=r.Logger.logfunction("GetCompositionFromConnectionsWithDataId",[e])||{};if(r.serviceWorker){n.serviceWorker=!0;try{const o=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataId",{conceptIds:e,connectionIds:t});return r.Logger.logUpdate(n),o.data}catch(e){console.error("GetCompositionFromConnectionsWithDataId error sw: ",e),(0,c.ey)(n,"GetCompositionFromConnectionsWithDataId",e),(0,r.handleServiceWorkerException)(e)}}let o=[];for(let t=0;t<e.length;t++){let n=yield(0,a.RW)(e[t]);o.push(n)}return r.Logger.logUpdate(n),o}))}function p(){var e=arguments;return l(this,arguments,void 0,(function*(t=[],n=[]){const o=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdFromConnections",e)||{};if(r.serviceWorker){o.serviceWorker=!0;try{const e=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataIdFromConnections",{conceptIds:t,connectionIds:n});return r.Logger.logUpdate(o),e.data}catch(e){console.error("GetCompositionFromConnectionsWithDataIdFromConnections error sw: ",e),(0,c.ey)(o,"GetCompositionFromConnectionsWithDataIdFromConnections",e),(0,r.handleServiceWorkerException)(e)}}let s=yield(0,i.j)(n),l=[];for(let e=0;e<t.length;e++){let n=yield(0,a.PT)(t[e],s);l.push(n)}return r.Logger.logUpdate(o),l}))}function f(){var e=arguments;return l(this,arguments,void 0,(function*(t=[],n=[]){const o=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdIndex",e)||{};if(r.serviceWorker){o.serviceWorker=!0;try{const e=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataIdIndex",{conceptIds:t,connectionIds:n});return r.Logger.logUpdate(o),e.data}catch(e){console.error("GetCompositionFromConnectionsWithDataIdIndex error sw: ",e),(0,c.ey)(o,"GetCompositionFromConnectionsWithDataIdIndex",e),(0,r.handleServiceWorkerException)(e)}}yield(0,i.j)(n),yield(0,s.B)(t);let l={};for(let e=0;e<t.length;e++){let n=yield(0,a.RW)(t[e]);l[t[e]]=n}return r.Logger.logUpdate(o),l}))}function v(){return l(this,arguments,void 0,(function*(e=[],t=[]){yield(0,i.j)(t),yield(0,s.B)(e);let n={};for(let t=0;t<e.length;t++){let o=yield(0,a.kx)(e[t]);n[e[t]]=o}return n}))}function y(){return l(this,arguments,void 0,(function*(e=[],t=[]){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetCompositionFromConnectionsWithIndexFromConnections",{conceptIds:e,connectionIds:t})).data}catch(e){console.error("GetCompositionFromConnectionsWithIndexFromConnections error sw: ",e),(0,r.handleServiceWorkerException)(e)}let n=yield(0,i.j)(t),o=[];for(let t=0;t<e.length;t++){let i=yield(0,a.JA)(e[t],n);o[e[t]]=i}return o}))}function g(e){var t=arguments;return l(this,void 0,void 0,(function*(){const n=r.Logger.logfunction("GetConnectionDataPrefetch",t)||{};if(r.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,r.sendMessage)("GetConnectionDataPrefetch",{connectionIds:e});return r.Logger.logUpdate(n),t.data}catch(e){console.error("GetConnectionDataPrefetch error sw: ",e),(0,c.ey)(n,"GetConnectionDataPrefetch",e),(0,r.handleServiceWorkerException)(e)}}let o=[],s=[],a={};for(let t=0;t<e.length;t++){let n=yield r.ConnectionData.GetConnection(e[t]);0==n.id?o.push(e[t]):s.push(n)}for(let t=0;t<o.length;t++)a[e[t]]=!1;let l=[],d=yield(0,i.j)(o);s=[...s,...d];for(let e=0;e<s.length;e++)l.push(s[e].ofTheConceptId),l.push(s[e].toTheConceptId),l.push(s[e].typeId);return yield(0,r.GetConceptBulk)(l),r.Logger.logUpdate(n),s}))}function m(){var e=arguments;return l(this,arguments,void 0,(function*(t=[],n=[]){const o=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdInObject",e);yield(0,i.j)(n);let c={};for(let e=0;e<t.length;e++){let n=yield(0,a.RW)(t[e]);c[t[e]]=n}return r.Logger.logUpdate(o),c}))}function C(){return l(this,arguments,void 0,(function*(e=[],t=[]){yield(0,i.j)(t);let n={};for(let t=0;t<e.length;t++){let o=yield(0,a.$N)(e[t]);n[e[t]]=o}return n}))}function T(){return l(this,arguments,void 0,(function*(e=[],t=[]){yield(0,i.j)(t);let n={};for(let t=0;t<e.length;t++){let o=yield(0,a.kx)(e[t]);n[e[t]]=o}return n}))}function w(){return l(this,arguments,void 0,(function*(e=[],t=[]){yield(0,i.j)(t);let n={};for(let t=0;t<e.length;t++){let o=yield(0,a.XI)(e[t]);n[e[t]]=o,console.log("this is the normal data",e[t],o)}return n}))}},2013:(e,t,n)=>{n.d(t,{A:()=>a,w:()=>l});var o=n(8146),i=n(4059),r=n(3026),c=n(1863),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){var t=arguments;return s(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("GetConceptByCharacter",t)||{};if(i.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,i.sendMessage)("GetConceptByCharacter",{characterValue:e});return i.Logger.logUpdate(n),t.data}catch(e){console.error("GetConceptByCharacter sw error: ",e),(0,c.ey)(n,"GetConceptByCharacter",e),(0,i.handleServiceWorkerException)(e)}}let s=yield r.I.GetConceptByCharacter(e),a=`${e}`;return null!=s&&0!=(null==s?void 0:s.id)||!a||(yield(0,o.Y)(e),s=yield r.I.GetConceptByCharacterAndTypeLocal(e,51),0==s.id&&(s=yield r.I.GetConceptByCharacter(e))),i.Logger.logUpdate(n),s}))}function l(e){var t=arguments;return s(this,void 0,void 0,(function*(){const n=i.Logger.logfunction("GetConceptByCharacterUpdated",t)||{};if(i.serviceWorker){n.serviceWorker=!0;try{const t=yield(0,i.sendMessage)("GetConceptByCharacterUpdated",{characterValue:e});return i.Logger.logUpdate(n),t.data}catch(e){console.error("GetConceptByCharacterUpdated error sw: ",e),(0,c.ey)(n,"GetConceptByCharacterUpdated",e),(0,i.handleServiceWorkerException)(e)}}let s=yield r.I.GetConceptByCharacter(e),a=`${e}`;return null!=s&&0!=(null==s?void 0:s.id)||!a||(yield(0,o.Y)(e),s=yield r.I.GetConceptByCharacter(e)),i.Logger.logUpdate(n),s}))}},7887:(e,t,n)=>{n.d(t,{a:()=>c,p:()=>s});var o=n(8286),i=n(4864),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function c(){return r(this,void 0,void 0,(function*(){try{let e=[];if(Array.isArray(e))for(let t=0;t<e.length;t++)o.d.AddConnectionToMemory(e[t])}catch(e){throw{message:"Cannot create Connection Binary Tree Concept",ok:!1,status:400,data:e}}}))}function s(){return r(this,void 0,void 0,(function*(){try{let e=[];if(Array.isArray(e))for(let t=0;t<e.length;t++)i.G.AddConnectionToMemory(e[t])}catch(e){throw{message:"Cannot create Local Connection Binary Tree Concept",ok:!1,status:400,data:e}}}))}},7876:(e,t,n)=>{n.d(t,{A:()=>d,K:()=>u});var o=n(1735),i=n(7139),r=n(4059),c=n(3026),s=n(7282),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const l=new Map;function d(e){return a(this,arguments,void 0,(function*(e,t=999){let n=performance.now();if(o.J.activateStatus)try{o.J.incrementConcept(e)}catch(e){console.error("Error adding connection in access tracker"),r.Logger.log("ERROR","Error Adding Connection")}if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetTheConcept",{id:e,userId:t})).data}catch(e){console.error("GetTheConcept sw error: ",e),(0,r.handleServiceWorkerException)(e)}let d=(0,s.o)();if(l.has(e))return l.get(e)||d;const u=(()=>a(this,void 0,void 0,(function*(){try{if(e<0)return yield r.LocalConceptsData.GetConceptByGhostId(e);if(d=yield c.I.GetConcept(e),(null==d||0==d.id)&&null!=e&&null!=e){let t=yield(0,i.r)(e);d=t}if(0!=d.id&&null==d.type&&null==(yield c.I.GetConcept(d.typeId))&&null!=d.typeId&&null!=d.typeId){let e=yield(0,i.r)(d.typeId);d.type=e}return d}catch(o){throw console.error("this is the error in the getting concept",o),r.Logger.logError(n,t,"read","unknown",void 0,500,o,"GetTheConcept",[e,t],"unknown",void 0),o}finally{l.delete(e)}})))();return l.set(e,u),u}))}function u(e){return a(this,void 0,void 0,(function*(){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("AddTypeConcept",{concept:e})).data}catch(e){console.error("AddTypeConcept sw error: ",e),(0,r.handleServiceWorkerException)(e)}if(null==e.type){let t=yield c.I.GetConcept(e.typeId);if(0==t.id&&0!=e.typeId&&999!=e.typeId){let t=yield(0,i.r)(e.typeId);e.type=t}else e.type=t}}))}},7869:(e,t,n)=>{n.d(t,{_:()=>v,A:()=>f});var o=n(9581),i=n(3026),r=n(1863),c=n(3518),s=n(4059),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},l=n(2299);class d{}d.isUpdated=!1,d.isOnlineSync=!1;var u=n(3655),h=n(9003),p=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function f(){return p(this,arguments,void 0,(function*(e=!0){try{if(yield(0,u.qI)("concepts"),yield(0,h.qI)("concepts"),e){if((yield(0,u.b8)()).isOnlineSync)return!0;yield function(){return a(this,void 0,void 0,(function*(){const e=s.Logger.logfunction("GetAiData");try{const a=(new Date).getTime();var t=(0,c.ab)("application/x-www-form-urlencoded");const l=yield fetch(o.B.GetAllAiData(),{method:"GET",headers:t});l.ok||(console.log("Ai Error Message: ","Cannot get response"),(0,r.ry)(l));const d=yield l.json();for(var n=0;n<d.length;n++)i.I.AddConcept(d[n]);v();let u=(new Date).getTime()-a;console.log("The time taken is ",u),s.Logger.logUpdate(e)}catch(e){e instanceof Error?console.log("Ai Error Message: ",e.message):console.log("Ai Error Message: ",e),(0,r.Mb)(e,o.B.GetAllAiData())}}))}()}return!0}catch(e){let t={message:"cannot initlize the AI system",ok:!1,status:400,data:e};return console.log(t),!0}}))}function v(){return p(this,void 0,void 0,(function*(){d.isOnlineSync=!0;var e=new l.B(d.isOnlineSync);(0,u.El)(e)}))}},8095:(e,t,n)=>{n.d(t,{h:()=>s});var o=n(4059),i=n(9700),r=n(1863),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e,t,n){var s=arguments;return c(this,arguments,void 0,(function*(e,t,n,c=!1,a={concepts:[],connections:[]}){var l,d,u,h,p,f;const v=i.V.logfunction("CreateConnectionBetweenTwoConceptsLocal",s)||{};let y=performance.now();try{if(o.serviceWorker){v.serviceWorker=!0;try{const r=yield(0,o.sendMessage)("CreateConnectionBetweenTwoConceptsLocal",{ofTheConcept:e,toTheConcept:t,linker:n,both:c,actions:a});return(null===(d=null===(l=null==r?void 0:r.actions)||void 0===l?void 0:l.concepts)||void 0===d?void 0:d.length)&&(a.concepts=JSON.parse(JSON.stringify(r.actions.concepts))),(null===(h=null===(u=null==r?void 0:r.actions)||void 0===u?void 0:u.connections)||void 0===h?void 0:h.length)&&(a.connections=JSON.parse(JSON.stringify(r.actions.connections))),i.V.logUpdate(v),r.data}catch(e){console.error("CreateConnectionBetweenTwoConceptsLocal sw error: ",e),(0,r.ey)(v,"CreateConnectionBetweenTwoConceptsLocal",e),(0,o.handleServiceWorkerException)(e)}}if(e.userId,c){let i=(null===(p=t.type)||void 0===p?void 0:p.characterValue)+"_s_"+n+"_by";var g=yield(0,o.MakeTheInstanceConceptLocal)("connection",i,!1,999,999,999,0,a);yield(0,o.CreateTheConnectionLocal)(t.id,e.id,g.id,1e3,void 0,void 0,a)}let s=(null===(f=e.type)||void 0===f?void 0:f.characterValue)+"_s_"+n+"_s";var m=yield(0,o.MakeTheInstanceConceptLocal)("connection",s,!1,999,999,999,void 0,a);let y=yield(0,o.CreateTheConnectionLocal)(e.id,t.id,m.id,1e3,void 0,void 0,a);return i.V.logUpdate(v),y}catch(o){throw i.V.logError(y,e.userId,"create",void 0,void 0,500,o,"CreateConnectionBetweenTwoConceptsLocal",[e,t,n,c],void 0,void 0),(0,r.ey)(v,"CreateConnectionBetweenTwoConceptsLocal",o),o}}))}},6416:(e,t,n)=>{n.d(t,{u:()=>i});var o=n(2615);function i(){let e=new Date,t=new Date;return new o.j(0,0,0,0,0,"0",0,!1,e,t,"0")}},3075:(e,t,n)=>{n.d(t,{Ay:()=>d,EO:()=>u,xd:()=>h});var o=n(205),i=n(9736),r=n(5257),c=n(9003),s=n(4059),a=n(1863),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(){return l(this,void 0,void 0,(function*(){const e=s.Logger.logfunction("CreateLocalBinaryTreeFromIndexDb");try{let t=[];if(Array.isArray(t))for(let e=0;e<t.length;e++){let n=t[e];i.v.AddConceptToMemory(n)}o.B.isLocalDataLoaded=!0,o.B.isLocalTypeLoaded=!0,o.B.isLocalCharacterLoaded=!0,s.Logger.logUpdate(e)}catch(t){yield(0,s.DelayFunctionExecution)(2e3,d());let n={message:"Cannot create local binary tree from index db",data:t,ok:!1,status:400};throw(0,a.ey)(e,"CreateLocalBinaryTreeFromIndexDb",t),n}}))}function u(){return l(this,void 0,void 0,(function*(){var e;const t=s.Logger.logfunction("PopulateTheLocalConceptsToMemory");try{yield null===(e=navigator.locks)||void 0===e?void 0:e.request("dblock",(e=>l(this,void 0,void 0,(function*(){let e=yield(0,c.S5)("localid");if(Array.isArray(e)){if(e[0]){let t=e[0].value;if(t)r.R.AddConceptId(e[0]),yield(0,c.kH)("localid",{id:0,value:t-10});else{t=-Math.floor(1e8*Math.random());let e={id:0,value:t},n={id:0,value:t-10};r.R.AddConceptId(e),yield(0,c.kH)("localid",n)}}e[2]}})))),s.Logger.logUpdate(t)}catch(e){let n={message:"Cannot populate Local Ids from the Index Db",data:e,ok:!1,status:400};throw(0,a.ey)(t,"PopulateTheLocalConceptsToMemory",e),n}}))}function h(){return l(this,void 0,void 0,(function*(){var e;const t=s.Logger.logfunction("PopulateTheLocalConnectionToMemory");try{yield null===(e=navigator.locks)||void 0===e?void 0:e.request("dblock",(e=>l(this,void 0,void 0,(function*(){let e=yield(0,c.S5)("localid");if(Array.isArray(e)){if(e[1]){let t=e[1].value;if(t)r.R.AddConnectionId(e[1]),yield(0,c.kH)("localid",{id:1,value:t-10});else{t=-Math.floor(1e8*Math.random());let e={id:0,value:t},n={id:0,value:t-10};r.R.AddConnectionId(e),yield(0,c.kH)("localid",n)}}e[2]}})))),s.Logger.logUpdate(t)}catch(e){let n={message:"Cannot populate Local Ids from the Index Db",data:e,ok:!1,status:400};throw(0,a.ey)(t,"PopulateTheLocalConnectionToMemory",e),n}}))}},999:(e,t,n)=>{n.d(t,{R:()=>l});var o=n(4059),i=n(1863),r=n(6416),c=n(4711),s=n(5868),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e){return a(this,arguments,void 0,(function*(e,t=null,n=null,a=null,d=null,u=null,h=null,p=!1,f={concepts:[],connections:[]}){var v,y,g,m;const C=o.Logger.logfunction("CreateTheCompositionLocal")||{};if(o.serviceWorker){C.serviceWorker=!0;try{const i=yield(0,o.sendMessage)("CreateTheCompositionLocal",{json:e,ofTheConceptId:t,ofTheConceptUserId:n,mainKey:a,userId:d,accessId:u,sessionInformationId:h,actions:f});return(null===(y=null===(v=null==i?void 0:i.actions)||void 0===v?void 0:v.concepts)||void 0===y?void 0:y.length)&&(f.concepts=JSON.parse(JSON.stringify(i.actions.concepts))),(null===(m=null===(g=null==i?void 0:i.actions)||void 0===g?void 0:g.connections)||void 0===m?void 0:m.length)&&(f.connections=JSON.parse(JSON.stringify(i.actions.connections))),o.Logger.logUpdate(C),i.data}catch(e){console.error("CreateTheCompositionLocal error sw: ",e),(0,i.ey)(C,"CreateTheCompositionLocal",e),(0,o.handleServiceWorkerException)(e)}}let T=null!=d?d:999,w=null!=u?u:999,I=null!=h?h:999,k=null!=a?a:0,N=(0,r.u)();for(const o in e)if("string"!=typeof e[o]&&"number"!=typeof e[o])if(null==t&&null==n){let t=k,n=yield(0,s.k)(o,"",!0,T,w,I,void 0,f);N=n,t=n.id,k=n.id,yield l(e[o],n.id,n.userId,t,d,u,h,void 0,f)}else{let n=null!=t?t:999,i=k,r=yield(0,s.k)(o,"",!0,T,w,I,void 0,f);yield(0,c.F)(n,r.id,i,void 0,void 0,void 0,f),yield l(e[o],r.id,r.userId,i,d,u,h,void 0,f)}else{let n=null!=t?t:999,i=k,r=yield(0,s.k)(o,e[o].toString(),!1,T,w,I,void 0,f);yield(0,c.F)(n,r.id,i,void 0,void 0,void 0,f)}return o.Logger.logUpdate(C),N}))}},3077:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(4059),i=n(2615),r=n(9736),c=n(5257),s=n(9700),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t,n,l,d,u){return a(this,arguments,void 0,(function*(e,t,n,a,l,d,u=!1,h=0,p={concepts:[],connections:[]}){var f,v,y,g;let m=performance.now();try{if(o.serviceWorker)try{const i=yield(0,o.sendMessage)("CreateTheConceptLocal",{referent:e,typecharacter:t,userId:n,categoryId:a,typeId:l,accessId:d,isComposition:u,referentId:h});return(null===(v=null===(f=null==i?void 0:i.actions)||void 0===f?void 0:f.concepts)||void 0===v?void 0:v.length)&&(p.concepts=JSON.parse(JSON.stringify(i.actions.concepts))),(null===(g=null===(y=null==i?void 0:i.actions)||void 0===y?void 0:y.connections)||void 0===g?void 0:g.length)&&(p.connections=JSON.parse(JSON.stringify(i.actions.connections))),i.data}catch(e){console.error("CreateTheConceptLocal error sw: ",e),(0,o.handleServiceWorkerException)(e)}let s=yield c.R.getConceptId(),m=!0,C=new Date,T=new Date;if("the"==e)return new i.j(1,999,5,5,h,e,d,m,C,T,t);let w=new i.j(s,n,l,a,h,e,d,m,C,T,t);return w.isTemp=!0,w.isComposition=u,r.v.AddConcept(w),p.concepts.push(w),w}catch(o){throw s.V.logError(m,n,"create","unknown","unknown",500,void 0,"createTheConceptLocal",[e,t,n,a,l,d,u],void 0),o}}))}},4711:(e,t,n)=>{n.d(t,{F:()=>l,d:()=>d});var o=n(2155),i=n(4864),r=n(5257),c=n(9700),s=n(4059),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t,n){return a(this,arguments,void 0,(function*(e,t,n,a=1,l="",d=999,u={concepts:[],connections:[]}){var h,p,f,v;let y=performance.now();if(s.serviceWorker)try{const o=yield(0,s.sendMessage)("CreateTheConnectionLocal",{ofTheConceptId:e,toTheConceptId:t,typeId:n,orderId:a,typeString:l,userId:d,actions:u});return(null===(p=null===(h=null==o?void 0:o.actions)||void 0===h?void 0:h.concepts)||void 0===p?void 0:p.length)&&(u.concepts=JSON.parse(JSON.stringify(o.actions.concepts))),(null===(v=null===(f=null==o?void 0:o.actions)||void 0===f?void 0:f.connections)||void 0===v?void 0:v.length)&&(u.connections=JSON.parse(JSON.stringify(o.actions.connections))),o.data}catch(e){console.log("CreateTheConnectionLocal error sw: ",e),(0,s.handleServiceWorkerException)(e)}try{let c=4,h=yield r.R.getConnectionId(),p=0,f=0,v=0;p=e,f=t,v=n;let y=new o.N(0,0,0,0,0,0,0);return e!=t&&(y=new o.N(h,p,f,d,n,a,c),y.isTemp=!0,y.typeCharacter=l,s.LocalSyncData.AddConnection(y),i.G.AddConnection(y),u.connections.push(y)),y}catch(o){throw c.V.logError(y,d,"create","Unknown","Unknown",500,void 0,"CreateTheConnectionLocal",[e,t,n,a,l,d],"UnknownUserAgent",[]),o}}))}function d(e,t,n){return a(this,arguments,void 0,(function*(e,t,n,o={concepts:[],connections:[]}){var i,r,c,a;if(s.serviceWorker)try{const l=yield(0,s.sendMessage)("CreateConnection",{ofTheConcept:e,toTheConcept:t,connectionTypeString:n,actions:o});return(null===(r=null===(i=null==l?void 0:l.actions)||void 0===i?void 0:i.concepts)||void 0===r?void 0:r.length)&&(o.concepts=JSON.parse(JSON.stringify(l.actions.concepts))),(null===(a=null===(c=null==l?void 0:l.actions)||void 0===c?void 0:c.connections)||void 0===a?void 0:a.length)&&(o.connections=JSON.parse(JSON.stringify(l.actions.connections))),l.data}catch(e){console.log("CreateConnection error sw: ",e),(0,s.handleServiceWorkerException)(e)}let d=yield(0,s.MakeTheTypeConceptLocal)(n,999,999,999),u=e.userId;return yield l(e.id,t.id,d.id,1e3,n,u,o)}))}},8064:(e,t,n)=>{n.d(t,{$I:()=>s,Ay:()=>c});var o=n(9736),i=(n(9581),n(3518),n(4059));n(1863);var r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function c(e){return r(this,void 0,void 0,(function*(){return yield o.v.GetConceptByCharacterAndTypeLocal(e,51)}))}function s(e){return r(this,void 0,void 0,(function*(){if(i.serviceWorker)try{return(yield(0,i.sendMessage)("GetConceptByCharacterAndCategoryLocal",{character:e})).data}catch(e){console.error("GetConceptByCharacterAndCategoryLocal error sw: ",e),(0,i.handleServiceWorkerException)(e)}let t=(0,i.CreateDefaultLConcept)();if("the"==e)return t.id=1,t.typeId=5,t.characterValue="the",t;let n=(0,i.SplitStrings)(e);if(n.length>1){let i=1,c=yield s(n[0]);0!=c.id&&(i=c.id),t=yield function(e,t){return r(this,void 0,void 0,(function*(){return o.v.GetConceptByCharacterAndCategoryLocal(e,t)}))}(e,i)}else n[0]==e&&(t=yield c(e));return t}))}},1213:(e,t,n)=>{n.d(t,{f:()=>a});var o=n(9736),i=n(7820),r=n(4059),c=n(176),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function a(e){return s(this,void 0,void 0,(function*(){let t=performance.now();try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetTheConceptLocal",{id:e})).data}catch(e){console.error("GetTheConceptLocal error sw: ",e),(0,r.handleServiceWorkerException)(e)}let t=(0,r.CreateDefaultLConcept)();if(e<0){if(t=yield o.v.GetConcept(e),0==t.id){let n=yield i.G.getNodeFromTree(e);if(null==n?void 0:n.value){let e=n.value;e&&(t=e)}}}else{let n=yield(0,r.GetTheConcept)(e);t=(0,c.F4)(n)}return t}catch(n){throw r.Logger.logError(t,"unknown","read","unknown",void 0,200,void 0,"GetTheConceptLocal",[e],"unknown",void 0),n}}))}},9975:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(4059),i=n(9736),r=n(3077),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e,t,n,s,a){return c(this,arguments,void 0,(function*(e,t,n,c,s,a={concepts:[],connections:[]}){var l,d,u,h;if(o.serviceWorker)try{const i=yield(0,o.sendMessage)("MakeTheConceptLocal",{referent:e,typeCharacter:t,userId:n,categoryId:c,typeId:s,actions:a});return(null===(d=null===(l=null==i?void 0:i.actions)||void 0===l?void 0:l.concepts)||void 0===d?void 0:d.length)&&(a.concepts=JSON.parse(JSON.stringify(i.actions.concepts))),(null===(h=null===(u=null==i?void 0:i.actions)||void 0===u?void 0:u.connections)||void 0===h?void 0:h.length)&&(a.connections=JSON.parse(JSON.stringify(i.actions.connections))),i.data}catch(e){console.error("MakeTheConceptLocal error sw: ",e),(0,o.handleServiceWorkerException)(e)}let p=yield i.v.GetConceptByCharacterAndTypeLocal(e,s),f=p;return"the"==t&&(c=1),0==f.id&&(p=yield(0,r.A)(e,t,n,c,s,4,void 0,null,a),f=p),f}))}},5868:(e,t,n)=>{n.d(t,{k:()=>l});var o=n(3077),i=n(8357),r=n(9736),c=n(4059),s=n(1863),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function l(e,t){var n=arguments;return a(this,arguments,void 0,(function*(e,t,a=!1,l,d,u=999,h=0,p={concepts:[],connections:[]}){var f,v,y,g;const m=c.Logger.logfunction("MakeTheInstanceConceptLocal",n)||{};if(c.serviceWorker){m.serviceWorker=!0;try{const n=yield(0,c.sendMessage)("MakeTheInstanceConceptLocal",{type:e,referent:t,composition:a,userId:l,accessId:d,sessionInformationId:u,referentId:h,actions:p});return(null===(v=null===(f=null==n?void 0:n.actions)||void 0===f?void 0:f.concepts)||void 0===v?void 0:v.length)&&(p.concepts=JSON.parse(JSON.stringify(n.actions.concepts))),(null===(g=null===(y=null==n?void 0:n.actions)||void 0===y?void 0:y.connections)||void 0===g?void 0:g.length)&&(p.connections=JSON.parse(JSON.stringify(n.actions.connections))),c.Logger.logUpdate(m),n.data}catch(e){console.error("MakeTheInstanceConceptLocal error sw: ",e),(0,s.ey)(m,"MakeTheInstanceConceptLocal",e),(0,c.handleServiceWorkerException)(e)}}try{let n,s,d=999,u=4,f=l,v=4,y="",g=t.length;if(y=e.startsWith("the_")?e:"the_"+e,a)n=yield(0,i.$)(e,d,l,l,p),s=yield(0,o.A)(t,e,l,u,n.id,v,!0,h,p);else if(g>255)n=yield(0,i.$)(y,d,f,l,p),s=yield(0,o.A)(t,y,l,u,n.id,v,void 0,void 0,p);else{n=yield(0,i.$)(y,d,f,l,p);let e=yield r.v.GetConceptByCharacterAndTypeLocal(t,n.id);s=e,0==e.id&&0==e.userId&&(s=yield(0,o.A)(t,y,l,u,n.id,v,void 0,void 0,p))}return s.type=n,c.LocalSyncData.AddConcept(s),p.concepts.push(s),c.Logger.logUpdate(m),s}catch(e){throw(0,s.ey)(m,"MakeTheInstanceConceptLocal",e),e}}))}},8357:(e,t,n)=>{n.d(t,{$:()=>d});var o=n(3077),i=n(8064),r=n(6467),c=n(9975),s=n(4059),a=n(1863),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e,t,n,u){var h=arguments;return l(this,arguments,void 0,(function*(e,t,n,l,u={concepts:[],connections:[]}){var p,f,v,y;const g=s.Logger.logfunction("MakeTheTypeConceptLocal",h)||{};if(s.serviceWorker){g.serviceWorker=!0;try{const o=yield(0,s.sendMessage)("MakeTheTypeConceptLocal",{typeString:e,sessionId:t,sessionUserId:n,userId:l,actions:u});return(null===(f=null===(p=null==o?void 0:o.actions)||void 0===p?void 0:p.concepts)||void 0===f?void 0:f.length)&&(u.concepts=JSON.parse(JSON.stringify(o.actions.concepts))),(null===(y=null===(v=null==o?void 0:o.actions)||void 0===v?void 0:v.connections)||void 0===y?void 0:y.length)&&(u.connections=JSON.parse(JSON.stringify(o.actions.connections))),s.Logger.logUpdate(g),o.data}catch(e){console.error("MakeTheTypeConceptLocal error sw: ",e),(0,a.ey)(g,"MakeTheTypeConceptLocal",e),(0,s.handleServiceWorkerException)(e)}}let m=yield(0,i.$I)(e);if(m&&(0==m.id||0==m.userId)){let i=(0,r.f)(e);if(i[0]==e)m=yield(0,c.A)(e,"the",l,1,51,u);else{let r=yield d(i[0],t,n,l,u),c=yield d(i[1],t,n,l,u);m=yield(0,o.A)(e,i[1],l,r.id,c.id,4,void 0,null,u)}}return s.Logger.logUpdate(g),m}))}},3729:(e,t,n)=>{n.d(t,{D:()=>p});var o=n(9934),i=n(4485),r=n(2),c=n(7876),s=n(4818),a=n(999),l=n(5868),d=n(4059),u=n(176),h=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function p(e){return h(this,arguments,void 0,(function*(e,t={concepts:[],connections:[]}){var n,h,p,f;if(performance.now(),d.serviceWorker)try{const o=yield(0,d.sendMessage)("UpdateCompositionLocal",{patcherStructure:e,actions:t});return(null===(h=null===(n=null==o?void 0:o.actions)||void 0===n?void 0:n.concepts)||void 0===h?void 0:h.length)&&(t.concepts=JSON.parse(JSON.stringify(o.actions.concepts))),(null===(f=null===(p=null==o?void 0:o.actions)||void 0===p?void 0:p.connections)||void 0===f?void 0:f.length)&&(t.connections=JSON.parse(JSON.stringify(o.actions.connections))),o.data}catch(e){console.error("UpdateCompositionLocal error sw: ",e),(0,d.handleServiceWorkerException)(e)}const v=e.userId,y=e.sessionId,g=e.accessId;let m=[];const C=[];let T=(0,d.CreateDefaultLConcept)(),w=(0,d.CreateDefaultLConcept)();const I=[],k=e.compositionId,N=e.ofTheCompositionId;let A=[],L=yield(0,r.s)(k);for(let e=0;e<L.length;e++)m.push((0,u.P6)(L[e]));const S=[],_=[];let b=[];for(let e=0;e<m.length;e++)(0,o.A)(_,m[e].ofTheConceptId),(0,o.A)(S,m[e].ofTheConceptId),(0,o.A)(S,m[e].toTheConceptId),b.push(m[e].ofTheConceptId);for(let e=0;e<S.length;e++){const t=yield(0,c.A)(S[e]);k==S[e]&&(T=(0,u.F4)(t)),N==S[e]&&(w=(0,u.F4)(t)),C.push((0,u.F4)(t))}const B=e.patchObject;for(const e in B){let n=(0,d.CreateDefaultLConcept)();const o=B[e];let r=T;w.id>0&&(r=w),Array.isArray(o)||"object"==typeof o?(n=yield(0,l.k)(e,"",!0,T.userId,4,999,void 0,t),yield(0,a.R)(B[e],n.id,n.userId,T.id,T.userId,4,999,void 0,t)):n=yield(0,l.k)(e,o,!1,v,g,y,void 0,t);const c=(0,i.nm)(C,n);for(let e=0;e<c.length;e++)if(c[e].id>0){const t=(0,i.gt)(m,c[e].id);A=A.concat(t),I.push(c[e])}yield(0,d.CreateTheConnectionLocal)(r.id,n.id,T.id,2,void 0,void 0,t),C.push(n)}for(let e=0;e<A.length;e++)yield(0,s.m)(A[e].id);yield d.LocalSyncData.SyncDataOnline(void 0,t)}))}},8407:(e,t,n)=>{n.d(t,{A:()=>f});var o=n(9581),i=n(3518),r=n(1863),c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},s=n(4402),a=n(4059),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class d{constructor(e,t,n,o,i,r,c,s,a,l){this.id=0,this.userId=e,this.data=t,this.securityId=n,this.securityUserId=o,this.accessId=i,this.accessUserId=r,this.sessionId=c,this.sessionUserId=s,this.entryTimestamp=a,this.isNew=l}}var u=n(7282),h=n(2212),p=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function f(e,t){var n=arguments;return p(this,arguments,void 0,(function*(e,t,p=!1,f,v=4,y=999,g=0){const m=a.Logger.logfunction("MakeTheInstanceConcept",n)||{};if(a.serviceWorker){m.serviceWorker=!0;try{const n=yield(0,a.sendMessage)("MakeTheInstanceConcept",{type:e,referent:t,composition:p,userId:f,passedAccessId:v,passedSessionId:y,referentId:g});return a.Logger.logUpdate(m),n.data}catch(e){console.error("MakeTheInstanceConcept sw error: ",e),(0,r.ey)(m,"MakeTheInstanceConcept",e),(0,a.handleServiceWorkerException)(e)}}let C,T=y,w=f,I=f,k=v,N=f,A="",L=t.length,S=(0,u.o)();if(A=e.startsWith("the_")?e:"the_"+e,p)S=yield(0,a.MakeTheTypeConceptApi)(e,f),C=yield(0,h.Ay)(t,f,4,S.id,g,k,e);else if(L>255)S=yield(0,a.MakeTheTypeConceptApi)(A,f),C=yield(0,h.Ay)(t,f,4,S.id,g,k,A),function(e){c(this,void 0,void 0,(function*(){try{var t=(0,i.Xr)();const n=yield fetch(o.B.CreateTheTextDataUrl(),{method:"POST",headers:t,body:JSON.stringify(e)});if(!n.ok)throw(0,r.ry)(n),new Error(`Error! status: ${n.status}`);return yield n.json()}catch(e){throw e instanceof Error?console.log("Create the text error message: ",e.message):console.log("Create the text unexpected error: ",e),e}}))}(new d(f,t,999,w,k,N,T,I,Date.now().toString(),!0));else{S=yield(0,a.MakeTheTypeConceptApi)(A,f);let e=yield(0,s.A)(t,S.id);C=e,0==e.id&&0==e.userId&&(C=yield(0,h.N)(t,f,4,S.id,12,k,A),function(e,t,n,c){var s=arguments;l(this,void 0,void 0,(function*(){const l=a.Logger.logfunction("MakeTheNameInBackend",s);try{let s={newConceptId:e,referent:t,typeId:n,typeUserId:c},d=(0,i.Xr)(),u=JSON.stringify(s);const h=yield fetch(o.B.MakeTheNameInBackendUrl(),{method:"POST",headers:d,body:u});a.Logger.logUpdate(l),h.ok||(0,r.ry)(h)}catch(e){e instanceof Error?console.log("make the name in backend error message: ",e.message):console.log("make the name in backend unexpected error: ",e),(0,r.Mb)(e,o.B.MakeTheNameInBackendUrl()),(0,r.ey)(l,"MakeTheNameInBackend",e)}}))}(C.id,`${t}`,S.id,f))}return C.type=S,a.Logger.logUpdate(m),C}))}},5312:(e,t,n)=>{n.d(t,{NK:()=>h,Ve:()=>p,cf:()=>d,vw:()=>f,y8:()=>u});var o=n(2832),i=n(3130),r=n(4059),c=n(1863),s=n(6687),a=n(1320),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function d(e){var t=arguments;return l(this,arguments,void 0,(function*(e,n="",d=null,h=i.y0){var p,v,y,g,m,C,T,w;const I=r.Logger.logfunction("SearchLinkMultipleAll",t)||{};try{try{if(r.serviceWorker){I.serviceWorker=!0;const t=yield(0,r.sendMessage)("SearchLinkMultipleAll",{searchQuery:e,token:n,caller:d,format:h});return r.Logger.logUpdate(I),t.data}}catch(e){console.error("SearchLinkMultipleAll error sw: ",e),(0,c.ey)(I,"SearchLinkMultipleAll",e),(0,r.handleServiceWorkerException)(e)}let t=[],k=[],N=[],A=[],L=e[0].composition,S={},_={};(null==d?void 0:d.isDataLoaded)?(S.compositionIds=null===(p=d.conceptIds)||void 0===p?void 0:p.slice(),S.internalConnections=null===(v=d.internalConnections)||void 0===v?void 0:v.slice(),S.linkers=null===(y=d.linkers)||void 0===y?void 0:y.slice(),S.reverse=null===(g=d.reverse)||void 0===g?void 0:g.slice(),_=S,t=_.compositionIds,N=_.internalConnections,k=_.linkers,A=_.reverse):(S=yield(0,o.j)(e,n),d&&(d.conceptIds=null===(m=S.compositionIds)||void 0===m?void 0:m.slice(),d.internalConnections=null===(C=S.internalConnections)||void 0===C?void 0:C.slice(),d.linkers=null===(T=S.linkers)||void 0===T?void 0:T.slice(),d.reverse=null===(w=S.reverse)||void 0===w?void 0:w.slice(),d.isDataLoaded=!0),_=S,t=_.compositionIds,N=_.internalConnections,k=_.linkers,A=_.reverse);let b=yield function(e,t,n,o,r,c){return l(this,arguments,void 0,(function*(e,t,n,o,r,c,l=i.y0){try{let d,h,p=yield(0,s.QL)(e);return l==i.ZJ?(d=yield(0,s.MT)(t,n),h=yield f(e,d,r,o)):l==i.yv?(d=yield(0,s.D)(t,n),h=yield f(e,d,r,o)):100==l?(d=yield(0,s.nr)(t,n),h=yield u(p,d,r,o)):l==i.SL?h=yield(0,a._W)(e,t,n,c.ofCompositions,o):(d=yield(0,s.rv)(t,n),h=yield u(p,d,r,o)),h}catch(e){return void console.log("Error Occured in build layer",e)}}))}(k,t,N,A,L,e[0],h);return r.Logger.logUpdate(I),b}catch(e){throw console.log("this is the error in the search link multiple",e),(0,c.ey)(I,"SearchLinkMultipleAll",e),e}}))}function u(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,o=[]){(new Date).getTime();let i={},c=[];for(let t=0;t<e.length;t++)c.push(e[t].toTheConceptId),c.push(e[t].ofTheConceptId),c.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let n=0;n<e.length;n++){let i=!1;if(o.includes(e[n].id)&&(i=!0),1==i){if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].toTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=null==o?void 0:o.data,s=Object.keys(c)[0];try{let o=i.characterValue+"_reverse";"string"==typeof c&&(c={}),Array.isArray(c[s][o])||("string"==typeof c[s]&&(c[s]={}),c[s][o]=[]),c[s][o].push(t[e[n].ofTheConceptId])}catch(e){console.log("this is error",e)}}}else if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].ofTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=null==o?void 0:o.data,s=Object.keys(c)[0];try{"string"==typeof c&&(c={}),Array.isArray(c[s][i.characterValue])||("string"==typeof c[s]&&(c[s]={}),c[s][i.characterValue]=[]),c[s][i.characterValue].push(t[e[n].toTheConceptId])}catch(e){console.log("this is error",e)}}}return i=t[n],i}))}function h(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,o=[]){let i=[],c=[];for(let t=0;t<e.length;t++)c.push(e[t].toTheConceptId),c.push(e[t].ofTheConceptId),c.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let n=0;n<e.length;n++){let i=!1;if(o.includes(e[n].id)&&(i=!0),1==i){if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].toTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=Object.keys(o)[0];try{let r=i.characterValue+"_reverse";"string"==typeof o&&(o={}),Array.isArray(o[c][r])||("string"==typeof o[c]&&(o[c]={}),o[c][r]=[]),o[c][r].push(t[e[n].ofTheConceptId])}catch(e){console.log("this is error",e)}}}else if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].ofTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=Object.keys(o)[0];try{"string"==typeof o&&(o={}),Array.isArray(o[c][i.characterValue])||("string"==typeof o[c]&&(o[c]={}),o[c][i.characterValue]=[]),o[c][i.characterValue].push(t[e[n].toTheConceptId])}catch(e){console.log("this is error",e)}}}for(let e=0;e<n.length;e++){let o=t[n[e]];o&&i.push(o)}return i}))}function p(e,t,n,o){return l(this,arguments,void 0,(function*(e,t,n,o,i=[]){(new Date).getTime();let c=[],s=[];for(let t=0;t<e.length;t++)s.push(e[t].toTheConceptId),s.push(e[t].ofTheConceptId),s.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let n=0;n<e.length;n++){let o=!1;if(i.includes(e[n].id)&&(o=!0),1==o){if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].toTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=null==o?void 0:o.data,s=Object.keys(c)[0];try{let o=i.characterValue+"_reverse";"string"==typeof c&&(c={}),Array.isArray(c[s][o])||("string"==typeof c[s]&&(c[s]={}),c[s][o]=[]),c[s][o].push(t[e[n].ofTheConceptId])}catch(e){console.log("this is error",e)}}}else if(t[e[n].ofTheConceptId]&&t[e[n].toTheConceptId]){let o=t[e[n].ofTheConceptId],i=yield(0,r.GetTheConcept)(e[n].typeId),c=null==o?void 0:o.data,s=Object.keys(c)[0];try{"string"==typeof c&&(c={}),Array.isArray(c[s][i.characterValue])||("string"==typeof c[s]&&(c[s]={}),c[s][i.characterValue]=[]),c[s][i.characterValue].push(t[e[n].toTheConceptId])}catch(e){console.log("this is error",e)}}}for(let e=0;e<o.length;e++){let n=t[o[e]];n&&c.push(n)}return c}))}function f(e,t,n){return l(this,arguments,void 0,(function*(e,t,n,o=[]){let i={},c=yield(0,r.GetConnectionBulk)(e),s=[];for(let e=0;e<c.length;e++)s.push(c[e].toTheConceptId),s.push(c[e].ofTheConceptId),s.push(c[e].typeId);yield(0,r.GetConceptBulk)(s),c.sort((function(e,t){return t.id-e.id}));for(let e=0;e<c.length;e++){let n=!1;if(o.includes(c[e].id)&&(n=!0),1==n){if(t[c[e].ofTheConceptId]&&t[c[e].toTheConceptId]){let n=t[c[e].toTheConceptId],o=yield(0,r.GetTheConcept)(c[e].typeId),i=n,s=Object.keys(i)[0];try{let n=o.characterValue+"_reverse";"string"==typeof i&&(i={}),Array.isArray(i[s][n])||("string"==typeof i[s]&&(i[s]={}),i[s][n]=[]),i[s][n].push(t[c[e].ofTheConceptId])}catch(e){console.log("this is error",e)}}}else if(t[c[e].ofTheConceptId]&&t[c[e].toTheConceptId]){let n=t[c[e].ofTheConceptId],o=yield(0,r.GetTheConcept)(c[e].typeId),i=n,s=Object.keys(i)[0];try{"string"==typeof i&&(i={}),Array.isArray(i[s][o.characterValue])||("string"==typeof i[s]&&(i[s]={}),i[s][o.characterValue]=[]),i[s][o.characterValue].push(t[c[e].toTheConceptId])}catch(e){console.log("this is error",e)}}}return i=t[n],i}))}},1320:(e,t,n)=>{n.d(t,{zl:()=>g,b6:()=>T,e$:()=>I,y6:()=>w,rq:()=>k,yV:()=>m,_W:()=>C});var o=n(4059),i=n(6687);function r(e){return e.startsWith("the_")?e.slice(4):e}var c=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function s(e,t,n){return c(this,void 0,void 0,(function*(){var i,r,c,s,a,l,d,u;let h=[];for(let t=0;t<e.length;t++)h.push(e[t].toTheConceptId),h.push(e[t].ofTheConceptId),h.push(e[t].typeId);for(let h=0;h<e.length;h++){let p=!1;n.includes(e[h].id)&&(p=!0);let f=yield(0,o.GetTheConcept)(e[h].ofTheConceptId),v=yield(0,o.GetTheConcept)(e[h].toTheConceptId);if(1==p&&0!=f.id&&0!=v.id){let n,a=null!==(r=null===(i=v.type)||void 0===i?void 0:i.characterValue)&&void 0!==r?r:"self";e[h].toTheConceptId in t?n=t[e[h].toTheConceptId]:(n={},n[a]={},t[e[h].toTheConceptId]=n);let l=yield(0,o.GetTheConcept)(e[h].typeId);try{let e=null!==(s=null===(c=null==f?void 0:f.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"none",n=f.characterValue;l.characterValue,l.characterValue.includes("_s_")&&(f.id in t||(t[f.id]={}),t[f.id][e]=n),t[v.id]={}}catch(e){console.log("this is error",e)}}if(0!=f.id&&0!=v.id){let n,i=null!==(l=null===(a=f.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"self";e[h].ofTheConceptId in t?n=t[e[h].ofTheConceptId]:(n={},n[i]={},t[e[h].ofTheConceptId]=n);let r=yield(0,o.GetTheConcept)(e[h].typeId);try{let e=null!==(u=null===(d=null==v?void 0:v.type)||void 0===d?void 0:d.characterValue)&&void 0!==u?u:"none",n=v.characterValue;r.characterValue.includes("_s_")&&(v.id in t||(t[v.id]={}),t[v.id][e]=n),t[f.id]={}}catch(e){console.log("this is error",e)}}}return t}))}var a=n(5312),l=n(7876),d=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function u(e,t,n){if(e in t){let o=t[e];o&&(n[o.connectionType+"_count"]=o.count)}}var h=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},p=n(4698),f=n(6915),v=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},y=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function g(e,t){return y(this,arguments,void 0,(function*(e,t,n=""){let r=yield(0,o.SearchWithTypeAndLinkerApi)(e,t,n),c=r.compositionIds,s=r.internalConnections,l=r.linkers,d=r.reverse,u=r.mainCompositionIds,h=yield(0,i.QL)(l),p=yield(0,i.MT)(c,s);return yield(0,a.NK)(h,p,u,d)}))}function m(e,t,n,o,r){return y(this,void 0,void 0,(function*(){let c=yield(0,i.QL)(e),s=yield(0,i.rv)(t,n);return yield(0,a.Ve)(c,s,t,o,r)}))}function C(e,t,n,o,r){return y(this,void 0,void 0,(function*(){let c=yield(0,i.QL)(e),s=yield(0,i.D)(t,n);return yield(0,a.NK)(c,s,o,r)}))}function T(e,t,n,a,l){return y(this,void 0,void 0,(function*(){if(o.serviceWorker)try{return(yield(0,o.sendMessage)("formatConnections",{linkers:e,conceptIds:t,mainCompositionIds:n,reverse:a,countInfos:l})).data}catch(e){console.error("formatConnections error sw: ",e),(0,o.handleServiceWorkerException)(e)}let d=yield(0,i.QL)(e);d=(0,f.X)(d);let u=[];u=yield s(d,u,a),u=yield function(e,t,n){return c(this,void 0,void 0,(function*(){var i,c,s,a,l,d,u,h;let p=[];for(let t=0;t<e.length;t++)p.push(e[t].toTheConceptId),p.push(e[t].ofTheConceptId),p.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let p=0;p<e.length;p++){let f=!1;n.includes(e[p].id)&&(f=!0);let v=yield(0,o.GetTheConcept)(e[p].ofTheConceptId),y=yield(0,o.GetTheConcept)(e[p].toTheConceptId);if(1==f&&0!=v.id&&0!=y.id){let n,l=null!==(c=null===(i=y.type)||void 0===i?void 0:i.characterValue)&&void 0!==c?c:"self";e[p].toTheConceptId in t?(n=t[e[p].toTheConceptId],l in n||(n[l]={})):(n={},n[l]={},t[e[p].toTheConceptId]=n);let d=yield(0,o.GetTheConcept)(e[p].typeId);try{let e=null!==(a=null===(s=null==v?void 0:v.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"none",t=v.characterValue,o=d.characterValue;""==o&&(o=e,o=r(o));let i={[e]:t},c=o+"_reverse";d.characterValue.includes("_s_")||("string"==typeof n[l]&&(n[l]={}),n[l][c]=i)}catch(e){console.log("this is error",e)}}if(0!=v.id&&0!=y.id){let n,i=null!==(d=null===(l=v.type)||void 0===l?void 0:l.characterValue)&&void 0!==d?d:"self";e[p].ofTheConceptId in t?(n=t[e[p].ofTheConceptId],i in n||(n[i]={})):(n={},n[i]={},t[e[p].ofTheConceptId]=n);let c=yield(0,o.GetTheConcept)(e[p].typeId);try{let e=null!==(h=null===(u=null==y?void 0:y.type)||void 0===u?void 0:u.characterValue)&&void 0!==h?h:"none",t=y.characterValue,o=c.characterValue,s=(c.characterValue,!1);""==o&&(o=e,o=r(o),s=!0);let a={[e]:t};isNaN(Number(o))?c.characterValue.includes("_s_")||("string"==typeof n[i]&&(n[i]={}),n[i][o]=s?t:a):(Array.isArray(n[i])||(n[i]=[]),n[i].push(t))}catch(e){console.log("this is error",e)}}}return t}))}(d,u,a);let h=yield function(e,t,n,i){return c(this,arguments,void 0,(function*(e,t,n,i,r=[]){var c,s,a,l,d,u;let h=[],p=[];for(let t=0;t<e.length;t++)p.push(e[t].toTheConceptId),p.push(e[t].ofTheConceptId),p.push(e[t].typeId);e.sort((function(e,t){return t.id-e.id}));for(let n=0;n<e.length;n++){let i=!1;r.includes(e[n].id)&&(i=!0);let h=yield(0,o.GetTheConcept)(e[n].ofTheConceptId),p=yield(0,o.GetTheConcept)(e[n].toTheConceptId);if(1==i&&0!=h.id&&0!=p.id&&p.id in t){let i,r=null!==(s=null===(c=p.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"self";e[n].toTheConceptId in t?i=t[e[n].toTheConceptId]:(i={},i[r]={},t[e[n].toTheConceptId]=i);let a=yield(0,o.GetTheConcept)(e[n].typeId);try{let o=a.characterValue+"_reverse",c=t[e[n].ofTheConceptId];c&&(Array.isArray(i[r][o])?i[r][o].push(c):a.characterValue.includes("_s_")?(i[r][o]=[],i[r][o].push(c)):i[r][o]=c)}catch(e){console.log("this is error",e)}}if(0!=h.id&&0!=p.id&&h.id in t){let i,r=null!==(l=null===(a=h.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"self";e[n].ofTheConceptId in t?(i=t[e[n].ofTheConceptId],"string"==typeof i[r]&&(i[r]={})):(i={},i[r]={},t[e[n].ofTheConceptId]=i);let c=!1,s=(yield(0,o.GetTheConcept)(e[n].typeId)).characterValue;""==s&&(s=p.characterValue,c=!0),""==s&&(s=null!==(u=null===(d=null==p?void 0:p.type)||void 0===d?void 0:d.characterValue)&&void 0!==u?u:"");try{let o=t[e[n].toTheConceptId];o&&(Array.isArray(i[r])?c?i[r].push(o[s]):i[r].push(o):Array.isArray(i[r][s])?i[r][s].push(o):s.includes("_s_")?(i[r][s]=[],c?i[r][s].push(o[s]):i[r][s].push(o)):i[r][s]=c?o[s]:o)}catch(e){console.log("this is error",e)}}}for(let e=0;e<n.length;e++){let i=t[n[e]];i?(i.id=n[e],h.push(i)):0!=(yield o.ConceptsData.GetConcept(n[e])).id&&(i={},i.id=n[e],h.push(i))}return h}))}(d,u,n,[],a);return h}))}function w(e,t,n,c,a){return y(this,arguments,void 0,(function*(e,t,n,c,a,h="DESC"){if(o.serviceWorker)try{return(yield(0,o.sendMessage)("formatConnectionsJustId",{linkers:e,conceptIds:t,mainCompositionIds:n,reverse:c,countInfos:a,order:h})).data}catch(e){console.error("formatConnectionsJustId error sw: ",e),(0,o.handleServiceWorkerException)(e)}let v=yield(0,i.QL)(e),y=yield(0,p.V)(a);v=(0,f.X)(v,h);let g=[];g=yield s(v,g,c),g=yield function(e,t){return d(this,arguments,void 0,(function*(e,t,n=[]){var o,i,c,s,a,d,u,h;let p=[];for(let t=0;t<e.length;t++)p.push(e[t].toTheConceptId),p.push(e[t].ofTheConceptId),p.push(e[t].typeId);for(let p=0;p<e.length;p++){let f=!1,v=yield(0,l.A)(e[p].ofTheConceptId),y=yield(0,l.A)(e[p].toTheConceptId);if(n.includes(e[p].id)&&(f=!0),1==f&&0!=v.id&&0!=y.id){let n,a=yield(0,l.A)(e[p].typeId),d=null!==(i=null===(o=y.type)||void 0===o?void 0:o.characterValue)&&void 0!==i?i:"self";e[p].toTheConceptId in t?(n=t[e[p].toTheConceptId],d in n||(n[d]={})):(n={},n[d]={},t[e[p].toTheConceptId]=n);try{let t=null!==(s=null===(c=null==v?void 0:v.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"none",o=v.characterValue,i=a.characterValue;""==i&&(i=t,i=r(i));let l={id:v.id,[t]:o,created_on:e[p].entryTimeStamp},u=i+"_reverse";u.includes("_s_")||("string"==typeof n[d]&&(n[d]={}),n[d][u]=l)}catch(e){console.log("this is error",e)}}if(0!=v.id&&0!=y.id){let n,o=yield(0,l.A)(e[p].typeId),i=null!==(d=null===(a=v.type)||void 0===a?void 0:a.characterValue)&&void 0!==d?d:"self";e[p].ofTheConceptId in t?(n=t[e[p].ofTheConceptId],i in n||(n[i]={})):(n={},n[i]={},t[e[p].ofTheConceptId]=n);try{let t=null!==(h=null===(u=null==y?void 0:y.type)||void 0===u?void 0:u.characterValue)&&void 0!==h?h:"none",c=y.characterValue,s=o.characterValue,a=!1;""==s&&(s=t,s=r(s),a=!0);let l={};l[t]={id:y.id,data:c,created_on:e[p].entryTimeStamp},isNaN(Number(s))?s.includes("_s_")||("string"==typeof n[i]&&(n[i]={}),n[i][s]=a?l[t]:l):(Array.isArray(n[i])||(n[i]=[]),n[i].push(l[t]))}catch(e){console.log("this is error",e)}}}return t}))}(v,g,c);let m=yield function(e,t,n){return d(this,arguments,void 0,(function*(e,t,n,i=[],r){var c,s,a,d,h,p,f;(new Date).getTime();let v=[],y=[];for(let t=0;t<e.length;t++)y.push(e[t].toTheConceptId),y.push(e[t].ofTheConceptId),y.push(e[t].typeId);for(let n=0;n<e.length;n++){let o=!1,v=yield(0,l.A)(e[n].ofTheConceptId),y=yield(0,l.A)(e[n].toTheConceptId);if(i.includes(e[n].id)&&(o=!0),1==o&&0!=v.id&&0!=y.id&&y.id in t){let o,i=yield(0,l.A)(e[n].typeId),r=null!==(s=null===(c=y.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"self",a=!1;e[n].toTheConceptId in t&&(a=!0),e[n].toTheConceptId in t?(o=t[e[n].toTheConceptId],"string"==typeof o[r]&&(o[r]={})):(o={},o[r]={},t[e[n].toTheConceptId]=o);try{if(t[e[n].ofTheConceptId]){let c=t[e[n].ofTheConceptId];c&&(c.id=v.id,c.created_on=v.entryTimeStamp);let s=i.characterValue+"_reverse";Array.isArray(o[r][s])?o[r][s].push(c):s.includes("_s_")?(o[r][s]=[],o[r][s].push(c)):o[r][s]=c}}catch(e){console.log("this is error",e)}}if(0!=v.id&&0!=y.id&&v.id in t){let o,i=yield(0,l.A)(e[n].typeId),c=null!==(d=null===(a=v.type)||void 0===a?void 0:a.characterValue)&&void 0!==d?d:"self",s=!1;e[n].toTheConceptId in t&&(s=!0),e[n].ofTheConceptId in t?(o=t[e[n].ofTheConceptId],"string"==typeof o[c]&&(o[c]={})):(o={},o[c]={},t[e[n].ofTheConceptId]=o),u(v.id,r,o);let g=!1,m=i.characterValue;""==m&&(m=y.characterValue,g=!0),""==m&&(m=(null===(h=null==y?void 0:y.type)||void 0===h?void 0:h.characterValue)||"");try{let i=null!==(f=null===(p=null==y?void 0:y.type)||void 0===p?void 0:p.characterValue)&&void 0!==f?f:"none",s=t[e[n].toTheConceptId];if(s){let t={};t[i]={data:s[i],id:y.id,created_on:e[n].entryTimeStamp},Array.isArray(o[c])?g?o[c].push(s[m]):o[c].push(s):Array.isArray(o[c][m])?o[c][m].push(t):m.includes("_s_")?(o[c][m]=[],g?o[c][m].push(t[i]):o[c][m].push(t)):o[c][m]=g?t[i]:t,u(y.id,r,t)}}catch(e){console.log("this is error",e)}}}for(let e=0;e<n.length;e++){let i={};i=t[n[e]],i?i.id=n[e]:0!=(yield o.ConceptsData.GetConcept(n[e])).id&&(i={},i.id=n[e]),v.push(i)}return v}))}(v,g,n,c,y);return m}))}function I(e,t,n,c,s){return y(this,arguments,void 0,(function*(e,t,n,c,s,a="DESC"){if(o.serviceWorker)try{return(yield(0,o.sendMessage)("formatConnectionsDataId",{linkers:e,conceptIds:t,mainCompositionIds:n,reverse:c,countInfos:s,order:a})).data}catch(e){console.error("GetConnectionDataPrefetch error sw: ",e),(0,o.handleServiceWorkerException)(e)}let l=yield(0,i.QL)(e),d=yield(0,p.V)(s);l=(0,f.X)(l,a);let v=[];v=yield function(e,t){var n=arguments;return h(this,arguments,void 0,(function*(e,t,i=[]){var r,c,s,a,l,d,u,h;const p=o.Logger.logfunction("FormatFunctionData",n);let f=[];for(let t=0;t<e.length;t++)f.push(e[t].toTheConceptId),f.push(e[t].ofTheConceptId),f.push(e[t].typeId);for(let n=0;n<e.length;n++){let p=!1,f=yield(0,o.GetTheConcept)(e[n].ofTheConceptId),v=yield(0,o.GetTheConcept)(e[n].toTheConceptId);if(i.includes(e[n].id)&&(p=!0),1==p&&0!=f.id&&0!=v.id){let i,l=yield(0,o.GetTheConcept)(e[n].typeId),d=null!==(c=null===(r=v.type)||void 0===r?void 0:r.characterValue)&&void 0!==c?c:"self";e[n].toTheConceptId in t?i=t[e[n].toTheConceptId]:(i={},i[d]={},t[e[n].toTheConceptId]=i);try{let e=null!==(a=null===(s=null==f?void 0:f.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"none",n=f.characterValue;(l.characterValue+"_reverse").includes("_s_")&&(f.id in t||(t[f.id]={}),t[f.id][e]=n),t[v.id]={}}catch(e){console.log("this is error",e)}}if(0!=f.id&&0!=v.id){let i,r=yield(0,o.GetTheConcept)(e[n].typeId),c=null!==(d=null===(l=f.type)||void 0===l?void 0:l.characterValue)&&void 0!==d?d:"self";e[n].ofTheConceptId in t?i=t[e[n].ofTheConceptId]:(i={},i[c]={},t[e[n].ofTheConceptId]=i);try{let e=null!==(h=null===(u=null==v?void 0:v.type)||void 0===u?void 0:u.characterValue)&&void 0!==h?h:"none",n=v.characterValue;r.characterValue.includes("_s_")&&(v.id in t||(t[v.id]={}),t[v.id][e]=n),t[f.id]={}}catch(e){console.log("this is error",e)}}}return o.Logger.logUpdate(p),t}))}(l,v,c),v=yield function(e,t){var n=arguments;return h(this,arguments,void 0,(function*(e,t,i=[]){var c,s,a,l,d,u,h,p;const f=o.Logger.logfunction("FormatFunctionDataForData",n);let v=[];for(let t=0;t<e.length;t++)v.push(e[t].toTheConceptId),v.push(e[t].ofTheConceptId),v.push(e[t].typeId);for(let n=0;n<e.length;n++){let f=!1,v=yield(0,o.GetTheConcept)(e[n].ofTheConceptId),y=yield(0,o.GetTheConcept)(e[n].toTheConceptId);if(i.includes(e[n].id)&&(f=!0),1==f&&0!=v.id&&0!=y.id){let i,d=yield(0,o.GetTheConcept)(e[n].typeId),u=null!==(s=null===(c=y.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"self";e[n].toTheConceptId in t?(i=t[e[n].toTheConceptId],u in i||(i[u]={})):(i={},i[u]={},t[e[n].toTheConceptId]=i);try{let e=null!==(l=null===(a=null==v?void 0:v.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"none",t=v.characterValue,n=d.characterValue;""==n&&(n=e,n=r(n));let o={id:v.id,data:{[e]:t}},c=n+"_reverse";c.includes("_s_")||("string"==typeof i[u]&&(i[u]={}),i[u][c]=o)}catch(e){console.log("this is error",e)}}if(0!=v.id&&0!=y.id){let i,c=yield(0,o.GetTheConcept)(e[n].typeId),s=null!==(u=null===(d=v.type)||void 0===d?void 0:d.characterValue)&&void 0!==u?u:"self";e[n].ofTheConceptId in t?(i=t[e[n].ofTheConceptId],s in i||(i[s]={})):(i={},i[s]={},t[e[n].ofTheConceptId]=i);try{let e=null!==(p=null===(h=null==y?void 0:y.type)||void 0===h?void 0:h.characterValue)&&void 0!==p?p:"none",t=y.characterValue,n=c.characterValue,o=!1;""==n&&(n=e,n=r(n),o=!0);let a={id:y.id,data:{[e]:t}};isNaN(Number(n))?n.includes("_s_")||("string"==typeof i[s]&&(i[s]={}),i[s][n]=a):(Array.isArray(i[s])||(i[s]=[]),i[s].push(a))}catch(e){console.log("this is error",e)}}}return o.Logger.logUpdate(f),t}))}(l,v,c);let y=yield function(e,t,n,i){var r=arguments;return h(this,arguments,void 0,(function*(e,t,n,i,c=[],s){var a,l,d,h,p,f;const v=o.Logger.logfunction("FormatFromConnectionsAlteredArrayExternal",r);let y=[],g=[];for(let t=0;t<e.length;t++)g.push(e[t].toTheConceptId),g.push(e[t].ofTheConceptId),g.push(e[t].typeId);for(let n=0;n<e.length;n++){let i=!1,r=yield(0,o.GetTheConcept)(e[n].ofTheConceptId),v=yield(0,o.GetTheConcept)(e[n].toTheConceptId);if(c.includes(e[n].id)&&(i=!0),1==i&&0!=r.id&&0!=v.id&&v.id in t){let i,c=yield(0,o.GetTheConcept)(e[n].typeId),d=null!==(l=null===(a=v.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"self",h=!1;e[n].toTheConceptId in t&&(h=!0),e[n].toTheConceptId in t?(i=t[e[n].toTheConceptId],"string"==typeof i[d]&&(i[d]={})):(i={},i[d]={},t[e[n].toTheConceptId]=i),u(v.id,s,i);try{if(t[e[n].ofTheConceptId]){let o={id:r.id,data:t[e[n].ofTheConceptId],created_on:e[n].entryTimeStamp},s=c.characterValue+"_reverse";Array.isArray(i[d][s])?i[d][s].push(o):s.includes("_s_")?(i[d][s]=[],i[d][s].push(o)):i[d][s]=o}}catch(e){console.log("this is error",e)}}if(0!=r.id&&0!=v.id&&r.id in t){let i,c=yield(0,o.GetTheConcept)(e[n].typeId),a=null!==(h=null===(d=r.type)||void 0===d?void 0:d.characterValue)&&void 0!==h?h:"self",l=!1;e[n].toTheConceptId in t&&(l=!0),e[n].ofTheConceptId in t?(i=t[e[n].ofTheConceptId],"string"==typeof i[a]&&(i[a]={})):(i={},i[a]={},t[e[n].ofTheConceptId]=i),u(r.id,s,i);let y=!0,g=c.characterValue;""==g&&(g=v.characterValue,y=!0),""==g&&(g=(null===(p=null==v?void 0:v.type)||void 0===p?void 0:p.characterValue)||"");try{null===(f=null==v?void 0:v.type)||void 0===f||f.characterValue;let o=t[e[n].toTheConceptId];if(o){let r={id:v.id,data:t[e[n].toTheConceptId],created_on:e[n].entryTimeStamp};Array.isArray(i[a])?i[a].push(o):Array.isArray(i[a][g])?i[a][c.characterValue].push(r):g.includes("_s_")?(i[a][g]=[],i[a][g].push(r)):i[a][g]=r,u(v.id,s,r)}}catch(e){console.log("this is error",e)}}}for(let e=0;e<i.length;e++){let n={};n.id=i[e];let r=yield(0,o.GetTheConcept)(n.id);n.data=t[i[e]],n.created_on=r.entryTimeStamp,y.push(n)}return o.Logger.logUpdate(v),y}))}(l,v,[],n,c,d);return y}))}function k(e,t,n,c,s){return y(this,arguments,void 0,(function*(e,t,n,c,s,a="DESC"){let l=yield(0,i.QL)(e),d=yield(0,p.V)(s);l=(0,f.X)(l,a);let h={};h=yield function(e){var t=arguments;return v(this,arguments,void 0,(function*(e,n={},i=[]){var r,c,s,a,l;const d=o.Logger.logfunction("FormatFunctionDataV2",t);for(const t of e){const e=i.includes(t.id),d=yield(0,o.GetTheConcept)(t.ofTheConceptId),u=yield(0,o.GetTheConcept)(t.toTheConceptId),h=yield(0,o.GetTheConcept)(t.typeId);if(0===d.id||0===u.id)continue;const p=e?u:d,f=e?d:u,v=null!==(c=null===(r=p.type)||void 0===r?void 0:r.characterValue)&&void 0!==c?c:"self",y=null!==(a=null===(s=f.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"none",g=f.characterValue,m=null===(l=h.characterValue)||void 0===l?void 0:l.includes("_s_");n[p.id]||(n[p.id]={}),n[p.id][v]||(n[p.id][v]={}),m&&(n[f.id]||(n[f.id]={}),n[f.id][y]=g)}return o.Logger.logUpdate(d),n}))}(l,h,c),h=yield function(e){var t=arguments;return v(this,arguments,void 0,(function*(e,n={},i=[]){var c,s,a,l,d;const u=o.Logger.logfunction("FormatFunctionDataForDataV2",t);for(const t of e){const e=i.includes(t.id),u=yield(0,o.GetTheConcept)(t.ofTheConceptId),h=yield(0,o.GetTheConcept)(t.toTheConceptId),p=yield(0,o.GetTheConcept)(t.typeId);if(0===u.id||0===h.id)continue;const f=e?h:u,v=e?u:h,y=null!==(s=null===(c=f.type)||void 0===c?void 0:c.characterValue)&&void 0!==s?s:"self",g=null!==(l=null===(a=v.type)||void 0===a?void 0:a.characterValue)&&void 0!==l?l:"none",m=v.characterValue,C=null!==(d=p.characterValue)&&void 0!==d?d:"";let T=""===C?r(g):C;const w=T.includes("_s_"),I=!isNaN(Number(T)),k={id:v.id,data:{[g]:m}};n[f.id]||(n[f.id]={}),y in n[f.id]&&"string"!=typeof n[f.id][y]||(n[f.id][y]=I?[]:{});try{if(w)continue;I?n[f.id][y].push(k):n[f.id][y][e?`${T}_reverse`:T]=k}catch(e){console.error("Error formatting concept data:",e)}}return o.Logger.logUpdate(u),n}))}(l,h,c);let y=yield function(e,t,n){var i=arguments;return v(this,arguments,void 0,(function*(e,t,n,r=[],c){var s,a,l;const d=o.Logger.logfunction("FormatFromConnectionsAlteredArrayExternal",i),h=[];for(const n of e){const e=r.includes(n.id),i=yield(0,o.GetTheConcept)(n.ofTheConceptId),d=yield(0,o.GetTheConcept)(n.toTheConceptId),h=yield(0,o.GetTheConcept)(n.typeId);if(0===i.id||0===d.id)continue;const p=e?d:i,f=e?i:d,v=p.id,y=f.id,g=null!==(a=null===(s=p.type)||void 0===s?void 0:s.characterValue)&&void 0!==a?a:"self",m=h.characterValue+"_reverse",C=h.characterValue||f.characterValue||(null===(l=f.type)||void 0===l?void 0:l.characterValue)||"";t[v]||(t[v]={}),t[v][g]&&"string"!=typeof t[v][g]||(t[v][g]={});const T=t[v][g],w=t[y],I={id:f.id,data:w,created_on:n.entryTimeStamp};u(v,c,t[v]);try{e?Array.isArray(T[m])?T[m].push(I):m.includes("_s_")?T[m]=[I]:T[m]=I:(Array.isArray(T)?T.push(w):Array.isArray(T[C])?T[C].push(I):C.includes("_s_")?T[C]=[I]:T[C]=I,u(y,c,I))}catch(e){console.error("Error processing connection:",e)}}for(const e of n){const n=yield(0,o.GetTheConcept)(e);h.push({id:e,data:t[e],created_on:n.entryTimeStamp})}return o.Logger.logUpdate(d),h}))}(l,h,n,c,d);return y}))}},6915:(e,t,n)=>{function o(e,t="DESC"){return"ASC"==t?e.sort((function(e,t){return e.id-t.id})):e.sort((function(e,t){return t.id-e.id})),e}n.d(t,{X:()=>o})},3518:(e,t,n)=>{n.d(t,{BZ:()=>s,Xr:()=>r,ab:()=>c});var o=n(3278),i=n(490);function r(e="application/json",t="application/json"){var n;let i={},r=null===(n=o.b.sessionId)||void 0===n?void 0:n.toString();return i=""!=o.b.BearerAccessToken?{"Content-Type":e,Authorization:"Bearer "+o.b.BearerAccessToken,Accept:t,"X-Session-id":r}:{"Content-Type":e,Accept:t,"X-Session-id":r},i}function c(e="application/json",t="",n="application/json"){var i;""==t&&(t=o.b.BearerAccessToken);let r={},c=null===(i=o.b.sessionId)||void 0===i?void 0:i.toString();return r=""!=t?{"Content-Type":e,Authorization:"Bearer "+t,Accept:n,"X-Session-id":c}:{"Content-Type":e,Accept:n,"X-Session-id":c},r}function s(){var e;let t=o.b.BearerAccessToken,n=null===(e=o.b.sessionId)||void 0===e?void 0:e.toString();if(""==t){let e=(0,i.s)();""!=e.token&&(o.b.BearerAccessToken=e.token,t=e.token)}let r=new Headers;return r.append("Authorization","Bearer "+t),r.append("X-Session-Id",n),r}},6467:(e,t,n)=>{function o(e){const t=e.lastIndexOf("_");let n=[];return n=t>0?[e.substring(0,t),e.substring(t+1,e.length)]:[e],n}n.d(t,{f:()=>o})},490:(e,t,n)=>{function o(){var e,t,n,o;let i={entity:0,userConcept:0,userId:0,token:""};try{let r=(null===localStorage||void 0===localStorage?void 0:localStorage.getItem("profile"))||"";if(r){const c=JSON.parse(r);i.entity=null!==(e=null==c?void 0:c.entityId)&&void 0!==e?e:0,i.userConcept=null!==(t=null==c?void 0:c.userConcept)&&void 0!==t?t:0,i.userId=null!==(n=null==c?void 0:c.userId)&&void 0!==n?n:0,i.token=null!==(o=null==c?void 0:c.token)&&void 0!==o?o:""}}catch(e){console.log("This is the exception in getting user details from local storage")}return i}n.d(t,{s:()=>o})},1596:(e,t,n)=>{n.d(t,{g:()=>c});var o=n(4059),i=n(3278),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function c(e,t){return r(this,void 0,void 0,(function*(){if("undefined"!=typeof self&&"undefined"!=typeof ServiceWorkerGlobalScope&&self instanceof ServiceWorkerGlobalScope)throw new Error("Cannot switch server from service worker");try{!function(){const e=o.BaseUrl.NODE_CACHE_URL;if(e===o.BaseUrl.BASE_URL)throw new Error("Base Server Down");let t=sessionStorage.getItem("cacheServers");t=JSON.parse(t);const n=t.indexOf(e);if(t.includes(e)&&-1!==n&&t.splice(n,1),sessionStorage.setItem("cacheServers",JSON.stringify(t)),t.length){const e=t[0];o.BaseUrl.NODE_CACHE_URL=e}else o.BaseUrl.NODE_CACHE_URL=o.BaseUrl.BASE_URL;console.log("before the payload",i.b.sessionId),navigator.serviceWorker&&navigator.serviceWorker.controller&&(0,o.sendMessage)("SESSION_DATA",{type:"SESSION_DATA",data:o.BaseUrl.NODE_CACHE_URL,session:i.b.sessionId})}();try{return yield fetch(`${o.BaseUrl.NODE_CACHE_URL}${t}`,e)}catch(n){return yield c(e,t)}}catch(e){throw e}}))}},4310:(e,t,n)=>{n.d(t,{Cp:()=>h,ix:()=>v,qj:()=>f,xJ:()=>p});var o=n(4059),i=n(1596),r=n(4698),c=n(1863),s=n(1320),a=n(3518),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const d=new Map,u=new Map;function h(e){var t=arguments;return l(this,void 0,void 0,(function*(){o.Logger.logfunction("BuildWidgetFromId",t);try{if(o.serviceWorker)return(yield(0,o.sendMessage)("BuildWidgetFromId",{id:e})).data}catch(e){console.error("BuildWidgetFromId error sw: ",e),(0,o.handleServiceWorkerException)(e)}let n={};if(d.has(e))return d.get(e)||n;const i=(()=>l(this,void 0,void 0,(function*(){try{let t=[],i=[],l=[],d=[],u="DESC",h=[],p={},f=(0,a.Xr)("application/json"),v=o.BaseUrl.getWidgetData()+"?id="+e;const y=yield fetch(v,{method:"GET",headers:f});if(!y.ok)return(0,c.ry)(y),console.log("This is the BuildWidgetFromId error",y.status),[];p=yield y.json(),t=p.conceptIds,i=p.linkers,l=p.reverse,d=p.mainCompositionIds,h=p.countinfo;let g=(0,r.w)(h);return n=yield(0,s.e$)(i,t,d,l,g,u),n}catch(e){throw console.log("this is the error in the build widget",e),e}finally{d.delete(e)}})))();return d.set(e,i),i}))}function p(e){return l(this,void 0,void 0,(function*(){try{if(o.serviceWorker)return(yield(0,o.sendMessage)("BuildWidgetFromCache",{id:e})).data}catch(e){console.error("BuildWidgetFromCache error sw: ",e),(0,o.handleServiceWorkerException)(e)}let t={data:null,mainId:0},n=yield o.ConceptsData.GetWidget(e);if(n.widgetId>0){let e="DESC",o=n.conceptIds,i=n.linkers,c=n.reverse,a=n.mainCompositionIds,l=n.countinfo,d=(0,r.w)(l);t={data:yield(0,s.e$)(i,o,a,c,d,e),mainId:n.mainId}}return t}))}function f(e){var t=arguments;return l(this,void 0,void 0,(function*(){o.Logger.logfunction("BuildWidgetFromIdForLatest",t);try{if(o.serviceWorker)return(yield(0,o.sendMessage)("BuildWidgetFromIdForLatest",{id:e})).data}catch(e){console.error("BuildWidgetFromIdForLatest error sw: ",e),(0,o.handleServiceWorkerException)(e)}let n={};if(u.has(e))return u.get(e)||n;const d=(()=>l(this,void 0,void 0,(function*(){try{let t,l=[],d=[],u=[],h=[],p="DESC",f=[],v={},y=(0,a.Xr)("application/json");try{let n=o.BaseUrl.getLatestWidgetData()+"?id="+e;t=yield fetch(n,{method:"GET",headers:y})}catch(n){t=yield(0,i.g)({method:"GET",headers:y},"?id="+e)}if(!t.ok)return(0,c.ry)(t),console.log("This is the BuildWidgetFromId error",t.status),[];v=yield t.json(),l=v.conceptIds,d=v.linkers,u=v.reverse,h=v.mainCompositionIds,f=v.countinfo;let g=(0,r.w)(f);return n=yield(0,s.e$)(d,l,h,u,g,p),{data:n,mainId:v.mainId}}catch(e){throw console.log("this is the error in the build widget",e),e}finally{u.delete(e)}})))();return u.set(e,d),d}))}function v(e,t){for(let n=0;n<e.length;n++)if(e[n].id==t)return e[n]}},4287:(e,t,n)=>{n.d(t,{w:()=>c});var o=n(4059),i=n(3130),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class c{constructor(){this.subscribers=[],this.mainConcept=0,this.compositionIds=[],this.conceptIds=[],this.internalConnections=[],this.reverse=[],this.linkers=[],this.newIds=[],this.dependency=[],this.isDataLoaded=!1,this.isUpdating=!1,this.fetched=!1,this.format=i.yv,this.eventHandlers={}}listenToEventType(e){if(this.eventHandlers[e])return;const t=t=>r(this,void 0,void 0,(function*(){if(this.isUpdating)console.log("rejected this",e);else{this.isUpdating=!0;let e=this;setTimeout((function(){return r(this,void 0,void 0,(function*(){let n=t;if(!e.compositionIds.includes(null==n?void 0:n.detail)){e.compositionIds.unshift(null==n?void 0:n.detail),e.listenToEvent(null==n?void 0:n.detail);let t=null==n?void 0:n.detail,i=yield o.ConnectionData.GetConnectionByOfTheConceptAndType(t,t);for(let t=0;t<i.length;t++)yield o.ConnectionData.GetConnection(i[t]).then((t=>{t.typeId==e.mainConcept?e.internalConnections.includes(t.id)||e.internalConnections.push(t.id):e.linkers.includes(t.id)||e.linkers.push(t.id),e.conceptIds.includes(t.toTheConceptId)||e.conceptIds.push(t.toTheConceptId),e.compositionIds.includes(t.ofTheConceptId)||e.compositionIds.push(t.ofTheConceptId)}))}e.isUpdating=!1,yield e.bind(),e.notify()}))}),200)}}));this.eventHandlers[e]=t,console.log("added listener",e),window.addEventListener(`${e}`,t)}listenToEvent(e){if(this.eventHandlers[e])return;const t=t=>r(this,void 0,void 0,(function*(){if(this.isUpdating)console.log("rejected this",e);else{this.isUpdating=!0;let t=this;setTimeout((function(){return r(this,void 0,void 0,(function*(){let n=yield o.ConnectionData.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<n.length;e++)yield o.ConnectionData.GetConnection(n[e]).then((e=>{e.typeId==t.mainConcept?t.internalConnections.includes(e.id)||t.internalConnections.push(e.id):t.linkers.includes(e.id)||t.linkers.push(e.id),t.conceptIds.includes(e.toTheConceptId)||t.conceptIds.push(e.toTheConceptId),t.compositionIds.includes(e.ofTheConceptId)||(t.compositionIds.push(e.ofTheConceptId),t.newIds.includes(e.ofTheConceptId)||t.newIds.push(e.ofTheConceptId))}));t.isUpdating=!1,yield t.bind(),t.notify()}))}),200)}}));this.eventHandlers[e]=t,window.addEventListener(`${e}`,t)}removeListenToEvent(e){const t=this.eventHandlers[e];t&&(window.removeEventListener(`${e}`,t),delete this.eventHandlers[e])}listenToEventConnectionType(e,t){window.addEventListener(`${e}`,(n=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let n=this;setTimeout((function(){return r(this,void 0,void 0,(function*(){let i=yield o.ConnectionData.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<i.length;e++)i.typeId==t&&(yield o.ConnectionData.GetConnection(i[e]).then((e=>{e.typeId==n.mainConcept?n.internalConnections.includes(e.id)||n.internalConnections.push(e.id):n.linkers.includes(e.id)||n.linkers.push(e.id),n.conceptIds.includes(e.toTheConceptId)||n.conceptIds.push(e.toTheConceptId),n.compositionIds.includes(e.ofTheConceptId)||n.compositionIds.push(e.ofTheConceptId)})));n.isUpdating=!1,yield n.bind(),n.notify()}))}),200)}}))}bind(){return r(this,void 0,void 0,(function*(){console.log("this is the old execute data")}))}run(){return r(this,void 0,void 0,(function*(){console.log("this is non subscriber data")}))}update(){return r(this,void 0,void 0,(function*(){this.isDataLoaded=!1,yield this.bind(),this.notify()}))}subscribe(e){return r(this,void 0,void 0,(function*(){return this.subscribers.push(e),console.log("again executing data"),yield this.bind(),e(this.data,this)}))}execute(){return r(this,void 0,void 0,(function*(){return yield this.run()}))}unsubscribe(e){return this.subscribers.filter((t=>t!=e)),this.subscribers.length}notify(){console.log("notifiers",this.subscribers),this.subscribers.map((e=>{console.log("notify"),e(this.data,this)}))}}},5328:(e,t,n)=>{n.d(t,{d:()=>l});var o=n(4059),i=n(3130),r=n(8939),c=n(4287),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class a extends c.w{constructor(e,t,n,o,i){super(),this.connections=[],this.data=[],this.mainConcept=e,this.linker=t,this.inpage=n,this.page=o,this.format=i}bind(){return s(this,void 0,void 0,(function*(){var e;if(!this.isDataLoaded){let i=yield(0,o.GetTheConcept)(this.mainConcept),r=(null===(e=i.type)||void 0===e?void 0:e.characterValue)+"_s_"+this.linker,c=yield(0,o.GetConceptByCharacterAndType)(r,16);if(c.id>0){let e=yield(0,o.GetConnectionOfTheConcept)(c.id,i.id,i.userId,this.inpage,this.page);this.connections=e;for(var t=[],n=0;n<this.connections.length;n++)t.push(this.connections[n].toTheConceptId),this.linkers.push(this.connections[n].id),this.listenToEvent(this.connections[n].toTheConceptId);yield(0,o.GetAllConnectionsOfCompositionBulk)(t)}this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()}))}build(){return s(this,void 0,void 0,(function*(){this.data=[],this.connections=yield(0,o.GetConnectionBulk)(this.linkers);for(var e=0;e<this.connections.length;e++){let t=this.connections[e].toTheConceptId,n=yield(0,o.GetTheConcept)(t);if(console.log("this is the format",this.format),this.format==i.yv){let e=yield(0,r.RW)(n.id);this.data.push(e)}else if(this.format==i.ZJ){let e=yield(0,r.kx)(n.id);this.data.push(e)}else if(this.format==i.iw){let e=yield(0,o.GetCompositionWithIdAndDateFromMemory)(n.id);this.data.push(e)}else{let e=yield(0,o.GetCompositionWithIdAndDateFromMemory)(n.id);this.data.push(e)}}return this.data}))}}function l(e,t,n,o,r=i.yv){return new a(e,t,n,o,r)}},4059:(e,t,n)=>{n.r(t),n.d(t,{ADMIN:()=>kn,ALLID:()=>In.BG,AccessTracker:()=>Be.J,AddGhostConcept:()=>Zt,Anomaly:()=>To,BaseUrl:()=>l.B,BinaryTree:()=>Ie.W,BuildWidgetFromId:()=>Do.Cp,BuilderStatefulWidget:()=>fo,Composition:()=>Tt,CompositionBinaryTree:()=>yt,CompositionNode:()=>ft,Concept:()=>zn.j,ConceptsData:()=>a.I,Connection:()=>W.N,ConnectionData:()=>xe.d,CountInfo:()=>Fo.y,CreateComposition:()=>D.A,CreateConnection:()=>Jt.d,CreateConnectionBetweenEntityLocal:()=>Ro,CreateConnectionBetweenTwoConcepts:()=>X,CreateConnectionBetweenTwoConceptsGeneral:()=>Z,CreateConnectionBetweenTwoConceptsLocal:()=>vn.h,CreateData:()=>ai,CreateDefaultConcept:()=>P.o,CreateDefaultLConcept:()=>$t.u,CreateSession:()=>Ot,CreateSessionVisit:()=>Wt,CreateTheCompositionLocal:()=>U.R,CreateTheCompositionWithCache:()=>It,CreateTheConnection:()=>ie.q,CreateTheConnectionGeneral:()=>$,CreateTheConnectionLocal:()=>Jt.F,DATAID:()=>In.y0,DATAIDDATE:()=>In.iw,DATAV2:()=>In.pU,DelayFunctionExecution:()=>wn,DeleteConceptById:()=>Le,DeleteConceptLocal:()=>gn,DeleteConnectionById:()=>J.m,DeleteConnectionByIdBulk:()=>J.E,DeleteConnectionByType:()=>No.$S,DeleteConnectionByTypeBulk:()=>No.L0,DeleteUser:()=>Se,DependencyObserver:()=>_n.w,FilterSearch:()=>Kn,FormatFromConnections:()=>Kt.vw,FormatFromConnectionsAltered:()=>Kt.y8,FreeschemaQuery:()=>Ao,FreeschemaQueryApi:()=>So,GetAllConnectionsOfComposition:()=>R.s,GetAllConnectionsOfCompositionBulk:()=>f.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>No.WC,GetComposition:()=>y.Nj,GetCompositionBulk:()=>Ve.dF,GetCompositionBulkWithDataId:()=>Ve.cw,GetCompositionFromConnectionsWithDataId:()=>Ve.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>Ve.km,GetCompositionFromConnectionsWithDataIdInObject:()=>Ve.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>Ve.Nt,GetCompositionFromConnectionsWithIndex:()=>Ve.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>Ve.hG,GetCompositionFromMemoryWithConnections:()=>y.JA,GetCompositionList:()=>T,GetCompositionListAll:()=>w,GetCompositionListAllWithId:()=>I,GetCompositionListListener:()=>Un,GetCompositionListLocal:()=>E,GetCompositionListLocalWithId:()=>G,GetCompositionListWithId:()=>k,GetCompositionListWithIdUpdated:()=>N,GetCompositionListener:()=>Gn,GetCompositionLocal:()=>_,GetCompositionLocalWithId:()=>b,GetCompositionWithAllIds:()=>y.Mb,GetCompositionWithCache:()=>xt,GetCompositionWithDataIdBulk:()=>Rt,GetCompositionWithDataIdWithCache:()=>Gt,GetCompositionWithId:()=>y.yz,GetCompositionWithIdAndDateFromMemory:()=>y.Ez,GetConceptBulk:()=>tt.r,GetConceptByCharacter:()=>g.A,GetConceptByCharacterAndCategoryLocal:()=>m.$I,GetConceptByCharacterAndType:()=>re.A,GetConnectionBetweenTwoConceptsLinker:()=>Tn,GetConnectionBulk:()=>nt.j,GetConnectionById:()=>Ue,GetConnectionDataPrefetch:()=>Ve.QL,GetConnectionOfTheConcept:()=>F,GetConnectionTypeForCount:()=>$n.V,GetLink:()=>se,GetLinkListListener:()=>Hn,GetLinkListener:()=>Fn.d,GetLinkRaw:()=>ae,GetLinkerConnectionFromConcepts:()=>ge,GetLinkerConnectionToConcepts:()=>me,GetRelation:()=>jt,GetRelationLocal:()=>rn,GetRelationRaw:()=>Ht,GetTheConcept:()=>z.A,GetTheConceptLocal:()=>en.f,GetUserGhostId:()=>Yt,JUSTDATA:()=>In.ZJ,LConcept:()=>qn,LConnection:()=>Qn,LISTNORMAL:()=>In.SL,LocalConceptsData:()=>v.v,LocalSyncData:()=>Zn.H,LocalTransaction:()=>go,Logger:()=>ro.V,LoginToBackend:()=>it,MakeTheInstanceConcept:()=>q.A,MakeTheInstanceConceptLocal:()=>K.k,MakeTheTimestamp:()=>Me,MakeTheTypeConceptApi:()=>pe,MakeTheTypeConceptLocal:()=>le.$,NORMAL:()=>In.yv,PRIVATE:()=>Nn,PUBLIC:()=>An,PatcherStructure:()=>Xn,Prototype:()=>fi,RAW:()=>In.XZ,RecursiveSearchApi:()=>He,RecursiveSearchApiNewRawFullLinker:()=>qe,RecursiveSearchApiRaw:()=>Je,RecursiveSearchApiRawFullLinker:()=>ze,RecursiveSearchApiWithInternalConnections:()=>$e,RecursiveSearchListener:()=>Pn,SchemaQuery:()=>xo,SchemaQueryListener:()=>Bo,SearchAllConcepts:()=>Lt,SearchLinkInternal:()=>pn,SearchLinkInternalAll:()=>fn,SearchLinkMultipleAll:()=>Kt.cf,SearchLinkMultipleAllObservable:()=>bn,SearchLinkMultipleApi:()=>c.j,SearchQuery:()=>Pe,SearchStructure:()=>eo,SearchWithLinker:()=>_t,SearchWithTypeAndLinker:()=>On.zl,SearchWithTypeAndLinkerApi:()=>Sn,Selector:()=>Wo,SessionData:()=>Yn,Signin:()=>lt,Signup:()=>ct,SignupEntity:()=>st,SplitStrings:()=>s.f,StatefulWidget:()=>ho,SyncData:()=>M.Y,TrashTheConcept:()=>be,UpdateComposition:()=>Nt,UpdateCompositionLocal:()=>tn.D,UserBinaryTree:()=>Qt,Validator:()=>Io,ViewInternalData:()=>ln,ViewInternalDataApi:()=>sn,WidgetTree:()=>Eo,convertFromConceptToLConcept:()=>dn.F4,convertFromLConceptToConcept:()=>dn.dp,convertWidgetTreeToWidget:()=>ni,convertWidgetTreeToWidgetWithWrapper:()=>oi,createFormFieldData:()=>ko,createPrototypeLocal:()=>gi,dispatchIdEvent:()=>Ei,getFromDatabaseWithType:()=>ne,getObjectsFromIndexDb:()=>oe,getUserDetails:()=>Oo.s,getWidgetBulkFromId:()=>ti,getWidgetFromId:()=>ei,handleServiceWorkerException:()=>Ri,hasActivatedSW:()=>Ai,init:()=>_i,orderTheConnections:()=>Jn.X,recursiveFetch:()=>y.zN,recursiveFetchNew:()=>mt,removeAllChildren:()=>Uo,renderLatestWidget:()=>Qo,renderPage:()=>qo,renderWidget:()=>Xo,searchLinkMultipleListener:()=>Bn,sendEmail:()=>ao,sendMessage:()=>bi,serviceWorker:()=>Ti,setHasActivatedSW:()=>Li,storeToDatabase:()=>te,subscribedListeners:()=>ki,unwrapContainers:()=>ci,updateAccessToken:()=>Si,uploadAttachment:()=>Ze,uploadFile:()=>et,uploadImage:()=>Ke,validDocumentFormats:()=>Ye,validImageFormats:()=>Xe});var o={};n.r(o),n.d(o,{ADMIN:()=>kn,ALLID:()=>In.BG,AccessTracker:()=>Be.J,AddGhostConcept:()=>Zt,Anomaly:()=>To,BaseUrl:()=>l.B,BinaryTree:()=>Ie.W,BuildWidgetFromId:()=>Do.Cp,BuilderStatefulWidget:()=>fo,Composition:()=>Tt,CompositionBinaryTree:()=>yt,CompositionNode:()=>ft,Concept:()=>zn.j,ConceptsData:()=>a.I,Connection:()=>W.N,ConnectionData:()=>xe.d,CountInfo:()=>Fo.y,CreateComposition:()=>D.A,CreateConnection:()=>Jt.d,CreateConnectionBetweenEntityLocal:()=>Ro,CreateConnectionBetweenTwoConcepts:()=>X,CreateConnectionBetweenTwoConceptsGeneral:()=>Z,CreateConnectionBetweenTwoConceptsLocal:()=>vn.h,CreateData:()=>ai,CreateDefaultConcept:()=>P.o,CreateDefaultLConcept:()=>$t.u,CreateSession:()=>Ot,CreateSessionVisit:()=>Wt,CreateTheCompositionLocal:()=>U.R,CreateTheCompositionWithCache:()=>It,CreateTheConnection:()=>ie.q,CreateTheConnectionGeneral:()=>$,CreateTheConnectionLocal:()=>Jt.F,DATAID:()=>In.y0,DATAIDDATE:()=>In.iw,DATAV2:()=>In.pU,DelayFunctionExecution:()=>wn,DeleteConceptById:()=>Le,DeleteConceptLocal:()=>gn,DeleteConnectionById:()=>J.m,DeleteConnectionByIdBulk:()=>J.E,DeleteConnectionByType:()=>No.$S,DeleteConnectionByTypeBulk:()=>No.L0,DeleteUser:()=>Se,DependencyObserver:()=>_n.w,FilterSearch:()=>Kn,FormatFromConnections:()=>Kt.vw,FormatFromConnectionsAltered:()=>Kt.y8,FreeschemaQuery:()=>Ao,FreeschemaQueryApi:()=>So,GetAllConnectionsOfComposition:()=>R.s,GetAllConnectionsOfCompositionBulk:()=>f.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>No.WC,GetComposition:()=>y.Nj,GetCompositionBulk:()=>Ve.dF,GetCompositionBulkWithDataId:()=>Ve.cw,GetCompositionFromConnectionsWithDataId:()=>Ve.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>Ve.km,GetCompositionFromConnectionsWithDataIdInObject:()=>Ve.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>Ve.Nt,GetCompositionFromConnectionsWithIndex:()=>Ve.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>Ve.hG,GetCompositionFromMemoryWithConnections:()=>y.JA,GetCompositionList:()=>T,GetCompositionListAll:()=>w,GetCompositionListAllWithId:()=>I,GetCompositionListListener:()=>Un,GetCompositionListLocal:()=>E,GetCompositionListLocalWithId:()=>G,GetCompositionListWithId:()=>k,GetCompositionListWithIdUpdated:()=>N,GetCompositionListener:()=>Gn,GetCompositionLocal:()=>_,GetCompositionLocalWithId:()=>b,GetCompositionWithAllIds:()=>y.Mb,GetCompositionWithCache:()=>xt,GetCompositionWithDataIdBulk:()=>Rt,GetCompositionWithDataIdWithCache:()=>Gt,GetCompositionWithId:()=>y.yz,GetCompositionWithIdAndDateFromMemory:()=>y.Ez,GetConceptBulk:()=>tt.r,GetConceptByCharacter:()=>g.A,GetConceptByCharacterAndCategoryLocal:()=>m.$I,GetConceptByCharacterAndType:()=>re.A,GetConnectionBetweenTwoConceptsLinker:()=>Tn,GetConnectionBulk:()=>nt.j,GetConnectionById:()=>Ue,GetConnectionDataPrefetch:()=>Ve.QL,GetConnectionOfTheConcept:()=>F,GetConnectionTypeForCount:()=>$n.V,GetLink:()=>se,GetLinkListListener:()=>Hn,GetLinkListener:()=>Fn.d,GetLinkRaw:()=>ae,GetLinkerConnectionFromConcepts:()=>ge,GetLinkerConnectionToConcepts:()=>me,GetRelation:()=>jt,GetRelationLocal:()=>rn,GetRelationRaw:()=>Ht,GetTheConcept:()=>z.A,GetTheConceptLocal:()=>en.f,GetUserGhostId:()=>Yt,JUSTDATA:()=>In.ZJ,LConcept:()=>qn,LConnection:()=>Qn,LISTNORMAL:()=>In.SL,LocalConceptsData:()=>v.v,LocalSyncData:()=>Zn.H,LocalTransaction:()=>go,Logger:()=>ro.V,LoginToBackend:()=>it,MakeTheInstanceConcept:()=>q.A,MakeTheInstanceConceptLocal:()=>K.k,MakeTheTimestamp:()=>Me,MakeTheTypeConceptApi:()=>pe,MakeTheTypeConceptLocal:()=>le.$,NORMAL:()=>In.yv,PRIVATE:()=>Nn,PUBLIC:()=>An,PatcherStructure:()=>Xn,Prototype:()=>fi,RAW:()=>In.XZ,RecursiveSearchApi:()=>He,RecursiveSearchApiNewRawFullLinker:()=>qe,RecursiveSearchApiRaw:()=>Je,RecursiveSearchApiRawFullLinker:()=>ze,RecursiveSearchApiWithInternalConnections:()=>$e,RecursiveSearchListener:()=>Pn,SchemaQuery:()=>xo,SchemaQueryListener:()=>Bo,SearchAllConcepts:()=>Lt,SearchLinkInternal:()=>pn,SearchLinkInternalAll:()=>fn,SearchLinkMultipleAll:()=>Kt.cf,SearchLinkMultipleAllObservable:()=>bn,SearchLinkMultipleApi:()=>c.j,SearchQuery:()=>Pe,SearchStructure:()=>eo,SearchWithLinker:()=>_t,SearchWithTypeAndLinker:()=>On.zl,SearchWithTypeAndLinkerApi:()=>Sn,Selector:()=>Wo,SessionData:()=>Yn,Signin:()=>lt,Signup:()=>ct,SignupEntity:()=>st,SplitStrings:()=>s.f,StatefulWidget:()=>ho,SyncData:()=>M.Y,TrashTheConcept:()=>be,UpdateComposition:()=>Nt,UpdateCompositionLocal:()=>tn.D,UserBinaryTree:()=>Qt,Validator:()=>Io,ViewInternalData:()=>ln,ViewInternalDataApi:()=>sn,WidgetTree:()=>Eo,convertFromConceptToLConcept:()=>dn.F4,convertFromLConceptToConcept:()=>dn.dp,convertWidgetTreeToWidget:()=>ni,convertWidgetTreeToWidgetWithWrapper:()=>oi,createFormFieldData:()=>ko,createPrototypeLocal:()=>gi,dispatchIdEvent:()=>Ei,getFromDatabaseWithType:()=>ne,getObjectsFromIndexDb:()=>oe,getUserDetails:()=>Oo.s,getWidgetBulkFromId:()=>ti,getWidgetFromId:()=>ei,handleServiceWorkerException:()=>Ri,hasActivatedSW:()=>Ai,init:()=>_i,orderTheConnections:()=>Jn.X,recursiveFetch:()=>y.zN,recursiveFetchNew:()=>mt,removeAllChildren:()=>Uo,renderLatestWidget:()=>Qo,renderPage:()=>qo,renderWidget:()=>Xo,searchLinkMultipleListener:()=>Bn,sendEmail:()=>ao,sendMessage:()=>bi,serviceWorker:()=>Ti,setHasActivatedSW:()=>Li,storeToDatabase:()=>te,subscribedListeners:()=>ki,unwrapContainers:()=>ci,updateAccessToken:()=>Si,uploadAttachment:()=>Ze,uploadFile:()=>et,uploadImage:()=>Ke,validDocumentFormats:()=>Ye,validImageFormats:()=>Xe});var i=n(5020),r=n(205),c=n(2832),s=n(6467),a=n(3026),l=n(9581),d=n(3518),u=n(1863),h=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function p(e,t){var n=arguments;return h(this,void 0,void 0,(function*(){const o=ro.V.logfunction("GetAllConceptsByType",n);try{var i=new URLSearchParams;i.append("type",e),i.append("user_id",t.toString());var r=(0,d.Xr)("application/x-www-form-urlencoded");const n=yield fetch(l.B.GetAllConceptsByTypeUrl(),{method:"POST",headers:r,body:i});if(n.ok){const e=yield n.json();for(var c=0;c<e.length;c++)a.I.AddConcept(e[c])}else console.log("GetAllConceptsByType error",n.status),(0,u.ry)(n)}catch(e){e instanceof Error?console.log("GetAllConceptsByType error message: ",e.message):console.log("GetAllConceptsByType unexpected error: ",e),(0,u.Mb)(e,l.B.GetAllConceptsByTypeUrl()),(0,u.ey)(o,"GetAllConceptsByType",e)}}))}var f=n(8642),v=n(9736),y=n(8939),g=n(2013),m=n(8064),C=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function T(e,t){var n=arguments;return C(this,arguments,void 0,(function*(e,t,o=10,i=1){const r=ro.V.logfunction("GetCompositionList",n)||{};if(Ti){r.serviceWorker=!0;try{const n=yield bi("GetCompositionList",{compositionName:e,userId:t,inpage:o,page:i});return ro.V.logUpdate(r),n.data}catch(e){console.error("GetCompositionList sw error: ",e),(0,u.ey)(r,"GetCompositionList",e),Ri(e)}}let c=yield(0,g.A)(e),s=[];if(c){yield p(e,t);let n=yield a.I.GetConceptsByTypeIdAndUser(c.id,t),r=o*(i-1),l=[];for(let e=r;e<r+o;e++)n[e]&&l.push(n[e].id);yield(0,f.Y)(l);for(let e=r;e<r+o;e++)if(n[e]){let t=yield(0,y.kx)(n[e].id);s.push(t)}}return ro.V.logUpdate(r),s}))}function w(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){let i=E(e,t),r=T(e,t),c=[];return Promise.race([i,r]).then((e=>{console.log("Promise result",e),c.push(...e)})).catch((e=>{console.log("error in handling",e)})),r.then((e=>{console.log("This is the second promise result",e),c.push(...e)})),c}))}function I(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){if(Ti)try{return(yield bi("GetCompositionListAllWithId",{compositionName:e,userId:t,inpage:n,page:o})).data}catch(e){console.error("GetCompositionListAllWithId sw error: ",e),Ri(e)}let i=yield(0,m.Ay)(e),r=yield(0,g.A)(e),c=[],s=[],l=[],d=[];0!=i.id&&(s=yield v.v.GetConceptsByTypeIdAndUser(i.id,t)),0!=r.id&&(yield p(e,t),d=yield a.I.GetConceptsByTypeIdAndUser(r.id,t),c=d);for(let e=0;e<s.length;e++){let t=!1;for(let n=0;n<d.length;n++)s[e].ghostId==d[n].ghostId&&(t=!0);t||l.push(s[e])}console.log("This is the all list",l);let u=[];return u=yield function(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){let i=[],r=n*(o-1),c=[],s=t.length;for(let t=r;t<r+n-s;t++)e[t]&&c.push(e[t].id);for(let e=0;e<t.length;e++){let n=yield b(t[e].id);i.push(n)}yield(0,f.Y)(c);for(let t=r;t<r+n-s;t++)if(e[t]){let n=yield(0,y.RW)(e[t].id);i.push(n)}return i}))}(c,l,n,o),u}))}function k(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){if(Ti)try{return(yield bi("GetCompositionListWithId",{compositionName:e,userId:t,inpage:n,page:o})).data}catch(e){console.error("GetCompositionListWithId sw error: ",e),Ri(e)}let i=yield(0,g.A)(e),r=[];if(i){yield p(e,t);let c=yield a.I.GetConceptsByTypeIdAndUser(i.id,t),s=n*(o-1),l=[];for(let e=s;e<s+n;e++)c[e]&&l.push(c[e].id);yield(0,f.Y)(l);for(let e=s;e<s+n;e++)if(c[e]){let t=yield(0,y.RW)(c[e].id);r.push(t)}}return r}))}function N(e,t){return C(this,arguments,void 0,(function*(e,t,n=10,o=1){let i=yield(0,g.w)(e),r=[];if(i){yield p(e,t);let c=yield a.I.GetConceptsByTypeIdAndUser(i.id,t),s=n*(o-1),l=[];for(let e=s;e<s+n;e++)c[e]&&l.push(c[e].id);yield(0,f.Y)(l);for(let e=s;e<s+n;e++)if(c[e]){let t=yield(0,y.RW)(c[e].id);r.push(t)}}return r}))}var A=n(4864),L=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},S=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function _(e){return S(this,void 0,void 0,(function*(){var t,n;try{if(Ti)try{return(yield bi("GetCompositionLocal",{id:e})).data}catch(e){console.error("GetCompositionLocal error sw: ",e),Ri(e)}let o=[],i={};o=yield A.G.GetConnectionsOfCompositionLocal(e);let r=[];for(let e=0;e<o.length;e++)r.includes(o[e].ofTheConceptId)||r.push(o[e].ofTheConceptId);let c=yield v.v.GetConcept(e);if(0==c.id){let t=yield function(e){var t=arguments;return L(this,void 0,void 0,(function*(){const n=ro.V.logfunction("TranslateLocalToReal",t);let o=(0,P.o)();try{var i=(0,d.ab)("application/x-www-form-urlencoded");const t=yield fetch(l.B.GetRealConceptById(),{method:"POST",headers:i,body:`id=${e}`});if(t.ok)return o=yield t.json(),o.id>0&&a.I.AddConcept(o),o;console.log("Error in Getting Translating concept Error",t.status),(0,u.ry)(t),ro.V.logUpdate(n)}catch(e){e instanceof Error?console.log("Error in Getting Translating concept error message: ",e):console.log("Error in Getting Translating concept unexpected error: ",e),(0,u.Mb)(e,l.B.GetRealConceptById()),(0,u.ey)(n,"TranslateLocalToReal",e)}return o}))}(e);if(t.id>0)return yield(0,y.Nj)(t.id)}let s=yield B(e,o,r);return i[null!==(n=null===(t=null==c?void 0:c.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:"top"]=s,i}catch(e){throw e}}))}function b(e){return S(this,void 0,void 0,(function*(){var t,n;try{if(Ti)try{return(yield bi("GetCompositionLocalWithId",{id:e})).data}catch(e){console.error("GetCompositionLocalWithId error sw: ",e),Ri(e)}let o=[],i={},r={};o=yield A.G.GetConnectionsOfCompositionLocal(e);let c=[];for(let e=0;e<o.length;e++)c.includes(o[e].ofTheConceptId)||c.push(o[e].ofTheConceptId);let s=yield v.v.GetConcept(e);if(0!=s.id){let r=yield B(e,o,c);i[null!==(n=null===(t=null==s?void 0:s.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:"top"]=r}return r.data=i,r.id=e,r}catch(e){throw e}}))}function B(e,t,n){return S(this,arguments,void 0,(function*(e,t,n,o=[]){var i,r,c;let s={},a=[],l=yield v.v.GetConcept(e);if(0!=l.id&&null==l.type){let e=l.typeId,t=yield v.v.GetConcept(e);l.type=t}if(null===(i=null==l?void 0:l.type)||void 0===i?void 0:i.characterValue,!n.includes(e))return null==l?void 0:l.characterValue;if(o.includes(e))return"";o.push(e);for(let o=0;o<t.length;o++)if(t[o].ofTheConceptId==e){let e=t[o].toTheConceptId,i=yield v.v.GetConcept(e);if(0!=i.id&&null==(null==i?void 0:i.type)){let e=i.typeId,t=yield v.v.GetConcept(e);i.type=t}let l="the_",d=(null!==(c=null===(r=null==i?void 0:i.type)||void 0===r?void 0:r.characterValue)&&void 0!==c?c:"top").replace(l,"");if(isNaN(Number(d))){if(d){const o=yield B(e,t,n);s[d]=o}}else{const o=yield B(e,t,n);a[d]=o,s=a}}return s}))}var x=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function E(e,t){return x(this,void 0,void 0,(function*(){if(Ti)try{return(yield bi("GetCompositionListLocal",{compositionName:e,userId:t})).data}catch(e){console.error("GetCompositionListLocal error sw: ",e),Ri(e)}try{let n=yield(0,m.Ay)(e),o=[];if(0!=n.id){let e=yield v.v.GetConceptsByTypeIdAndUser(n.id,t);for(let t=0;t<e.length;t++){let n=yield _(e[t].id);o.push(n)}}return o}catch(e){throw e}}))}function G(e,t){return x(this,void 0,void 0,(function*(){if(Ti)try{return(yield bi("GetCompositionListLocalWithId",{compositionName:e,userId:t})).data}catch(e){console.error("GetCompositionListLocalWithId error sw: ",e),Ri(e)}try{let n=yield(0,m.Ay)(e),o=[];if(0!=n.id){let e=yield v.v.GetConceptsByTypeIdAndUser(n.id,t);for(let t=0;t<e.length;t++){let n=yield b(e[t].id);o.push(n)}}return o}catch(e){throw e}}))}var R=n(2),D=n(1218),U=n(999),O=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function F(e,t,n){var o=arguments;return O(this,arguments,void 0,(function*(e,t,n,i=10,r=1){const c=ro.V.logfunction("GetConnectionOfTheConcept",o)||{};let s=[];try{if(Ti){c.serviceWorker=!0;try{const o=yield bi("GetConnectionOfTheConcept",{typeId:e,ofTheConceptId:t,userId:n,inpage:i,page:r});return ro.V.logUpdate(c),o.data}catch(e){console.error("GetConnectionOfTheConcept sw error: ",e),(0,u.ey)(c,"GetConnectionOfTheConcept",e),Ri(e)}}let o=new URLSearchParams;o.append("typeId",`${e}`),o.append("ofTheConceptId",`${t}`),o.append("userId",`${n}`),o.append("inpage",`${i}`),o.append("page",`${r}`);let a=(0,d.Xr)("application/x-www-form-urlencoded");const h=yield fetch(l.B.GetAllConnectionsOfConceptUrl(),{method:"POST",headers:a,body:o});return h.ok?s=yield h.json():((0,u.ey)(c,"GetConnectionOfTheConcept",h.status),(0,u.ry)(h),console.log("Get connection of concept error",h.status)),ro.V.logUpdate(c),s}catch(e){e instanceof Error?console.log("Get connection of concept  error message: ",e.message):console.log("Get connection of concept unexpected error: ",e),(0,u.Mb)(e,l.B.GetAllConnectionsOfConceptUrl()),(0,u.ey)(c,"GetConnectionOfTheConcept",e)}}))}var W=n(2155),M=n(442),P=n(7282),V=n(5976),j=n(7273),H=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function $(e,t,n,o){return H(this,arguments,void 0,(function*(e,t,n,o,i=1,r=4){if(e>0&&n>0){var c=t,s=yield V.p.getId(),a=new W.N(s,e,n,c,o,i,r);return e==n?(a.ofTheConceptId=0,a.toTheConceptId=1,a):(a.toUpdate=!0,a.isTemp=!1,M.Y.AddConnection(a),a)}throw new j.z("cannot create connection because id are negative ",!1,400,"")}))}var J=n(4818),z=n(7876),q=n(8407),Q=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function X(e,t,n){return Q(this,arguments,void 0,(function*(e,t,n,o=!1,i=!1){var r,c;if(Ti)try{return(yield bi("CreateConnectionBetweenTwoConcepts",{ofTheConcept:e,toTheConcept:t,linker:n,both:o,count:i})).data}catch(e){console.error("CreateConnectionBetweenTwoConcepts sw error: ",e),Ri(e)}let s=e.userId;if(o){let o=n+"_by",c=(null===(r=t.type)||void 0===r?void 0:r.characterValue)+"_s_"+o;i&&(yield Y(o,t,s));let a=yield(0,q.A)("connection",c,!1,999,999,999),l=new W.N(0,t.id,e.id,s,a.id,1e3,4);M.Y.AddConnection(l)}let a=n+"_s",l=(null===(c=e.type)||void 0===c?void 0:c.characterValue)+"_s_"+a;i&&(yield Y(a,e,s));let d=yield(0,q.A)("connection",l,!1,999,999,999),u=new W.N(0,e.id,t.id,s,d.id,1e3,4);return M.Y.AddConnection(u),u}))}function Y(e,t){return Q(this,arguments,void 0,(function*(e,t,n=null){var o;let i=t,r=null!=n?n:t.userId,c=e+"_count",s=(null===(o=t.type)||void 0===o?void 0:o.characterValue)+"_s_"+c,a=yield(0,q.A)("connection",s,!1,r,4,999),l=yield F(a.id,t.id,r,10,1),d=[],u=(0,P.o)();for(let e=0;e<l.length;e++){let t=yield(0,z.A)(l[e].toTheConceptId);d.push(t)}if(d.length<1)u=yield(0,q.A)("count","1",!1,r,4,999);else{let e=d[0],t=0;try{t=Number(e.characterValue)}catch(e){t=0}t+=1,u=yield(0,q.A)("count",t.toString(),!1,r,4,999);for(let e=0;e<l.length;e++)(0,J.m)(l[e].id)}let h=new W.N(0,i.id,u.id,i.userId,a.id,1e3,4);yield M.Y.AddConnection(h)}))}function Z(e,t,n){return Q(this,arguments,void 0,(function*(e,t,n,o=!1,i=!1){var r,c;let s=e.userId;if(o){let o=n+"_by",c=(null===(r=t.type)||void 0===r?void 0:r.characterValue)+"_s_"+o;i&&(yield Y(o,t,s));let a=yield(0,q.A)("connection",c,!1,999,999,999),l=new W.N(0,t.id,e.id,s,a.id,1e3,4);M.Y.AddConnection(l)}let a=n+"_s",l=(null===(c=e.type)||void 0===c?void 0:c.characterValue)+"_s_"+a;i&&(yield Y(a,e,s));let d=yield(0,q.A)("connection",l,!1,999,999,999);return yield $(e.id,e.userId,t.id,d.id,1e3,4)}))}var K=n(5868),ee=(n(3655),function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))});function te(e,t){const n=ro.V.logfunction("storeToDatabase",[e,"noindexdb"]);ro.V.logUpdate(n)}function ne(e,t,n){return ee(this,void 0,void 0,(function*(){const t=ro.V.logfunction("getFromDatabaseWithType",[e,"noindexdb"]);ro.V.logUpdate(t)}))}function oe(e){return ee(this,void 0,void 0,(function*(){const t=ro.V.logfunction("getObjectsFromIndexDb",[e,"noindexdb"]);ro.V.logUpdate(t)}))}var ie=n(1666),re=n(4402),ce=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function se(e,t){var n=arguments;return ce(this,arguments,void 0,(function*(e,t,o=10,i=1){var r;const c=ro.V.logfunction("GetLink",n)||{};if(Ti){c.serviceWorker=!0;try{const n=yield bi("GetLink",{id:e,linker:t,inpage:o,page:i});return ro.V.logUpdate(c),n.data}catch(e){console.error("GetLink sw error: ",e),(0,u.ey)(c,"GetLink",e),Ri(e)}}let s=[],a=yield(0,z.A)(e),l=(null===(r=a.type)||void 0===r?void 0:r.characterValue)+"_s_"+t,d=yield(0,re.A)(l,16);if(d.id>0){let e=yield F(d.id,a.id,a.userId,o,i),t=[];for(let n=0;n<e.length;n++)t.push(e[n].toTheConceptId);yield(0,f.Y)(t);for(let t=0;t<e.length;t++){let n=e[t].toTheConceptId,o=yield(0,z.A)(n),i=yield(0,y.Ez)(o.id);s.push(i)}}return ro.V.logUpdate(c),s}))}function ae(e,t){var n=arguments;return ce(this,arguments,void 0,(function*(e,t,o=10,i=1){var r;const c=ro.V.logfunction("GetLinkRaw",n);let s=[],a=yield(0,z.A)(e),l=(null===(r=a.type)||void 0===r?void 0:r.characterValue)+"_s_"+t,d=yield(0,re.A)(l,16);if(d.id>0){let e=yield F(d.id,a.id,a.userId,o,i),t=[];for(let n=0;n<e.length;n++)t.push(e[n].toTheConceptId);for(let t=0;t<e.length;t++){let n=e[t].toTheConceptId,o=yield(0,z.A)(n);s.push(o)}}return ro.V.logUpdate(c),s}))}var le=n(8357),de=n(1708),ue=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const he=new Map;function pe(e,t){var n=arguments;return ue(this,void 0,void 0,(function*(){const t=ro.V.logfunction("MakeTheTypeConceptApi",n);let o=(0,P.o)();if(he.has(e))return he.get(e)||o;const i=(()=>ue(this,void 0,void 0,(function*(){try{if(o=yield(0,de.Az)(e),0==o.id||4==o.typeId){let n=(0,d.Xr)("application/x-www-form-urlencoded");const i=yield fetch(l.B.MakeTheTypeConceptUrl(),{method:"POST",headers:n,body:`type=${e}`});if(!i.ok)throw(0,u.ry)(i),new Error(`Error! status: ${i.status}`);let r=yield i.json();o=r,ro.V.logUpdate(t)}}catch(e){e instanceof Error?console.log("Make The Type Concept Api error : ",e.message):console.log("Make The Type Concept Api error : ",e),(0,u.Mb)(e,l.B.MakeTheTypeConceptUrl()),(0,u.ey)(t,"MakeTheTypeConceptApi",e)}finally{he.delete(e)}return o})))();return he.set(e,i),i}))}var fe=n(8675),ve=n(6058),ye=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function ge(e){var t=arguments;return ye(this,void 0,void 0,(function*(){const n=ro.V.logfunction("GetLinkerConnectionFromConcepts",t);let o=yield(0,fe.l)(e);for(let e=0;e<o.length;e++){let t=o[e],n=t.typeId,i=yield(0,z.A)(n);t.type=i}return ro.V.logUpdate(n),o}))}function me(e){var t=arguments;return ye(this,void 0,void 0,(function*(){const n=ro.V.logfunction("GetLinkerConnectionToConcepts",t);let o=yield(0,ve.W)(e);for(let e=0;e<o.length;e++){let t=o[e],n=t.typeId,i=yield(0,z.A)(n);t.type=i}return ro.V.logUpdate(n),o}))}var Ce=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},Te=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},we=n(6963),Ie=n(2202),ke=n(5457),Ne=n(991),Ae=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Le(e){var t=arguments;return Ae(this,void 0,void 0,(function*(){const n=ro.V.logfunction("DeleteConceptById",t);if(Ti)try{return(yield bi("DeleteConceptById",{id:e})).data}catch(e){console.error("DeleteConceptById sw error: ",e),Ri(e)}if(e>0){var o=yield a.I.GetConcept(e);if(o.id>0){var i=o.typeId,r=o.characterValue;yield ke.c.removeTypeConcept(i,e),yield we.f.removeNodeByCharacter(r,e),yield function(e){var t=arguments;return Te(this,void 0,void 0,(function*(){let n=!1;const o=ro.V.logfunction("DeleteTheConcept",t);try{const t=new FormData;t.append("id",e.toString());let i=(0,d.BZ)();const r=yield fetch(l.B.DeleteConceptUrl(),{method:"POST",headers:i,body:t});r.ok?n=(yield r.json()).success:(console.log("Delete concept error",r.status),(0,u.ry)(r)),n&&a.I.AddNpc(e),ro.V.logUpdate(o)}catch(e){e instanceof Error?console.log("Delete concept error message: ",e.message):console.log("Delete concept unexpected error: ",e),(0,u.Mb)(e,l.B.DeleteConceptUrl()),(0,u.ey)(o,"DeleteTheConcept",e)}return n}))}(e),yield Ie.W.removeNodeFromTree(e),yield Ne.H.removeNodeFromTree(e)}}else v.v.RemoveConceptById(e);ro.V.logUpdate(n)}))}function Se(e){return Ae(this,void 0,void 0,(function*(){if(Ti)try{return(yield bi("DeleteUser",{id:e})).data}catch(e){console.error("DeleteUser sw error: ",e),Ri(e)}e>0?function(e){var t=arguments;Ce(this,void 0,void 0,(function*(){const n=ro.V.logfunction("DeleteUserInBackend",t);try{var o=(0,d.ab)("application/json","");let t=l.B.DeleteUserUrl();t=t+"?conceptId="+e+"&apiKey=freeschema";const i=yield fetch(t,{method:"POST",headers:o});if(i.ok){let e=yield i.json(),t=Number(e.data);return console.log("this is the delete email concept",t),Le(t),ro.V.logUpdate(n),t}throw(0,u.ry)(i),new Error(`Delete composition Error! status: ${i.status}`)}catch(e){e instanceof Error?console.log("Delete composition error message: ",e.message):console.log("Delete composition unexpected error: ",e),(0,u.Mb)(e,l.B.DeleteConceptUrl()),(0,u.ey)(n,"DeleteUserInBackend",e)}}))}(e):v.v.RemoveConceptById(e)}))}var _e=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function be(e,t){return _e(this,void 0,void 0,(function*(){try{const n=new Headers;n.append("Authorization","Bearer "+t);const o=new FormData;o.append("id",e.toString());const i=yield fetch(l.B.DeleteConceptUrl(),{method:"POST",body:o,headers:n});if(!i.ok)throw(0,u.ry)(i),new Error(`Delete composition Error! status: ${i.status}`)}catch(e){e instanceof Error?console.log("Delete composition error message: ",e.message):console.log("Delete composition unexpected error: ",e),(0,u.Mb)(e,l.B.DeleteConceptUrl())}}))}var Be=n(1735),xe=n(8286),Ee=n(1596),Ge=n(3278),Re=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};var De=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ue(e){var t=arguments;return De(this,void 0,void 0,(function*(){const n=ro.V.logfunction("GetConnectionById",t);if(console.log("AccessTracker activation status from GetConnectionById"),!0===Be.J.activateStatus)try{Be.J.incrementConnection(e)}catch(e){console.error("Error adding connection in access tracker"),ro.V.log("ERROR","Error Adding Connection")}if(Ti)try{return(yield bi("GetConnectionById",{id:e})).data}catch(e){console.error("GetConnectionById sw error: ",e),Ri(e)}let o=yield xe.d.GetConnection(e);return null!=o&&0!=o.id||null==e||null==e||(o=yield function(e){var t=arguments;return Re(this,void 0,void 0,(function*(){const n=ro.V.logfunction("GetConnection",t);let o=yield xe.d.GetConnection(e);try{if(0!=o.id)return o;{const t=new FormData;t.append("id",e.toString());const i={method:"POST",headers:{Authorization:"Bearer "+Ge.b.BearerAccessToken},body:t};let r;try{r=yield fetch(l.B.GetConnectionUrl(),i)}catch(e){r=yield(0,Ee.g)(i,"/api/get-connection-by-id")}return yield function(e,t){return Re(this,void 0,void 0,(function*(){e.ok?(t=yield e.json(),xe.d.AddConnection(t)):((0,u.ry)(e),console.log("Get Connection Error",e.status))}))}(r,o),ro.V.logUpdate(n),o}}catch(e){e instanceof Error?console.log("Get Connection error message: ",e.message):console.log("Get Connection unexpected error: ",e),(0,u.Mb)(e,l.B.GetConnectionUrl()),(0,u.ey)(n,"GetConnection",e)}}))}(e)),ro.V.logUpdate(n),o}))}var Oe=n(2212),Fe=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},We=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Me(e,t,n){return We(this,arguments,void 0,(function*(e,t,n,o=4,i=999){const r=ro.V.logfunction("MakeTheTimestamp")||{};if(Ti){r.serviceWorker=!0;try{const c=yield bi("MakeTheTimestamp",{type:e,referent:t,userId:n,accessId:o,sessionInformationId:i});return ro.V.logUpdate(r),c.data}catch(e){console.error("MakeTheTimestamp sw error: ",e),(0,u.ey)(r,"MakeTheTimestamp",e),Ri(e)}}let c,s="",a=e.startsWith("the_"),l=(0,P.o)();s=a?e:"the_"+e,l=yield pe(s,n);let d=yield function(e,t,n,o,i,r,c){return Fe(this,void 0,void 0,(function*(){let n=yield(0,re.A)(e,o),i=n;return 0==i.id&&(n=yield(0,Oe.Ay)(e,t,4,o,0,r,c),i=n),i}))}(t,n,0,l.id,0,o,s);return c=d,ro.V.logUpdate(r),c}))}class Pe{constructor(){this.composition=0,this.type="",this.linker="",this.inpage=10,this.page=1,this.listLinkers=[],this.fullLinkers=[],this.textSearch="",this.logic="or",this.reverse=!1,this.doFilter=!1,this.filterSearches=[],this.selectors=[],this.ofCompositions=[]}}var Ve=n(6687),je=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function He(){var e=arguments;return je(this,arguments,void 0,(function*(t=0,n=[],o="",i=[]){const r=ro.V.logfunction("RecursiveSearchApi",e)||{};let c=[];try{if(Ti){r.serviceWorker=!0;try{const e=yield bi("RecursiveSearchApi",{composition:t,listLinkers:n,textSearch:o,fullLinkers:i});return ro.V.logUpdate(r),e.data}catch(e){console.error("RecursiveSearchApi sw error: ",e),(0,u.ey)(r,"RecursiveSearchApi",e),Ri(e)}}let e=new Pe;e.composition=t,e.listLinkers=n,e.fullLinkers=i,e.textSearch=o;let s=JSON.stringify(e),a=(0,d.Xr)();const h=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:a,body:s});if(h.ok){const e=yield h.json();let t=e.compositionIds,n=e.internalConnections;e.externalConnections,c=yield(0,Ve.p8)(t,n)}else console.log("recursive search error ",h.status),(0,u.ey)(r,"RecursiveSearchApi",h.status),(0,u.ry)(h);ro.V.logUpdate(r)}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.ey)(r,"RecursiveSearchApi",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl())}return c}))}function $e(){var e=arguments;return je(this,arguments,void 0,(function*(t=0,n=[],o=""){const i=ro.V.logfunction("RecursiveSearchApiWithInternalConnections",e)||{};let r=[];try{if(Ti){i.serviceWorker=!0;try{const e=yield bi("RecursiveSearchApiWithInternalConnections",{composition:t,listLinkers:n,textSearch:o});return ro.V.logUpdate(i),e.data}catch(e){console.error("RecursiveSearchApiWithInternalConnections sw error: ",e),(0,u.ey)(i,"RecursiveSearchApiWithInternalConnections",e),Ri(e)}}let e=new Pe;e.composition=t,e.listLinkers=n,e.textSearch=o;let c=JSON.stringify(e),s=(0,d.Xr)();const a=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:s,body:c});if(a.ok){const e=yield a.json();let t=e.compositionIds,n=e.internalConnections;e.externalConnections,r=yield(0,Ve.km)(t,n),ro.V.logUpdate(i)}else console.log("recursive search error ",a.status),(0,u.ey)(i,"GetCompositionConnectionsBetweenTwoConcepts",a.status),(0,u.ry)(a)}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.ey)(i,"GetCompositionConnectionsBetweenTwoConcepts",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl())}return r}))}function Je(){var e=arguments;return je(this,arguments,void 0,(function*(t=0,n=[],o="",i=[]){const r=ro.V.logfunction("RecursiveSearchApiRaw",e)||{};try{if(Ti){r.serviceWorker=!0;try{const e=yield bi("RecursiveSearchApiRaw",{composition:t,listLinkers:n,textSearch:o,fullLinkers:i});return ro.V.logUpdate(r),e.data}catch(e){console.error("RecursiveSearchApiRaw sw error: ",e),(0,u.ey)(r,"RecursiveSearchApiRaw",e),Ri(e)}}let e=new Pe;e.composition=t,e.listLinkers=n,e.textSearch=o,e.fullLinkers=i;let c=JSON.stringify(e),s=(0,d.Xr)();const a=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:s,body:c});if(a.ok){const e=yield a.json();return e.compositionIds,e.internalConnections,e.externalConnections,ro.V.logUpdate(r),e}return console.log("recursive search error ",a.status),(0,u.ey)(r,"RecursiveSearchApiRaw",a.status),(0,u.ry)(a),ro.V.logUpdate(r),[]}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.ey)(r,"RecursiveSearchApiRaw",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl())}}))}function ze(){var e=arguments;return je(this,arguments,void 0,(function*(t=0,n=[],o=""){const i=ro.V.logfunction("RecursiveSearchApiRawFullLinker",e)||{};try{if(Ti){i.serviceWorker=!0;try{const e=yield bi("RecursiveSearchApiRawFullLinker",{composition:t,fullLinkers:n,textSearch:o});return ro.V.logUpdate(i),e.data}catch(e){console.error("RecursiveSearchApiRawFullLinker sw error: ",e),(0,u.ey)(i,"RecursiveSearchApiRawFullLinker",e),Ri(e)}}let e=new Pe;e.composition=t,e.fullLinkers=n,e.textSearch=o;let r=JSON.stringify(e),c=(0,d.Xr)();const s=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:c,body:r});if(s.ok){const e=yield s.json();return e.compositionIds,e.internalConnections,e.externalConnections,ro.V.logUpdate(i),e}return console.log("recursive search error ",s.status),(0,u.ey)(i,"RecursiveSearchApiRawFullLinker",s.status),(0,u.ry)(s),ro.V.logUpdate(i),[]}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl()),(0,u.ey)(i,"RecursiveSearchApiRawFullLinker",e)}}))}function qe(){var e=arguments;return je(this,arguments,void 0,(function*(t=0,n=[],o=""){const i=ro.V.logfunction("RecursiveSearchApiRawFullLinker",e)||{};try{if(Ti)try{i.serviceWorker=!0;const e=yield bi("RecursiveSearchApiNewRawFullLinker",{composition:t,fullLinkers:n,textSearch:o});return ro.V.logUpdate(i),e.data}catch(e){console.error("RecursiveSearchApiNewRawFullLinker sw error: ",e),(0,u.ey)(i,"RecursiveSearchApiNewRawFullLinker",e),Ri(e)}let e=new Pe;e.composition=t,e.fullLinkers=n,e.textSearch=o;let r=JSON.stringify(e),c=(0,d.Xr)();const s=yield fetch(l.B.RecursiveSearchUrl(),{method:"POST",headers:c,body:r});if(s.ok){const e=yield s.json();return e.compositionIds,e.internalConnections,e.externalConnections,ro.V.logUpdate(i),e}return console.log("recursive search error ",s.status),(0,u.ey)(i,"RecursiveSearchApiNewRawFullLinker",s.status),(0,u.ry)(s),ro.V.logUpdate(i),[]}catch(e){e instanceof Error?console.log("recursive search error message: ",e.message):console.log("recursive search unexpected error: ",e),(0,u.Mb)(e,l.B.RecursiveSearchUrl()),(0,u.ey)(i,"RecursiveSearchApiNewRawFullLinker",e)}}))}var Qe=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const Xe=["image/jpeg","image/jpg","image/png","image/webp"],Ye=["application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint","text/plain","application/pdf"];function Ze(e,t){return Qe(this,void 0,void 0,(function*(){const n=ro.V.logfunction("uploadAttachment");try{console.log("File Type",e.type);const o=new FormData;let i;if(Ye.includes(e.type))o.append("file",e,e.name),i=yield et(o,t);else{if(!Xe.includes(e.type))return{message:"Invalid File Format",success:!1};o.append("image",e,e.name),i=yield Ke(o,t)}return(null==i?void 0:i.data)?(ro.V.logUpdate(n),{message:"Upload Success",success:!0,url:i.data}):{message:"File Upload Failed",success:!1}}catch(e){throw console.error(e),(0,u.ey)(n,"uploadAttachment",e),e}}))}function Ke(e){return Qe(this,arguments,void 0,(function*(e,t=""){const n=ro.V.logfunction("uploadImage");try{const o=yield fetch(l.B.uploadImageUrl(),{method:"POST",body:e,headers:{Authorization:`Bearer ${t}`}});if(!o.ok){const e=o.headers.get("content-type");e&&e.includes("text/plain")&&console.info(null==o?void 0:o.text());const t=yield null==o?void 0:o.text();return console.error(`${o.status} ${t}`),ro.V.logUpdate(n),null}return yield o.json()}catch(e){return console.error(e),(0,u.ey)(n,"uploadImage",e),null}}))}function et(e){return Qe(this,arguments,void 0,(function*(e,t=""){const n=ro.V.logfunction("uploadFile");try{const o=yield fetch(l.B.uploadFileUrl(),{method:"POST",body:e,headers:{Authorization:`Bearer ${t}`}});if(!o.ok){const e=o.headers.get("content-type");e&&e.includes("text/plain")&&console.info(o.text());const t=yield o.text();return console.error(`${o.status} ${t}`),null}return ro.V.logUpdate(n),yield o.json()}catch(e){return console.error(e),(0,u.ey)(n,"uploadFile",e),null}}))}var tt=n(1239),nt=n(7467),ot=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function it(e,t){var n=arguments;return ot(this,void 0,void 0,(function*(){const o=ro.V.logfunction("LoginToBackend",n);try{let n={email:e,password:t},i=new Headers;i.append("Content-Type","application/json");let r=JSON.stringify(n);const c=yield fetch(l.B.LoginUrl(),{method:"POST",headers:i,body:r}),s=yield c.json();if(c.ok)return Ge.b.BearerAccessToken=s.data.token,ro.V.logUpdate(o),s;console.log("Login tsccs error message: ",c.status),(0,u.ER)(c,s)}catch(e){e instanceof Error?console.log("Login tsccs error message: ",e.message):console.log(" Login tsccs  unexpected error: ",e),(0,u.Mb)(e,l.B.LoginUrl()),(0,u.ey)(o,"LoginToBackend",e)}}))}var rt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function ct(e){return rt(this,void 0,void 0,(function*(){const t=yield function(){return rt(this,arguments,void 0,(function*(e="",t={}){let n={message:"success",status:!1,statusCode:200,data:"cannot signup"};try{const o=yield fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t)}),i=yield o.json();return o.ok?n={message:"success",status:!0,statusCode:200,data:i}:(0,u.ER)(o,i),n}catch(t){console.log("Signup Error: ",t),(0,u.Mb)(t,e)}}))}(l.B.SignupUrl(),e);return t}))}function st(e){return rt(this,void 0,void 0,(function*(){const t=l.B.NODE_URL,n=yield fetch(`${t}/api/v1/entity/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.ok)return n.json();if(404===n.status)throw new Error("404, Not found");if(500===n.status)throw new Error("500, internal server error");throw new Error(n.status)}))}var at=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function lt(e){return at(this,void 0,void 0,(function*(){const t=JSON.stringify({email:e.email,password:e.password});let n={message:"success",status:!1,statusCode:200,data:""};const o=new Headers;o.append("Content-Type","application/json");const i=l.B.LoginUrl();try{const e=yield fetch(i,{method:"POST",headers:o,body:t,redirect:"follow"}),r=yield e.json();return e.ok?n={message:"success",status:!0,statusCode:200,data:null==r?void 0:r.data}:(0,u.ER)(e,r),n}catch(e){console.log("Sign in api error",e),(0,u.Mb)(e,i)}}))}var dt=n(9934),ut=n(4485);function ht(e=[],t){Array.isArray(e)&&e.splice(e.findIndex((function(e){return e.id===t.id})),1)}function pt(e=[],t){Array.isArray(e)&&e.splice(e.findIndex((function(e){return e.id===t.id})),1)}class ft{constructor(e,t,n,o){this.expiryTime=new Date(Date.now()+6e5),this.height=1,this.key=e,this.value=t,this.leftNode=n,this.rightNode=o}isValid(){const e=new Date(Date.now());return!(this.expiryTime<e&&(yt.removeNodeFromTree(this.key),1))}saveToCache(e){this.value.cached=e}addNode(e,t,n){if(null==t)return e;const o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return this.isValid(),e;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));const r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return this.isValid(),t}rightRotate(e){if(e){const t=e.leftNode;if(t){const n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){const t=e.rightNode;if(t){const n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key&&t.isValid()?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){const t=e.rightNode;return e=null,t}if(null==e.rightNode){const t=e.leftNode;return e=null,t}{const t=this.inOrderSuccessor(e.rightNode);return e.value=t.value,e.key=t.key,e.rightNode=this.removeNode(e.rightNode,t.key),e}}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var vt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class yt{static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static addCompositionToTree(e){const t=new ft(e.id,e,null,null);this.addNodeToTree(t)}static getNodeFromTree(e){return vt(this,void 0,void 0,(function*(){return this.root?this.root.getFromNode(e,this.root):null}))}static removeNodeFromTree(e){return vt(this,void 0,void 0,(function*(){this.root&&(this.root=this.root.removeNode(this.root,e))}))}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}yt.root=null;var gt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function mt(e,t,n,o){return gt(this,arguments,void 0,(function*(e,t,n,o,i=[]){var r,c;let s={};const l=[];if(0==e)return"";let d=Ct(n,e);if(null!=d&&0!=d.id||null==e||null==e||(d=yield(0,z.A)(e)),0!=d.id&&null==d.type){const e=d.typeId;let t=Ct(n,e);d.type=t,null==t&&null!=e&&null!=e&&(t=yield(0,z.A)(e),d.type=t)}if(!o.includes(e))return null==d?void 0:d.characterValue;if(i.includes(e))return"";i.push(e);for(let d=0;d<t.length;d++)if(t[d].ofTheConceptId==e){const u=t[d].toTheConceptId;if(o.includes(e)){let e=Ct(n,u);if(null!=e&&0!=e.id||null==u||null==u||(e=yield(0,z.A)(u)),0!=e.id&&null==(null==e?void 0:e.type)){const t=e.typeId;let n=yield a.I.GetConcept(t);e.type=n,null==n&&null!=t&&null!=t&&(n=yield(0,z.A)(t),e.type=n)}const d="the_",h=(null!==(c=null===(r=null==e?void 0:e.type)||void 0===r?void 0:r.characterValue)&&void 0!==c?c:"").replace(d,"");if(isNaN(Number(h))){if(h){const e=yield mt(u,t,n,o,i);s[h]=e}}else{const e=yield mt(u,t,n,o,i);l[h]=e,s=l}}}return s}))}function Ct(e,t){let n=(0,P.o)();for(let o=0;o<e.length;o++)if(t==e[o].id)return n=e[o],n;return n}class Tt{constructor(){this.id=0,this.mainConcept=(0,P.o)(),this.connections=[],this.concepts=[],this.subcompositions=[],this.cached={}}updateCache(){return e=this,t=void 0,o=function*(){if(0==this.mainConcept.id)for(let e=0;e<this.concepts.length;e++)this.concepts[e].id==this.id&&(this.mainConcept=this.concepts[e]);this.cached=yield mt(this.id,this.connections,this.concepts,this.subcompositions,[])},new((n=void 0)||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}));var e,t,n,o}UpdateAcrossDistributedSystem(){var e,t;try{0!=this.id&&(t=null===(e=this.id)||void 0===e?void 0:e.toString(),l.B.MQTT_CONNECTION&&l.B.MQTT_CONNECTION.publish("compositionUpdate",t))}catch(e){console.log("Error while publishing message",e)}}isUpdating(){this.UpdateAcrossDistributedSystem()}GetDataCache(){var e,t,n;const o={};o[null!==(n=null===(t=null===(e=this.mainConcept)||void 0===e?void 0:e.type)||void 0===t?void 0:t.characterValue)&&void 0!==n?n:""]=this.cached;const i={};return i.data=o,i.id=this.id,i}}var wt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function It(e){return wt(this,arguments,void 0,(function*(e,t=null,n=null,o=null,i=null,r=null,c=null,s=null){const a=null!=i?i:999,l=null!=r?r:4,d=null!=c?c:999;let u=null!=o?o:0,h=(0,P.o)();null==s&&(s=new Tt);for(const o in e)if("object"==typeof e[o]||Array.isArray(e[o])){const p=yield(0,q.A)(o,"",!0,a,l,d);if(null==t&&null==n){let t=u;h=p,t=p.id,u=p.id,s.concepts.push(p),s.id=p.id,yield It(e[o],p.id,p.userId,t,i,r,c,s)}else{const a=null!=t?t:999,l=null!=n?n:999,d=u;h=p,s.concepts.push(p);const f=yield(0,ie.q)(a,l,p.id,d);s.connections.push(f),yield It(e[o],p.id,p.userId,d,i,r,c,s)}null!=e[o]&&null!=e[o]&&s.subcompositions.push(p.id)}else{const i=null!=t?t:999,r=null!=n?n:999,c=u,h=yield(0,q.A)(o,e[o],!1,a,l,d);s.concepts.push(h);const p=yield(0,ie.q)(i,r,h.id,c);s.connections.push(p)}return h}))}var kt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Nt(e){return kt(this,void 0,void 0,(function*(){const t=ro.V.logfunction("UpdateComposition")||{};if(Ti){t.serviceWorker=!0;try{const n=yield bi("UpdateComposition",{patcherStructure:e});return ro.V.logUpdate(t),n.data}catch(e){console.error("UpdateComposition sw error: ",e),(0,u.ey)(t,"UpdateComposition",e),Ri(e)}}const n=e.userId,o=e.sessionId,i=e.accessId;let r=[];const c=[];let s=(0,P.o)(),a=(0,P.o)();const l=[];let d=e.compositionId;const h=e.ofTheCompositionId;let p=[];if(d<0){let e=yield(0,z.A)(d,n);if(!(e.id>0))return null;d=e.id}r=yield(0,R.s)(d);const f=[],v=new Tt,y=[];v.id=d,v.isUpdating();let g=[];for(let e=0;e<r.length;e++)(0,dt.A)(y,r[e].ofTheConceptId),(0,dt.A)(f,r[e].ofTheConceptId),(0,dt.A)(f,r[e].toTheConceptId),g.push(r[e].ofTheConceptId);v.subcompositions=y,v.connections=r;for(let e=0;e<f.length;e++){const t=yield(0,z.A)(f[e]);d==f[e]&&(s=t),h==f[e]&&(a=t),c.push(t)}const m=e.patchObject;for(const e in m){let t=(0,P.o)();const r=m[e];let d=s;if(a.id>0&&(d=a),Array.isArray(r)||"object"==typeof r){t=yield(0,q.A)(e,"",!0,s.userId,4,999),v.subcompositions.push(t.id);const n=(0,ut.vo)(c,t);for(let e=0;e<n.length;e++)if(n[e].id>0){const t=(0,ut.wS)(v.connections,n[e].id);p=p.concat(t),l.push(n[e])}yield It(m[e],t.id,t.userId,s.id,s.userId,4,999,v)}else{t=yield(0,q.A)(e,r,!1,n,i,o);const s=(0,ut.vo)(c,t);for(let e=0;e<s.length;e++)if(s[e].id>0){const t=(0,ut.wS)(v.connections,s[e].id);p=p.concat(t),l.push(s[e])}}const u=(0,ie.q)(d.id,d.userId,t.id,s.id);c.push(t),v.connections.push(u)}for(let e=0;e<p.length;e++)pt(v.connections,p[e]),(0,J.m)(p[e].id);for(let e=0;e<l.length;e++)ht(c,l[e]);v.concepts=v.concepts.concat(c),v.mainConcept=s,v.id=s.id,yield v.updateCache(),yt.addCompositionToTree(v),M.Y.SyncDataOnline();let C=v.GetDataCache();return ro.V.logUpdate(t),C}))}var At=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Lt(e,t,n,o){return At(this,arguments,void 0,(function*(e,t,n,o,i=10,r=1){var c=(0,d.ab)("application/x-www-form-urlencoded",o),s=new URLSearchParams;s.append("type",e),s.append("search",t),s.append("composition",n),s.append("inpage",i.toString()),s.append("page",r.toString());const a=l.B.SearchCompositionsUrl()+"?"+s.toString();try{const e=yield fetch(a,{method:"GET",headers:c});return e.ok?yield e.json():((0,u.ry)(e),[])}catch(e){console.log("This is the searching error",e),(0,u.Mb)(e,a)}}))}var St=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function _t(e){return St(this,arguments,void 0,(function*(e,t=""){var n=(0,d.ab)("application/json",t);const o=l.B.SearchLinkMultipleAll(),i=JSON.stringify(e);try{const e=yield fetch(o,{method:"POST",headers:n,body:i});return e.ok?yield e.json():(console.log("This is the searching error",e.status),(0,u.ry)(e),[])}catch(e){console.log("This is the searching error",e),(0,u.Mb)(e,o)}}))}var bt=n(7139),Bt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function xt(e){return Bt(this,arguments,void 0,(function*(e,t=[]){var n,o;let i=[];const r=[];let c={},s={};const l=yield yt.getNodeFromTree(e),d=[];let u=yield a.I.GetConcept(e);if(0==u.id&&null!=e&&null!=e&&(u=yield(0,bt.r)(e)),null==l){let a=[];a=t.length>0?Et(e,t):yield(0,R.s)(e),i=a;for(let e=0;e<i.length;e++)d.includes(i[e].ofTheConceptId)||(d.push(i[e].ofTheConceptId),r.push(i[e].ofTheConceptId)),r.includes(i[e].toTheConceptId)||r.push(i[e].toTheConceptId);Dt(u,i,r,d);let l=[];s=yield(0,y.zN)(e,i,d,l),c[null!==(o=null===(n=null==u?void 0:u.type)||void 0===n?void 0:n.characterValue)&&void 0!==o?o:""]=s}else s=l.value.GetDataCache(),c=s;return 0==u.id?"":c}))}function Et(e,t){const n=[];for(let o=0;o<t.length;o++)t[o].typeId==e&&n.push(t[o]);return n}function Gt(e){return Bt(this,arguments,void 0,(function*(e,t=[]){var n,o;let i={},r=[];const c=[];let s;const l={},d=yield yt.getNodeFromTree(e),u=[];let h=yield a.I.GetConcept(e);if(0==h.id&&null!=e&&null!=e&&(h=yield(0,bt.r)(e)),null==d){let a=[];a=t.length>0?Et(e,t):yield(0,R.s)(e),r=a;for(let e=0;e<r.length;e++)u.includes(r[e].ofTheConceptId)||(u.push(r[e].ofTheConceptId),c.push(r[e].ofTheConceptId)),c.includes(r[e].toTheConceptId)||c.push(r[e].toTheConceptId);Dt(h,r,c,u),s=yield(0,y.zN)(e,r,u),l[null!==(o=null===(n=null==h?void 0:h.type)||void 0===n?void 0:n.characterValue)&&void 0!==o?o:""]=s,i.created_at=h.entryTimeStamp,i.data=l,i.id=e}else s=d.value.GetDataCache(),i=s;return 0==h.id?"":i}))}function Rt(e,t){return Bt(this,void 0,void 0,(function*(){let n=[];const o=[];n=yield(0,nt.j)(t);for(let t=0;t<e.length;t++){const i=yield Gt(e[t],n);i&&o.push(i)}return o}))}function Dt(e,t,n,o){return Bt(this,void 0,void 0,(function*(){const i=new Tt,r=yield function(e){return Bt(this,void 0,void 0,(function*(){let t=[];const n=[];for(let o=0;o<(null==e?void 0:e.length);o++){const i=yield a.I.GetConcept(e[o]);0==i.id?n.push(e[o]):t.push(i)}return 0==(null==n?void 0:n.length)||(t=yield(0,tt.I)(n)),t}))}(n);i.connections=t,i.concepts=r,i.id=e.id,i.subcompositions=o,i.mainConcept=e;const c=yield mt(e.id,t,r,o,[]);i.cached=c,yt.addCompositionToTree(i)}))}var Ut=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ot(e){return Ut(this,void 0,void 0,(function*(){try{var t=(0,d.Xr)();const n=JSON.stringify(e),o=yield fetch(l.B.CreateSessionId(),{method:"POST",headers:t,body:n});return o.ok?o.json():(console.log("Creating session failed",yield o.json()),(0,u.ry)(o),null)}catch(e){console.log("Creating session failed",e),(0,u.Mb)(e,l.B.CreateSessionId())}}))}var Ft=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Wt(e,t){return Ft(this,void 0,void 0,(function*(){try{var n=(0,d.Xr)("application/x-www-form-urlencoded");const o=new URLSearchParams;o.append("sessionId",e.toString()),o.append("url",t);const i=yield fetch(l.B.CreateSessionVisitUrl(),{method:"POST",headers:n,body:o});return i.ok?i.json():(console.log("Creating session url failed",yield i.json()),(0,u.ry)(i),null)}catch(e){console.log("Creating session url failed",e),(0,u.Mb)(e,l.B.CreateSessionVisitUrl())}}))}var Mt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Pt(e,t,n){return Mt(this,arguments,void 0,(function*(e,t,n,o=10,i=1){let r=[];try{var c=new URLSearchParams;c.append("typeId",`${e}`),c.append("toTheConceptId",`${t}`),c.append("userId",`${n}`),c.append("inpage",`${o}`),c.append("page",`${i}`);var s=(0,d.Xr)("application/x-www-form-urlencoded");const a=yield fetch(l.B.GetAllConnectionsToConceptUrl(),{method:"POST",headers:s,body:c});return a.ok?r=yield a.json():(console.log("Get connection of concept error",a.status),(0,u.ry)(a)),r}catch(e){throw e instanceof Error?console.log("Get connection of concept  error message: ",e.message):console.log("Get connection of concept unexpected error: ",e),e}}))}var Vt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function jt(e,t){var n=arguments;return Vt(this,arguments,void 0,(function*(e,t,o=10,i=1,r=!1){const c=ro.V.logfunction("GetRelation",n)||{};if(Ti){c.serviceWorker=!0;try{const n=yield bi("GetRelation",{id:e,relation:t,inpage:o,page:i,reverse:r});return ro.V.logUpdate(c),n.data}catch(e){console.error("GetRelation error sw: ",e),(0,u.ey)(c,"GetRelation",e),Ri(e)}}let s=[],a=yield(0,z.A)(e),l=yield(0,de.Az)(t),d=[];if(l.id>0)if(r){d=yield Pt(l.id,a.id,a.userId,o,i);let e=[];for(var h=0;h<d.length;h++)e.push(d[h].ofTheConceptId);yield(0,f.Y)(e);for(let e=0;e<d.length;e++){let t=d[e].ofTheConceptId,n=yield(0,z.A)(t),o=yield(0,y.Ez)(n.id);s.push(o)}}else{d=yield F(l.id,a.id,a.userId,o,i);let e=[];for(let t=0;t<d.length;t++)e.push(d[t].toTheConceptId);yield(0,f.Y)(e);for(let e=0;e<d.length;e++){let t=d[e].toTheConceptId,n=yield(0,z.A)(t),o=yield(0,y.Ez)(n.id);s.push(o)}}return ro.V.logUpdate(c),s}))}function Ht(e,t){var n=arguments;return Vt(this,arguments,void 0,(function*(e,t,o=10,i=1,r=!1){const c=ro.V.logfunction("GetRelationRaw",n)||{};if(Ti){c.serviceWorker=!0;try{const n=yield bi("GetRelationRaw",{id:e,relation:t,inpage:o,page:i,reverse:r});return ro.V.logUpdate(c),n.data}catch(e){console.error("GetRelationRaw error sw: ",e),(0,u.ey)(c,"GetRelationRaw",e),Ri(e)}}let s=[],a=yield(0,z.A)(e),l=yield(0,de.Az)(t),d=[],h=[];if(l.id>0){if(r){d=yield Pt(l.id,a.id,a.userId,o,i);for(var p=0;p<d.length;p++)h.push(d[p].ofTheConceptId)}else{d=yield F(l.id,a.id,a.userId,o,i);for(let e=0;e<d.length;e++)h.push(d[e].toTheConceptId)}s=yield(0,tt.r)(h)}return ro.V.logUpdate(c),s}))}var $t=n(6416),Jt=n(4711);class zt{constructor(e,t,n,o){this.value=[],this.height=1,this.key=e,this.value.push(t),this.leftNode=n,this.rightNode=o}addNode(e,t,n){if(null==t)return e;var o=t.leftNode,i=t.rightNode;if(t.key>e.key)t.leftNode=this.addNode(e,o,n);else{if(!(t.key<e.key))return t.value.push(...e.value),t;t.rightNode=this.addNode(e,i,n)}t.height=1+Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode));let r=this.getBalanceFactor(t);if(r>1&&t.leftNode){if(e.key<t.leftNode.key)return this.rightRotate(t);if(e.key>t.leftNode.key)return t.leftNode=this.leftRotate(t.leftNode),this.rightRotate(t)}if(r<-1&&t.rightNode){if(e.key>t.rightNode.key)return this.leftRotate(t);if(e.key<t.rightNode.key)return t.rightNode=this.rightRotate(t.rightNode),this.leftRotate(t)}return t}rightRotate(e){if(e){let t=e.leftNode;if(t){let n=t.rightNode;return e.leftNode=n,t.rightNode=e,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(t.rightNode))+1,t}}return e}leftRotate(e){if(e){let t=e.rightNode;if(t){let n=t.leftNode;return t.leftNode=e,e.rightNode=n,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,t.height=Math.max(this.getHeight(t.leftNode),this.getHeight(e.rightNode))+1,t}}return e}getHeight(e){return e?e.height:0}getBalanceFactor(e){return null==e?0:this.getHeight(e.leftNode)-this.getHeight(e.rightNode)}getFromNode(e,t){return t?e==t.key?t:e<t.key?this.getFromNode(e,t.leftNode):e>t.key?this.getFromNode(e,t.rightNode):t:t}removeNode(e,t){if(null==e)return e;if(e.key>t)return e.leftNode=this.removeNode(e.leftNode,t),e;if(e.key<t)return e.rightNode=this.removeNode(e.rightNode,t),e;if(null==e.leftNode){let t=e.rightNode;return e=null,t}if(null==e.rightNode){let t=e.leftNode;return e=null,t}var n=this.inOrderSuccessor(e.rightNode);return e.value=n.value,e.key=n.key,e.rightNode=this.removeNode(e.rightNode,n.key),e}countNodeBelow(e){return null==e?0:1+this.countNodeBelow(e.leftNode)+this.countNodeBelow(e.rightNode)}inOrderSuccessor(e){for(;null!=e.leftNode;)e=e.leftNode;return e}}var qt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Qt{static compositeKey(e,t){return("0000"+e.toString(16).toUpperCase()).slice(-4)+("0000"+t.toString(16).toUpperCase()).slice(-4)}static addNodeToTree(e){if(null==this.root)return this.root=e,this.root;this.root=this.root.addNode(e,this.root,this.root.height)}static waitForDataToLoad(){return qt(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.checkFlag(e),setTimeout((()=>{t("not")}),25e3)}))}))}static checkFlag(e){if(r.B.isDataLoaded)return e("done");setTimeout(Qt.checkFlag,1e3,e)}static addConceptToTree(e,t,n=999){let o=this.compositeKey(t,n);var i=new zt(o,e,null,null);this.addNodeToTree(i)}static getNodeFromTree(e,t){return qt(this,void 0,void 0,(function*(){let n=this.compositeKey(e,t);return this.root?this.root.getFromNode(n,this.root):null}))}static removeNodeFromTree(e){return qt(this,arguments,void 0,(function*(e,t=999){if(this.root){let n=this.compositeKey(e,t);this.root=this.root.removeNode(this.root,n)}}))}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}Qt.root=null;var Xt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Yt(e,t){return Xt(this,arguments,void 0,(function*(e,t,n=999){let o=yield Qt.getNodeFromTree(e,n),i=(0,$t.u)();if(o)for(let e=0;e<o.value.length;e++){let n=o.value[e];n.ghostId==t&&(i=n)}return i}))}function Zt(e,t){return Xt(this,arguments,void 0,(function*(e,t,n=999){Qt.addConceptToTree(e,t,n)}))}var Kt=n(5312),en=n(1213),tn=n(3729),nn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},on=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function rn(e,t,n){return on(this,void 0,void 0,(function*(){try{if(Ti)try{return(yield bi("GetRelationLocal",{id:e,relation:t,userId:n})).data}catch(e){console.error("GetRelationLocal error sw: ",e),Ri(e)}let o=yield(0,m.$I)(t),i=[];0!=o.id&&(i=yield function(e,t){return nn(this,void 0,void 0,(function*(){try{return yield A.G.GetConnectionOfCompositionAndTypeLocal(t,e)}catch(e){throw e}}))}(e,o.id));let r=[];for(let e=0;e<i.length;e++){let t=yield _(i[e].toTheConceptId);r.push(t)}return r}catch(e){throw e}}))}var cn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function sn(e){return cn(this,void 0,void 0,(function*(){let t=[];try{var n=(0,d.Xr)();const o=yield fetch(l.B.ViewInternalDataUrl(),{method:"POST",headers:n,body:JSON.stringify(e)});if(o.ok){let e=yield o.json(),n={};for(let o=0;o<e.length;o++){let i=e[o].concepts;t=e[o].connections;let r=e[o].id;(0,tt.r)(i),n[r]=t}return n}return console.log("View Internal Data error",o.status),(0,u.ry)(o),t}catch(e){throw e instanceof Error?console.log(" This is the view internal data error message: ",e.message):console.log(" This is the view internal data unexpected error: ",e),e}}))}var an=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function ln(e){return an(this,void 0,void 0,(function*(){var t;try{let n=yield sn(e),o=[];for(let i=0;i<e.length;i++){let r=e[i],c=n[r];if(r&&c){let e=[],t={};for(let t=0;t<c.length;t++)e.includes(c[t].ofTheConceptId)||e.push(c[t].ofTheConceptId);let n=yield(0,y.zN)(r,c,e);t.data=n,t.id=r,o.push(t)}else{let e={};e.id=r;let n=yield(0,z.A)(r),i={};n.type&&(i[null===(t=null==n?void 0:n.type)||void 0===t?void 0:t.characterValue]=n.characterValue,e.data=i,o.push(e))}}return o}catch(e){throw e}}))}var dn=n(176),un=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))},hn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function pn(e){return hn(this,arguments,void 0,(function*(e,t=""){try{let n=yield function(e){return un(this,arguments,void 0,(function*(e,t=""){var n=(0,d.ab)("application/json",t);let o=l.B.SearchInternalWithAuthenticatedCcsUrl();o=o+"?composition="+e.composition+"&search="+e.search+"&internalComposition="+e.internalComposition+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;try{const e=yield fetch(o,{method:"GET",headers:n});return e.ok?yield e.json():(console.log("This is the searching internal error",e.status),(0,u.ry)(e),[])}catch(e){console.log("This is the searching internal error",e),(0,u.Mb)(e,o)}}))}(e,t);return yield ln(n)}catch(e){throw e}}))}function fn(e){return hn(this,arguments,void 0,(function*(e,t=""){try{return yield function(e){return un(this,void 0,void 0,(function*(){var t=(0,d.ab)("application/json","");let n=l.B.SearchInternalWithCcsUrl();n=n+"?composition="+e.composition+"&search="+e.search+"&internalComposition="+e.internalComposition+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;try{const e=yield fetch(n,{method:"GET",headers:t});return e.ok?yield e.json():(console.log("This is the searching internal error",e.status),(0,u.ry)(e),[])}catch(e){console.log("This is the searching internal error",e),(0,u.Mb)(e,n)}}))}(e)}catch(e){throw e}}))}var vn=n(8095),yn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function gn(e){return yn(this,void 0,void 0,(function*(){if(Ti)try{return(yield bi("DeleteConceptLocal",{id:e})).data}catch(e){console.error("DeleteConceptLocal error sw: ",e),Ri(e)}let t=yield(0,en.f)(e);v.v.RemoveConcept(t)}))}var mn=n(2803),Cn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Tn(e,t,n,o){return Cn(this,arguments,void 0,(function*(e,t,n,o,i=!0){var r,c;const s=ro.V.logfunction("GetConnectionBetweenTwoConceptsLinker")||{};if(Ti){s.serviceWorker=!0;try{const r=yield bi("GetConnectionBetweenTwoConceptsLinker",{ofTheConcept:e,toTheConcept:t,linker:n,fullLinker:o,forward:i});return ro.V.logUpdate(s),r.data}catch(e){console.error("GetConnectionBetweenTwoConceptsLinker sw error: ",e),(0,u.ey)(s,"GetConnectionBetweenTwoConceptsLinker",e),Ri(e)}}let a=(0,P.o)();if(""!=n){let o="";o=i?(null===(r=e.type)||void 0===r?void 0:r.characterValue)+"_s_"+n+"_s":(null===(c=t.type)||void 0===c?void 0:c.characterValue)+"_s_"+n+"_by",a=yield(0,q.A)("connection",o,!1,999)}""!=o&&(a=yield pe(o,999));let l=[];return l=i?yield(0,mn.x)(e.id,t.id,a.id):yield(0,mn.x)(t.id,e.id,a.id),ro.V.logUpdate(s),l}))}function wn(e,t){return new Promise(((n,o)=>{setTimeout((()=>{n(t)}),e)}))}var In=n(3130);const kn=3,Nn=4,An=5;var Ln=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Sn(e,t){return Ln(this,arguments,void 0,(function*(e,t,n=""){let o=l.B.SearchAllTypeWithLinker(e.auth);var i=(0,d.ab)("application/json",n);o=o+"?search="+e.search+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;const r=JSON.stringify(t);try{const e=yield fetch(o,{method:"POST",headers:i,body:r});return e.ok?yield e.json():((0,u.ry)(e),console.log("This is the searching multiple error",e.status),[])}catch(e){console.log("This is the searching SearchWithTypeAndLinker error",e),(0,u.Mb)(e,o)}}))}var _n=n(4287);class bn extends _n.w{constructor(e,t,n=In.y0){super(),this.searchQuery=[],this.format=In.y0,this.searchQuery=e,this.format=n}bind(){return e=this,t=void 0,o=function*(){return this.data=yield(0,Kt.cf)(this.searchQuery,"",this,this.format),this.mainConcept=this.searchQuery[0].composition,this.listenToEvent(this.mainConcept),console.log("this is the data",this.data),this.data},new((n=void 0)||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}));var e,t,n,o}}function Bn(e,t,n=In.y0){return new bn(e,null!=t?t:"",n)}var xn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class En extends _n.w{constructor(e,t=In.ZJ){super(),this.id=e,this.format=t}bind(){return xn(this,void 0,void 0,(function*(){if(!this.isDataLoaded){let e=yield(0,y.hL)(this.id);this.mainConcept=this.id,this.compositionIds=e.compositionList;let t=e.connectionList;for(let e=0;e<t.length;e++)this.internalConnections.push(t[e].id);this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()}))}build(){return xn(this,void 0,void 0,(function*(){let e=[],t=this.internalConnections;for(let n=0;n<t.length;n++)e.push(yield xe.d.GetConnection(t[n]));return this.format==In.ZJ?this.data=yield(0,y.ay)(this.mainConcept,e,this.compositionIds):this.format==In.y0?this.data=yield(0,y.$V)(this.mainConcept,e,this.compositionIds):this.format==In.yv?this.data=yield(0,y.re)(this.mainConcept,e,this.compositionIds):this.data=yield(0,y.ay)(this.mainConcept,e,this.compositionIds),this.data}))}}function Gn(e,t=In.ZJ){return new En(e,t)}var Rn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Dn extends _n.w{constructor(e,t,n,o,i){super(),this.data=[],this.startPage=0,this.compositionName=e,this.userId=t,this.inpage=n,this.page=o,this.format=i}bind(){return Rn(this,void 0,void 0,(function*(){if(!this.isDataLoaded){var e=yield(0,g.A)(this.compositionName);if(e){yield p(this.compositionName,this.userId);let o=yield a.I.GetConceptsByTypeIdAndUser(e.id,this.userId);for(var t=this.inpage*(this.page-1),n=t;n<t+this.inpage;n++)o[n]&&this.compositionIds.push(o[n].id)}yield(0,f.Y)(this.compositionIds),this.isDataLoaded=!0,this.listenToEventType(e.id);for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e])}return yield this.build()}))}build(){return Rn(this,void 0,void 0,(function*(){if(this.data=[],this.format==In.ZJ){for(let e=this.startPage;e<this.startPage+this.inpage;e++)if(this.compositionIds[e]){let t=yield(0,y.kx)(this.compositionIds[e]);this.data.push(t)}}else if(this.format==In.y0){for(let e=this.startPage;e<this.startPage+this.inpage;e++)if(this.compositionIds[e]){let t=yield(0,y.RW)(this.compositionIds[e]);this.data.push(t)}}else if(this.format==In.yv){for(let e=this.startPage;e<this.startPage+this.inpage;e++)if(this.compositionIds[e]){let t=yield(0,y.XI)(this.compositionIds[e]);this.data.push(t)}}else for(let e=this.startPage;e<this.startPage+this.inpage;e++)if(this.compositionIds[e]){let t=yield(0,y.kx)(this.compositionIds[e]);this.data.push(t)}return this.data}))}}function Un(e,t,n,o,i=In.ZJ){return new Dn(e,t,n,o,i)}var On=n(1320),Fn=n(5328),Wn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Mn extends _n.w{constructor(e,t,n="",o){super(),this.searchText="",this.connections=[],this.externalConnectionIds=[],this.data=[],this.mainConcept=e,this.searchLinkers=t,this.textSearch=n,o&&(this.format=o)}listenToEvent(e){window.addEventListener(`${e}`,(t=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout((function(){return Wn(this,void 0,void 0,(function*(){let n=yield xe.d.GetConnectionByOfTheConceptAndType(e,e);for(let e=0;e<n.length;e++)yield xe.d.GetConnection(n[e]).then((e=>{e.typeId==t.mainConcept?t.internalConnections.includes(e.id)||t.internalConnections.push(e.id):t.linkers.includes(e.id)||t.linkers.push(e.id),t.conceptIds.includes(e.toTheConceptId)||t.conceptIds.push(e.toTheConceptId),t.compositionIds.includes(e.ofTheConceptId)||t.compositionIds.push(e.ofTheConceptId),t.compositionIds.includes(e.toTheConceptId)||t.compositionIds.push(e.toTheConceptId)}));t.isUpdating=!1,yield t.bind(),t.notify()}))}),200)}}))}bind(){return Wn(this,void 0,void 0,(function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;const e=yield Je(this.mainConcept,this.searchLinkers,this.textSearch);this.compositionIds=e.compositionIds||[],this.internalConnections=e.internalConnections||[],this.externalConnectionIds=e.externalConnections||[],this.linkers=this.externalConnectionIds,this.connections=yield(0,nt.j)(this.externalConnectionIds);for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);this.listenToEvent(this.mainConcept)}return yield this.build()}))}build(){return Wn(this,void 0,void 0,(function*(){return this.externalConnectionIds=this.linkers,this.format&&this.format==In.XZ?this.data={compositionIds:this.compositionIds,internalConnections:this.internalConnections,externalConnections:this.externalConnectionIds}:this.data=yield(0,Ve.p8)(this.compositionIds,this.internalConnections),this.data}))}}function Pn(e,t,n="",o){return new Mn(e,t,n,o)}var Vn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class jn extends _n.w{constructor(e,t,n,o=In.y0){super(),this.searchQuery=[],this.format=In.y0,this.mainCompositionIds=[],this.searchCharacter="",this.token="",this.searchStructure=e,this.searchQuery=t,this.searchQuery[0].type=e.composition,this.searchCharacter=e.composition,this.format=o,this.token=Ge.b.BearerAccessToken}listenToEventType(e){window.addEventListener(`${e}`,(e=>{if(this.isUpdating)console.log("rejected this");else{this.isUpdating=!0;let t=this;setTimeout((function(){return Vn(this,void 0,void 0,(function*(){let n=e;t.mainCompositionIds.includes(null==n?void 0:n.detail)||(t.mainCompositionIds.unshift(null==n?void 0:n.detail),t.conceptIds.push(null==n?void 0:n.detail),t.listenToEvent(null==n?void 0:n.detail),xe.d.GetConnectionsOfConcept(null==n?void 0:n.detail).then((e=>{for(let n=0;n<e.length;n++)t.linkers.push(e[n].id)}))),t.isUpdating=!1,yield t.bind(),t.notify()}))}),200)}}))}bind(){return Vn(this,void 0,void 0,(function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;var e=yield(0,g.A)(this.searchCharacter);let t=yield Sn(this.searchStructure,this.searchQuery,this.token);this.conceptIds=t.compositionIds,this.internalConnections=t.internalConnections,this.linkers=t.linkers,this.reverse=t.reverse,this.mainCompositionIds=t.mainCompositionIds,this.listenToEventType(e.id);for(let e=0;e<this.mainCompositionIds.length;e++)this.listenToEvent(this.mainCompositionIds[e])}return yield this.build()}))}build(){return Vn(this,void 0,void 0,(function*(){return yield(0,tt.r)(this.conceptIds),this.format==In.y0?this.data=yield(0,On.yV)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse):this.data=yield(0,On._W)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse),this.data}))}}function Hn(e,t,n,o=In.y0){return new jn(e,t,n,o)}var $n=n(4698),Jn=n(6915),zn=n(2615);class qn{constructor(e,t,n,o,i,r,c,s=!1,a,d,u){this.structureType="lconcept",this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=l.B.getRandomizer(),this.id=e,this.userId=t,this.typeId=n,this.ghostId=e,this.categoryId=o,this.characterValue=r,this.accessId=i,this.type=null,this.isNew=s,this.typeCharacter=c,this.entryTimeStamp=a,this.updatedTimeStamp=d,this.isSynced=!1,this.referentId=u}getType(){console.log(this.typeId)}}class Qn{constructor(e,t,n,o,i,r){this.isTemp=!1,this.applicationId=l.B.getRandomizer(),this.type=(0,P.o)(),this.id=e,this.ofTheConceptId=t,this.toTheConceptId=n,this.typeId=o,this.ghostId=e,this.orderId=i,this.typeCharacter="",this.accessId=r,this.typeCharacter="",this.entryTimeStamp=(0,P.Y)(new Date),this.terminationDateTime=new Date,this.localSyncTime=new Date}}class Xn{constructor(){this.compositionId=0,this.userId=999,this.sessionId=999,this.accessId=4,this.ofTheCompositionId=0,this.patchObject={}}}class Yn{constructor(){this.id="0",this.remote_address="",this.server_port="",this.server_address="",this.server_name="",this.server_software="",this.http_user_agent="",this.self="",this.port="",this.userId="",this.email=""}}var Zn=n(628);class Kn{constructor(){this.type="",this.search="",this.logicoperator="=",this.index=0,this.composition=!0,this.name="",this.operateon=""}}class eo{constructor(){this.type="",this.search="",this.composition="",this.internalComposition="",this.userId=999,this.inpage=10,this.page=1,this.auth=!0}}var to=n(7887),no=n(3075),oo=n(7869),io=n(9635),ro=n(9700);class co{static initialize(){try{console.warn("Initialized Application Monitoring for tracking errors..."),this.initGlobalErrorHandlers(),this.logCatchError(),this.logErrorEvent(),this.logUnhandledError(),this.logUserInteractions(),this.logNetworkRequests(),this.logRouteChanges(),this.logPerformanceMetrics(),this.logWebSocketEvents()}catch(e){console.error("Error during Application Monitoring initialization:",e)}}static initGlobalErrorHandlers(){try{if(console.log("this is the window",window),void 0===typeof window)return;const e=Ge.b.sessionId||"unknown";window.onerror=(t,n,o,i,r)=>{const c={message:t,source:n,lineno:o,colno:i,stack:(null==r?void 0:r.stack)||"undefined",requestFrom:l.B.BASE_APPLICATION,sessionId:e};ro.V.logApplication("ERROR","Runtime Error",c),ro.V.log("ERROR","Runtime Error",c)},window.onunhandledrejection=t=>{ro.V.logApplication("ERROR","Unhandled Promise Rejection",{message:t.reason?t.reason.message:t.reason,stack:t.reason?t.reason.stack:null,requestFrom:l.B.BASE_APPLICATION,sessionId:e}),ro.V.log("ERROR","Unhandled Promise Rejection",{message:t.reason?t.reason.message:t.reason,stack:t.reason?t.reason.stack:null,requestFrom:l.B.BASE_APPLICATION,sessionId:e})}}catch(e){console.warn("Failed to initialize global error handlers:",e)}}static logCatchError(){try{const e=console.error;console.log("Inside originalConsoleError...");const t=Ge.b.sessionId||"unknown";console.error=function(...n){const o="Console Error",i={arguments:n.map((e=>so(e))),requestFrom:l.B.BASE_APPLICATION,sessionId:t};ro.V.logApplication("ERROR",o,i),ro.V.log("ERROR",o,i),e.apply(console,n)}}catch(e){console.warn("Failed to override console.error:",e)}}static logErrorEvent(){try{window.addEventListener("error",(e=>{var t;console.log("Inside error event...");const n=Ge.b.sessionId||"unknown",o={error:(null===(t=e.error)||void 0===t?void 0:t.message)||e.message,source:e.filename,line:e.lineno,column:e.colno,stack:e.error?so(e.error.stack):void 0,requestFrom:l.B.BASE_APPLICATION,sessionId:n},i="Unhandled Error";ro.V.logApplication("ERROR",i,o),ro.V.log("ERROR",i,o)}))}catch(e){console.warn("Failed to add error event listener:",e)}}static logUnhandledError(){try{window.addEventListener("unhandledrejection",(e=>{var t,n;console.log("Inside unhandledrejection...");const o=Ge.b.sessionId||"unknown",i={reason:(null===(t=e.reason)||void 0===t?void 0:t.message)||String(e.reason),stack:(null===(n=e.reason)||void 0===n?void 0:n.stack)||"No stack trace available",requestFrom:l.B.BASE_APPLICATION,sessionId:o};ro.V.logApplication("ERROR","Unhandled Promise Rejection",i),ro.V.log("ERROR","Unhandled Promise Rejection",i)}))}catch(e){console.warn("Failed to add unhandled rejection event listener:",e)}}static logUserInteractions(){document.addEventListener("click",(e=>{var t;const n=Ge.b.sessionId||"unknown",o=e.target,i={element:o.tagName,id:o.id,classes:o.className,text:null===(t=o.innerText)||void 0===t?void 0:t.slice(0,50),requestFrom:l.B.BASE_APPLICATION,sessionId:n};ro.V.logApplication("INFO","User Click",i)})),document.addEventListener("input",(e=>{const t=e.target;Ge.b.sessionId,t.tagName,t.id,t.value,l.B.BASE_APPLICATION})),document.addEventListener("scroll",(()=>{Ge.b.sessionId,window.scrollY,l.B.BASE_APPLICATION}))}static logNetworkRequests(){try{if(void 0===typeof window)return;const e=Ge.b.sessionId||"unknown",t=null===window||void 0===window?void 0:window.fetch;if(!t)throw new Error("Original fetch is not available.");const n=[l.B.PostLogger(),l.B.PostPrefetchConceptConnections()];window.fetch=(...o)=>{return i=this,r=void 0,s=function*(){const[i,r]=o,c=i instanceof Request?i.url:i instanceof URL?i.toString():i;if(n.includes(c))return console.log("Ignored URLs detected : ",c),t(...o);let s={request:{type:"REQUEST",message:"Network Request",method:(null==r?void 0:r.method)||"GET",url:c,body:null==r?void 0:r.body,requestFrom:l.B.BASE_APPLICATION,sessionId:e}};try{const n=yield t(...o);return s.response={type:"RESPONSE",message:"Network Response",url:c,status:n.status,requestFrom:l.B.BASE_APPLICATION,sessionId:e},n}catch(t){throw s.response={type:"ERROR",message:"Network Request Failed",url:c,error:t instanceof Error?t.message:String(t),requestFrom:l.B.BASE_APPLICATION,sessionId:e},ro.V.logApplication("ERROR","Failed Network Request",s),new Error(`Network request failed for ${c}: ${t.message}`)}},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{a(s.next(e))}catch(e){t(e)}}function o(e){try{a(s.throw(e))}catch(e){t(e)}}function a(t){var i;t.done?e(t.value):(i=t.value,i instanceof c?i:new c((function(e){e(i)}))).then(n,o)}a((s=s.apply(i,r||[])).next())}));var i,r,c,s}}catch(e){console.warn("Failed to override network requests:",e)}}static logPerformanceMetrics(){void 0!==typeof window&&(null===window||void 0===window||window.addEventListener("load",(()=>{const e=performance.timing;Ge.b.sessionId,e.loadEventEnd,e.navigationStart,e.domContentLoadedEventEnd,e.navigationStart,l.B.BASE_APPLICATION})))}static logRouteChanges(){const e=history.pushState,t=Ge.b.sessionId||"unknown";history.pushState=function(...n){var o;const i={url:null===(o=n[2])||void 0===o?void 0:o.toString(),requestFrom:l.B.BASE_APPLICATION,sessionId:t};return ro.V.logApplication("INFO","Route Change",i),e.apply(this,n)},null===window||void 0===window||window.addEventListener("popstate",(()=>{const e={url:location.href,requestFrom:l.B.BASE_APPLICATION,sessionId:t};ro.V.logApplication("INFO","Route Changed (Back/Forward)",e)}))}static logWebSocketEvents(){if(void 0===typeof window)return;const e=Ge.b.sessionId||"unknown",t=WebSocket;window.WebSocket=class extends t{constructor(t,n){super(t,n);const o={url:t.toString(),requestFrom:l.B.BASE_APPLICATION,sessionId:e};ro.V.logApplication("INFO","WebSocket Open",o),this.addEventListener("message",(n=>{const o={url:t,data:n.data,requestFrom:l.B.BASE_APPLICATION,sessionId:e};ro.V.logApplication("INFO","WebSocket Message",o)})),this.addEventListener("error",(n=>{const o={url:t,error:n instanceof Error?n.message:String(n),requestFrom:l.B.BASE_APPLICATION,sessionId:e};ro.V.logApplication("ERROR","WebSocket Error",o)})),this.addEventListener("close",(()=>{const n={url:t,requestFrom:l.B.BASE_APPLICATION,sessionId:e};ro.V.logApplication("INFO","WebSocket Closed",n)}))}}}}function so(e){try{return JSON.stringify(e,((e,t)=>t&&"object"==typeof t&&t instanceof Error?{message:t.message,stack:t.stack}:t))}catch(e){return"Error while serializing value"}}const ao=(e,t,...n)=>{return o=void 0,i=[e,t,...n],c=function*(e,t,n=!1){try{let o=l.B.sendMail();n&&(o=l.B.sendBulkMail());const i=yield fetch(o,{method:"POST",body:e instanceof FormData?e:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}),r=i.headers.get("content-type");if(!i.ok){const e=yield i.json();return console.info(`${i.status} ${e}`),null}const c=yield i.json();return r&&r.includes("text/plain")?yield i.text():c}catch(e){return console.error(e),null}},new((r=void 0)||(r=Promise))((function(e,t){function n(e){try{a(c.next(e))}catch(e){t(e)}}function s(e){try{a(c.throw(e))}catch(e){t(e)}}function a(t){var o;t.done?e(t.value):(o=t.value,o instanceof r?o:new r((function(e){e(o)}))).then(n,s)}a((c=c.apply(o,i||[])).next())}));var o,i,r,c};class lo{constructor(){this.inDevelopment=!1,this.subscribers=[]}notify(e=null){this.subscribers.map((t=>{t(e||this.data)}))}dataChange(e){this.subscribers.push(e)}}class uo extends lo{constructor(){super(...arguments),this.element=null,this.elementIdentifier=0,this.widgetMounted=!1}getComponent(){return this.element}getElementById(e){let t=this.getComponent(),n=document.body;if(t){let o=t.querySelector("#"+e);if(o)return n=o,n}return null}createWidgetWrapperIdentifier(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier.toString()}}class ho extends uo{constructor(){super(...arguments),this.html="",this.css="",this.js="",this.state={},this.previousState={},this.childWidgets=[],this.childWidgetElement=[],this.widgetState={},this.parentElement=""}querySelector(e){return this.element?this.element.querySelector(e):null}querySelectorAll(e){return this.element?this.element.querySelectorAll(e):null}getElement(){return this.element}setTitle(e){document.title=e}getHtml(){return this.html}UpdateChildData(e,t){let n=t;n.data=e,n.render(),n.update()}update(){}setState(e){this.previousState=Object.assign({},this),this.data=e,this.state=Object.assign({},this),this.hasStateChanged()&&(this.notify(),this.render())}setStateProperty(e){this.previousState=Object.assign({},this),Object.assign(this,e),this.state=Object.assign({},this),this.hasStateChanged()&&(this.notify(),this.render())}hasStateChanged(){return!this.isPropertyEqual(this.state,this.previousState)}isPropertyEqual(e,t){if(e===t)return!0;if("object"!=typeof e||"object"!=typeof t||null===e||null===t)return!1;const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(let i of n){if(!o.includes(i))return!1;for(let n of o)if(i==n&&"state"!=i&&"previousState"!=i&&e[i]!=t[i])return!1}return!0}loadChildWidgets(){this.childWidgets.map((e=>{let t=this.getElementById(e.parentElement);t&&(t.innerHTML=""),e.mount(t)}))}render(){this.element&&(this.element.innerHTML=this.getHtml()),this.loadChildWidgets(),this.after_render()}getElementByClassName(e){let t=this.getComponent();return t?null==t?void 0:t.querySelectorAll("."+e):[]}mount_child(){}mount(e){return t=this,n=void 0,i=function*(){e&&(this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier(),this.element.innerHTML=this.getHtml(),this.element.classList.add("mftsccs-marking-rendered"),e.appendChild(this.element),this.parentElement=e.id,this.before_render(),this.mount_child(),this.widgetMounted=!0)},new((o=void 0)||(o=Promise))((function(e,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(c,s)}a((i=i.apply(t,n||[])).next())}));var t,n,o,i}before_render(){this.render()}after_render(){console.log("this is calling the after render",this)}renderChildWidgets(){function e(t){var n;t&&(null===(n=t.childWidgets)||void 0===n||n.forEach((t=>{e(t)})),t.render())}console.log("this is the render child widget",this),this.childWidgets.forEach((t=>{e(t)}))}setWidgetState(e,t){this.widgetState[e]=t,function e(t){t&&Array.isArray(t.childWidgets)&&t.childWidgets.forEach((n=>{n.widgetState=Object.assign(Object.assign({},n.widgetState),t.widgetState),e(n)}))}(this),this.renderChildWidgets()}getWidgetState(e,t){return Object.keys.length&&this.widgetState[e]?this.widgetState[e]:t}}var po=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class fo extends ho{constructor(){super(...arguments),this.childComponents=[],this.componentMounted=!1,this.oldHtml=null,this.phonebooks=[],this.childrenData={},this.childWidgets=[],this.typeValueList=[],this.widgetType="the_element_name",this.parentConceptList=[],this.customFunctions=[]}getUserId(){return po(this,void 0,void 0,(function*(){const e=yield new Promise((e=>{let t=(null===localStorage||void 0===localStorage?void 0:localStorage.getItem("profile"))||"";t?e(JSON.parse(t)):e()}));return null==e?void 0:e.userId}))}getTypeValueList(){return po(this,arguments,void 0,(function*(e=""){return new Promise((t=>po(this,void 0,void 0,(function*(){const n=null==(e=this.widgetType)?void 0:e.match(/^[a-z0-9]+_[a-z0-9]+/i),o=n?n[0]:"",i=null==e?void 0:e.match(/^([a-z0-9]+).*_([a-z0-9]+)$/i),r=i?`${i[1]}_${i[2]}`:"";let c=[],s=new Kn;s.type=r,s.search="1",s.logicoperator=">",s.name="emailfilter",s.operateon="entityEmail",s.composition=!1,c.push(s);let a=new Ao;a.typeConnection=e,a.name="entityEmail";let l=new Ao;l.type=o,l.filterLogic="( emailfilter )",l.filters=c,l.name="top",l.inpage=100,l.freeschemaQueries=[a],l.outputFormat=In.y0,Bo(l,"").subscribe((n=>{if(null==n?void 0:n.length){const i=null==n?void 0:n.map((t=>{var n,i,c,s,a,l,d;const u=null===(s=null===(c=null===(i=null===(n=t.data)||void 0===n?void 0:n[o])||void 0===i?void 0:i[e])||void 0===c?void 0:c.data)||void 0===s?void 0:s[r];return{id:null===(d=null===(l=null===(a=t.data)||void 0===a?void 0:a[o])||void 0===l?void 0:l[e])||void 0===d?void 0:d.id,name:u,text:u}}));return this.typeValueList=i,t(i),i}}))}))))}))}setTitle(e){document.title=e}getHtml(){return this.html}createRandomNumber(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier}mount_child(){return po(this,void 0,void 0,(function*(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.mountChildWidgetsFunction}\n        }).call(this);\n      `).bind(this)(o)}catch(e){throw console.log("This is the error in the mount child",e),e}}))}setProperty(e){return po(this,void 0,void 0,(function*(){return this.widgetType=e,this.getTypeValueList(this.widgetType).then((()=>{var e,t,n;null===(e=this.element)||void 0===e||e.setAttribute("data-type-value",this.widgetType),null===(n=null===(t=this.element)||void 0===t?void 0:t.parentElement)||void 0===n||n.setAttribute("data-type-value",this.widgetType),this.render()})),this}))}createTypeEditor(e){!function(e,t){if(e){const n=document.querySelector("#widget-properties #widget-type"),o=null==n?void 0:n.querySelectorAll("input");null==o||o.forEach((e=>{null==e||e.remove()}));const i=e.target.closest(".added-widget-container"),r=e.target.closest("div");let c="";i?c=null==i?void 0:i.getAttribute("data-type-value"):r&&(c=null==r?void 0:r.getAttribute("data-type-value"));const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("name","input-widgetTypeValue"),s.setAttribute("of",t.elementIdentifier.toString()),s.setAttribute("class","form-control"),s.setAttribute("id","widgetType"),s.setAttribute("onchange","updateWidgetTypeValue(event)"),t.widgetType?s.value=t.widgetType:s.setAttribute("placeholder","e.g. the_entity");let a=t;s.addEventListener("change",(function(e){var t,n,o;const i=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;a.widgetType=i,a.before_render(),a.loadChildWidgets(),null===(o=null===(n=a.element)||void 0===n?void 0:n.parentElement)||void 0===o||o.setAttribute("data-type-value",a.widgetType)})),null==n||n.appendChild(s)}}(e,this)}mount(e){return po(this,void 0,void 0,(function*(){if(e){this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier();let t=this;this.inDevelopment?(this.element.onclick=function(e){e.preventDefault(),t.createTypeEditor(e)},this.element.className="mftsccs-marking-element"):this.element.classList.add("mftsccs-marking-rendered"),this.element.innerHTML=this.getHtml(),null==e||e.setAttribute("data-type-value",t.widgetType),e.appendChild(this.element),this.parentElement=e.id,0==this.componentMounted||0==this.widgetMounted?(this.render_custom_functions(),this.before_render(),this.mount_child(),this.widgetMounted=!0,this.componentMounted=!0):this.render(),this.childWidgetElement=this.getElementByClassName("added-widget-container")}}))}render_custom_functions(){var e;const t=null===(e=this.customFunctions)||void 0===e?void 0:e.map((e=>null==e?void 0:e.code)).join("");try{new Function("tsccs",`\n          return (async function() {\n            ${t}\n          }).call(this);\n        `).bind(this)(o)}catch(e){throw console.error("This is the error in the render_custom_functions",e),e}}before_render(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.componentDidMountFunction}\n        }).call(this);\n      `).bind(this)(o)}catch(e){throw console.log("This is the error in the before render",e),e}}after_render(){try{new Function("tsccs",`\n        return (async function() {\n          ${this.addEventFunction}\n        }).call(this);\n      `).bind(this)(o)}catch(e){throw console.log("This is the error in the after render",e),e}}CreateConnectionBetweenEntityLocal(e,t,n){return po(this,void 0,void 0,(function*(){var o;const i=e.userId,r=(null===(o=e.type)||void 0===o?void 0:o.characterValue)+"_"+n,c=yield(0,le.$)(r,999,999,i);return yield(0,Jt.F)(e.id,t.id,c.id,1e3),"connection created"}))}}var vo=n(3077),yo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class go{constructor(){this.actions={concepts:[],connections:[]},this.success=!0,this.transactionId=Math.random().toString().substring(5)}initialize(){return yo(this,void 0,void 0,(function*(){yield Zn.H.initializeTransaction(this.transactionId)}))}commitTransaction(){return yo(this,void 0,void 0,(function*(){if(!this.success)throw Error("Query Transaction Expired");yield Zn.H.SyncDataOnline(this.transactionId),this.actions={concepts:[],connections:[]},this.success=!1}))}commitTransactionWithoutAuth(){return yo(this,void 0,void 0,(function*(){if(!this.success)throw Error("Query Transaction Expired");yield Zn.H.SyncDataOnlineWithoutAuth(this.transactionId),this.actions={concepts:[],connections:[]},this.success=!1}))}rollbackTransaction(){return yo(this,void 0,void 0,(function*(){this.success=!1,this.actions={concepts:[],connections:[]},yield Zn.H.rollbackTransaction(this.transactionId,this.actions)}))}markAction(){return yo(this,void 0,void 0,(function*(){yield Zn.H.markTransactionActions(this.transactionId,this.actions)}))}MakeTheInstanceConceptLocal(e,t){return yo(this,arguments,void 0,(function*(e,t,n=!1,o,i,r=999,c=0){try{if(!this.success)throw Error("Query Transaction Expired");const s=yield(0,K.k)(e,t,n,o,i,r,c,this.actions);return yield this.markAction(),s}catch(e){throw console.log(e),this.success=!1,e}}))}MakeTheTypeConceptLocal(e,t,n,o){return yo(this,void 0,void 0,(function*(){try{if(!this.success)throw Error("Query Transaction Expired");const i=yield(0,le.$)(e,t,n,o,this.actions);return yield this.markAction(),i}catch(e){throw console.log(e),this.success=!1,e}}))}CreateTheConceptLocal(e,t,n,o,i,r){return yo(this,arguments,void 0,(function*(e,t,n,o,i,r,c=!1,s=0,a={concepts:[],connections:[]}){try{if(!this.success)throw Error("Query Transaction Expired");const a=yield(0,vo.A)(e,t,n,o,i,r,c,s,this.actions);return yield this.markAction(),a}catch(e){throw console.log(e),this.success=!1,e}}))}CreateConnectionBetweenTwoConceptsLocal(e,t,n){return yo(this,arguments,void 0,(function*(e,t,n,o=!1){try{if(!this.success)throw Error("Query Transaction Expired");const i=yield(0,vn.h)(e,t,n,o,this.actions);return yield this.markAction(),i}catch(e){throw console.log(e),this.success=!1,e}}))}CreateTheConnectionLocal(e,t,n){return yo(this,arguments,void 0,(function*(e,t,n,o=1,i="",r=999){try{if(!this.success)throw Error("Query Transaction Expired");const c=yield(0,Jt.F)(e,t,n,o,i,r,this.actions);return yield this.markAction(),c}catch(e){throw console.log(e),this.success=!1,e}}))}CreateConnection(e,t,n){return yo(this,void 0,void 0,(function*(){try{if(!this.success)throw Error("Query Transaction Expired");const o=yield(0,Jt.d)(e,t,n,this.actions);return yield this.markAction(),o}catch(e){throw console.log(e),this.success=!1,e}}))}CreateConnectionBetweenEntityLocal(e,t,n){return yo(this,void 0,void 0,(function*(){try{if(!this.success)throw Error("Query Transaction Expired");const o=yield Ro(e,t,n,this.actions);return yield this.markAction(),o}catch(e){throw console.log(e),this.success=!1,e}}))}CreateTheCompositionLocal(e){return yo(this,arguments,void 0,(function*(e,t=null,n=null,o=null,i=null,r=null,c=null,s=!1){try{if(!this.success)throw Error("Query Transaction Expired");const a=yield(0,U.R)(e,t,n,o,i,r,c,s,this.actions);return yield this.markAction(),a}catch(e){throw console.log(e),this.success=!1,e}}))}}const mo={number:/^\d+(\.\d+)?$/,text:/^[\s\S]*$/,textOnly:/^[A-Za-z\s]+$/,email:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,document:/\.(pdf|docx?|pptx?|xlsx?)$/i,sound:/\.(mp3|wav|ogg|flac)$/i,image:/\.(jpg|jpeg|png|gif|bmp|svg|webp)$/i,video:/\.(mp4|avi|mov|mkv|flv|webm)$/i,url:/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^(?:[01]\d|2[0-3]):[0-5]\d$/,password:/^.{6,}$/,ipaddress:/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([0-9a-fA-F]{1,4}:){7}([0-9a-fA-F]{1,4})$/,uuid:/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/};var Co=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class To{constructor(){To.cacheInitialized||To.initializeAnomalyParameters()}static initializeAnomalyParameters(){return Co(this,void 0,void 0,(function*(){try{yield To.getAnomalyParameters(),To.refreshCache(),To.cacheInitialized=!0}catch(e){console.error("Error during anomaly parameter initialization:",e)}}))}static getAnomalyParameters(){return Co(this,void 0,void 0,(function*(){const e=Date.now();if(To.anomalyParamsCache&&e-To.lastFetchedTime<To.cacheExpiryThreshold)return console.log("Returning cached anomaly parameters"),To.anomalyParamsCache;try{return yield To.fetchAnomalyParameters()}catch(e){throw console.error("Error fetching anomaly parameters:",e),e}}))}static fetchAnomalyParameters(){return Co(this,void 0,void 0,(function*(){try{const e=yield fetch("https://devai.freeschema.com/v1/get-frontend-anomaly-parameters",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to fetch anomaly parameters");const t=yield e.json();return To.anomalyParamsCache=t.data,To.lastFetchedTime=Date.now(),t.data}catch(e){throw console.error("API Fetch Error:",e),e}}))}static refreshCache(){return Co(this,void 0,void 0,(function*(){try{Date.now()-To.lastFetchedTime>To.cacheExpiryThreshold&&(yield To.getAnomalyParameters())}catch(e){console.error("Error refreshing anomaly parameters cache:",e)}}))}detectDataType(e){for(const[t,n]of Object.entries(mo))if(n.test(e))return t;return null}checkConceptAnomaly(e,t){return Co(this,void 0,void 0,(function*(){const n=[];try{if(!t)return n.push("Null value"),{valid:!1,warnings:n};const o=To.anomalyParamsCache;e.startsWith("the_")||(e=`the_${e}`);const i=o[e];if(console.log("Concept Details : ",i),!i)return console.warn(`No concept details found for type: ${e}`),n.push(`No concept details found for type: ${e}`),{valid:!1,warnings:n};const r=t.length,{min_length:c,max_length:s,data_types:a}=i,l=r>=c&&r<=s,d=this.detectDataType(t),u=a.includes(d);return l||n.push(`Length of '${t}' is outside the allowed range (min: ${c}, max: ${s}). Current length: ${r}.`),u||n.push(`Type mismatch for '${t}'. Expected types: ${a.join(", ")}, detected type: ${d}.`),l&&u&&n.push(`Concept ${e} is valid. Length: ${r}, Type: ${d}`),{valid:l&&u,warnings:n}}catch(o){return console.error(`Error checking anomaly for ${e} with value ${t}:`,o),{valid:!1,warnings:n}}}))}static checkAnomalyInBulk(e){return Co(this,void 0,void 0,(function*(){To.cacheInitialized||(yield To.initializeAnomalyParameters());try{const t={};for(const[n,o]of Object.entries(e)){const e=o.value,{valid:i,warnings:r}=yield(new To).checkConceptAnomaly(n,e);t[n]={valid:i,warnings:r}}return t}catch(e){throw console.error("Bulk Anomaly Check Error:",e),e}}))}static getExportedFunction(){console.log("Main : ",o);const e=Object.keys(o);return console.log("The exported List : ",e),e}static getFunctionaAnomalyParameters(){}}To.anomalyParamsCache=null,To.cacheInitialized=!1,To.lastFetchedTime=0,To.cacheExpiryThreshold=6e5;var wo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class Io{checkUniqueness(e,t){return wo(this,void 0,void 0,(function*(){const n=ro.V.logfunction("checkUniqueness");e.startsWith("the_")||(e="the_"+e);let o=(yield pe(e,999)).id,i=yield(0,re.A)(t,o);return console.log("This is the concept for validator",i),!(i.id>0||(ro.V.logUpdate(n),0))}))}validateField(e){return wo(this,void 0,void 0,(function*(){var t;const n=ro.V.logfunction("validateField");try{performance.now();const o={},{name:i,value:r,type:c,dataType:s,pattern:a,conceptType:l,maxLength:d,minLength:u,minValue:h,maxValue:p,accept:f,file:v,required:y,isUnique:g}=e;if(console.log("Validation is happening on : \n",e),!y||null!==r&&""!==r||(o.required=`The field ${i} is required.`),s&&r){let e=mo[s];e&&""!==r&&!e.test(r)&&(o.dataType=`Invalid value for ${s}`)}if(a&&r){const e="string"==typeof a?new RegExp(a):a;""===r||e.test(r)||(o.pattern="Pattern doesn't match with value")}if(r&&null!=d&&r.length>d&&(o.maxLength=`Length exceeds the maximum length of ${d}`),r&&null!=u&&r.length<u&&(o.minLength=`Length must be at least ${u} characters long`),null!=h&&r&&!isNaN(Number(r))&&Number(r)<h&&(o.minValue=`Value must be greater than or equal to ${h}`),null!=p&&r&&!isNaN(Number(r))&&Number(r)>p&&(o.maxValue=`Value must be less than or equal to ${p}`),v&&c&&f){const e=f.split(",").map((e=>e.trim().toLowerCase())),n=null===(t=v.name.split(".").pop())||void 0===t?void 0:t.toLowerCase();n&&!e.includes(n)&&(o.accept=`File must be a valid file type: ${e.join(", ")}`)}return l&&g&&r&&((yield this.checkUniqueness(l,r))||(o.unique="Value is not unique")),ro.V.logUpdate(n),console.log("Before Validation Result : ",o),o}catch(e){throw(0,u.ey)(n,"Validator.validateField",e),e}}))}validateForm(e){return wo(this,void 0,void 0,(function*(){const t=ro.V.logfunction("validateForm");try{performance.now();const n={};for(const t in e){const o=yield this.validateField(e[t]);Object.keys(o).length>0&&(n[t]=o)}return ro.V.logUpdate(t),n}catch(e){throw(0,u.ey)(t,"Validator.validateForm",e),e}}))}validate(e){const t=ro.V.logfunction("validate");try{let n={};return this.validateField(e).then((e=>{Object.keys(e).length>0?(n.status=!1,n.details=e):n.status=!0})),console.error("Error on validate object"),ro.V.logUpdate(t),n}catch(e){(0,u.ey)(t,"Validator.validate",e)}}}const ko=e=>{var t;const n=document.getElementsByName(e)[0];if(!n)return console.warn(`Element with NAME "${e}" not found.`),{name:null,value:null,type:null,dataType:null,pattern:null,conceptType:null,maxLength:null,minLength:null,minValue:null,maxValue:null,accept:null,file:null,required:!1,isUnique:!0};const o=n.hasAttribute("required")||"true"===n.getAttribute("data-required"),i=n.hasAttribute("isUnique")&&"true"===n.getAttribute("isUnique");return{name:n.name,value:n.value,type:n.type,dataType:n.getAttribute("data-type"),pattern:n.getAttribute("data-pattern"),conceptType:n.getAttribute("concept-type"),maxLength:n.getAttribute("maxlength")?parseInt(n.getAttribute("maxlength")):null,minLength:n.getAttribute("minlength")?parseInt(n.getAttribute("minlength")):null,minValue:n.getAttribute("min")?parseInt(n.getAttribute("min")):null,maxValue:n.getAttribute("max")?parseInt(n.getAttribute("max")):null,accept:n.getAttribute("accept")||null,file:"file"===n.type&&(null===(t=n.files)||void 0===t?void 0:t[0])||null,required:o,isUnique:i}};var No=n(2289);class Ao{constructor(){this.type="",this.inpage=10,this.page=1,this.concepts=[],this.conceptIds=[],this.selectors=[],this.freeschemaQueries=[],this.filters=[],this.filterLogic="",this.typeConnection="",this.order="DESC",this.outputFormat=In.yv,this.name="",this.filterAncestor="",this.reverse=!1,this.limit=!1,this.isSecure=!1,this.includeInFilter=!1,this.isOldConnectionType=!1}}var Lo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function So(e){var t=arguments;return Lo(this,arguments,void 0,(function*(e,n=""){const o=ro.V.logfunction("FreeschemaQueryApi",t);var i=(0,d.ab)("application/json",n);const r=l.B.FreeschemaQueryUrl(),c=JSON.stringify(e);try{const e=yield fetch(r,{method:"POST",headers:i,body:c});return e.ok?yield e.json():((0,u.ry)(e),console.log("This is the freeschema query error",e.status),[])}catch(e){console.log("This is the freeschema query error others",e),(0,u.Mb)(e,r),(0,u.ey)(o,"FreeschemaQueryApi",e)}}))}var _o=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};class bo extends _n.w{constructor(e,t){super(),this.query=new Ao,this.countInfoStrings=[],this.order="DESC",this.totalCount=0,this.query=e,this.format=e.outputFormat,this.order=e.order}run(){return _o(this,void 0,void 0,(function*(){var e,t;this.query.outputFormat=In.BG,this.compositionIds=[];let n=yield So(this.query,"");return this.conceptIds=n.conceptIds,this.internalConnections=null!==(e=n.internalConnections)&&void 0!==e?e:[],this.linkers=null!==(t=n.linkers)&&void 0!==t?t:[],this.reverse=n.reverse,this.compositionIds=n.mainCompositionIds,this.totalCount=n.mainCount,this.countInfoStrings=n.countinfo,yield this.build()}))}bind(){return _o(this,void 0,void 0,(function*(){var e,t;if(this.compositionIds.length>0)for(let e=0;e<this.compositionIds.length;e++)this.removeListenToEvent(this.compositionIds[e]);if(this.isDataLoaded)for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);else{this.query.outputFormat=In.BG,this.compositionIds=[];let n=yield So(this.query,"");this.conceptIds=n.conceptIds,this.internalConnections=null!==(e=n.internalConnections)&&void 0!==e?e:[],this.linkers=null!==(t=n.linkers)&&void 0!==t?t:[],this.reverse=n.reverse,this.compositionIds=n.mainCompositionIds,this.totalCount=n.mainCount,this.countInfoStrings=n.countinfo}let n=yield this.build();if(!this.isDataLoaded){this.isDataLoaded=!0;for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);if(""!=this.query.type){let e=yield pe(this.query.type,999);e.id>0&&this.listenToEventType(e.id)}}for(let e=0;e<this.newIds.length;e++)this.listenToEvent(this.newIds[e]);return this.newIds=[],n}))}build(){return _o(this,void 0,void 0,(function*(){ro.V.logfunction("build",["schemaquery",this.compositionIds]);let e=(0,$n.w)(this.countInfoStrings);return this.format==In.y0?this.data=yield(0,On.e$)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,e,this.order):this.format==In.ZJ?this.data=yield(0,On.y6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,e,this.order):this.format==In.pU?this.data=yield(0,On.rq)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,e,this.order):this.format==In.XZ?(console.log("this is the raw format"),this.data={},this.data.linkers=this.linkers,this.data.conceptIds=this.conceptIds,this.data.compositionIds=this.compositionIds,this.data.reverse=this.reverse,this.data.countInfos=e,this.data.order=this.order):this.data=yield(0,On.b6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,e),this.data}))}}function Bo(e,t){return new bo(e,t)}function xo(e,t){return new bo(e,t).execute()}class Eo{constructor(){this.id=0,this.name="",this.html="",this.css="",this.js="",this.library={css:[],js:[]},this.assistant={id:"",input:"",type:""},this.timestamp="",this.widgetId=0,this.type="",this.clean="",this.after_render="",this.before_render="",this.custom_functions=[],this.update="",this.origin=0,this.version=0,this.mount_child="",this.children=[],this.wrapper="0",this.widget=new fo}}var Go=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Ro(e,t,n){return Go(this,arguments,void 0,(function*(e,t,n,o={concepts:[],connections:[]}){var i,r,c,s,a;const l=ro.V.logfunction("CreateConnectionBetweenEntityLocal",[e.id,t.id,n]);if(Ti)try{const a=yield bi("CreateConnectionBetweenEntityLocal",{concept1Data:e,concept2Data:t,linker:n,actions:o});return(null===(r=null===(i=null==a?void 0:a.actions)||void 0===i?void 0:i.concepts)||void 0===r?void 0:r.length)&&(o.concepts=JSON.parse(JSON.stringify(a.actions.concepts))),(null===(s=null===(c=null==a?void 0:a.actions)||void 0===c?void 0:c.connections)||void 0===s?void 0:s.length)&&(o.connections=JSON.parse(JSON.stringify(a.actions.connections))),a.data}catch(e){console.log("CreateConnectionBetweenEntityLocal error sw: ",e),Ri(e)}const d=e.userId,u=(null===(a=e.type)||void 0===a?void 0:a.characterValue)+"_"+n,h=yield(0,le.$)(u,999,999,d,o);console.log(yield(0,Jt.F)(e.id,t.id,h.id,1e3,void 0,void 0,o)),ro.V.logUpdate(l)}))}var Do=n(4310);function Uo(e){for(;e.firstChild;)e.removeChild(e.firstChild)}var Oo=n(490),Fo=n(276);class Wo extends ho{constructor(e,t,n,o="",i=10){super(),this.inpage=10,this.selector=t,this.mainType=e,this.filterType=o,this.inpage=i,this.parentDomElement=n,this.mount(this.parentDomElement)}before_render(){this.render()}addFilter(e){if(""!=e){let t=new Kn;t.search=e,t.type=this.filterType,t.logicoperator="like",t.operateon="selector",t.name="selector_filter";let n="( selector_filter )";this.query.filters=[t],this.query.filterLogic=n}else this.query.filters=[],this.query.filterLogic="";console.log("this is the filters",this.query)}after_render(){let e=this.getElementById("selector"),t=this.getElementById("search-bar"),n=this;t.onchange=()=>{n.addFilter(t.value),n.mainDetails.update()};let o=new Ao;o.type=this.mainType,o.inpage=this.inpage;let i=new Ao;i.typeConnection=this.selector,i.name="selector",o.freeschemaQueries=[i],this.query=o,Bo(this.query,"").subscribe(((t,n)=>{let o={};this.mainDetails=n;for(let e=0;e<t.length;e++){let n=t[e],i=n.id,r=n[this.mainType];if(console.log("this is the selected data myItem",r,t[e],this.mainType,n),r){let e=r[this.selector];if(e){const t=Object.values(e)[0];o[i]=t}}}Uo(e);for(const[t,n]of Object.entries(o)){const o=document.createElement("option");o.value=t,o.textContent=n,e.appendChild(o)}console.log("this is the output from selector",t)}))}getHtml(){const e=document.createElement("style");return e.textContent="\n.search-select-wrapper {\n  width: 300px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  font-family: Arial, sans-serif;\n}\n\n#search-bar {\n  padding: 8px;\n  font-size: 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n}\n\n#selector {\n  padding: 6px;\n  font-size: 14px;\n  border: 1px solid #ccc;\n  border-radius: 6px;\n}\n",document.head.prepend(e),this.html='\n        <div class="search-select-wrapper">\n        <input type="text" placeholder="Select or type..." id=\'search-bar\'>\n        <select id=\'selector\'>\n        </div>',this.html}}const Mo='\n/* CKEditor content styles */\n.ck-content {\n  /* Container styles */\n  max-width: 100%;\n  margin: 0 auto;\n  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;\n  line-height: 1.5;\n  padding: 0.75rem;\n  background: #fff;\n  color: #333;\n  border: 1px solid #ccced1;\n}\n\n/* Headings */\n.ck-content h1, .ck-content h2, .ck-content h3, \n.ck-content h4, .ck-content h5, .ck-content h6 {\n  font-weight: 700;\n  line-height: 1.2;\n  margin: 1em 0 0.5em;\n}\n\n.ck-content h1 { font-size: 2.5em; }\n.ck-content h2 { font-size: 2em; }\n.ck-content h3 { font-size: 1.75em; }\n.ck-content h4 { font-size: 1.5em; }\n.ck-content h5 { font-size: 1.25em; }\n.ck-content h6 { font-size: 1em; }\n\n/* Paragraphs and spacing */\n.ck-content p {\n  margin: 1em 0;\n  line-height: 1.6;\n}\n\n/* Links */\n.ck-content a {\n  color: #1a73e8;\n  text-decoration: none;\n}\n\n.ck-content a:hover {\n  text-decoration: underline;\n}\n\n/* Lists */\n.ck-content ul,\n.ck-content ol {\n  padding-left: 2em;\n  margin: 1em 0;\n}\n\n.ck-content ul {\n  list-style: disc;\n}\n\n.ck-content ol {\n  list-style: decimal;\n}\n\n.ck-content li {\n  margin: 0.5em 0;\n}\n\n/* Blockquotes */\n.ck-content blockquote {\n  margin: 1em 0;\n  padding-left: 1em;\n  border-left: 5px solid #ccc;\n  font-style: italic;\n  color: #666;\n}\n\n/* Code blocks */\n.ck-content pre {\n  background: #f5f5f5;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  padding: 1em;\n  margin: 1em 0;\n  overflow-x: auto;\n  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;\n}\n\n.ck-content code {\n  background: #f5f5f5;\n  padding: 0.2em 0.4em;\n  border-radius: 3px;\n  font-size: 0.9em;\n  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;\n}\n\n/* Tables */\n.ck-content table {\n  border-collapse: collapse;\n  width: 100%;\n  margin: 1em 0;\n}\n\n.ck-content table th,\n.ck-content table td {\n  border: 1px solid #ddd;\n  padding: 0.75em;\n  text-align: left;\n}\n\n.ck-content table th {\n  background: #f5f5f5;\n  font-weight: bold;\n}\n\n/* Images */\n.ck-content img {\n  max-width: 100%;\n  height: auto;\n  margin: 1em 0;\n}\n\n.ck-content figure {\n  margin: 1em 0;\n  text-align: center;\n}\n\n.ck-content figure img {\n  margin: 0;\n}\n\n.ck-content figcaption {\n  color: #666;\n  font-size: 0.9em;\n  margin-top: 0.5em;\n}\n\n/* Dark mode */\n/*\n@media (prefers-color-scheme: dark) {\n  .ck-content {\n    background: #1a1a1a;\n    color: #e0e0e0;\n  }\n\n  .ck-content a {\n    color: #64b5f6;\n  }\n\n  .ck-content blockquote {\n    border-left-color: #404040;\n    color: #b0b0b0;\n  }\n\n  .ck-content pre,\n  .ck-content code {\n    background: #2d2d2d;\n    border-color: #404040;\n  }\n\n  .ck-content table th,\n  .ck-content table td {\n    border-color: #404040;\n  }\n\n  .ck-content table th {\n    background: #2d2d2d;\n  }\n\n  .ck-content figcaption {\n    color: #b0b0b0;\n  }\n}\n*/\n\n/* CUSTOM DOCUMENTATION CSS */\n\n#documentation-preview {\n  border: 1px solid #ccc;\n  padding: 1rem;\n}\n\n#documentation-preview h3 {\n  font-size: 1.5rem;\n  margin-bottom: 1rem;\n}\n\n.pre-wrapper {\n  background: #f2f5f9;\n  border: 1px solid #cecece;\n  display: block;\n  padding: 1rem;\n  border-radius: 0.25rem;\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n}\n\n.pre-wrapper pre {\n  margin: 0;\n  color: #e87aa2;\n}\n\n.widget-doc-section pre {\n  background-color: transparent;\n}\n\n.widget-doc-section p {\n  margin: 0;\n}\n\n.widget-doc-section code {\n  color: #e87aa2;\n  font-size: 0.875rem;\n}\n\n.mv-3 {\n  margin-top: 1rem;\n  margin-bottom: 1rem;\n}\n\n.pv-3 {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n}\n\n  .widget-documentation-heading {\n    background-color: #6e757d;\n    color: #eee;\n    font-size: 1.5rem;\n    padding: 0.5rem 1rem;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n  }\n\n  .widget-documentation-heading h4 {\n    margin-bottom: 0;\n  }\n\n  .close-documentation-button {\n    border: none;\n    outline: none;\n    background-color: transparent;\n    line-height: 0;\n    margin: 0;\n    padding: 0;\n    cursor: pointer;\n  }\n\n  .close-documentation-button:hover,\n  .close-documentation-button:focus  {\n    background-color: transparent;\n  }\n\n  .documentation-creator {\n    text-align: right;\n    color: #666;\n    margin: 0;\n    padding-top: 0.5rem;\n    padding-bottom: 0.5rem;\n  }\n\n  .documentation-creator span {\n    font-style: italic;\n  }\n\n  .documentation-attachments {\n    display: flex;\n    flex-wrap: wrap;\n  }\n\n  .documentation-attachments img {\n    width: 25%;\n    height: auto;\n    border: 1px solid #ccc;\n    padding: 0.25rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .documentation-attachments iframe {\n    width: 50%;\n    border: 1px solid #ccc;\n    padding: 0.25rem;\n    margin-top: 0.5rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .widget-documentation-footer {\n    text-align: right;\n    margin-top: 1rem;\n  }\n\n  .widget-documentation-footer button {\n    border-radius: 0;\n    border: none;\n    padding: 0.5rem 1.5rem;\n    text-align: center;\n    background: #6e757d;\n    color: #eee;\n  }\n\n  #widget-details {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n    z-index: 9999;\n  }\n\n  #widget-details button {\n    background: #fff;\n    border: 1px solid #ccc;\n    border-radius: 0 0 0 0.25rem;\n    height: auto;\n    width: auto;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.25rem;\n  }\n\n  #widget-details button:hover, \n  #widget-details button:focus {\n    opacity: 0.75;\n  }\n\n  #widget-details button span {\n    pointer-events: none;\n    font-size: 1rem;\n  }\n\n  #widget-details button svg {\n    pointer-events: none;\n    width: 16px;\n    height: 16px;\n    fill: #999;\n  }\n\n  #widget-documentation-preview-modal {\n    border: none;\n  }\n\n  @media (min-width: 768px) {\n    #widget-documentation-preview-modal {\n      flex: 0 0 auto;\n      width: 66.66666667%;\n    }\n  }\n\n',Po={PAGE_COMP_NAME:"page",WIDGET_COMP_NAME:"widget",PROJECT_COMP_NAME:"project"};var Vo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function jo(e){const t=document.getElementById("fspage-properties");if(!t)return;let n=null==t?void 0:t.textContent;n=n?n.replace(new RegExp(e,"g"),""):"",t.textContent=n}function Ho(e,t){let n=document.querySelector(`meta[name="${e}"]`);n||(n=document.createElement("meta"),n.setAttribute("name",e),document.head.appendChild(n)),n.setAttribute("content",t)}var $o=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function Jo(e){return $o(this,void 0,void 0,(function*(){var t,n,o,i;(null===(n=null===(t=null==e?void 0:e.library)||void 0===t?void 0:t.css)||void 0===n?void 0:n.length)&&function(e){var t;const n=null===(t=null==e?void 0:e.library)||void 0===t?void 0:t.css,o=`vde-css-${(null==e?void 0:e.origin)?null==e?void 0:e.origin:null==e?void 0:e.widgetId}`;(function(e){const t=`link.${e}`,n=document.querySelectorAll(t);(null==n?void 0:n.length)&&(null==n||n.forEach((e=>{e.remove()})))})(o),(null==n?void 0:n.length)&&(null==n||n.sort(((e,t)=>Number(null==e?void 0:e.order)-Number(null==t?void 0:t.order)))),null==n||n.forEach((e=>{const t=document.createElement("link");t.classList.add(o),t.setAttribute("rel","stylesheet"),t.setAttribute("href",e.url),document.head.appendChild(t)}))}(e),(null===(i=null===(o=null==e?void 0:e.library)||void 0===o?void 0:o.js)||void 0===i?void 0:i.length)&&(yield function(e){return $o(this,void 0,void 0,(function*(){var t;const n=null===(t=null==e?void 0:e.library)||void 0===t?void 0:t.js,o=`vde-js-${(null==e?void 0:e.origin)?null==e?void 0:e.origin:null==e?void 0:e.widgetId}`;if(function(e){const t=`script.${e}`,n=document.querySelectorAll(t);(null==n?void 0:n.length)&&(null==n||n.forEach((e=>{e.remove()})))}(o),null==n?void 0:n.length){n.sort(((e,t)=>Number(null==e?void 0:e.order)-Number(null==t?void 0:t.order)));for(const e of n)(null==e?void 0:e.url)?document.querySelector(`script[src="${e.url}"]`)?console.log("Library already loaded:",e.url):yield new Promise(((t,n)=>{const i=document.createElement("script");i.classList.add(o),i.setAttribute("type","text/javascript"),i.setAttribute("src",e.url),i.setAttribute("crossorigin","anonymous"),i.onload=()=>{t()},i.onerror=t=>{console.error("Failed to load script:",e.url,t),n(new Error(`Failed to load script: ${e.url}`))},document.head.appendChild(i)})):console.warn("Skipping library with invalid URL:",e);console.log("All JavaScript libraries loaded successfully")}}))}(e))}))}var zo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function qo(e,t,n,o){return zo(this,void 0,void 0,(function*(){var i;const r=yield jt(e,"the_page_body"),c=new Ao;c.conceptIds=[e],c.inpage=100,c.outputFormat=In.y0,c.selectors=["the_page_body","the_page_title","the_page_slug","the_page_font_family","the_page_font_size","the_page_width","the_page_type","the_page_meta_title","the_page_meta_description","the_page_meta_keywords"],Bo(c,"").subscribe((e=>zo(this,void 0,void 0,(function*(){var t,n;console.log("SchemaQueryListener data --\x3e",e),yield function(e){return Vo(this,void 0,void 0,(function*(){var t,n,o,i,r,c,s,a,l,d,u,h,p,f;[{key:"meta_title",value:null===(n=null===(t=null==e?void 0:e[`the_${Po.PAGE_COMP_NAME}_meta_title`])||void 0===t?void 0:t.data)||void 0===n?void 0:n.the_meta_title},{key:"meta_description",value:null===(i=null===(o=null==e?void 0:e[`the_${Po.PAGE_COMP_NAME}_meta_description`])||void 0===o?void 0:o.data)||void 0===i?void 0:i.the_meta_description},{key:"meta_keywords",value:null===(c=null===(r=null==e?void 0:e[`the_${Po.PAGE_COMP_NAME}_meta_keywords`])||void 0===r?void 0:r.data)||void 0===c?void 0:c.the_meta_keywords},{key:"width",value:null===(a=null===(s=null==e?void 0:e[`the_${Po.PAGE_COMP_NAME}_width`])||void 0===s?void 0:s.data)||void 0===a?void 0:a.the_width},{key:"font_size",value:null===(d=null===(l=null==e?void 0:e[`the_${Po.PAGE_COMP_NAME}_font_size`])||void 0===l?void 0:l.data)||void 0===d?void 0:d.the_font_size},{key:"font_family",value:null===(h=null===(u=null==e?void 0:e[`the_${Po.PAGE_COMP_NAME}_font_family`])||void 0===u?void 0:u.data)||void 0===h?void 0:h.the_font_family},{key:"type",value:null===(f=null===(p=null==e?void 0:e[`the_${Po.PAGE_COMP_NAME}_type`])||void 0===p?void 0:p.data)||void 0===f?void 0:f.the_type}].forEach((e=>{e.value&&function(e,t){Vo(this,void 0,void 0,(function*(){const n=document.getElementById("fspage-properties")||function(){const e=document.createElement("style");return e.id="fspage-properties",document.head.appendChild(e),e}();let o="";switch(e){case"width":jo(".fspage { width: [^;]+ !important; }"),o=t?`.fspage { width: ${t} !important; }`:"";break;case"font_size":jo(".fspage { font-size: [^;]+; }"),o=t?`.fspage { font-size: ${t}px; }`:"";break;case"font_family":jo(".fspage { font-family: [^;]+; }"),o=t?`.fspage { font-family: ${t}; }`:"";break;case"type":jo(".fspage { width: 1200px; margin: 0 auto; }"),jo(".fspage { width: 100%; padding: 0; }"),o="fixed"===t?".fspage { width: 1200px; margin: 0 auto; }":"fluid"===t?".fspage { width: 100%; padding: 0; }":"";break;case"meta_title":document.title=t;break;case"meta_keywords":Ho(e.replace("meta_",""),t);break;case"meta_description":return void Ho(e.replace("meta_",""),t)}n.textContent+=o}))}(e.key,e.value)}))}))}(null===(n=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.data)||void 0===n?void 0:n[`the_${Po.PAGE_COMP_NAME}`])})))),document.getElementById("app").classList.add("fspage");const s=document.head.querySelectorAll("style#mystyleid");Array.from(s).forEach((e=>e.remove())),(null===(i=null==r?void 0:r[0])||void 0===i?void 0:i.id)?yield Qo(r[0].id,t,n,o):t.innerHTML="<h4>Invalid or Page doesn't exist</h4>"}))}function Qo(e,t,n,o){return zo(this,void 0,void 0,(function*(){try{let i=yield(0,Do.qj)(e),r=i.mainId,c=i.data;const s=yield Ko(c,r);return yield Yo(r,s,t,n,o)}catch(e){console.error(`Error Caught Rendering Widget: ${e}`),t.textContent=`Error: ${e.message}`}}))}function Xo(e,t,n,o){return zo(this,void 0,void 0,(function*(){try{const i=yield(0,Do.Cp)(e);return yield Yo(e,i,t,n,o)}catch(e){console.error(`Error Caught Rendering Widget: ${e}`)}}))}function Yo(e,t,n,o){return zo(this,arguments,void 0,(function*(e,t,n,o,i=!0){const r=yield ti(e,[],t);if(!r.name)return void(n.innerHTML="<h4>Invalid or Widget doesn't exist</h4>");const c=n;yield Jo(r);const s=yield ni(r,c,void 0,o),a=Array.from({length:32},(()=>"abcdef"[Math.floor(6*Math.random())])).join("");n.classList.add(`${a}`),n.style.position="relative";const d=document.createElement("style");d.id="mystyleid",d.innerHTML=`\n  .${a} {\n    ${r.css+s.css+Mo} \n  }\n`,r.children.length&&(null==r||r.children.forEach((e=>{var t;const n=null==e?void 0:e.library;((null===(t=null==n?void 0:n.css)||void 0===t?void 0:t.length)||(null==n?void 0:n.js.length))&&Jo(e)}))),document.head.appendChild(d);const u=document.createElement("script");if(u.innerHTML=r.js,c.appendChild(u),i){const e=document.createElement("div");e.id="widget-details",e.innerHTML="",e.innerHTML=`\n        <button class="widget-documentation-btn" widget-id="${(null==r?void 0:r.origin)||(null==r?void 0:r.widgetId)}" class="d-flex align-items-center gap-1" title="Documentation">\n          <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 441 512.02"><path d="M324.87 279.77c32.01 0 61.01 13.01 82.03 34.02 21.09 21 34.1 50.05 34.1 82.1 0 32.06-13.01 61.11-34.02 82.11l-1.32 1.22c-20.92 20.29-49.41 32.8-80.79 32.8-32.06 0-61.1-13.01-82.1-34.02-21.01-21-34.02-50.05-34.02-82.11s13.01-61.1 34.02-82.1c21-21.01 50.04-34.02 82.1-34.02zM243.11 38.08v54.18c.99 12.93 5.5 23.09 13.42 29.85 8.2 7.01 20.46 10.94 36.69 11.23l37.92-.04-88.03-95.22zm91.21 120.49-41.3-.04c-22.49-.35-40.21-6.4-52.9-17.24-13.23-11.31-20.68-27.35-22.19-47.23l-.11-1.74V25.29H62.87c-10.34 0-19.75 4.23-26.55 11.03-6.8 6.8-11.03 16.21-11.03 26.55v336.49c0 10.3 4.25 19.71 11.06 26.52 6.8 6.8 16.22 11.05 26.52 11.05h119.41c2.54 8.79 5.87 17.25 9.92 25.29H62.87c-17.28 0-33.02-7.08-44.41-18.46C7.08 432.37 0 416.64 0 399.36V62.87c0-17.26 7.08-32.98 18.45-44.36C29.89 7.08 45.61 0 62.87 0h173.88c4.11 0 7.76 1.96 10.07 5l109.39 118.34c2.24 2.43 3.34 5.49 3.34 8.55l.03 119.72c-8.18-1.97-16.62-3.25-25.26-3.79v-89.25zm-229.76 54.49c-6.98 0-12.64-5.66-12.64-12.64 0-6.99 5.66-12.65 12.64-12.65h150.49c6.98 0 12.65 5.66 12.65 12.65 0 6.98-5.67 12.64-12.65 12.64H104.56zm0 72.3c-6.98 0-12.64-5.66-12.64-12.65 0-6.98 5.66-12.64 12.64-12.64h142.52c3.71 0 7.05 1.6 9.37 4.15a149.03 149.03 0 0 0-30.54 21.14H104.56zm0 72.3c-6.98 0-12.64-5.66-12.64-12.65 0-6.98 5.66-12.64 12.64-12.64h86.2c-3.82 8.05-6.95 16.51-9.29 25.29h-76.91zm239.61-18.85c7.41 7.43 4.68 18.9-3.05 25.23-7.46 6.01-20.97 8.92-28.68 1.83-7.77-7.23-4.68-18.87 2.76-25.24 7.18-6.05 21.39-9.37 28.97-1.82zm-43.88 95h6.34v-41.33H294.6c0-16.37 30.05-5.74 52.18-11.32v52.65h8.37v17.58h-54.86v-17.58z"/></svg>\n        </button>\n      `,c.appendChild(e);const t=document.createElement("dialog");t.id="widget-documentation-preview-modal",t.className="col-md-8",t.innerHTML="",t.innerHTML='\n        <div class="widget-documentation-heading">\n          <h4>Documentation</h4>\n          <button class="close-documentation-button document-preview-close-button" title="Close">\n            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>\n          </button>\n        </div>\n\n        \x3c!-- <div id="documentation-preview" class="ck-content"></div> --\x3e\n        <div id="documentation-view" class="ck-content"></div>\n\n        <div class="widget-documentation-footer">\n          <button class="document-preview-close-button">Close</button>\n        </div>\n      ',c.appendChild(t);const n=c.querySelectorAll(".widget-documentation-btn");null==n||n.forEach((e=>{e.addEventListener("click",(e=>{const t=null==e?void 0:e.target;!function(e){zo(this,void 0,void 0,(function*(){console.log("openDocumentationPreviewModal widgetId",e);const t=new Ao;t.typeConnection="the_widget_documentation",t.name="documentationText",t.selectors=["the_documentation_text"];const n=new Ao;n.typeConnection="the_widget_s_documentation",n.name="documentationBlank",n.selectors=["the_documentation_text","the_documentation_content","the_documentation_language","the_documentation_doc_title","the_documentation_folder","the_documentation_creator_email","the_documentation_created_by","the_documentation_content","the_documentation_type","the_documentation_s_doc_url","the_documentation_s_image_url","the_documentation_s_video_link","the_documentation_auth_type","the_documentation_bearer_token","the_documentation_method","the_documentation_method_url","the_documentation_username","the_documentation_password","the_documentation_s_json_list","the_documentation_api_script","the_documentation_api_body","the_documentation_code_editor","the_documentation_return"];const o=new Ao;o.typeConnection="the_documentation_s_json_list",o.name="documentationJSON",o.selectors=["the_json_list_key","the_json_list_value"],n.freeschemaQueries=[o];const i=new Ao;i.conceptIds=[e],i.freeschemaQueries=[t,n],i.inpage=100,i.outputFormat=In.y0,yield Bo(i,"").subscribe((t=>zo(this,void 0,void 0,(function*(){var n,o,i,r,c,s,a,d,u,h,p;let f;console.log("widget documentation preview data ->",t);const v=(null===(d=null===(a=null===(s=null===(c=null===(r=null===(i=null===(o=null===(n=null==t?void 0:t[0])||void 0===n?void 0:n.data)||void 0===o?void 0:o.the_widget)||void 0===i?void 0:i.the_widget_documentation)||void 0===r?void 0:r.data)||void 0===c?void 0:c.the_documentation)||void 0===s?void 0:s.the_documentation_text)||void 0===a?void 0:a.data)||void 0===d?void 0:d.the_text)||"";v&&(f=v);const y=null===(p=null===(h=null===(u=null==t?void 0:t[0])||void 0===u?void 0:u.data)||void 0===h?void 0:h.the_widget)||void 0===p?void 0:p.the_widget_s_documentation;if(null==y?void 0:y.length){const e=null==y?void 0:y.map((e=>{var t,n,o,i,r,c,s,a,l,d,u,h,p,f,v,y,g,m,C,T,w,I,k,N,A,L,S,_,b,B,x;const E=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.the_documentation,G=null===(o=null===(n=null==E?void 0:E.the_documentation_type)||void 0===n?void 0:n.data)||void 0===o?void 0:o.the_type,R=null===(r=null===(i=null==E?void 0:E.the_documentation_content)||void 0===i?void 0:i.data)||void 0===r?void 0:r.the_content,D=null===(s=null===(c=null==E?void 0:E.the_documentation_creator_email)||void 0===c?void 0:c.data)||void 0===s?void 0:s.the_creator_email,U=null===(l=null===(a=null==E?void 0:E.the_documentation_doc_title)||void 0===a?void 0:a.data)||void 0===l?void 0:l.the_doc_title,O=null===(u=null===(d=null==E?void 0:E.the_documentation_method)||void 0===d?void 0:d.data)||void 0===u?void 0:u.the_method,F=null===(p=null===(h=null==E?void 0:E.the_documentation_method_url)||void 0===h?void 0:h.data)||void 0===p?void 0:p.the_method_url,W=null===(v=null===(f=null==E?void 0:E.the_documentation_bearer_token)||void 0===f?void 0:f.data)||void 0===v?void 0:v.the_bearer_token,M=null===(g=null===(y=null==E?void 0:E.the_documentation_username)||void 0===y?void 0:y.data)||void 0===g?void 0:g.the_username,P=null===(C=null===(m=null==E?void 0:E.the_documentation_password)||void 0===m?void 0:m.data)||void 0===C?void 0:C.the_password,V=null===(w=null===(T=null==E?void 0:E.the_documentation_auth_type)||void 0===T?void 0:T.data)||void 0===w?void 0:w.the_auth_type,j=null==E?void 0:E.the_documentation_s_json_list,H=null===(k=null===(I=null==E?void 0:E.the_documentation_api_script)||void 0===I?void 0:I.data)||void 0===k?void 0:k.the_api_script,$=null===(A=null===(N=null==E?void 0:E.the_documentation_api_body)||void 0===N?void 0:N.data)||void 0===A?void 0:A.the_api_body,J=null===(S=null===(L=null==E?void 0:E.the_documentation_language)||void 0===L?void 0:L.data)||void 0===S?void 0:S.the_language,z=null===(b=null===(_=null==E?void 0:E.the_documentation_return)||void 0===_?void 0:_.data)||void 0===b?void 0:b.the_return,q=null===(x=null===(B=null==E?void 0:E.the_documentation_code_editor)||void 0===B?void 0:B.data)||void 0===x?void 0:x.the_code_editor,Q=null==E?void 0:E.the_documentation_s_doc_url,X=null==E?void 0:E.the_documentation_s_image_url,Y=null==E?void 0:E.the_documentation_s_video_link;let Z={type:G,content:R,creatorEmail:D,title:U};if("blank"===G)Z=Object.assign({},Z);else if("api"===G){const e=[];(null==j?void 0:j.length)&&(null==j||j.forEach((t=>{var n,o,i,r,c,s,a,l;e.push({key:null===(r=null===(i=null===(o=null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.the_json_list)||void 0===o?void 0:o.the_json_list_key)||void 0===i?void 0:i.data)||void 0===r?void 0:r.the_key,value:null===(l=null===(a=null===(s=null===(c=null==t?void 0:t.data)||void 0===c?void 0:c.the_json_list)||void 0===s?void 0:s.the_json_list_value)||void 0===a?void 0:a.data)||void 0===l?void 0:l.the_value})}))),Z=Object.assign(Object.assign({},Z),{method:O,methodURL:F,authType:V,username:M,password:P,bearerToken:W,json:e,script:H,body:$})}else"function"===G&&(Z=Object.assign(Object.assign({},Z),{language:J,return:z,codeEditor:q}));const K=[],ee=[],te=[];return(null==X?void 0:X.length)&&(null==X||X.forEach((e=>{var t;K.push(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.the_image_url)}))),(null==Y?void 0:Y.length)&&(null==Y||Y.forEach((e=>{var t;ee.push(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.the_video_link)}))),(null==Q?void 0:Q.length)&&(null==Q||Q.forEach((e=>{var t;te.push(null===(t=e.data)||void 0===t?void 0:t.the_doc_url)}))),Z=Object.assign(Object.assign({},Z),{imageList:K,linkList:te,videoList:ee}),Z}));f=e}yield function(){return zo(this,void 0,void 0,(function*(){document.getElementById("widget-documentation-preview-modal").showModal()}))}(),function(e,t){zo(this,void 0,void 0,(function*(){const n=document.getElementById("documentation-view");if(0!=l.B.DOCUMENTATION_WIDGET)return void(yield Qo(l.B.DOCUMENTATION_WIDGET,n,{currentWidgetId:t}));const o=document.getElementById("documentation-preview");o.innerHTML="",e&&(null==e?void 0:e.length)&&"string"!=typeof e?null==e||e.forEach((e=>{var t,n,i,r;const c=document.createElement("h3");let s="";switch(null==e?void 0:e.type){case"api":s="API";break;case"function":s="Functions and Classes";break;case"imgAndLink":s="Images and Links";break;default:s=""}c.innerHTML=`\n        ${null==e?void 0:e.title} ${s?"("+s+")":""}\n      `,null==o||o.appendChild(c);const a=document.createElement("div");a.classList.add("widget-doc-content"),(null==e?void 0:e.content)&&(a.innerHTML=e.content,null==o||o.appendChild(a));const l=document.createElement("div");if(l.classList.add("widget-doc-section"),"api"===e.type){let n="";n="basicAuth"===e.authType?`\n            <p>username: <code>${null==e?void 0:e.username}</code></p>\n            <p>password: <code>${null==e?void 0:e.password}</code></p>\n          `:"bearerToken"===e.authType?`\n          <h6>Token: <code>${null==e?void 0:e.bearerToken}</code></h6>\n          `:"None";const o=e.json.map((e=>`${null==e?void 0:e.key}: ${null==e?void 0:e.value}`)).join(", "),i=document.createElement("pre");i.textContent=o,l.innerHTML=`\n          <div class="pv-3">\n            <h6>Method Type: <code>${null==e?void 0:e.method.toUpperCase()}</code></h6>\n            <h6>Endpoint: <code>${null==e?void 0:e.methodURL}</code></h6>\n          </div>\n          <div class="pv-3">\n            <h6>Auth Type: <code>${(null===(t=null==e?void 0:e.authType)||void 0===t?void 0:t.toUpperCase())||""}</code></h6>\n            ${n}\n          </div>\n          <div class="pv-3">\n            <h6>JSON</h6>\n            <code class="pre-wrapper" id="json-list-pre"></code>\n          </div>\n          <div class="pv-3">\n            <h6>Body</h6>\n            ${e.body}\n          </div>\n          <div class="pv-3">\n            <h6>Scripts</h6>\n            ${e.script}\n          </div>\n        `;const r=l.querySelector("#json-list-pre");r&&(r.appendChild(i),r.removeAttribute("id"))}else if("function"===e.type){const t=document.createElement("pre");t.textContent=null==e?void 0:e.codeEditor;const n=document.createElement("pre");n.textContent=null==e?void 0:e.return,l.innerHTML=`\n          <div class="mv-3">\n            <h6>Parameter</h6>\n            <p>Language: ${null==e?void 0:e.language}</p>\n            <code class="pre-wrapper" id="editor-pre"></pre></code>\n            <h6>Returns</h6>\n            <code class="pre-wrapper" id="return-pre"></code>\n          </div>\n        `;const o=l.querySelector("#editor-pre");o&&(o.appendChild(t),o.removeAttribute("id"));const i=l.querySelector("#return-pre");i&&(i.appendChild(n),i.removeAttribute("id"))}const d=document.createElement("div");d.classList.add("mv-3");const u=null===(n=null==e?void 0:e.linkList)||void 0===n?void 0:n.map((e=>`\n            <p>${e}</p>\n          `)).join(""),h=null===(i=null==e?void 0:e.imageList)||void 0===i?void 0:i.map((e=>`\n          <img src="${e}">\n        `)).join(""),p=null===(r=null==e?void 0:e.videoList)||void 0===r?void 0:r.map((e=>`\n            <iframe width="560" height="315" src="${e}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>\n        `)).join(""),f=(null==u?void 0:u.length)?`\n          <div class="mv-3">\n          <h6>Web links</h6>\n          ${u}\n          </div>\n        `:"",v=(null==h?void 0:h.length)?`\n          <h6>Attachments</h6>\n          <div class="documentation-attachments">\n            ${h}\n          </div>\n        `:"",y=(null==p?void 0:p.length)?`\n            <h6>Videos</h6>\n            <div class="documentation-attachments">\n              ${p}\n            </div>\n            `:"";d.innerHTML=`\n        <div class="mv-3">\n          ${f}\n          ${v}\n          ${y}\n        </div>\n        <p class="documentation-creator">- added by: <span>${null==e?void 0:e.creatorEmail}</span></p>\n      `,null==l||l.appendChild(d),null==o||o.appendChild(l)})):void 0!==e&&(o.innerHTML=e)}))}(f,e)}))))}))}(null==t?void 0:t.getAttribute("widget-id"))}))}));const o=c.querySelectorAll(".document-preview-close-button");null==o||o.forEach((e=>{e.addEventListener("click",(()=>{!function(){zo(this,void 0,void 0,(function*(){const e=document.getElementById("widget-documentation-preview-modal"),t=null==e?void 0:e.querySelector("form");null==t||t.reset(),null==e||e.close()}))}()}))}))}return c.querySelectorAll(".wb-initial-empty").forEach((e=>{e.classList.remove("wb-initial-empty")})),document.querySelectorAll('[onclick="widgetSelected(event)"]').forEach((e=>{e.removeAttribute("onclick")})),s}))}function Zo(e,t){return zo(this,void 0,void 0,(function*(){var n,o,i,r,c,s,a,l,d,u,h,p;const f=null===(o=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.the_widget)||void 0===o?void 0:o.the_widget_s_child;if(t.push(e),f&&f.length)for(let e=0;e<f.length;e++){const n=f[e];let o=null===(l=null===(a=null===(s=null===(c=null===(r=null===(i=null==n?void 0:n.data.the_child_widget)||void 0===i?void 0:i.the_child_widget_info)||void 0===r?void 0:r.data)||void 0===c?void 0:c.the_widget)||void 0===s?void 0:s.the_widget_origin)||void 0===a?void 0:a.data)||void 0===l?void 0:l.the_origin;const v=!!(null===(h=null===(u=null===(d=null==n?void 0:n.data)||void 0===d?void 0:d.the_child_widget)||void 0===u?void 0:u.the_child_widget_use_latest)||void 0===h?void 0:h.data);console.log("originIdOfChildWidget",o,n),o=Number(o)||!1;let y=null;if(v&&o){const e=yield(0,Do.qj)(o);y=(null===(p=null==e?void 0:e.data)||void 0===p?void 0:p[0])||[],y.useLatest=!0,n.data.the_child_widget.the_child_widget_info=y}n.data.the_child_widget.the_child_widget_info.sChildId=n.id,yield Zo(n.data.the_child_widget.the_child_widget_info,t)}}))}function Ko(e,t){return zo(this,void 0,void 0,(function*(){const n=[],o=[...e];try{const e=o.find((e=>e.id===t));yield Zo(e,n)}catch(e){console.error("convert to real bulk error",e)}return n}))}function ei(e){return zo(this,arguments,void 0,(function*(e,t=[],n=""){let o=yield(0,Do.Cp)(e);const i=yield Ko(o,e);return yield ti(e,[],i)}))}function ti(e){return zo(this,arguments,void 0,(function*(e,t=[],n,o=""){var i,r,c,s,a,l,d,u,h,p,f,v,y,g,m,C,T,w,I,k,N,A,L,S,_,b,B,x,E,G,R,D,U,O,F,W,M,P,V,j,H,$,J,z,q,Q,X,Y,Z,K,ee,te,ne,oe,ie,re,ce;try{const se=new Eo,ae=(0,Do.ix)(n,e);console.log("getWidgetBulkFromId output ->",ae),t.push(e);const le=null===(i=null==ae?void 0:ae.data)||void 0===i?void 0:i.the_widget;se.name=null===(c=null===(r=null==le?void 0:le.the_widget_name)||void 0===r?void 0:r.data)||void 0===c?void 0:c.the_name,se.html=null===(a=null===(s=null==le?void 0:le.the_widget_html)||void 0===s?void 0:s.data)||void 0===a?void 0:a.the_html,se.css=null===(d=null===(l=null==le?void 0:le.the_widget_css)||void 0===l?void 0:l.data)||void 0===d?void 0:d.the_css,se.js=null===(h=null===(u=null==le?void 0:le.the_widget_js)||void 0===u?void 0:u.data)||void 0===h?void 0:h.the_js,se.origin=Number((null===(f=null===(p=null==le?void 0:le.the_widget_origin)||void 0===p?void 0:p.data)||void 0===f?void 0:f.the_origin)||(null===(y=null===(v=null==le?void 0:le.the_widget_origin)||void 0===v?void 0:v.data)||void 0===y?void 0:y.the_originid)),se.version=null===(m=null===(g=null==le?void 0:le.the_widget_version)||void 0===g?void 0:g.data)||void 0===m?void 0:m.the_version,se.clean=null===(T=null===(C=null==le?void 0:le.the_widget_clean)||void 0===C?void 0:C.data)||void 0===T?void 0:T.the_clean,se.timestamp=null===(I=null===(w=null==le?void 0:le.the_widget_timestamp)||void 0===w?void 0:w.data)||void 0===I?void 0:I.the_timestamp,se.id=null==ae?void 0:ae.id;const de=null===(N=null===(k=null==le?void 0:le.the_widget_type)||void 0===k?void 0:k.data)||void 0===N?void 0:N.the_type;se.type="null"==de||null==de?"the_element_name":de,se.after_render=null===(L=null===(A=null==le?void 0:le.the_widget_after_render)||void 0===A?void 0:A.data)||void 0===L?void 0:L.the_after_render,se.before_render=null===(_=null===(S=null==le?void 0:le.the_widget_before_render)||void 0===S?void 0:S.data)||void 0===_?void 0:_.the_before_render,se.update=null===(B=null===(b=null==le?void 0:le.the_widget_update)||void 0===b?void 0:b.data)||void 0===B?void 0:B.the_update,se.widgetId=e,se.mount_child=null===(E=null===(x=null==le?void 0:le.the_widget_mount_child)||void 0===x?void 0:x.data)||void 0===E?void 0:E.the_mount_child;const ue=null==le?void 0:le.the_widget_s_child;ae.useLatest&&(se.useLatest=!0),ae.sChildId&&(se.sChildId=ae.sChildId);const he=null===(G=null==le?void 0:le.the_widget_s_css_library)||void 0===G?void 0:G.map((e=>{var t,n,o,i,r,c,s,a;return{order:null===(i=null===(o=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.the_css_library)||void 0===n?void 0:n.the_css_library_order)||void 0===o?void 0:o.data)||void 0===i?void 0:i.the_order,url:null===(a=null===(s=null===(c=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.the_css_library)||void 0===c?void 0:c.the_css_library_url)||void 0===s?void 0:s.data)||void 0===a?void 0:a.the_url}})),pe=null===(R=null==le?void 0:le.the_widget_s_js_library)||void 0===R?void 0:R.map((e=>{var t,n,o,i,r,c,s,a;return{order:null===(i=null===(o=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.the_js_library)||void 0===n?void 0:n.the_js_library_order)||void 0===o?void 0:o.data)||void 0===i?void 0:i.the_order,url:null===(a=null===(s=null===(c=null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.the_js_library)||void 0===c?void 0:c.the_js_library_url)||void 0===s?void 0:s.data)||void 0===a?void 0:a.the_url}}));se.library={css:he||[],js:pe||[]};const fe=null===(U=null===(D=null==le?void 0:le.the_widget_assistant)||void 0===D?void 0:D.data)||void 0===U?void 0:U.the_assistant;se.assistant={id:null===(F=null===(O=null==fe?void 0:fe.the_assistant_id)||void 0===O?void 0:O.data)||void 0===F?void 0:F.the_id,input:null===(M=null===(W=null==fe?void 0:fe.the_assistant_input)||void 0===W?void 0:W.data)||void 0===M?void 0:M.the_input,type:null===(V=null===(P=null==fe?void 0:fe.the_assistant_type)||void 0===P?void 0:P.data)||void 0===V?void 0:V.the_type};const ve=null===(j=null==le?void 0:le.the_widget_s_custom_function)||void 0===j?void 0:j.map((e=>{var t,n,o,i,r,c,s;const a=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.the_custom_function;return{id:null==e?void 0:e.id,name:null===(o=null===(n=null==a?void 0:a.the_custom_function_name)||void 0===n?void 0:n.data)||void 0===o?void 0:o.the_name,slug:null===(r=null===(i=null==a?void 0:a.the_custom_function_slug)||void 0===i?void 0:i.data)||void 0===r?void 0:r.the_slug,code:null===(s=null===(c=null==a?void 0:a.the_custom_function_code)||void 0===c?void 0:c.data)||void 0===s?void 0:s.the_code}}));if(console.log("customFunctionList -> ",ve),se.custom_functions=ve,null==ue?void 0:ue.length)for(let e=0;e<ue.length;e++){const i=(null===(J=null===($=null===(H=ue[e])||void 0===H?void 0:H.data.the_child_widget)||void 0===$?void 0:$.the_child_widget_info)||void 0===J?void 0:J.id)||(null===(X=null===(Q=null===(q=null===(z=ue[e])||void 0===z?void 0:z.data.the_child_widget)||void 0===q?void 0:q.the_child_widget_parent)||void 0===Q?void 0:Q.data)||void 0===X?void 0:X.the_parent),r=yield ti(i,t,n,o),c=null===(te=null===(ee=null===(K=null===(Z=null===(Y=ue[e])||void 0===Y?void 0:Y.data)||void 0===Z?void 0:Z.the_child_widget)||void 0===K?void 0:K.the_child_widget_type)||void 0===ee?void 0:ee.data)||void 0===te?void 0:te.the_type,s=null===(ce=null===(re=null===(ie=null===(oe=null===(ne=ue[e])||void 0===ne?void 0:ne.data)||void 0===oe?void 0:oe.the_child_widget)||void 0===ie?void 0:ie.the_child_widget_wrapper)||void 0===re?void 0:re.data)||void 0===ce?void 0:ce.the_wrapper;r.type="null"==c||null==c?"the_element_name":c,r.wrapper=s,se.children.push(r)}return se}catch(e){throw e instanceof Error&&console.error("error converting bulkwidget to widget tree",e.message),e}}))}function ni(e,t){return zo(this,arguments,void 0,(function*(e,t,n=!0,o,i){var r,c;const s=new fo;s.html=e.html,s.widgetType=e.type,s.componentDidMountFunction=e.before_render,s.addEventFunction=e.after_render,s.mountChildWidgetsFunction=e.mount_child,s.widgetState=Object.assign({},i),s.customFunctions=e.custom_functions,o&&(s.data=o),t.innerHTML="";const a=t;if(a&&(yield s.mount(a),e.widget=s,e.children.length>0&&(null===(r=s.childWidgetElement)||void 0===r?void 0:r.length)>0))for(let t=0;t<(null===(c=e.children)||void 0===c?void 0:c.length);t++){const n=e.children[t];for(let e=0;e<s.childWidgetElement.length;e++){const t=s.childWidgetElement[e];if(n.wrapper===t.id){const e=ii(n);n.html=`<div id="${n.wrapper}">${n.html}</div>`;const o=yield ni(e,t,!1,s.data,s.widgetState);s.childWidgets.push(o),s.css=s.css+o.css+`#${t.id} { ${n.css} }`,o.dataChange((e=>{var t;const n=null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.characterValue;n&&(s.childrenData[n]=e)}))}}}return console.log("newWidget ->",s,e),yield ci(t,".widget_container"),s}))}function oi(e,t){return zo(this,arguments,void 0,(function*(e,t,n=!0,o,i){var r,c;let s=new fo;s.html=e.html,s.widgetState=Object.assign({},o),s.widgetType=e.type,s.componentDidMountFunction=e.before_render,s.addEventFunction=e.after_render,s.mountChildWidgetsFunction=e.mount_child,s.customFunctions=e.custom_functions,s.inDevelopment=!1!==i,t.innerHTML="";let a=t;if(a&&(yield s.mount(a),e.widget=s,e.children.length>0&&(null===(r=s.childWidgetElement)||void 0===r?void 0:r.length)>0))for(let t=0;t<(null===(c=e.children)||void 0===c?void 0:c.length);t++){let n=e.children[t];for(let e=0;e<s.childWidgetElement.length;e++){let t=s.childWidgetElement[e];if(n.wrapper===t.id){const e=ii(n),o=yield oi(e,t,!1,s.widgetState,i);s.childWidgets.push(o),s.css=s.css+o.css+`#${t.id} { ${n.css} }`,o.dataChange((e=>{var t;console.log("This is the data change in child",e);let n=null===(t=null==e?void 0:e.type)||void 0===t?void 0:t.characterValue;n&&(s.childrenData[n]=e),console.log("new child data",s.childrenData)}))}}}return console.log("newWidget ->",s,e),s}))}function ii(e){return e.html=e.html.replace(/<[^>]*\bclass=["'][^"']*\bwidget_container\b[^"']*["'][^>]*>/g,(e=>e.replace(/\bwidget_container\b/g,"").trim())),e.html=e.html.replace(/<[^>]*\bdraggable=["'][^"']*\btrue\b[^"']*["'][^>]*>/g,(e=>e.replace(/\btrue\b/g,"false").trim())),e.html=e.html.replace(/<[^>]*\bclass=["'][^"']*\bhover-element\b[^"']*["'][^>]*>/g,(e=>e.replace(/\bhover-element\b/g,"").trim())),e.html=e.html.replace(/<[^>]*\bclass=["'][^"']*\bwb-block\b[^"']*["'][^>]*>/g,(e=>e.replace(/\bwb-block\b/g,"").trim())),e.html=e.html.replace(/<[^>]*onclick="widgetSelected\(event\)"\s*,?\s*ondragover="_dragService\.dragOverWidgetElement\(event\)"\s*,?\s*ondrop="_dragService\.dropWidgetElement\(event\)"\s*,?\s*ondragstart="_dragService\.dragStartWidgetElement\(event\)"\s*,?\s*ondragend="_dragService\.dragEndWidgetElement\(event\)"[^>]*>/g,(e=>e.replace(/onclick="widgetSelected\(event\)"/g,'onclick=""').replace(/ondragover="_dragService\.dragOverWidgetElement\(event\)"/g,'ondragover=""').replace(/ondrop="_dragService\.dropWidgetElement\(event\)"/g,'ondrop=""').replace(/ondragstart="_dragService\.dragStartWidgetElement\(event\)"/g,'ondragstart=""').replace(/ondragend="_dragService\.dragEndWidgetElement\(event\)"/g,'ondragend=""').trim())),e.html=e.html.replace(/<[^>]*\bondragstart=["'][^"']*\b_dragService\.onWidgetDragStart\(event\)\b[^"']*["'][^>]*>/g,(e=>e.replace(/\b_dragService\.onWidgetDragStart\(event\)\b/g,"").trim())),e}function ri(e,t){return zo(this,void 0,void 0,(function*(){return e&&1===e.nodeType&&e.querySelectorAll(t).forEach((e=>{for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.remove()})),e}))}function ci(e,t){return zo(this,void 0,void 0,(function*(){const n=e.querySelectorAll(t);for(const e of n){const n=e.parentElement;if(n){for(;e.firstChild;){const o=yield ri(e.firstChild,t);n.insertBefore(o,e)}n.removeChild(e)}}}))}var si=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function ai(e){return si(this,arguments,void 0,(function*(e,t=null,n="",o={concepts:[],connections:[]}){var i,r,c,s;if(Ti)try{const a=yield bi("CreateData",{json:e,ofConcept:t,typeConcept:n,actions:o});return(null===(r=null===(i=null==a?void 0:a.actions)||void 0===i?void 0:i.concepts)||void 0===r?void 0:r.length)&&(o.concepts=JSON.parse(JSON.stringify(a.actions.concepts))),(null===(s=null===(c=null==a?void 0:a.actions)||void 0===c?void 0:c.connections)||void 0===s?void 0:s.length)&&(o.connections=JSON.parse(JSON.stringify(a.actions.connections))),a.data}catch(e){console.error("CreateTheComposition sw error: ",e),Ri(e)}let a=999,l=999,d=(0,P.o)();for(const i in e){let r=li(i);if("string"!=typeof e[i]&&"number"!=typeof e[i])if(null==t||0==t.id)d=yield(0,K.k)(r,"",!0,a,4,l,void 0,o),Array.isArray(e[i])&&(r=di(r)),yield ai(e[i],d,r,o);else{Array.isArray(e[i])&&(r=ui(r));let c=ui(i),s=yield(0,K.k)(r,"",!0,a,4,l,void 0,o);d=s;let u=pi(n,c),h=yield(0,le.$)(u,l,a,a,o);yield(0,Jt.F)(t.id,s.id,h.id,1e3,h.characterValue,a,o),Array.isArray(e[i])&&(r=di(r)),yield ai(e[i],s,r,o)}else{let r=pi(n,i),c=yield(0,le.$)(r,l,a,a,o),s=yield(0,K.k)(i,e[i].toString(),!1,a,4,l,void 0,o);console.log("this is the type concept in down",c,s),null!=t&&(yield(0,Jt.F)(t.id,s.id,c.id,1e3,r,a,o))}}return d}))}function li(e){return e.startsWith("the_")?e:"the_"+e}function di(e){return e.endsWith("_s")?e:e+"_s"}function ui(e){return e.replace(/_s$/,"")}const hi=e=>/^[+-]?\d+(\.\d+)?$/.test(e);function pi(e,t){return hi(t)?e+"_":e+"_"+function(e){return e.startsWith("the_")?e.slice(4):e}(t)}class fi{constructor(){this.prototype="",this.required=[],this.optional=[],this.field="string",this.childPrototypes=[],this.isCompositional=!1,this.options=[],this.isQueryType=!1,this.querySelector=null,this.concepts=[],this.connections=[],this.addedConcepts=[],this.addedConnections=[]}}function vi(e,t){if(Array.isArray(e)&&Array.isArray(t))for(let n=0;n<t.length;n++)e.push(t[n]);return e}var yi=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};function gi(e){return yi(this,arguments,void 0,(function*(e,t=null){let n=[],o=[],i=[],r=(0,P.o)();try{null==t&&(t=new go,yield t.initialize());let c=[];if(e.isCompositional){if(r=yield function(e,t,n,o){return yi(this,void 0,void 0,(function*(){let i=(0,P.o)(),r=yield o.MakeTheInstanceConceptLocal("the_composition","",!0,999,999,999),c=yield o.MakeTheTypeConceptLocal("the_composition_type",999,999,999),s=yield o.MakeTheTypeConceptLocal(e,999,999,999),a=yield o.CreateTheConnectionLocal(r.id,s.id,c.id,1e3,"the_composition_type");return i=r,t.push(c),t.push(s),n.push(a),i}))}(e.prototype,n,o,t),e.isQueryType){let o=yield function(e,t,n){return yi(this,void 0,void 0,(function*(){let o=[],i=[],r="the_composition_filter_type",c="the_composition_selector",s=yield n.MakeTheTypeConceptLocal(r,999,999,999),a=yield n.MakeTheTypeConceptLocal(c,999,999,999);if(null!=e){let l=yield n.MakeTheTypeConceptLocal(e.selector,999,999,999);o.push(l);let d=yield n.MakeTheTypeConceptLocal(e.filterType,999,999,999);o.push(l),o.push(d);let u=yield n.CreateTheConnectionLocal(t.id,l.id,a.id,1e3,c,999);i.push(u);let h=yield n.CreateTheConnectionLocal(t.id,d.id,s.id,1e3,r,999);i.push(h)}return{concepts:o,connections:i}}))}(e.querySelector,r,t),c=o.concepts;vi(i,o.connections),vi(n,c)}if(e.options.length>0){let o=yield function(e,t,n){return yi(this,void 0,void 0,(function*(){let o=[],i=[],r="the_composition_s_option",c=yield n.MakeTheTypeConceptLocal(r,999,999,999);for(let s=0;s<e.length;s++){let a=e[s].type,l=e[s].value,d=yield n.MakeTheInstanceConceptLocal(a,l,!1,999,999,999);o.push(d);let u=yield n.CreateTheConnectionLocal(t.id,d.id,c.id,1e3,r,999);i.push(u)}return{concepts:o,connections:i}}))}(e.options,r,t),c=o.concepts;vi(i,o.connections),vi(n,c)}}else r=yield function(e,t){return yi(this,void 0,void 0,(function*(){let n=yield(0,z.A)(5124),o=yield t.MakeTheTypeConceptLocal(e,999,999,999),i=yield function(e,t,n,o){return yi(this,void 0,void 0,(function*(){let n=yield o.CreateTheConceptLocal("",t.characterValue,999,e.id,t.id,4,!1);return n.characterValue=t.characterValue,n.typeCharacter=t.characterValue,n.isComposition=!0,n.type=t,n}))}(n,o,0,t);return i}))}(e.prototype,t),i=yield Ci(e.required,r,n,t,!0),c=yield Ci(e.optional,r,n,t),n.push(r);let s=mi(r,!0,!0),a=yield t.MakeTheTypeConceptLocal(s,999,999,999);if(n.push(a),e.childPrototypes.length>0)for(let o=0;o<e.childPrototypes.length;o++){let c=yield gi(e.childPrototypes[o]),l=c.mainConcept,d=c.connections,u=c.concepts,h=yield t.CreateTheConnectionLocal(r.id,l.id,a.id,1e3,s,999);i.push(h),vi(i,d),vi(n,u),n.push(l)}vi(i,c),vi(i,o),vi(n,e.addedConcepts),vi(i,e.addedConnections),e.concepts=n,e.connections=i,console.log("this is the connections",i)}catch(e){null==t||t.rollbackTransaction()}return{concepts:n,connections:i,mainConcept:r}}))}function mi(e,t=!0,n=!1){var o;let i="the_prototype_of_"+(null===(o=e.type)||void 0===o?void 0:o.characterValue);return i+=t?"_requires":"_optional",n&&(i+="_the_composition"),i}function Ci(e,t,n,o){return yi(this,arguments,void 0,(function*(e,t,n,o,i=!1,r=!1){let c=[],s=[],a=mi(t,i,r),l=yield o.MakeTheTypeConceptLocal(a,999,999,999);n.push(l);for(let t=0;t<e.length;t++){let n=yield o.MakeTheTypeConceptLocal(e[t],999,999,999);c.push(n)}for(let e=0;e<c.length;e++){let n=yield o.CreateTheConnectionLocal(t.id,c[e].id,l.id,1e3,a,999);s.push(n)}for(let e=0;e<c.length;e++)n.push(c[e]);return s}))}var Ti,wi=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const Ii=Date.now().toString(36)+Math.random().toString(36).substring(2);let ki=[],Ni=[],Ai=!1;function Li(e){Ai=e}function Si(e="",t){Ge.b.BearerAccessToken=e,Ti&&bi("updateAccessToken",{accessToken:e,session:Ge.b.sessionId})}function _i(){return wi(this,arguments,void 0,(function*(e="",t="",n="",o="",i=!0,c="",s=void 0,a={},d={}){var h;try{l.B.BASE_URL=e,l.B.AI_URL=t,l.B.NODE_URL=o,l.B.BASE_APPLICATION=c,l.B.LOG_SERVER=null!==(h=d.logserver)&&void 0!==h?h:"https://logdev.freeschema.com",console.log("setting the logserver",l.B.LOG_SERVER,d.logserver),Si(n);let i=Math.floor(1e8*Math.random());l.B.setRandomizer(i);const p={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1};if(l.B.FLAGS=p,l.B.FLAGS=Object.assign(Object.assign({},p),a),function(e){const t=ro.V.logfunction("initializeFlags",arguments);try{return e.logApplication&&(co.initialize(),ro.V.logApplicationActivationStatus=!0,console.warn("Application log started.")),e.logPackage&&(ro.V.logPackageActivationStatus=!0,console.warn("Package log started.")),e.accessTracker&&(Be.J.activateStatus=!0,console.warn("Access Tracker Activated.")),e.isTest&&(r.B.isDataLoaded=!0,r.B.isCharacterLoaded=!0,r.B.isTypeLoaded=!0,r.B.isLocalDataLoaded=!0,r.B.isLocalTypeLoaded=!0,r.B.isLocalCharacterLoaded=!0,r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0,r.B.isLocalConnectionLoaded=!0),ro.V.logUpdate(t),e}catch(e){throw(0,u.ey)(t,"initializeFlags",e),e}}(l.B.FLAGS),!("serviceWorker"in navigator))return yield xi(),void console.warn("Service Worker not supported in this browser.");if(yield function(){return wi(this,void 0,void 0,(function*(){var e;let t=sessionStorage.getItem("cacheServers"),n=sessionStorage.getItem("config"),o=null!==(e=sessionStorage.getItem("session"))&&void 0!==e?e:"999",i=parseInt(o);void 0!==t&&"undefined"!==t||(l.B.NODE_CACHE_URL=l.B.BASE_URL),t=JSON.parse(t);const r=JSON.parse(n);t&&r&&r.documentationWidget&&999!=i?(Array.isArray(t)&&t.length?l.B.NODE_CACHE_URL=t[0]:l.B.NODE_CACHE_URL=l.B.BASE_URL,Ge.b.setSession(i),l.B.DOCUMENTATION_WIDGET=r.documentationWidget):yield function(){return wi(this,void 0,void 0,(function*(){let e,t=window.location.hostname;try{if(e=yield fetch(l.B.getAppConfig()+"?application="+t,{method:"POST"}),!e.ok)throw new Error("Failed to sync data to the server.");const n=yield e.json();n.success&&(sessionStorage.setItem("cacheServers",JSON.stringify(n.servers)),sessionStorage.setItem("config",JSON.stringify(n.config)),sessionStorage.setItem("session",n.session),Ge.b.setSession(n.session),n.servers?l.B.NODE_CACHE_URL=n.servers[0]:l.B.NODE_CACHE_URL=l.B.BASE_URL,n.config&&(l.B.DOCUMENTATION_WIDGET=n.config.documentationWidget))}catch(e){console.error("error getting app config from server",e.message)}}))}(),console.log("before the payload in app",Ge.b.sessionId),navigator.serviceWorker&&navigator.serviceWorker.controller&&bi("SESSION_DATA",{type:"SESSION_DATA",data:l.B.NODE_CACHE_URL,session:Ge.b.sessionId})}))}(),function(){navigator.serviceWorker.addEventListener("message",(e=>wi(this,void 0,void 0,(function*(){var t,n,o,i;try{if(e.data&&"API_401"===e.data.type){const{requestDetails:o}=e.data,i={method:o.method,headers:new Headers(o.headers),body:o.body},r=yield fetch(o.url,i),c=yield null==r?void 0:r.json();null===(n=null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||void 0===n||n.postMessage({type:"API_RESPONSE",messageId:e.data.messageId,response:new Response(c,{status:r.status,statusText:r.statusText,headers:r.headers})})}}catch(t){console.error("Error during listenPostMessage",t),null===(i=null===(o=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===o?void 0:o.controller)||void 0===i||i.postMessage({type:"API_RESPONSE",messageId:e.data.messageId})}}))))}(),function(){io.x.addEventListener("message",(e=>wi(this,void 0,void 0,(function*(){const{type:t,payload:n}=e.data;if(!t)return;let o={success:!1,data:void 0};Bi[t]?yield Bi[t](n):console.warn(`Unable to handle "${t}" case in BC service worker`)}))))}(),s&&s.activate&&s.manual)yield new Promise(((e,t)=>{navigator.serviceWorker.ready.then((t=>wi(this,void 0,void 0,(function*(){console.log("registraions ready",t),Ti=t.active,yield Di(),e("done")})))).catch((e=>{console.error("Error: Ready service worker",e),t(e)})).finally((()=>console.log("Finally service worker ready done"))),setTimeout((()=>t("Timeout ready")),3e4)}));else if(s&&(null==s?void 0:s.activate))try{console.log("service worker initialiing"),yield function(e){var t=arguments;return wi(this,void 0,void 0,(function*(){const n=ro.V.logfunction("handleRegisterServiceWorker",t);yield new Promise(((t,o)=>{var i,r;let c=!1;navigator.serviceWorker.register(null!==(i=e.pathToSW)&&void 0!==i?i:"./serviceWorker.bundle.js",{scope:null!==(r=e.scope)&&void 0!==r?r:"/"}).then((e=>wi(this,void 0,void 0,(function*(){console.log("Service Worker registered:",e),setInterval((()=>{Ni.length&&Gi()}),2e3),console.log("update listen start"),e.onupdatefound=()=>{const n=e.installing;console.log("new worker",n),n&&(n.onstatechange=()=>wi(this,void 0,void 0,(function*(){console.warn("on state change triggered",n.state,navigator.serviceWorker.controller),"installing"===n.state&&(console.log("Service Worker installing"),Ti=void 0),"activated"!==n.state&&"redundant"!==n.state||!navigator.serviceWorker.controller||(Ti=n,console.log("New Service Worker is active",e),setTimeout((()=>{console.log("Message Processed after some time"),Gi()}),5e3),yield Di(),c=!0,Gi(),t())})))},e.addEventListener("controllerchange",(()=>wi(this,void 0,void 0,(function*(){console.warn("controller change triggered",navigator.serviceWorker.controller),navigator.serviceWorker.controller&&(Ti=navigator.serviceWorker.controller,console.warn("Service worker has been activated; controller change"),yield Di())})))),(e.installing||e.waiting||e.active)&&e.addEventListener("statechange",(e=>wi(this,void 0,void 0,(function*(){var t;"activating"===(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.state)&&(Ti=navigator.serviceWorker.controller,console.warn("Service Worker is activating statechange"),yield Di())})))),e.active?(console.log("active sw"),Ti=e.active,yield Di(),Gi(),t()):setTimeout((()=>{c||o("Not Completed Initialization")}),1e4)})))).catch((e=>wi(this,void 0,void 0,(function*(){yield xi(),o(e),console.error("Service Worker registration failed:",e),(0,u.ey)(n,"handleRegisterServiceWorker",e)}))))}))}))}(s)}catch(e){yield xi(),console.error("Unable to start service worker",e)}else yield xi(),console.warn("Service Worker not activated");return!0}catch(e){yield xi(),console.warn("Cannot initialize the system",e)}}))}function bi(e,t){return wi(this,arguments,void 0,(function*(e,t,n=0){let o=!1;const i=Math.random().toString(36).substring(2);t.messageId=i,t.TABID=Ii;const r=JSON.parse(JSON.stringify(t));let c;return"checkProcess"!=e&&0==n&&(c=setInterval((()=>wi(this,void 0,void 0,(function*(){if(console.log("process took more than one second",i,e,o),!o&&!(yield function(e,t){return wi(this,void 0,void 0,(function*(){var n;try{const o=yield bi("checkProcess",{checkMessageId:e});if(console.log("check interval data res for type ",t,e,o.data),null===(n=null==o?void 0:o.data)||void 0===n?void 0:n.processing)return!0}catch(n){return console.error("error on checing executing process",t,e,n),!1}}))}(i,e))&&(clearInterval(c),!o)){if(console.log("Failed to handle type "+e+" message not found "+i,"retrying: ",0==n,e),0==n&&"checkProcess"!=e)return console.log("retrying ",e,i),yield bi(e,t,n+1);console.log("Failed to handle type "+e+" "+i)}}))),2e3)),new Promise(((n,s)=>{if(navigator.serviceWorker.controller||Ti||console.log("will go to queue",navigator.serviceWorker.controller,Ti,e),navigator.serviceWorker.controller||Ti){const a=r=>{var l,d,h,p,f,v;(null===(l=null==r?void 0:r.data)||void 0===l?void 0:l.messageId)==i&&(o=!0,clearInterval(c),r.data.success||(401==(null===(d=null==r?void 0:r.data)||void 0===d?void 0:d.status)?s((0,u.ry)(new Response("Unauthorized",{status:401,statusText:null===(h=null==r?void 0:r.data)||void 0===h?void 0:h.statusText}))):500==(null===(p=null==r?void 0:r.data)||void 0===p?void 0:p.status)?s((0,u.Mb)(new Response("Internal Server Error",{status:500,statusText:null===(f=null==r?void 0:r.data)||void 0===f?void 0:f.statusText}))):(console.error("Error in the response from worker:",r),s(`Failed to handle action ${e} ${JSON.stringify(t)}, Response: ${JSON.stringify(r.data)}`))),(null===(v=r.data)||void 0===v?void 0:v.actions)&&(t.actions=JSON.parse(JSON.stringify(r.data.actions))),n(r.data),navigator.serviceWorker.removeEventListener("message",a))};if(navigator.serviceWorker.addEventListener("message",a),navigator.serviceWorker.controller)"checkProcess"!=e&&console.log("sent to sw",e,i),navigator.serviceWorker.controller.postMessage({type:e,payload:r});else if(Ti){console.warn(`controller not found but serviceWorker is available. messageId: ${i}, type: ${e}`);try{Ti.postMessage({type:e,payload:r})}catch(t){console.log("Retrying again on catch service worker",t),Ti.postMessage({type:e,payload:r})}}else console.warn(`Service Worker hasn't loaded yet. messageId: ${i}, type: ${e}`),console.info("ready",navigator.serviceWorker.ready),setTimeout((()=>{console.warn(`Re-Trying after certain time. messageId: ${i}, type: ${e}`),Ti?(console.info("This is triggered "),null==Ti||Ti.postMessage({type:e,payload:t})):(console.log("not ready",e),clearInterval(c),s("Service worker not ready"))}),3e4);setTimeout((()=>{clearInterval(c),s(`No response from service worker after timeout: ${e}`),navigator.serviceWorker.removeEventListener("message",a)}),21e4)}else Ni.push({message:{type:e,payload:r}}),console.log("Message Queued",e,t),console.log(navigator.serviceWorker.controller,Ti,e),"init"==e&&(clearInterval(c),n(null))}))}))}const Bi={GetLinkListener:e=>wi(void 0,void 0,void 0,(function*(){const t=ki.find((t=>t.listenerId==e.listenerId));return null==t||t.callback(e.data),{success:!0}})),dispatchEvent:e=>wi(void 0,void 0,void 0,(function*(){if(Ti){let t=new CustomEvent(e.id||"",e.data);dispatchEvent(t)}return{success:!0}})),checkInit:e=>wi(void 0,void 0,void 0,(function*(){return console.log("service worker init 0"),navigator.serviceWorker.controller&&(console.log("service worker init 1"),Ti=navigator.serviceWorker.controller),yield Di(),{success:!0}}))};function xi(){return wi(this,void 0,void 0,(function*(){yield(0,oo.A)();const e=(new Date).getTime();yield(0,i.A)().then((()=>{let t=(new Date).getTime()-e;console.log("The time taken to prepare concept  data is  ",t)})).catch((e=>{throw e})),yield(0,no.Ay)().then((()=>{let t=(new Date).getTime()-e;console.log("The time taken to prepare local concept  ",t)})).catch((e=>{throw e})),yield(0,to.p)().then((()=>{r.B.isLocalConnectionLoaded=!0})).catch((e=>{throw e})),yield(0,no.xd)().catch((e=>{throw console.log("This is the error in populating binary tree"),e})),yield(0,to.a)().then((()=>{r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0;let t=(new Date).getTime()-e;console.log("The time taken to prepare connections  ",t)})).catch((e=>{throw e}))}))}function Ei(e,t={}){if(Ti||"undefined"!=typeof window){let n=new CustomEvent(`${e}`,t);dispatchEvent(n)}else io.x.postMessage({type:"dispatchEvent",payload:{id:e,data:t}})}function Gi(){return wi(this,void 0,void 0,(function*(){console.log("message queue",Ni);const e=Ni.find((e=>{var t;return"init"==(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.type)}));if(e){console.log("Processing Init Queue poped",null==e?void 0:e.type,e);const t=Ni.indexOf(e);t>-1&&Ni.splice(t,1),yield bi(null==e?void 0:e.type,null==e?void 0:e.payload)}for(console.log("message queue while",Ni);Ni.length>0;){const{message:e,resolve:t,reject:n}=Ni.shift();console.log("Queue poped",e.type,e),yield bi(e.type,e.payload)}}))}const Ri=e=>{if(e instanceof j.z)throw console.error("FreeSchemaResponse Error",e),e;console.error("Service Worker Error",e)};function Di(){return wi(this,void 0,void 0,(function*(){yield bi("init",{url:l.B.BASE_URL,aiurl:l.B.AI_URL,accessToken:Ge.b.BearerAccessToken,nodeUrl:l.B.NODE_URL,enableAi:!1,applicationName:l.B.BASE_APPLICATION,flags:l.B.FLAGS})}))}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o=n(4059),i=n(9635),r=n(205),c=n(3278),s=n(5020),a=n(7887),l=n(7869),d=n(3075),u=n(2803),h=n(7139),p=n(5284),f=n(8939),v=n(6687),y=n(2013),g=n(7876),m=n(1213),C=n(5328),T=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const w={GetConcept:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,h.r)(e.id)}})),GetTheConcept:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetTheConcept)(e.id,e.userId)}})),AddTypeConcept:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,g.K)(e.concept)}})),GetConceptBulk:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConceptBulk)(e.passedConcepts)}})),GetLink:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetLink)(e.id,e.linker,e.inpage,e.page)}})),GetRelation:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetRelation)(e.id,e.relation,e.inpage,e.page,e.reverse)}})),GetRelationRaw:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetRelationRaw)(e.id,e.relation,e.inpage,e.page,e.reverse)}})),GetComposition:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.Nj)(e.id)}})),GetCompositionList:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionList)(e.compositionName,e.userId,e.inpage,e.page)}})),GetCompositionListWithId:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionListWithId)(e.compositionName,e.userId,e.inpage,e.page)}})),GetCompositionById:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.hL)(e.id)}})),GetCompositionWithId:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.yz)(e.id)}})),GetCompositionListAllWithId:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionListAllWithId)(e.compositionName,e.userId,e.inpage,e.page)}})),GetConceptByCharacter:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConceptByCharacter)(e.characterValue)}})),GetConceptByCharacterUpdated:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,y.w)(e.characterValue)}})),GetConceptByCharacterAndType:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConceptByCharacterAndType)(e.characterValue,e.typeId)}})),GetCompositionFromConnectionsWithDataId:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,v.p8)(e.conceptIds,e.connectionIds)}})),GetCompositionFromConnectionsWithDataIdIndex:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,v.Nt)(e.conceptIds,e.connectionIds)}})),GetCompositionConnectionsBetweenTwoConcepts:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,u.x)(e.ofConceptId,e.toConcept,e.mainKey)}})),GetConnectionDataPrefetch:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,v.QL)(e.connectionIds)}})),GetCompositionWithIdFromMemory:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.RW)(e.id)}})),GetCompositionWithIdAndDateFromMemory:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.Ez)(e.id)}})),GetCompositionFromMemory:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.kx)(e.id)}})),GetCompositionFromMemoryNormal:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.XI)(e.id)}})),GetCompositionWithIdFromMemoryNew:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.$N)(e.id)}})),FindConnectionsOfCompositionsBulkInMemory:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,p.B)(e.composition_ids)}})),GetAllTheConnectionsByTypeAndOfTheConcept:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetAllTheConnectionsByTypeAndOfTheConcept)(e.id,e.linker,e.reverse)}})),GetCompositionFromMemoryWithConnections:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,f.JA)(e.id,e.connectionList)}})),GetCompositionFromConnectionsWithIndexFromConnections:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,v.hG)(e.conceptIds,e.connectionIds)}})),GetCompositionFromConnectionsWithDataIdFromConnections:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,v.km)(e.conceptIds,e.connectionIds)}})),GetTheConceptLocal:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,m.f)(e.id)}})),GetCompositionLocal:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionLocal)(e.id)}})),GetCompositionLocalWithId:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionLocalWithId)(e.id)}})),GetCompositionListLocal:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionListLocal)(e.compositionName,e.userId)}})),GetCompositionListLocalWithId:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetCompositionListLocalWithId)(e.compositionName,e.userId)}})),GetConceptByCharacterAndCategoryLocal:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConceptByCharacterAndCategoryLocal)(e.character)}})),ConceptsData__AddConcept:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.AddConcept(e.concept)}})),ConceptsData__AddWidget:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.AddWidget(e.widgetDetails)}})),ConceptsData__RemoveWidget:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.RemoveWidget(e.id)}})),ConceptsData__GetConcept:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.GetConcept(e.id)}})),ConceptsData__GetWidget:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.GetWidget(e.id)}})),ConceptsData__GetConceptsByTypeIdAndUser:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConceptsData.GetConceptsByTypeIdAndUser(e.typeId,e.userId)}})),ConnectionData__GetConnectionByOfTheConceptAndType:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConnectionData.GetConnectionByOfTheConceptAndType(e.ofTheConceptId,e.typeId)}})),ConnectionData__GetConnection:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConnectionData.GetConnection(e.id)}})),ConnectionData__GetConnectionsOfCompositionLocal:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConnectionData.GetConnectionsOfCompositionLocal(e.id)}})),ConnectionData__GetConnectionsOfConcept:e=>T(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.ConnectionData.GetConnectionsOfConcept(e.id)}})),GetLinkListener:e=>T(void 0,void 0,void 0,(function*(){let t=!1;return new Promise(((n,o)=>{(0,C.d)(e.id,e.linker,e.inpage,e.page,e.format).subscribe((o=>{var r,c;t?(console.log("isSubscribed",t),n({success:!0,data:o}),t=!0):(console.log("is not isSubscribed",t),i.x.postMessage({type:"GetLinkListener",payload:{id:null===(r=null==e?void 0:e.listener)||void 0===r?void 0:r.listenerId,listenerId:null===(c=null==e?void 0:e.listener)||void 0===c?void 0:c.listenerId,data:o}}))})).catch((e=>{console.log("Error : ",e),o("Error Occured")}))}))}))};var I=n(1320),k=n(4310),N=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const A={SearchLinkMultipleAll:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.SearchLinkMultipleAll)(e.searchQuery,e.token,e.caller,e.format)}})),RecursiveSearchApi:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApi)(e.composition,e.listLinkers,e.textSearch,e.fullLinkers)}})),RecursiveSearchApiWithInternalConnections:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApiWithInternalConnections)(e.composition,e.listLinkers,e.textSearch)}})),RecursiveSearchApiRaw:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApiRaw)(e.composition,e.listLinkers,e.textSearch,e.fullLinkers)}})),RecursiveSearchApiRawFullLinker:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApiRawFullLinker)(e.composition,e.fullLinkers,e.textSearch)}})),RecursiveSearchApiNewRawFullLinker:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.RecursiveSearchApiNewRawFullLinker)(e.composition,e.fullLinkers,e.textSearch)}})),formatConnectionsDataId:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,I.e$)(e.linkers,e.conceptIds,e.mainCompositionIds,e.reverse,e.countInfos,e.order)}})),formatConnectionsJustId:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,I.y6)(e.linkers,e.conceptIds,e.mainCompositionIds,e.reverse,e.countInfos,e.order)}})),formatConnections:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,I.b6)(e.linkers,e.conceptIds,e.mainCompositionIds,e.reverse,e.countInfos)}})),BuildWidgetFromId:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,k.Cp)(e.id)}})),BuildWidgetFromIdForLatest:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,k.qj)(e.id)}})),BuildWidgetFromCache:e=>N(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,k.xJ)(e.id)}}))};var L=n(1218),S=n(3077),_=n(9975),b=n(5868),B=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const x={MakeTheInstanceConcept:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.MakeTheInstanceConcept)(e.type,e.referent,e.composition,e.userId,e.passedAccessId,e.passedSessionId,e.referentId)}})),MakeTheConceptLocal:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,_.A)(e.referent,e.typeCharacter,e.userId,e.categoryId,e.typeId,e.actions)}})),MakeTheTimestamp:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.MakeTheTimestamp)(e.type,e.referent,e.userId,e.accessId,e.sessionInformationId)}})),CreateTheComposition:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,L.A)(e.json,e.ofTheConceptId,e.ofTheConceptUserId,e.mainKey,e.userId,e.accessId,e.sessionInformationId)}})),MakeTheInstanceConceptLocal:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,b.k)(e.type,e.referent,e.composition,e.userId,e.accessId,e.sessionInformationId,e.referentId,e.actions),actions:e.actions}})),MakeTheTypeConceptLocal:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.MakeTheTypeConceptLocal)(e.typeString,e.sessionId,e.sessionUserId,e.userId,e.actions),actions:e.actions}})),CreateTheConceptLocal:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,S.A)(e.referent,e.typecharacter,e.userId,e.categoryId,e.typeId,e.accessId,e.isComposition,e.referentId,e.actions),actions:e.actions}})),CreateTheCompositionLocal:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.CreateTheCompositionLocal)(e.json,e.ofTheConceptId,e.ofTheConceptUserId,e.mainKey,e.userId,e.accessId,e.sessionInformationId,e.automaticSync,e.actions),actions:e.actions}})),CreateData:e=>B(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.CreateData)(e.json,e.ofConcept,e.typeConcept,e.actions),actions:e.actions}}))};var E=n(3729),G=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const R={UpdateComposition:e=>G(void 0,void 0,void 0,(function*(){return yield(0,o.UpdateComposition)(e.patcherStructure),{success:!0}})),UpdateCompositionLocal:e=>G(void 0,void 0,void 0,(function*(){return yield(0,E.D)(e.patcherStructure,e.actions),{success:!0}}))};var D=n(8095),U=n(4711),O=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const F={GetConnectionById:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConnectionById)(e.id)}})),GetConnectionBulk:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConnectionBulk)(e.connectionIds)}})),GetConnectionOfTheConcept:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConnectionOfTheConcept)(e.typeId,e.ofTheConceptId,e.userId,e.inpage,e.page)}})),GetAllConnectionsOfCompositionBulk:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetAllConnectionsOfCompositionBulk)(e.composition_ids)}})),GetConnectionBetweenTwoConceptsLinker:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.GetConnectionBetweenTwoConceptsLinker)(e.ofTheConcept,e.toTheConcept,e.linker,e.fullLinker,e.forward)}})),CreateConnectionBetweenTwoConcepts:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.CreateConnectionBetweenTwoConcepts)(e.ofTheConcept,e.toTheConcept,e.linker,e.both)}})),CreateConnectionBetweenTwoConceptsLocal:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,D.h)(e.ofTheConcept,e.toTheConcept,e.linker,e.both,e.actions),actions:e.actions}})),CreateTheConnectionLocal:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.CreateTheConnectionLocal)(e.ofTheConceptId,e.toTheConceptId,e.typeId,e.orderId,e.typeString,e.userId,e.actions),actions:e.actions}})),CreateConnection:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,U.d)(e.ofTheConcept,e.toTheConcept,e.connectionTypeString,e.actions),actions:e.actions}})),CreateConnectionBetweenEntityLocal:e=>O(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.CreateConnectionBetweenEntityLocal)(e.concept1Data,e.concept2Data,e.linker,e.actions),actions:e.actions}}))};var W=n(4818),M=n(2289),P=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const V={DeleteConceptById:e=>P(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteConceptById)(e.id)}})),DeleteConnectionById:e=>P(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteConnectionById)(e.id)}})),DeleteUser:e=>P(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteUser)(e.id)}})),DeleteConnectionByType:e=>P(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteConnectionByType)(e.id,e.linker)}})),DeleteConnectionByTypeBulk:e=>P(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,M.L0)(e.id,e.linkers)}})),DeleteConnectionByIdBulk:e=>P(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,W.E)(e.ids)}})),DeleteConceptLocal:e=>P(void 0,void 0,void 0,(function*(){return{success:!0,data:yield(0,o.DeleteConceptLocal)(e.id)}}))};var j=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};const H={SyncData__SyncDataOnline:e=>j(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.SyncData.SyncDataOnline()}})),LocalSyncData__SyncDataOnline:e=>j(void 0,void 0,void 0,(function*(){return console.log("This is the transaction inside syncing",e),{success:!0,data:yield o.LocalSyncData.SyncDataOnline(e.transactionId,void 0,e.withAuth)}})),LocalSyncData__initializeTransaction:e=>j(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.LocalSyncData.initializeTransaction(e.transactionId)}})),LocalSyncData__markTransactionActions:e=>j(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.LocalSyncData.markTransactionActions(e.transactionId,e.actions),actions:e.actions}})),LocalSyncData__rollbackTransaction:e=>j(void 0,void 0,void 0,(function*(){return{success:!0,data:yield o.LocalSyncData.rollbackTransaction(e.transactionId,e.actions),actions:e.actions}}))};var $=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};let J=!1,z=new Map,q=!1,Q=[];const X=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({checkProcess:e=>$(void 0,void 0,void 0,(function*(){return(null==e?void 0:e.checkMessageId)&&Q.includes(null==e?void 0:e.checkMessageId)?{success:!0,data:{processing:!0},name:"init"}:{success:!0,data:{processing:!1},name:"init"}})),init:e=>$(void 0,void 0,void 0,(function*(){return J?(console.warn("Already Initialized"),{success:!0,name:"init"}):(console.log("init has started"),J=!0,console.log("init has set value"),console.log("Payload log in service worker : ",e),yield function(){return $(this,arguments,void 0,(function*(e="",t="",n="",i="",u=!0,h="",p){var f,v;o.BaseUrl.BASE_URL=e,o.BaseUrl.AI_URL=t,o.BaseUrl.NODE_URL=i,o.BaseUrl.BASE_APPLICATION=h,c.b.BearerAccessToken=n;let y=Math.floor(1e8*Math.random());if(console.log("Flags came in init of service worker is ",p),o.BaseUrl.setRandomizer(y),o.BaseUrl.FLAGS=p,null===(f=o.BaseUrl.FLAGS)||void 0===f?void 0:f.isTest)return r.B.isDataLoaded=!0,r.B.isCharacterLoaded=!0,r.B.isTypeLoaded=!0,r.B.isLocalDataLoaded=!0,r.B.isLocalTypeLoaded=!0,r.B.isLocalCharacterLoaded=!0,r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0,r.B.isLocalConnectionLoaded=!0,!0;console.log("This is the base url",o.BaseUrl.BASE_URL,y),console.log("service worker BaseUrl.FLAGS is ",o.BaseUrl.FLAGS),(null===(v=o.BaseUrl.FLAGS)||void 0===v?void 0:v.accessTracker)&&(console.log("From service worker, flag of Access Tracker."),o.AccessTracker.activateStatus=!0,console.log("Access Tracker Activation status from service worker",o.AccessTracker.activateStatus)),yield(0,l.A)();const g=(new Date).getTime();yield(0,s.A)().then((()=>{let e=(new Date).getTime()-g;console.log("The time taken to prepare concept  data is  ",e)})).catch((e=>{throw e})),yield(0,d.Ay)().then((()=>{let e=(new Date).getTime()-g;console.log("The time taken to prepare local concept  ",e)})).catch((e=>{throw e})),yield(0,a.p)().then((()=>{r.B.isLocalConnectionLoaded=!0})).catch((e=>{throw e})),yield(0,d.xd)(),yield(0,a.a)().then((()=>{r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0;let e=(new Date).getTime()-g;console.log("The time taken to prepare connections  ",e)})).catch((e=>{throw e}))}))}(null==e?void 0:e.url,null==e?void 0:e.aiurl,null==e?void 0:e.accessToken,null==e?void 0:e.nodeUrl,null==e?void 0:e.enableAi,null==e?void 0:e.applicationName,null==e?void 0:e.flags),console.log("init has completed"),{success:!0,data:void 0,name:"init"})})),updateAccessToken:e=>$(void 0,void 0,void 0,(function*(){return yield(0,o.updateAccessToken)(e.accessToken,e.session),{success:!0,name:"updateAccessToken"}})),SESSION_DATA:e=>$(void 0,void 0,void 0,(function*(){return console.log("this is the payload",e),o.BaseUrl.NODE_CACHE_URL=e.data,c.b.setSession(e.session),{success:!0,name:"SESSION_DATA"}}))},w),A),x),R),F),V),H),Y=()=>!!J||(i.x.postMessage({type:"checkInit",payload:{}}),!1);var Z=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};self.addEventListener("install",(e=>{console.log("Service Worker installing... sw"),e.waitUntil(self.skipWaiting())})),self.addEventListener("activate",(e=>Z(void 0,void 0,void 0,(function*(){yield(0,o.setHasActivatedSW)(!0),console.log("Service Worker activating... sw"),e.waitUntil(new Promise(((e,t)=>{try{self.clients.claim(),console.log("claimed"),Y(),e(void 0)}catch(e){console.error("Error during service worker activation:",e),t(e)}})))})))),self.addEventListener("fetch",(e=>{e.clientId||e.respondWith(K(e))})),self.addEventListener("message",(e=>{!function(e){$(this,void 0,void 0,(function*(){var t,n;let i={success:!1,data:void 0};const{type:r,payload:c}=e.data,s=c.TABID;let a=!1;try{if(!r||!c.TABID)return;Q.push(c.messageId),"init"==r||Y()||(console.warn("Message received before sw initialization",r,c.messageId),yield new Promise((e=>{console.log("is it stuck here???? type",r,c.messageId);const t=setInterval((()=>{console.log("Interval check 0",J,r,c.messageId),J?(console.log("Interval check 2",J,r,c.messageId),console.log(n,t),clearInterval(t),clearTimeout(n),e(void 0)):console.warn("Watring for init 1:",r)}),200),n=setTimeout((()=>{console.warn("Tried waiting for init but couldn't complete in time: ",r,c.messageId),clearInterval(t),e(void 0)}),9e4)})),console.log("After timeout promise",r,c.messageId,J),J||(console.log("wait failed",J,c.messageId,r),Q=yield Promise.all(Q.filter((e=>e!=c.messageId))),e.source.postMessage(i)),console.log("After timeout promise nice",r,J)),z.has(s)||z.set(s,{concepts:[],connections:[]});let l=z.get(s);if(Array.isArray(null===(t=null==c?void 0:c.actions)||void 0===t?void 0:t.concepts)&&Array.isArray(null===(n=null==c?void 0:c.actions)||void 0===n?void 0:n.connections)||(c.actions={concepts:[],connections:[]},a=!0),"LocalSyncData__SyncDataOnline"==r&&!c.transactionId&&l){console.log("this is the tab syncing for data",c);const e=o.LocalSyncData.SyncDataOnline(void 0,JSON.parse(JSON.stringify(l)),c.withAuth);z.delete(s),l=void 0,console.log("Syncing the tab here",r),i={success:!0,data:yield e,actions:{concepts:[],connections:[]}}}else X[r]?i=yield X[r](c):console.warn(`Unable to handle "${r}" case in service worker`);if(i.messageId=c.messageId,q&&console.warn("Race condition has been met",r),q=!0,l=z.get(s),i.actions&&l){let e={concepts:[...l.concepts,...i.actions.concepts],connections:[...l.connections,...i.actions.connections]};const[t,n]=yield Promise.all([Promise.all(Array.from(new Map(e.concepts.map((e=>[`${e.id}-${e.ghostId}`,e]))).values())),Promise.all(Array.from(new Map(e.connections.map((e=>[`${e.id}-${e.ghostId}`,e]))).values()))]);z.set(s,JSON.parse(JSON.stringify({concepts:t,connections:n})))}q=!1,a&&delete i.actions,Q=yield Promise.all(Q.filter((e=>e!=c.messageId))),e.source.postMessage(i)}catch(t){console.error("Service worker Message Handle Error: ",r,t),401!=(null==t?void 0:t.status)&&500!=(null==t?void 0:t.status)||(i={success:!1,data:{status:t.status,statusText:null==t?void 0:t.url},messageId:c.messageId}),Q=yield Promise.all(Q.filter((e=>e!=c.messageId))),e.source.postMessage(i)}}))}(e)}));const K=e=>Z(void 0,void 0,void 0,(function*(){try{const t=yield fetch(e.request);if(401===t.status){const n=Math.random().toString(36).substring(2);return e.waitUntil(e.source.postMessage({type:"API_401",messageId:n,message:"Unauthorized",payload:{method:e.request.method,url:e.request.url,headers:Array.from(e.request.headers.entries()),body:yield e.request.clone().json()}})),yield new Promise((e=>{console.log("Re resolving 401",t.url),setTimeout((()=>e(t)),6e4),navigator.serviceWorker.addEventListener("message",(o=>{var i,r,c;o.data&&(null===(i=o.data)||void 0===i?void 0:i.messageId)==n&&"API_RESPONSE"===(null===(r=o.data)||void 0===r?void 0:r.type)&&((null===(c=null==o?void 0:o.data)||void 0===c?void 0:c.response)?e(o.data.response):(console.log("Unable to resolve re 401",t.url),e(t)))}))}))}return t}catch(e){throw console.error("Error occured during 401 intercepting",e),e}}));