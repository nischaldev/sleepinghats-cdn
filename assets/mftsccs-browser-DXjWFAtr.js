var zc={1735:(fe,q,m)=>{m.d(q,{J:()=>A});var B,W=m(2290),r=m(3278),f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,[])).next())})};class A{static incrementConcept(s){try{s&&(this.conceptsData[s]=(this.conceptsData[s]||0)+1)}catch{console.error("Failed on increment concept")}}static incrementConnection(s){try{s&&(this.connectionsData[s]=(this.connectionsData[s]||0)+1)}catch{console.error("Failed on increment connection")}}static getTopConcepts(s){return Object.entries(this.conceptsData).map(([i,u])=>[parseInt(i),u]).sort((i,u)=>u[1]-i[1]).slice(0,s)}static getTopConnections(s){return Object.entries(this.connectionsData).map(([i,u])=>[parseInt(i),u]).sort((i,u)=>u[1]-i[1]).slice(0,s)}static saveDataToLocalStorage(){const s={concepts:this.conceptsData,connections:this.connectionsData};localStorage?.setItem(this.accessData,JSON.stringify(s))}static loadDataFromLocalStorage(){const s=localStorage==null?void 0:localStorage.getItem(this.accessData);if(s){const i=JSON.parse(s);this.conceptsData=i.concepts||{},this.connectionsData=i.connections||{}}}static sendToServer(){return f(this,void 0,void 0,function*(){try{yield this.syncToServer()}catch{console.error("Failed to process Access Tracker Sync with Server")}})}static syncToServer(){return f(this,void 0,void 0,function*(){try{if(!Object.keys(this.conceptsData).length&&!Object.keys(this.connectionsData).length)return;const s=r.b.BearerAccessToken;if(!s)return;const i=this.conceptsData&&Object.keys(this.conceptsData).length>0?this.conceptsData:{},u=this.connectionsData&&Object.keys(this.connectionsData).length>0?this.connectionsData:{},v=yield fetch(W.BaseUrl.PostPrefetchConceptConnections(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({concepts:i,connections:u})});if(!v.ok)throw new Error("Failed to sync data to the server.");yield v.json(),this.conceptsData={},this.connectionsData={},this.setNextSyncTime()}catch(s){console.error("Sync error:",s)}})}static setNextSyncTime(){this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS}static startAutoSync(){setInterval(()=>{const s=Date.now();this.nextSyncTime&&s>=this.nextSyncTime&&this.syncNow().catch(console.error)},6e4)}static syncNow(){return f(this,void 0,void 0,function*(){try{this.activateStatus?yield this.syncToServer():console.warn("Access Tracker inactive.")}catch{console.error("Error on sync access tracker")}})}static GetSuggestedConcepts(s){return f(this,void 0,void 0,function*(){try{const i=r.b.BearerAccessToken,u=new URL(W.BaseUrl.GetSuggestedConcepts());s!==void 0&&u.searchParams.append("top",s.toString());const v=yield fetch(u.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});if(!v.ok){const I=yield v.text();throw new Error(`Failed to load concepts: ${v.status} ${v.statusText}. Details: ${I}`)}const T=(yield v.json())||[];return yield this.addConceptToBinaryTree(T.data),T}catch(i){throw i instanceof Error?(console.error("Error fetching suggested concepts:",i.message),new Error("Unable to fetch suggested concepts. Please try again later.")):(console.error("An unexpected error occurred:",i),new Error("An unexpected error occurred while fetching suggested concepts."))}})}static GetSuggestedConnections(s){return f(this,void 0,void 0,function*(){try{const i=r.b.BearerAccessToken,u=new URL(W.BaseUrl.GetSuggestedConnections());s!==void 0&&u.searchParams.append("top",s.toString());const v=yield fetch(u.toString(),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});if(!v.ok){const I=yield v.text();throw new Error(`Failed to load connections: ${v.status} ${v.statusText}. Details: ${I}`)}const T=(yield v.json())||[];return yield this.addConnectionToBinaryTree(T.data),T}catch(i){throw i instanceof Error?(console.error("Error fetching suggested Connections:",i.message),new Error("Unable to fetch suggested connections. Please try again later.")):(console.error("An unexpected error occurred:",i),new Error("An unexpected error occurred while fetching suggested Connections."))}})}static addConceptToBinaryTree(s){return f(this,void 0,void 0,function*(){try{s.forEach(i=>{W.ConceptsData.AddConcept(i)})}catch{console.error("Error on adding Concepts Data into tree")}})}static addConnectionToBinaryTree(s){return f(this,void 0,void 0,function*(){try{s.forEach(i=>{W.ConnectionData.AddConnection(i)})}catch{console.error("Error on adding Connections Data into tree")}})}}B=A,A.conceptsData={},A.connectionsData={},A.SYNC_INTERVAL_MS=12e4,A.nextSyncTime=Date.now(),A.activateStatus=!1,A.accessData="Access Data",B.startAutoSync()},1167:(fe,q,m)=>{m.d(q,{Y:()=>N});var B=m(9581),W=m(3518),r=m(2290),f=m(1863),A=function(s,i,u,v){return new(u||(u=Promise))(function(T,I){function S(a){try{l(v.next(a))}catch(h){I(h)}}function d(a){try{l(v.throw(a))}catch(h){I(h)}}function l(a){var h;a.done?T(a.value):(h=a.value,h instanceof u?h:new u(function(k){k(h)})).then(S,d)}l((v=v.apply(s,[])).next())})};function N(s){return A(this,void 0,void 0,function*(){const i=r.Logger.logfunction("CreateTheConceptApi",s);let u=(0,r.CreateDefaultConcept)();try{var v=(0,W.Xr)();const T=yield fetch(B.B.CreateTheConceptUrl(),{method:"POST",headers:v,body:JSON.stringify(s)});if(!T.ok)throw(0,f.ry)(T),new Error(`Error! status: ${T.status}`);return u=yield T.json(),r.Logger.logUpdate(i),u}catch(T){T instanceof Error?console.log("Create the concept api error message: ",T.message):console.log("Create the concept api unexpected error: ",T),(0,f.Mb)(T,B.B.CreateTheConceptUrl()),(0,f.ey)(i,"CreateTheConceptApi",T)}})}},2:(fe,q,m)=>{m.d(q,{s:()=>i});var B=m(8286),W=m(9581),r=m(1412),f=m(3518),A=m(1863),N=m(2290),s=function(v,T,I,S){return new(I||(I=Promise))(function(d,l){function a(w){try{k(S.next(w))}catch(L){l(L)}}function h(w){try{k(S.throw(w))}catch(L){l(L)}}function k(w){var L;w.done?d(w.value):(L=w.value,L instanceof I?L:new I(function(x){x(L)})).then(a,h)}k((S=S.apply(v,[])).next())})};function i(v){var T=arguments;return s(this,void 0,void 0,function*(){const I=N.Logger.logfunction("GetAllConnectionsOfComposition",T);var S=[];if((S=yield B.d.GetConnectionsOfConcept(v)).length==0)S=yield u(v);else{var d=yield u(v);(0,r.e)(d,S),S=d}return N.Logger.logUpdate(I),S})}function u(v){var T=arguments;return s(this,void 0,void 0,function*(){const I=N.Logger.logfunction("GetAllConnectionsOfCompositionOnline",T);var S=[];try{(0,f.Xr)("application/json");const l=new Headers,a=new FormData;a.append("composition_id",v.toString());const h=yield fetch(W.B.GetAllConnectionsOfCompositionUrl(),{method:"POST",headers:l,body:a});if(console.log("this is getting connection from online",W.B.GetAllConnectionsOfCompositionUrl(),v),!h.ok)throw(0,A.ry)(h),new Error(`Error! status: ${h.status}`);const k=yield h.json();for(var d=0;d<k.length;d++)B.d.AddConnection(k[d]),S.push(k[d]);return N.Logger.logUpdate(I),S}catch(l){l instanceof Error?console.log("Get all connection of composition error : ",l.message):console.log("Get all connection of composition error : ",l),(0,A.Mb)(l,W.B.GetAllConnectionsOfCompositionUrl()),(0,A.ey)(I,"GetAllConnectionsOfCompositionOnline",l)}})}},8642:(fe,q,m)=>{m.d(q,{Y:()=>v});var B=m(8286),W=m(9581),r=m(4364),f=m(5284),A=m(1412),N=m(3518),s=m(1863),i=m(2290),u=function(T,I,S,d){return new(S||(S=Promise))(function(l,a){function h(L){try{w(d.next(L))}catch(x){a(x)}}function k(L){try{w(d.throw(L))}catch(x){a(x)}}function w(L){var x;L.done?l(L.value):(x=L.value,x instanceof S?x:new S(function(b){b(x)})).then(h,k)}w((d=d.apply(T,I||[])).next())})};function v(){var T=arguments;return u(this,arguments,void 0,function*(I=[]){const S=i.Logger.logfunction("GetAllConnectionsOfCompositionBulk",T)||{};if(i.serviceWorker){S.serviceWorker=!0;try{const h=yield(0,i.sendMessage)("GetAllConnectionsOfCompositionBulk",{composition_ids:I});return i.Logger.logUpdate(S),h.data}catch(h){console.error("GetAllConnectionsOfCompositionBulk sw error: ",h),(0,s.ey)(S,"GetAllConnectionsOfCompositionBulk",h),(0,i.handleServiceWorkerException)(h)}}var d=[];if(I.length<=0)return d;var l=yield(0,f.B)(I),a=yield function(){var h=arguments;return u(this,arguments,void 0,function*(k=[]){const w=i.Logger.logfunction("GetAllConnectionsOfCompositionOnline",h);var L=[];try{var x=(0,N.Xr)();const R=yield fetch(W.B.GetAllConnectionsOfCompositionBulkUrl(),{method:"POST",headers:x,body:JSON.stringify(k)});if(R.ok){const D=yield R.json();for(var b=0;b<D.length;b++)B.d.AddConnection(D[b]),L.push(D[b])}else console.log("Get all connections of composition bulk error message: ","Cannot get response"),(0,s.ry)(R);return i.Logger.logUpdate(w),L}catch(R){R instanceof Error?console.log("Get all connections of composition bulk error message: ",R.message):console.log("Get all connections of composition bulk unexpected error: ",R),(0,s.Mb)(R,W.B.GetAllConnectionsOfCompositionBulkUrl()),(0,s.ey)(w,"GetAllConnectionsOfCompositionOnline",R)}})}(I);return d=a,(0,A.e)(d,l),yield(0,r.s)(d),i.Logger.logUpdate(S),d})}},8675:(fe,q,m)=>{m.d(q,{l:()=>A});var B=m(1863),W=m(3518),r=m(2290),f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,[])).next())})};function A(N){var s=arguments;return f(this,void 0,void 0,function*(){r.Logger.logfunction("GetAllLinkerConnectionsFromTheConcept",s);var i=[];try{new Date().getTime();var u=(0,W.Xr)("application/x-www-form-urlencoded");const I=yield fetch(r.BaseUrl.GetAllLinkerConnectionOfConceptUrl()+`?conceptId=${N}`,{method:"GET",headers:u});if(I.ok){const S=yield I.json();for(var v=0;v<S.length;v++){var T=S[v];i.push(T)}}else console.log("Get all linker connection from the concepts error","cannot get respone"),(0,B.ry)(I)}catch(I){I instanceof Error?console.log("Get all linker connection from the concepts error: ",I.message):console.log("Get all linker connection from the concepts error(Unexpected): ",I),(0,B.Mb)(I,r.BaseUrl.GetAllLinkerConnectionOfConceptUrl())}return i})}},6058:(fe,q,m)=>{m.d(q,{W:()=>A});var B=m(1863),W=m(3518),r=m(2290),f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,[])).next())})};function A(N){var s=arguments;return f(this,void 0,void 0,function*(){const i=r.Logger.logfunction("GetAllLinkerConnectionsToTheConcept",s);var u=[];try{new Date().getTime();var v=(0,W.Xr)("application/x-www-form-urlencoded");const S=yield fetch(r.BaseUrl.GetAllLinkerConnectionToConceptUrl()+`?conceptId=${N}`,{method:"GET",headers:v});if(S.ok){const d=yield S.json();for(var T=0;T<d.length;T++){var I=d[T];u.push(I)}r.Logger.logUpdate(i)}else console.log("Get all linker connection To the concepts error","cannot get respone"),(0,B.ry)(S)}catch(S){S instanceof Error?console.log("Get all linker connection To the concepts error: ",S.message):console.log("Get all linker connection To the concepts error(Unexpected): ",S),(0,B.Mb)(S,r.BaseUrl.GetAllLinkerConnectionToConceptUrl()),(0,B.ey)(i,"GetAllLinkerConnectionsToTheConcept",S)}return u})}},2803:(fe,q,m)=>{m.d(q,{x:()=>N});var B=m(8286),W=m(9581),r=m(1863),f=m(2290),A=function(s,i,u,v){return new(u||(u=Promise))(function(T,I){function S(a){try{l(v.next(a))}catch(h){I(h)}}function d(a){try{l(v.throw(a))}catch(h){I(h)}}function l(a){var h;a.done?T(a.value):(h=a.value,h instanceof u?h:new u(function(k){k(h)})).then(S,d)}l((v=v.apply(s,[])).next())})};function N(s,i,u){var v=arguments;return A(this,void 0,void 0,function*(){const T=f.Logger.logfunction("GetCompositionConnectionsBetweenTwoConcepts",v)||{};var I=[];try{if(f.serviceWorker){T.serviceWorker=!0;try{const a=yield(0,f.sendMessage)("GetCompositionConnectionsBetweenTwoConcepts",{ofConceptId:s,toConcept:i,mainKey:u});return f.Logger.logUpdate(T),a.data}catch(a){console.error("GetCompositionConnectionsBetweenTwoConcepts sw error: ",a),(0,r.ey)(T,"GetCompositionConnectionsBetweenTwoConcepts",a),(0,f.handleServiceWorkerException)(a)}}var S=new FormData;S.append("ofConceptId",s.toString()),S.append("mainKey",u.toString()),S.append("toConceptId",i.toString());const l=yield fetch(W.B.GetCompositionConnectionBetweenTwoConceptsUrl(),{method:"POST",body:S,redirect:"follow"});if(l.ok){const a=yield l.json();for(var d=0;d<a.length;d++)B.d.AddConnection(a[d]),I.push(a[d]);f.Logger.logUpdate(T)}else console.log("Get composition connection between two concepts",l.status),(0,r.ry)(l)}catch(l){l instanceof Error?console.log("Get composition connection between two concepts error message: ",l.message):console.log("Get composition connection between two concepts unexpected error: ",l),(0,r.Mb)(l,W.B.GetCompositionConnectionBetweenTwoConceptsUrl()),(0,r.ey)(T,"GetCompositionConnectionsBetweenTwoConcepts",l)}return I})}},7139:(fe,q,m)=>{m.d(q,{r:()=>i});var B=m(3026),W=m(9581),r=m(2290),f=m(1863),A=m(1596),N=m(3278),s=function(u,v,T,I){return new(T||(T=Promise))(function(S,d){function l(k){try{h(I.next(k))}catch(w){d(w)}}function a(k){try{h(I.throw(k))}catch(w){d(w)}}function h(k){var w;k.done?S(k.value):(w=k.value,w instanceof T?w:new T(function(L){L(w)})).then(l,a)}h((I=I.apply(u,[])).next())})};function i(u){var v=arguments;return s(this,void 0,void 0,function*(){const T=r.Logger.logfunction("GetConcept",v)||{};let I=(0,r.CreateDefaultConcept)();const S=new FormData;S.append("id",u.toString());try{if(r.serviceWorker){T.serviceWorker=!0;try{const a=yield(0,r.sendMessage)("GetConcept",{id:u});return r.Logger.logUpdate(T),a.data}catch(a){console.error("GetConcept sw error: ",a),(0,f.ey)(T,"GetConcept",a),(0,r.handleServiceWorkerException)(a)}}if(u==0||u==null||u==null)return I;var d=yield B.I.GetConcept(u);let l=B.I.GetNpc(u);if(d.id!=0||l)return r.Logger.logUpdate(T),d;{let a;const h={method:"POST",body:S,headers:{Authorization:"Bearer "+N.b.BearerAccessToken}};try{console.log("this is the url",W.B.GetConceptUrl()),a=yield fetch(W.B.GetConceptUrl(),h)}catch{a=yield(0,A.g)(h,"/api/getConcept")}return yield function(k,w,L,x){return s(this,void 0,void 0,function*(){return k.ok?(w=yield k.json()).id>0?B.I.AddConcept(w):B.I.AddNpc(x):(console.log("Get the concept error",k.status),(0,f.ry)(k)),r.Logger.logUpdate(L),w})}(a,I,T,u)}}catch(l){l instanceof Error?console.log("Get the concept error message: ",l.message):console.log("Get the concept unexpected error: ",l),(0,f.Mb)(l,W.B.GetConceptUrl()),(0,f.ey)(T,"GetConcept",l)}})}},1239:(fe,q,m)=>{m.d(q,{I:()=>u,r:()=>i});var B=m(3026),W=m(9581),r=m(3518),f=m(1863),A=m(2290),N=m(1596),s=function(v,T,I,S){return new(I||(I=Promise))(function(d,l){function a(w){try{k(S.next(w))}catch(L){l(L)}}function h(w){try{k(S.throw(w))}catch(L){l(L)}}function k(w){var L;w.done?d(w.value):(L=w.value,L instanceof I?L:new I(function(x){x(L)})).then(a,h)}k((S=S.apply(v,[])).next())})};function i(v){return s(this,void 0,void 0,function*(){const T=A.Logger.logfunction("GetConceptBulk",[v.length])||{};let I=[],S=(new Date().getTime(),performance.now()),d=Array.from(new Set(v));try{if(A.serviceWorker){T.serviceWorker=!0;try{const l=yield(0,A.sendMessage)("GetConceptBulk",{passedConcepts:v});return A.Logger.logUpdate(T),l.data}catch(l){console.error("GetConceptBulk sw error: ",l),(0,f.ey)(T,"GetConceptBulk",l),(0,A.handleServiceWorkerException)(l)}}if(d.length>0){let l=[];for(let a=0;a<d.length;a++)if(!B.I.GetNpc(d[a])){let h=yield B.I.GetConcept(d[a]);h.id==0?l.push(d[a]):I.push(h)}if(l.length==0)return A.Logger.logfunction(T),I;{let a;const h={method:"POST",headers:(0,r.Xr)(),body:JSON.stringify(l)};try{a=yield fetch(W.B.GetConceptBulkUrl(),h)}catch{a=yield(0,N.g)(h,"/api/get_concept_bulk")}yield function(k,w,L,x,b){return s(this,void 0,void 0,function*(){if(k.ok){let R=yield k.json();if(R.length>0)for(let D=0;D<R.length;D++){let H=R[D];B.I.AddConcept(H),L.push(H)}A.Logger.logUpdate(x)}else console.log("Get Concept Bulk error",k.status),A.Logger.logError(b,"unknown","read","unknown",void 0,k.status,k,"GetConceptBulk",[w],"unknown",void 0),(0,f.ry)(k)})}(a,v,I,T,S)}}}catch(l){l instanceof Error?console.log("Get Concept Bulk  error message: ",l.message):console.log("Get Concept Bulk  unexpected error: ",l),A.Logger.logError(S,"unknown","read","unknown",void 0,500,l,"GetConceptBulk",[v],"unknown",void 0),(0,f.Mb)(l,W.B.GetConceptBulkUrl()),(0,f.ey)(T,"GetConceptBulk",l)}return I})}function u(v){return s(this,void 0,void 0,function*(){const T=[];if(v.length>0){const I={"Content-Type":"application/json"};try{const S=yield fetch(W.B.GetConceptBulkUrl(),{method:"POST",headers:I,body:JSON.stringify(v)});if(S.ok){const d=yield S.json();if(d.length>0)for(let l=0;l<d.length;l++){const a=d[l];T.push(a),B.I.AddConcept(a)}}else console.log("bulk concept getter api error: ",S.status),(0,f.ry)(S)}catch(S){S instanceof Error?console.log("bulk concept getter api error: ",S.message):console.log("bulk concept getter api error: ",S),(0,f.Mb)(S,W.B.GetConceptBulkUrl())}}return T})}},4402:(fe,q,m)=>{m.d(q,{A:()=>i});var B=m(3026),W=m(9581),r=m(3518),f=m(1863),A=m(2290),N=m(7876),s=function(u,v,T,I){return new(T||(T=Promise))(function(S,d){function l(k){try{h(I.next(k))}catch(w){d(w)}}function a(k){try{h(I.throw(k))}catch(w){d(w)}}function h(k){var w;k.done?S(k.value):(w=k.value,w instanceof T?w:new T(function(L){L(w)})).then(l,a)}h((I=I.apply(u,[])).next())})};function i(u,v){var T=arguments;return s(this,void 0,void 0,function*(){const I=A.Logger.logfunction("GetConceptByCharacterAndType",T);try{if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetConceptByCharacterAndType",{characterValue:u,typeId:v})).data}catch(h){console.error("GetConceptByCharacterAndType sw error: ",h),(0,A.handleServiceWorkerException)(h)}let a=yield B.I.GetConceptByCharacterAndTypeLocal(u,v);if(a==null||a.id==0){var S={character_value:`${u}`,type_id:v},d=JSON.stringify(S),l=(0,r.Xr)();const h=yield fetch(W.B.GetConceptByCharacterAndTypeUrl(),{method:"POST",headers:l,body:d});h.ok?(a=yield h.json(),(0,N.K)(a).then(w=>{B.I.AddConcept(a)})):((0,f.ry)(h),console.log("This is the concept by type and character error",h.status))}return A.Logger.logUpdate(I),a}catch(a){a instanceof Error?console.log(" This is the concept by type and character error message: ",a.message):console.log(" This is the concept by type and character unexpected error: ",a),(0,f.Mb)(a,W.B.GetConceptByCharacterAndTypeUrl()),(0,f.ey)(I,"GetConceptByCharacterAndType",a)}})}},8146:(fe,q,m)=>{m.d(q,{Y:()=>s});var B=m(3026),W=m(9581),r=m(2290),f=m(1863),A=m(7876),N=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,[])).next())})};function s(i){var u=arguments;return N(this,void 0,void 0,function*(){const v=r.Logger.logfunction("GetConceptByCharacterValue",u);let T=(0,r.CreateDefaultConcept)();try{const I=new FormData;I.append("character_value",i);const S=yield fetch(W.B.GetConceptByCharacterValueUrl(),{method:"POST",body:I});S.ok?(T=yield S.json(),T.id>0&&(0,A.K)(T).then(d=>{B.I.AddConcept(T)}),r.Logger.logUpdate(v)):((0,f.ry)(S),console.log("Error in Getting concept by character value Error",S.status))}catch(I){I instanceof Error?console.log("Error in Getting concept by character value error message: ",I):console.log("Error in Getting concept by character value unexpected error: ",I),(0,f.Mb)(I,W.B.GetConceptByCharacterValueUrl()),(0,f.ey)(v,"GetConceptByCharacterValue",I)}return T})}},7467:(fe,q,m)=>{m.d(q,{j:()=>u});var B=m(8286),W=m(9581),r=m(4364),f=m(3518),A=m(1863),N=m(2290),s=m(1596),i=function(v,T,I,S){return new(I||(I=Promise))(function(d,l){function a(w){try{k(S.next(w))}catch(L){l(L)}}function h(w){try{k(S.throw(w))}catch(L){l(L)}}function k(w){var L;w.done?d(w.value):(L=w.value,L instanceof I?L:new I(function(x){x(L)})).then(a,h)}k((S=S.apply(v,T||[])).next())})};function u(){return i(this,arguments,void 0,function*(v=[]){const T=N.Logger.logfunction("GetConnectionBulk",v.length)||{};let I=[];try{if(N.serviceWorker){T.serviceWorker=!0;try{const S=yield(0,N.sendMessage)("GetConnectionBulk",{connectionIds:v});return N.Logger.logUpdate(T),S.data}catch(S){console.error("GetConnectionBulk sw error: ",S),(0,A.ey)(T,"GetConnectionBulk",S),(0,N.handleServiceWorkerException)(S)}}if(v.length>0){let S=[];for(let d=0;d<v.length;d++)if(!B.d.GetNpConn(v[d])){let l=yield B.d.GetConnection(v[d]);l.id==0?S.push(v[d]):I.push(l)}if(S.length==0)return N.Logger.logUpdate(T),I;{let d;const l={method:"POST",headers:(0,f.Xr)(),body:JSON.stringify(S)};try{d=yield fetch(W.B.GetConnectionBulkUrl(),l)}catch{d=yield(0,s.g)(l,"/api/get_connection_bulk")}yield function(a,h,k){return i(this,void 0,void 0,function*(){if(a.ok){const w=yield a.json();if(w.length>0)for(let L=0;L<w.length;L++){let x=w[L];h.push(x),B.d.AddConnection(x)}}else(0,A.ey)(k,"GetConnectionBulk",a.status),(0,A.ry)(a),console.log("Get Connection Bulk error",a.status)})}(d,I,T),N.Logger.logUpdate(T)}}}catch(S){S instanceof Error?console.log("Get Connection Bulk error message: ",S):console.log("Get Connection Bulk unexpected error: ",S),(0,A.ey)(T,"GetConnectionBulk",S),(0,A.Mb)(S,W.B.GetConnectionBulkUrl())}return yield(0,r.s)(I),I})}},2832:(fe,q,m)=>{m.d(q,{j:()=>N});var B=m(2290),W=m(9581),r=m(1863),f=m(3518),A=function(s,i,u,v){return new(u||(u=Promise))(function(T,I){function S(a){try{l(v.next(a))}catch(h){I(h)}}function d(a){try{l(v.throw(a))}catch(h){I(h)}}function l(a){var h;a.done?T(a.value):(h=a.value,h instanceof u?h:new u(function(k){k(h)})).then(S,d)}l((v=v.apply(s,i||[])).next())})};function N(s){var i=arguments;return A(this,arguments,void 0,function*(u,v=""){const T=B.Logger.logfunction("SearchLinkMultipleApi",i);let I=performance.now();var S=(0,f.ab)("application/json",v);const d=W.B.SearchLinkMultipleAllApiUrl(),l=JSON.stringify(u);try{const a=yield fetch(d,{method:"POST",headers:S,body:l});if(a.ok){let h=yield a.json();return B.Logger.logUpdate(T),h}return(0,r.ry)(a),console.log("This is the searching multiple error",a.status),B.Logger.logError(I,"unknown","search","unknown",void 0,a.status,a,"SearchLinkMultipleApi",[u,v],"unknown",void 0),[]}catch(a){console.log("This is the searching multiple error",a),B.Logger.logError(I,"unknown","search","unknown",void 0,500,a,"SearchLinkMultipleApi",[u,v],"unknown",void 0),(0,r.Mb)(a,d),(0,r.ey)(T,"SearchLinkMultipleApi",a)}})}},3130:(fe,q,m)=>{m.d(q,{BG:()=>N,SL:()=>s,XZ:()=>A,ZJ:()=>r,iw:()=>f,pU:()=>i,y0:()=>W,yv:()=>B});const B=1,W=2,r=3,f=4,A=5,N=6,s=7,i=8},9635:(fe,q,m)=>{m.d(q,{x:()=>B});const B=new BroadcastChannel("Freeschema_mftsccs_browser_channel")},9581:(fe,q,m)=>{m.d(q,{B:()=>B});class B{static setRandomizer(r){console.log("set randomizer",r),this.BASE_RANDOMIZER=r}static getRandomizer(){return this.BASE_RANDOMIZER}static GetConceptUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&typeof this.NODE_CACHE_URL=="string"&&this.NODE_CACHE_URL.trim()===""?this.BASE_URL+"/api/getConcept":this.NODE_CACHE_URL+"/api/getConcept"}static GetConnectionUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&typeof this.NODE_CACHE_URL=="string"&&this.NODE_CACHE_URL.trim()===""?this.BASE_URL+"/api/get-connection-by-id":this.NODE_CACHE_URL+"/api/get-connection-by-id"}static GetConceptBulkUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&typeof this.NODE_CACHE_URL=="string"&&this.NODE_CACHE_URL.trim()===""?this.BASE_URL+"/api/get_concept_bulk":this.NODE_CACHE_URL+"/api/get_concept_bulk"}static GetConnectionBulkUrl(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&typeof this.NODE_CACHE_URL=="string"&&this.NODE_CACHE_URL.trim()===""?this.BASE_URL+"/api/get_connection_bulk":this.NODE_CACHE_URL+"/api/get_connection_bulk"}static GetAllConceptsOfUserUrl(){return this.BASE_URL+"/api/get_all_concepts_of_user"}static GetAllConnectionsOfUserUrl(){return this.BASE_URL+"/api/get_all_connections_of_user"}static GetAllConnectionsOfCompositionUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition"}static GetAllConnectionsOfCompositionBulkUrl(){return this.BASE_URL+"/api/get_all_connections_of_composition_bulk"}static GetConceptByCharacterValueUrl(){return this.BASE_URL+"/api/get_concept_by_character_value"}static GetConceptByCharacterAndTypeUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_type"}static GetConceptByCharacterAndCategoryUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category"}static GetConceptByCharacterAndCategoryDirectUrl(){return this.BASE_URL+"/api/get_concept_by_character_and_category_direct"}static GetCharacterByCharacterUrl(){return this.BASE_URL+"/api/get_character_by_character"}static GetAllConceptsByTypeUrl(){return this.BASE_URL+"/api/get_all_concepts_by_type"}static GetAllConnectionsOfConceptUrl(){return this.BASE_URL+"/api/get-link-connections"}static GetAllConnectionsToConceptUrl(){return this.BASE_URL+"/api/get-link-reverse-connections"}static GetAllAiData(){return this.BASE_URL+"/api/get-preloaded-concepts"}static getAppConfig(){return this.NODE_URL+"/api/v1/config"}static PostPrefetchConceptConnections(){return this.NODE_URL+"/api/v1/access-tracker/sync-access-tracker"}static GetSuggestedConcepts(){return this.NODE_URL+"/api/v1/access-tracker/list-concepts-file"}static GetSuggestedConnections(){return this.NODE_URL+"/api/v1/access-tracker/list-connections-file"}static PostLogger(){return this.LOG_SERVER+"/api/logger"}static GetAllPrefetchConnectionsUrl(){return this.BASE_URL+"/api/get_all_connections_of_user?inpage=500"}static GetAllLinkerConnectionOfConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-from-concept"}static GetAllLinkerConnectionToConceptUrl(){return this.BASE_URL+"/api/get-all-linkers-to-concept"}static DeleteConceptUrl(){return this.BASE_URL+"/api/delete_concept"}static DeleteUserUrl(){return this.BASE_URL+"/api/deleteuser"}static RecursiveSearchUrl(){return this.BASE_URL+"/api/recursivesearch-concept-connection"}static SearchLinkMultipleAllApiUrl(){return this.BASE_URL+"/api/Connection/search-link-multiple-all-ccs"}static MakeTheNameInBackendUrl(){return this.BASE_URL+"/api/make-name-from-frontend"}static SearchAllTypeWithLinker(r=!0){return r?this.BASE_URL+"/api/search-all-with-linker-ccs":this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static LoginUrl(){return this.BASE_URL+"/api/auth/login"}static SignupUrl(){return this.BASE_URL+"/api/auth/signup"}static GetCompositionConnectionBetweenTwoConceptsUrl(){return this.BASE_URL+"/api/get-composition-connection-between-two-concepts"}static SearchCompositionsUrl(){return this.BASE_URL+"/api/search-compositions"}static SearchLinkMultipleAll(){return this.BASE_URL+"/api/Connection/search-link-multiple-all"}static CreateSessionId(){return this.BASE_URL+"/api/create-session-id-remote"}static CreateSessionVisitUrl(){return this.BASE_URL+"/api/create-remote-session-visit"}static ViewInternalDataUrl(){return this.BASE_URL+"/api/view-api-internal-data-ccs-id-bulk"}static SearchInternalWithAuthenticatedCcsUrl(){return this.BASE_URL+"/api/search-composition-internal-authenticated-ccs"}static SearchInternalWithCcsUrl(){return this.BASE_URL+"/api-search-compositions-internal-clean-ccs"}static CreateGhostConceptApiUrl(r=!0){return r?B.NODE_URL+"/api/v1/local-concepts":B.NODE_URL+"/api/v1/local-concepts-without-auth"}static CreateGhostConnectionApiUrl(){return B.NODE_URL+"/api/v1/local-connections"}static GetRealConceptById(){return B.NODE_URL+"/api/v1/local-concepts-translate"}static GetReservedIdUrl(){return this.BASE_URL+"/api/get_reserved_ids"}static GetReservedConnectionIdUrl(){return this.BASE_URL+"/api/get_reserved_connection_ids"}static CreateTheTextDataUrl(){return this.BASE_URL+"/api/create_text_data"}static CreateTheCharacterDataUrl(){return this.BASE_URL+"/api/create_character_data"}static CreateTheConceptUrl(){return this.BASE_URL+"/api/create_the_concept"}static CreateTheConnectionUrl(){return this.BASE_URL+"/api/create_the_connection"}static CreateTheConnectionNewUrl(){return this.BASE_URL+"/api/create_the_connection_new"}static MakeTheTypeConceptUrl(){return this.BASE_URL+"/api/make_the_type_concept"}static DeleteTheConnectionUrl(){return this.BASE_URL+"/api/delete_connection"}static DeleteTheConnectionBulkUrl(){return this.BASE_URL+"/api/delete_connection_bulk"}static FreeschemaQueryUrl(){return this.BASE_URL+"/api/freeschema-query"}static uploadImageUrl(){return this.BASE_URL+"/api/Image/UploadImage"}static uploadImageUrlWithSmall(){return this.BASE_URL+"/api/Image/UploadImageV2"}static uploadFileUrl(){return this.BASE_URL+"/api/Image/UploadFile"}static sendMail(){return this.BASE_URL+"/api/sendmail"}static sendBulkMail(){return this.BASE_URL+"/api/sendmail/bulk"}static getWidgetData(){return this.BASE_URL+"/api/get-widget"}static getLatestWidgetData(){return!this.NODE_CACHE_URL||this.NODE_CACHE_URL&&typeof this.NODE_CACHE_URL=="string"&&this.NODE_CACHE_URL.trim()===""?this.BASE_URL+"/api/get-latest-widget":this.NODE_CACHE_URL+"/api/get-latest-widget"}static getConnectionsByTypes(){return this.BASE_URL+"/api/get-connection-by-types"}static CreatePrototypeUrl(){return this.BASE_URL+"/api/create-prototype"}static GetCachedImage(r){return"https://cdn.boomconcole.com/freeschema/"+r}}B.BASE_URL="https://localhost:7053/",B.NODE_CACHE_URL="",B.AI_URL="https://ai.freeschema.com",B.MQTT_URL="192.168.1.249",B.NODE_URL="http://localhost:5001",B.LOG_SERVER="https://logdev.freeschema.com",B.BASE_APPLICATION="",B.DOCUMENTATION_WIDGET=0,B.isNearestCache=!0,B.FLAGS={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1},B.BASE_RANDOMIZER=999},6963:(fe,q,m)=>{m.d(q,{f:()=>f});var B=m(205),W=m(6731),r=function(A,N,s,i){return new(s||(s=Promise))(function(u,v){function T(d){try{S(i.next(d))}catch(l){v(l)}}function I(d){try{S(i.throw(d))}catch(l){v(l)}}function S(d){var l;d.done?u(d.value):(l=d.value,l instanceof s?l:new s(function(a){a(l)})).then(T,I)}S((i=i.apply(A,[])).next())})};class f{static waitForDataToLoad(){return r(this,void 0,void 0,function*(){return new Promise((N,s)=>{this.checkFlag(N),setTimeout(()=>{s("not")},25e3)})})}static checkFlag(N){if(B.B.isCharacterLoaded)return N("done");setTimeout(f.checkFlag,1e3,N)}static addNodeToTree(N){return r(this,void 0,void 0,function*(){return this.characterRoot==null?(this.characterRoot=N,this.characterRoot):(this.characterRoot=this.characterRoot.addCharacterNode(N,this.characterRoot,this.characterRoot.height),this.characterRoot)})}static removeNodeByCharacter(N,s){return r(this,void 0,void 0,function*(){this.characterRoot&&this.characterRoot.removeNodeWithVariants(this.characterRoot,N,s)})}static countNumberOfNodes(){return this.characterRoot?this.characterRoot.countNodeBelow(this.characterRoot):0}static addConceptToTree(N){if(N.characterValue!=""){var s=new W.b(N.characterValue,N,null,null);this.addNodeToTree(s)}}static getNodeFromTree(N){return this.characterRoot?this.characterRoot.getCharacterFromNode(N,this.characterRoot):this.characterRoot}static getNodeFromTreeUpdated(N){return this.characterRoot?this.characterRoot.getCharacterFromNode(N,this.characterRoot):this.characterRoot}static getCharacterAndTypeFromTree(N,s){return r(this,void 0,void 0,function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndType(N,s,this.characterRoot):this.characterRoot})}static getCharacterAndCategoryFromTree(N,s){return r(this,void 0,void 0,function*(){return this.characterRoot?this.characterRoot.getFromNodeWithCharacterAndCategory(N,s,this.characterRoot):this.characterRoot})}static removeConceptCharacter(N){this.characterRoot&&(this.characterRoot=this.characterRoot.removeNode(this.characterRoot,N))}}f.characterRoot=null},2202:(fe,q,m)=>{m.d(q,{W:()=>N});var B=m(6963),W=m(6731),r=m(205),f=m(2290),A=function(s,i,u,v){return new(u||(u=Promise))(function(T,I){function S(a){try{l(v.next(a))}catch(h){I(h)}}function d(a){try{l(v.throw(a))}catch(h){I(h)}}function l(a){var h;a.done?T(a.value):(h=a.value,h instanceof u?h:new u(function(k){k(h)})).then(S,d)}l((v=v.apply(s,[])).next())})};class N{static addNodeToTree(i){if(this.root==null)return this.root=i,this.root;this.root=this.root.addNode(i,this.root,this.root.height)}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((i,u)=>{this.checkFlag(i),setTimeout(()=>{u("not")},25e3)})})}static checkFlag(i){if(r.B.isDataLoaded)return i("done");setTimeout(N.checkFlag,1e3,i)}static addConceptToTree(i){let u=new W.b(i.id,i,null,null),v=new W.b(i.characterValue,i,null,null);B.f.addNodeToTree(v),this.addNodeToTree(u)}static getNodeFromTree(i){return A(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(i,this.root):null})}static removeNodeFromTree(i){return A(this,void 0,void 0,function*(){if(this.root){let u=new Event(`${i}`);console.log("this is the fired event after delete",u),(0,f.dispatchIdEvent)(i),this.root=this.root.removeNode(this.root,i)}})}static getConceptListFromIds(i,u,v){return A(this,void 0,void 0,function*(){this.root&&this.root.checkIfIdsInNode(this.root,i,u,v)})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}N.root=null},5457:(fe,q,m)=>{m.d(q,{c:()=>N});var B=m(2290),W=m(7282),r=m(205);class f{constructor(i,u){this.value=[],this.height=1,this.key=i,this.value.push(u),this.leftNode=null,this.rightNode=null,this.currentNode=null}addType(i,u,v){var T,I,S,d;if(i==null)return(0,B.dispatchIdEvent)(u,{detail:v}),new f(u,v);if(u<i.key)i.leftNode=this.addType(i.leftNode,u,v);else{if(!(u>i.key))return i.value.includes(v)||((0,B.dispatchIdEvent)(u,{detail:v}),i.value.push(v)),i;i.rightNode=this.addType(i.rightNode,u,v)}i.height=Math.max(this.getHeight(i.leftNode),this.getHeight(i.rightNode))+1;const l=this.getBalanceFactor(i);return l>1&&u<((T=i.leftNode)===null||T===void 0?void 0:T.key)?this.rightRotate(i):l<-1&&u>((I=i.rightNode)===null||I===void 0?void 0:I.key)?this.leftRotate(i):l>1&&u>((S=i.leftNode)===null||S===void 0?void 0:S.key)?(i.leftNode=this.leftRotate(i.leftNode),this.rightRotate(i)):l<-1&&u<((d=i.rightNode)===null||d===void 0?void 0:d.key)?(i.rightNode=this.rightRotate(i.rightNode),this.leftRotate(i)):i}rightRotate(i){if(i){let u=i.leftNode;if(u){let v=u.rightNode;return i.leftNode=v,u.rightNode=i,i.height=Math.max(this.getHeight(i.leftNode),this.getHeight(i.rightNode))+1,u.height=Math.max(this.getHeight(u.leftNode),this.getHeight(u.rightNode))+1,u}}return i}leftRotate(i){if(i){let u=i.rightNode;if(u){let v=u.leftNode;return u.leftNode=i,i.rightNode=v,i.height=Math.max(this.getHeight(i.leftNode),this.getHeight(i.rightNode))+1,u.height=Math.max(this.getHeight(u.leftNode),this.getHeight(i.rightNode))+1,u}}return i}getHeight(i){return i?i.height:0}getBalanceFactor(i){return i==null?0:this.getHeight(i.leftNode)-this.getHeight(i.rightNode)}getFromNode(i,u){return u&&(i==u.key?u:i<u.key?this.getFromNode(i,u.leftNode):i>u.key?this.getFromNode(i,u.rightNode):u)}removeNodeWithVariants(i,u,v){if(i==null)return i;if(i.key>u)return i.leftNode=this.removeNodeWithVariants(i.leftNode,u,v),i;if(i.key<u)return i.rightNode=this.removeNodeWithVariants(i.rightNode,u,v),i;if(i.value.length>0){for(let T=0;T<i.value.length;T++)if(v==i.value[T])return i.value.splice(T,1),i}if(i.leftNode==null){let T=i.rightNode;return i=null,T}if(i.rightNode==null){let T=i.leftNode;return i=null,T}{let T=this.inOrderSuccessor(i.rightNode);return i.value=T.value,i.key=T.key,i.currentNode=T.currentNode,i.rightNode=this.removeNodeWithVariants(i.rightNode,T.key,v),i}}countNodeBelow(i){return i==null?0:1+this.countNodeBelow(i.leftNode)+this.countNodeBelow(i.rightNode)}inOrderSuccessor(i){for(;i.leftNode!=null;)i=i.leftNode;return i}}var A=function(s,i,u,v){return new(u||(u=Promise))(function(T,I){function S(a){try{l(v.next(a))}catch(h){I(h)}}function d(a){try{l(v.throw(a))}catch(h){I(h)}}function l(a){var h;a.done?T(a.value):(h=a.value,h instanceof u?h:new u(function(k){k(h)})).then(S,d)}l((v=v.apply(s,[])).next())})};class N{static addType(i){return A(this,void 0,void 0,function*(){return this.root==null?(this.root=i,new CustomEvent(`${i.key}`,{detail:i.value[0]}),(0,B.dispatchIdEvent)(i.key,{detail:i.value[0]}),this.root):(this.root=this.root.addType(this.root,i.key,i.value[0]),this.root)})}static addConceptToTree(i){if(i.typeId!=0){let u=new f(i.typeId,i.id);this.addType(u)}}static removeTypeConcept(i,u){this.root&&(this.root=this.root.removeNodeWithVariants(this.root,i,u))}static getNodeFromTreeNew(i){return this.root?this.root.getFromNode(i,this.root):this.root}static getTypeVariantsFromTreeNew(i){return A(this,void 0,void 0,function*(){let u=this.getNodeFromTreeNew(i),v=[],T=[];if(u){v=u.value;for(let I=0;I<v.length;I++){let S=!1;for(let d=0;d<T.length;d++)T[d].id==v[I]&&(S=!0);S||T.push(yield(0,B.GetTheConcept)(v[I]))}}return T})}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((i,u)=>{this.checkFlag(i),setTimeout(()=>{u("not")},25e3)})})}static checkFlag(i){if(r.B.isTypeLoaded)return i("done");setTimeout(N.checkFlag,1e3,i)}static getTypeVariantsFromTreeWithUserIdNew(i,u){return A(this,void 0,void 0,function*(){let v=[],T=yield this.getTypeVariantsFromTreeNew(i);console.log("these are all the concepts",T);for(let I=0;I<T.length;I++)T[I].userId==u&&v.push(T[I]);return v})}static getTypeVariantsWithCharacterValueNew(i,u){return A(this,void 0,void 0,function*(){let v=yield this.getTypeVariantsFromTreeNew(u);console.log("this is all the concepts for character",v);let T=(0,W.o)();for(let I=0;I<v.length;I++)v[I].characterValue==i&&(T=v[I]);return T})}static countNumberOfNodes(){return this.typeRoot?this.typeRoot.countNodeBelow(this.typeRoot):0}}N.typeRoot=null,N.root=null},2615:(fe,q,m)=>{m.d(q,{j:()=>W});var B=m(2290);class W{constructor(f,A,N,s,i,u,v,T=!1,I,S,d){this.count=0,this.typeCharacter="",this.referent=null,this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=B.BaseUrl.getRandomizer(),this.x=0,this.y=0,this.id=f,this.userId=A,this.typeId=N,this.ghostId=f,this.categoryId=s,this.referentId=i,this.characterValue=`${u}`,this.accessId=v,this.typeCharacter=d,this.type=null,this.isNew=T,this.entryTimeStamp=I,this.updatedTimeStamp=S}getType(){console.log(this.typeId)}}},3026:(fe,q,m)=>{m.d(q,{I:()=>I});var B=m(3655),W=m(2202),r=m(6963),f=m(5457),A=m(7282),N=m(2290);class s{constructor(d,l,a,h){this.height=1,this.key=d,this.value=l,this.leftNode=a,this.rightNode=h}addNode(d,l,a){if(l==null)return d;let h=l.leftNode,k=l.rightNode;if(l.key>d.key)l.leftNode=this.addNode(d,h,a);else{if(!(l.key<d.key))return l;l.rightNode=this.addNode(d,k,a)}l.height=1+Math.max(this.getHeight(l.leftNode),this.getHeight(l.rightNode));let w=this.getBalanceFactor(l);if(w>1&&l.leftNode){if(d.key<l.leftNode.key)return this.rightRotate(l);if(d.key>l.leftNode.key)return l.leftNode=this.leftRotate(l.leftNode),this.rightRotate(l)}if(w<-1&&l.rightNode){if(d.key>l.rightNode.key)return this.leftRotate(l);if(d.key<l.rightNode.key)return l.rightNode=this.rightRotate(l.rightNode),this.leftRotate(l)}return l}rightRotate(d){if(d){let l=d.leftNode;if(l){let a=l.rightNode;return d.leftNode=a,l.rightNode=d,d.height=Math.max(this.getHeight(d.leftNode),this.getHeight(d.rightNode))+1,l.height=Math.max(this.getHeight(l.leftNode),this.getHeight(l.rightNode))+1,l}}return d}leftRotate(d){if(d){let l=d.rightNode;if(l){let a=l.leftNode;return l.leftNode=d,d.rightNode=a,d.height=Math.max(this.getHeight(d.leftNode),this.getHeight(d.rightNode))+1,l.height=Math.max(this.getHeight(l.leftNode),this.getHeight(d.rightNode))+1,l}}return d}getHeight(d){return d?d.height:0}getBalanceFactor(d){return d==null?0:this.getHeight(d.leftNode)-this.getHeight(d.rightNode)}getFromNode(d,l){return l&&(d==l.key?l:d<l.key?this.getFromNode(d,l.leftNode):d>l.key?this.getFromNode(d,l.rightNode):l)}removeNode(d,l){if(d==null)return d;if(d.key>l)return d.leftNode=this.removeNode(d.leftNode,l),d;if(d.key<l)return d.rightNode=this.removeNode(d.rightNode,l),d;if(d.leftNode==null){let a=d.rightNode;return d=null,a}if(d.rightNode==null){let a=d.leftNode;return d=null,a}{let a=this.inOrderSuccessor(d.rightNode);return d.value=a.value,d.key=a.key,d.rightNode=this.removeNode(d.rightNode,a.key),d}}countNodeBelow(d){return d==null?0:1+this.countNodeBelow(d.leftNode)+this.countNodeBelow(d.rightNode)}inOrderSuccessor(d){for(;d.leftNode!=null;)d=d.leftNode;return d}}var i=function(S,d,l,a){return new(l||(l=Promise))(function(h,k){function w(b){try{x(a.next(b))}catch(R){k(R)}}function L(b){try{x(a.throw(b))}catch(R){k(R)}}function x(b){var R;b.done?h(b.value):(R=b.value,R instanceof l?R:new l(function(D){D(R)})).then(w,L)}x((a=a.apply(S,[])).next())})};class u{static addNodeToTree(d){if(this.root==null)return this.root=d,this.root;this.root=this.root.addNode(d,this.root,this.root.height)}static addWidgetToTree(d){let l=new s(d.widgetId,d,null,null);this.addNodeToTree(l)}static getNodeFromTree(d){return i(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(d,this.root):null})}static removeNodeFromTree(d){return i(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,d))})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}u.root=null;class v{constructor(){this.widgetId=0,this.mainId=0,this.conceptIds=[],this.linkers=[],this.reverse=[],this.mainCompositionIds=[],this.countinfo=[]}}var T=function(S,d,l,a){return new(l||(l=Promise))(function(h,k){function w(b){try{x(a.next(b))}catch(R){k(R)}}function L(b){try{x(a.throw(b))}catch(R){k(R)}}function x(b){var R;b.done?h(b.value):(R=b.value,R instanceof l?R:new l(function(D){D(R)})).then(w,L)}x((a=a.apply(S,[])).next())})};class I{constructor(){this.name="conceptsArray"}static CheckContains(d){for(var l=!1,a=0;a<this.conceptsArray.length;a++)this.conceptsArray[a].id==d.id&&(l=!0);return l}static AddNpc(d){this.NPC.includes(d)||(this.NPC.length>10&&(this.NPC=[]),this.NPC.push(d))}static GetNpc(d){return!!this.NPC.includes(d)}static AddConceptToStorage(d){d.id>0&&(0,B.kH)("concept",d)}static GetConceptBulkData(d,l,a){return T(this,void 0,void 0,function*(){yield W.W.getConceptListFromIds(d,l,a)})}static AddWidget(d){if(N.serviceWorker)try{(0,N.sendMessage)("ConceptsData__AddWidget",{widgetDetails:d})}catch(l){console.error("Concept Data, Add Widget sw error: ",l),(0,N.handleServiceWorkerException)(l)}d.widgetId>0&&u.addWidgetToTree(d)}static AddConcept(d){if(N.serviceWorker)try{(0,N.sendMessage)("ConceptsData__AddConcept",{concept:d})}catch(l){console.error("Concept Data, Add Concpet sw error: ",l),(0,N.handleServiceWorkerException)(l)}d.id>0&&(W.W.addConceptToTree(d),f.c.addConceptToTree(d))}static AddConceptToMemory(d){d.id>0&&(W.W.addConceptToTree(d),f.c.addConceptToTree(d))}static AddConceptTemporary(d){var l=this.CheckContains(d);this.conceptDictionary[d.id]=d,l&&this.RemoveConcept(d),this.conceptsArray.push(d)}static RemoveConcept(d){for(var l=0;l<this.conceptsArray.length;l++)this.conceptsArray[l].id==d.id&&this.conceptsArray.splice(l,1);(0,B.wh)("concept",d.id)}static GetWidget(d){return T(this,void 0,void 0,function*(){let l=new v;if(N.serviceWorker)try{return(yield(0,N.sendMessage)("ConceptsData__GetWidget",{id:d})).data}catch(h){console.error("Concept Data, Get Widget sw error: ",h),(0,N.handleServiceWorkerException)(h)}let a=yield u.getNodeFromTree(d);return a!=null&&(l=a.value),l})}static RemoveWidget(d){return T(this,void 0,void 0,function*(){if(N.serviceWorker)try{return(yield(0,N.sendMessage)("ConceptsData__RemoveWidget",{id:d})).data}catch(l){console.error("Concept Data, Remove Widget sw error: ",l),(0,N.handleServiceWorkerException)(l)}yield u.removeNodeFromTree(d)})}static GetConcept(d){return T(this,void 0,void 0,function*(){if(N.serviceWorker)try{return(yield(0,N.sendMessage)("ConceptsData__GetConcept",{id:d})).data}catch(k){console.error("Concept Data, Get Concpet sw error: ",k),(0,N.handleServiceWorkerException)(k)}if(d==0||d==null||d==null)return(0,A.o)();var l=(0,A.o)(),a=yield W.W.getNodeFromTree(d);if(a?.value){var h=a.value;h&&(l=h)}return l})}static GetConceptByCharacter(d){return T(this,void 0,void 0,function*(){var l=(0,A.o)(),a=r.f.getNodeFromTree(d);return a&&(l=a.value),l})}static GetConceptByCharacterUpdated(d){return T(this,void 0,void 0,function*(){var l=(0,A.o)(),a=r.f.getNodeFromTree(d);return a&&(l=a.value),l})}static GetConceptByCharacterAndTypeLocal(d,l){return T(this,void 0,void 0,function*(){return(0,A.o)(),yield f.c.getTypeVariantsWithCharacterValueNew(d,l)})}static GetConceptByCharacterAndCategoryLocal(d,l){return T(this,void 0,void 0,function*(){var a=(0,A.o)(),h=yield r.f.getCharacterAndCategoryFromTree(d,l);return h&&(a=h.value),a})}static GetConceptsByTypeId(d){let l=[];for(var a=0;a<this.conceptsArray.length;a++)this.conceptsArray[a].typeId==d&&l.push(this.conceptsArray[a]);return l}static GetConceptsByTypeIdAndUser(d,l){var a=arguments;return T(this,void 0,void 0,function*(){if(N.Logger.logfunction("ConceptsData.GetConceptsByTypeIdAndUser",a),N.serviceWorker)try{return(yield(0,N.sendMessage)("ConceptsData__GetConceptsByTypeIdAndUser",{typeId:d,userId:l})).data}catch(k){console.error("Concept Data, Get Concpet sw error:",k),(0,N.handleServiceWorkerException)(k)}let h=[];return h=yield f.c.getTypeVariantsFromTreeWithUserIdNew(d,l),h})}static GetBinaryCharacterTree(){return r.f.characterRoot}getName(){return this.name}}I.conceptsArray=[],I.NPC=[],I.conceptDictionary=[]},2155:(fe,q,m)=>{m.d(q,{N:()=>r});var B=m(7282),W=m(9581);class r{constructor(A=0,N,s,i,u,v,T){this.count=0,this.isTemp=!1,this.toUpdate=!1,this.applicationId=W.B.getRandomizer(),this.type=(0,B.o)(),this.ofConcept=(0,B.o)(),this.toConcept=(0,B.o)(),this.id=A,this.ofTheConceptId=N,this.toTheConceptId=s,this.userId=i,this.typeId=u,this.ghostId=A,this.orderId=v,this.accessId=T,this.entryTimeStamp=(0,B.Y)(new Date),this.terminationDateTime=new Date,this.localSyncTime=new Date,this.typeCharacter=""}}},5239:(fe,q,m)=>{m.d(q,{O:()=>A});var B=m(205),W=m(2290);class r{constructor(s,i,u,v){this.leftNode=null,this.rightNode=null,this.variants=[],this.height=1,this.key=s,this.value=i,this.leftNode=u,this.rightNode=v,this.currentNode=null}addCurrentNode(s,i){return i==null?i=s:(s.value.typeId!=i.value.typeId&&(i.currentNode=this.addCurrentNode(s,i.currentNode)),i)}addCurrentNodeType(s,i){if(i==null)return s;let u=!1;s.value.id==i.value.id&&(u=!0);for(let v=0;v<i.variants.length;v++)i.variants[v].value.id==s.value.id&&(u=!0);return u||i.variants.push(s),i}getMax(s,i){return s>i?s:i}addNode(s,i,u){if(i==null)return(0,W.dispatchIdEvent)(s.value.ofTheConceptId),s;let v=i.leftNode,T=i.rightNode;if(s.key<i.key)i.leftNode=this.addNode(s,v,u);else{if(!(s.key>i.key))return i;i.rightNode=this.addNode(s,T,u)}i.height=1+this.getMax(this.getHeight(i.leftNode),this.getHeight(i.rightNode));let I=this.getBalanceFactor(i);if(I>1&&i.leftNode){if(this.getBalanceFactor(i.leftNode)>=0)return this.rightRotate(i);if(this.getBalanceFactor(i.leftNode)<0)return i.leftNode=this.leftRotate(i.leftNode),this.rightRotate(i)}if(I<-1&&i.rightNode){if(this.getBalanceFactor(i.rightNode)<=0)return this.leftRotate(i);if(this.getBalanceFactor(i.rightNode)>0)return i.rightNode=this.rightRotate(i.rightNode),this.leftRotate(i)}return i}addTypeNode(s,i,u){if(s.value.typeId!=0){if(i==null)return s;let v=i.leftNode,T=i.rightNode;if(i.key>s.key)i.leftNode=this.addTypeNode(s,v,u);else{if(!(i.key<s.key))return i.key==s.key&&i.key!=0&&i.addCurrentNodeType(s,i),i;i.rightNode=this.addTypeNode(s,T,u)}i.height=1+this.getMax(this.getHeight(i.leftNode),this.getHeight(i.rightNode));let I=this.getBalanceFactor(i);if(I>1&&i.leftNode){if(s.key<i.leftNode.key)return this.rightRotate(i);if(s.key>i.leftNode.key)return i.leftNode=this.leftRotate(i.leftNode),this.rightRotate(i)}if(I<-1&&i.rightNode){if(s.key>i.rightNode.key)return this.leftRotate(i);if(s.key<i.rightNode.key)return i.rightNode=this.rightRotate(i.rightNode),this.leftRotate(i)}}return i}rightRotate(s){if(s){let i=s.leftNode;if(i){let u=i.rightNode;return s.leftNode=u,i.rightNode=s,s.height=this.getMax(this.getHeight(s.leftNode),this.getHeight(s.rightNode))+1,i.height=this.getMax(this.getHeight(i.leftNode),this.getHeight(i.rightNode))+1,i}throw console.log("this is the error in right rotation",s,i),new Error("Cannot perform right rotation: left node is null.")}return s}leftRotate(s){if(s){let i=s.rightNode;if(i){let u=i.leftNode;return i.leftNode=s,s.rightNode=u,s.height=this.getMax(this.getHeight(s.leftNode),this.getHeight(s.rightNode))+1,i.height=this.getMax(this.getHeight(i.leftNode),this.getHeight(s.rightNode))+1,i}throw console.log("this is the error in left rotation",s,i),new Error("Cannot perform left rotation: right node is null.")}return s}getHeight(s){return s?s.height:0}getBalanceFactor(s){return s==null?0:this.getHeight(s.leftNode)-this.getHeight(s.rightNode)}getFromNode(s,i){try{if(i)return s==i.key?(i.value.count?i.value.count++:i.value.count=1,i):s<i.key?this.getFromNode(s,i.leftNode):s>i.key?this.getFromNode(s,i.rightNode):i}catch{console.log("this is the exception",s,i,i?.leftNode,i?.rightNode)}return i}getCharacterFromNode(s,i){return i&&(s==i.key?i:s<i.key?this.getCharacterFromNode(s,i.leftNode):s>i.key?this.getCharacterFromNode(s,i.rightNode):i)}checkIfIdsInNode(s,i,u,v){if(s){if(i.includes(s.key)){u.push(s.value);let T=i.indexOf(s.key);i.splice(T,1)}s.leftNode&&this.checkIfIdsInNode(s.leftNode,i,u,v),s.rightNode&&this.checkIfIdsInNode(s.rightNode,i,u,v)}}traverse(s){let i=0;return s&&(i+=1,s?.leftNode&&(i+=this.traverse(s.leftNode)),s.rightNode&&(i+=this.traverse(s.rightNode))),i}removeNode(s,i){if(s==null)return s;if(s.key>i)return s.leftNode=this.removeNode(s.leftNode,i),s;if(s.key<i)return s.rightNode=this.removeNode(s.rightNode,i),s;if(new Event(`${s.value.ofTheConceptId}`),(0,W.dispatchIdEvent)(s.value.ofTheConceptId),s.leftNode==null){let u=s.rightNode;return s=null,u}if(s.rightNode==null){let u=s.leftNode;return s=null,u}{let u=this.inOrderSuccessor(s.rightNode);return s.value=u.value,s.key=u.key,s.variants=u.variants,s.currentNode=u.currentNode,s.rightNode=this.removeNode(s.rightNode,u.key),s}}removeNodeWithVariants(s,i,u){if(s==null)return s;if(s.key>i)return s.leftNode=this.removeNodeWithVariants(s.leftNode,i,u),s;if(s.key<i)return s.rightNode=this.removeNodeWithVariants(s.rightNode,i,u),s;if(s.variants.length>0){if(s.value.id==u){let v=s.variants[0];if(v)return s.value=v.value,s.key=v.key,s.currentNode=v.currentNode,s.variants.splice(0,1),s}else for(let v=0;v<s.variants.length;v++)if(u==s.variants[v].value.id)return s.variants.splice(v,1),s}if(s.leftNode==null){let v=s.rightNode;return s=null,v}if(s.rightNode==null){let v=s.leftNode;return s=null,v}{let v=this.inOrderSuccessor(s.rightNode);return s.value=v.value,s.key=v.key,s.variants=v.variants,s.currentNode=v.currentNode,s.rightNode=this.removeNodeWithVariants(s.rightNode,v.key,u),s}}inOrderSuccessor(s){for(;s.leftNode!=null;)s=s.leftNode;return s}}var f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,[])).next())})};class A{static addNodeToTree(s){try{if(this.connectionroot==null)return this.connectionroot=s,this.connectionroot;this.connectionroot=this.connectionroot.addNode(s,this.connectionroot,this.connectionroot.height)}catch(i){throw console.log("This is the error in making the tree",i),i}}static addConnectionToTree(s){let i=new r(s.id,s,null,null);this.addNodeToTree(i)}static traverse(){var s;return(s=this.connectionroot)===null||s===void 0?void 0:s.traverse(this.connectionroot)}static waitForDataToLoad(){return f(this,void 0,void 0,function*(){return new Promise((s,i)=>{this.checkFlag(s),setTimeout(()=>{i("not")},25e3)})})}static checkFlag(s){if(B.B.isConnectionLoaded)return s("done");setTimeout(A.checkFlag,1e3,s)}static removeNodeFromTree(s){return f(this,void 0,void 0,function*(){this.connectionroot&&(this.connectionroot=this.connectionroot.removeNode(this.connectionroot,s))})}static getNodeFromTree(s){return f(this,void 0,void 0,function*(){try{return this.connectionroot?this.connectionroot.getFromNode(s,this.connectionroot):this.connectionroot}catch{console.log("this is the getNodeFromTree",s,this.connectionroot)}})}static getConnectionListFromIds(s,i,u){return f(this,void 0,void 0,function*(){this.connectionroot&&this.connectionroot.checkIfIdsInNode(this.connectionroot,s,i,u)})}}A.connectionroot=null},991:(fe,q,m)=>{m.d(q,{H:()=>A});var B=m(2290),W=m(3996);class r extends W.i{constructor(s,i,u,v){super(s,i,u,v),this.key="",this.value=[],this.height=1,this.key=s,this.value=i,this.leftNode=u,this.rightNode=v}addNode(s,i,u){if(i==null)return s;let v=i.leftNode,T=i.rightNode;if(i.key>s.key)i.leftNode=this.addNode(s,v,u);else{if(!(i.key<s.key))return i;i.rightNode=this.addNode(s,T,u)}i.height=1+Math.max(this.getHeight(i.leftNode),this.getHeight(i.rightNode));let I=this.getBalanceFactor(i);if(I>1&&i.leftNode){if(this.getBalanceFactor(i.leftNode)>=0)return this.rightRotate(i);if(this.getBalanceFactor(i.leftNode)<0)return i.leftNode=this.leftRotate(i.leftNode),this.rightRotate(i)}if(I<-1&&i.rightNode){if(this.getBalanceFactor(i.rightNode)<=0)return this.leftRotate(i);if(this.getBalanceFactor(i.rightNode)>0)return i.rightNode=this.rightRotate(i.rightNode),this.leftRotate(i)}return i}}var f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,[])).next())})};class A{static CreateCompositionKey(s,i){return s}static GetConnectionByOfTheConceptAndTypeId(s,i){let u=this.CreateCompositionKey(s,i);if(this.node){let v=this.node.getFromNode(u,this.node);if(v)return v.value}return null}static addConnection(s){if(s.id>0){let i=this.CreateCompositionKey(s.ofTheConceptId,s.typeId);if(this.node){let u=this.node.getFromNode(i,this.node);if(u){let v=u?.value;v.length==0&&(u.value=[]),v.includes(s.id)||v.push(s.id)}else{let v=[];v.push(s.id);let T=new r(i,v,null,null);this.addNodeToTree(T)}}else{let u=[];u.push(s.id);let v=new r(i,u,null,null);this.addNodeToTree(v)}new Event(`${i}`)}else console.log("cannot insert key id with  n 0 to the connection tree",s)}static addNodeToTree(s){return f(this,void 0,void 0,function*(){return this.node==null?(this.node=s,console.log("this is type dispatch in connection",s),(0,B.dispatchIdEvent)(s.key),this.node):(this.node=this.node.addNode(s,this.node,this.node.height),this.node)})}static removeNodeFromTree(s){return f(this,void 0,void 0,function*(){this.node&&(this.node=this.node.removeNode(this.node,s))})}}A.node=null},3996:(fe,q,m)=>{m.d(q,{i:()=>B});class B{constructor(r,f,A,N){this.key="",this.value=[],this.height=1,this.key=r,this.value=f,this.leftNode=A,this.rightNode=N}getFromNode(r,f){return f&&(r==f.key?f:r<f.key?this.getFromNode(r,f.leftNode):r>f.key?this.getFromNode(r,f.rightNode):f)}rightRotate(r){if(r){let f=r.leftNode;if(f){let A=f.rightNode;return r.leftNode=A,f.rightNode=r,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}}return r}leftRotate(r){if(r){let f=r.rightNode;if(f){let A=f.leftNode;return f.leftNode=r,r.rightNode=A,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(r.rightNode))+1,f}}return r}getHeight(r){return r?r.height:0}getBalanceFactor(r){return r==null?0:this.getHeight(r.leftNode)-this.getHeight(r.rightNode)}removeNode(r,f){if(r==null)return r;if(r.key>f)return r.leftNode=this.removeNode(r.leftNode,f),r;if(r.key<f)return r.rightNode=this.removeNode(r.rightNode,f),r;if(r.leftNode==null){let A=r.rightNode;return r=null,A}if(r.rightNode==null){let A=r.leftNode;return r=null,A}{let A=this.inOrderSuccessor(r.rightNode);return r.value=A.value,r.key=A.key,r.variants=A.variants,r.currentNode=A.currentNode,r.rightNode=this.removeNode(r.rightNode,A.key),r}}inOrderSuccessor(r){for(;r.leftNode!=null;)r=r.leftNode;return r}}},8286:(fe,q,m)=>{m.d(q,{d:()=>I});var B=m(1735),W=m(2290),r=m(3655),f=m(1863),A=m(2155),N=m(5239),s=m(991),i=m(3996);class u extends i.i{constructor(d,l,a,h){super(d,l,a,h),this.key="",this.value=[],this.height=1,this.key=d,this.value=l,this.leftNode=a,this.rightNode=h}addNode(d,l,a){if(l==null)return d;let h=l.leftNode,k=l.rightNode;if(l.key>d.key)l.leftNode=this.addNode(d,h,a);else{if(!(l.key<d.key))return l;l.rightNode=this.addNode(d,k,a)}l.height=1+Math.max(this.getHeight(l.leftNode),this.getHeight(l.rightNode));let w=this.getBalanceFactor(l);if(w>1&&l.leftNode){if(d.key<l.leftNode.key)return this.rightRotate(l);if(d.key>l.leftNode.key)return l.leftNode=this.leftRotate(l.leftNode),this.rightRotate(l)}if(w<-1&&l.rightNode){if(d.key>l.rightNode.key)return this.leftRotate(l);if(d.key<l.rightNode.key)return l.rightNode=this.rightRotate(l.rightNode),this.leftRotate(l)}return l}}class v{static CreateCompositionKey(d){return d}static addNodeToTree(d){return l=this,a=void 0,k=function*(){return this.connectionTypeRoot==null?(this.connectionTypeRoot=d,this.connectionTypeRoot):(this.connectionTypeRoot=this.connectionTypeRoot.addNode(d,this.connectionTypeRoot,this.connectionTypeRoot.height),this.connectionTypeRoot)},new((h=void 0)||(h=Promise))(function(w,L){function x(D){try{R(k.next(D))}catch(H){L(H)}}function b(D){try{R(k.throw(D))}catch(H){L(H)}}function R(D){var H;D.done?w(D.value):(H=D.value,H instanceof h?H:new h(function(O){O(H)})).then(x,b)}R((k=k.apply(l,a||[])).next())});var l,a,h,k}static addConnectionToTree(d){if(d.id>0){let l=this.CreateCompositionKey(d.typeId);if(this.connectionTypeRoot){let a=this.connectionTypeRoot.getFromNode(l,this.connectionTypeRoot);if(a){let h=a?.value;h.length==0&&(a.value=[]),h.includes(d.id)||h.push(d.id)}else{let h=[];h.push(d.id);let k=new u(l,h,null,null);this.addNodeToTree(k)}}else{let a=[];a.push(d.id);let h=new u(l,a,null,null);this.addNodeToTree(h)}}else console.log("cannot insert key id with  n 0 to the connection tree",d)}static GetConnectionByOfTheConceptAndTypeId(d,l){let a=this.CreateCompositionKey(l);if(this.connectionTypeRoot){let h=this.connectionTypeRoot.getFromNode(a,this.connectionTypeRoot);if(h)return h.value}return null}}v.connectionTypeRoot=null;var T=function(S,d,l,a){return new(l||(l=Promise))(function(h,k){function w(b){try{x(a.next(b))}catch(R){k(R)}}function L(b){try{x(a.throw(b))}catch(R){k(R)}}function x(b){var R;b.done?h(b.value):(R=b.value,R instanceof l?R:new l(function(D){D(R)})).then(w,L)}x((a=a.apply(S,[])).next())})};class I{constructor(){this.name="Connection Array"}static CheckContains(d){let l=!1;for(let a=0;a<this.connectionArray.length;a++)this.connectionArray[a].id==d.id&&(l=!0);return l}static AddConnectionToStorage(d){(0,r.kH)("connection",d)}static AddNpConn(d){this.deletedConnections.includes(d)||this.deletedConnections.push(d)}static GetNpConn(d){return!!this.deletedConnections.includes(d)}static AddConnection(d){try{N.O.addConnectionToTree(d),v.addConnectionToTree(d),s.H.addConnection(d)}catch(l){throw console.log("this is the error in making the connection"),l}}static AddConnectionToMemory(d){d.isTemp||(N.O.addConnectionToTree(d),v.addConnectionToTree(d),s.H.addConnection(d))}static AddToDictionary(d){this.connectionDictionary[d.id]=d}static RemoveConnection(d){d.id!=0&&((0,r.wh)("connection",d.id),N.O.removeNodeFromTree(d.id),s.H.removeNodeFromTree(d.id))}static GetConnectionTypeOfTree(){s.H.node}static GetConnectionByOfTheConceptAndType(d,l){return T(this,void 0,void 0,function*(){try{if(W.serviceWorker)try{return(yield(0,W.sendMessage)("ConnectionData__GetConnectionByOfTheConceptAndType",{ofTheConceptId:d,typeId:l})).data}catch(a){console.error("GetConnectionByOfTheConceptAndType sw error: ",a),(0,W.handleServiceWorkerException)(a)}return s.H.GetConnectionByOfTheConceptAndTypeId(d,l)||[]}catch(a){return console.log("this is the error in GetConnectionByOfTheConceptAndType",a),[]}})}static GetConnectionByOfType(d,l){const a=W.Logger.logfunction("ConnectionData.GetConnectionByOfType",arguments);let h=v.GetConnectionByOfTheConceptAndTypeId(d,l);return h?(W.Logger.logUpdate(a),h):(W.Logger.logUpdate(a),[])}static GetConnectionTree(){return N.O.connectionroot}static GetConnectionTypeTree(){return v.connectionTypeRoot}static GetConnectionBulkData(d,l,a){return T(this,void 0,void 0,function*(){yield N.O.getConnectionListFromIds(d,l,a)})}static GetConnection(d){return T(this,void 0,void 0,function*(){B.J.incrementConnection(d);let l=new A.N(0,0,0,0,0,0,0);try{if(W.serviceWorker)try{return(yield(0,W.sendMessage)("ConnectionData__GetConnection",{id:d})).data}catch(h){console.error("GetConnection sw error: ",h),(0,W.handleServiceWorkerException)(h)}let a=yield N.O.getNodeFromTree(d);if(a?.value){let h=a.value;h&&(l=h)}return l}catch(a){return console.log("this is the error in GetConnection",a),l}})}static GetConnectionsOfCompositionLocal(d){var l=arguments;return T(this,void 0,void 0,function*(){const a=W.Logger.logfunction("ConnectionData.GetConnectionsOfCompositionLocal",l)||{};let h=[];try{if(W.serviceWorker){a.serviceWorker=!0;try{const w=yield(0,W.sendMessage)("ConnectionData__GetConnectionsOfCompositionLocal",{id:d});return W.Logger.logUpdate(a),w.data}catch(w){console.error("GetConnectionsOfCompositionLocal sw error: ",w),(0,f.ey)(a,"GetConnectionsOfCompositionLocal",w),(0,W.handleServiceWorkerException)(w)}}let k=[];k=I.GetConnectionByOfType(d,d);for(let w=0;w<k.length;w++){let L=yield N.O.getNodeFromTree(k[w]);L&&h.push(L.value),W.Logger.logUpdate(a)}}catch(k){console.log("this is the error GetConnectionsOfCompositionLocal",d,h),(0,f.ey)(a,"ConnectionData.GetConnectionsOfCompositionLocal",k)}return h})}static GetConnectionsOfConcept(d){return T(this,void 0,void 0,function*(){let l=[],a=[];try{if(W.serviceWorker)try{return(yield(0,W.sendMessage)("ConnectionData__GetConnectionsOfConcept",{id:d})).data}catch(h){console.error("GetConnectionsOfConcept sw error: ",h),(0,W.handleServiceWorkerException)(h)}l=yield I.GetConnectionByOfTheConceptAndType(d,d);for(let h=0;h<l.length;h++){let k=yield N.O.getNodeFromTree(l[h]);k&&a.push(k.value)}return a}catch(h){return console.log("this is the error in GetConnectionsOfConcept",h),a}})}getName(){return this.name}}I.deletedConnections=[],I.connectionArray=[],I.connectionDictionary=[]},276:(fe,q,m)=>{m.d(q,{y:()=>B});class B{constructor(){this.conceptId=0,this.connectionTypeId=0,this.connectionType="",this.count=0}}},205:(fe,q,m)=>{m.d(q,{B:()=>B});class B{}B.isTypeLoaded=!1,B.isCharacterLoaded=!1,B.isDataLoaded=!1,B.isLocalDataLoaded=!1,B.isLocalCharacterLoaded=!1,B.isLocalTypeLoaded=!1,B.isConnectionLoaded=!1,B.isConnectionTypeLoaded=!1,B.isLocalConnectionLoaded=!1},2515:(fe,q,m)=>{m.d(q,{x:()=>B});class B{constructor(r,f,A,N){this.variants=[],this.height=1,this.key=r,this.value=f,this.leftNode=A,this.rightNode=N,this.currentNode=null}addCurrentNode(r,f){return f==null?f=r:(r.value.typeId!=f.value.typeId&&(f.currentNode=this.addCurrentNode(r,f.currentNode)),f)}addCurrentNodeType(r,f){if(f==null)return r;var A=!1;for(let N=0;N<f.variants.length;N++)f.variants[N].value.id==r.value.id&&(A=!0);return A||f.variants.push(r),f}addNode(r,f,A){if(f==null)return r;var N=f.leftNode,s=f.rightNode;if(f.key>r.key)f.leftNode=this.addNode(r,N,A);else{if(!(f.key<r.key))return f;f.rightNode=this.addNode(r,s,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let i=this.getBalanceFactor(f);if(i>1&&f.leftNode){if(r.key<f.leftNode.key)return this.rightRotate(f);if(r.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(i<-1&&f.rightNode){if(r.key>f.rightNode.key)return this.leftRotate(f);if(r.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}return f}addCharacterNode(r,f,A){if(r.value.characterValue!=""){if(f==null)return r;var N=f.leftNode,s=f.rightNode;if(f.key>r.key)f.leftNode=this.addCharacterNode(r,N,A);else{if(!(f.key<r.key))return f.key==r.key&&f.key!=""&&f.value.id!=r.value.id&&f.addCurrentNodeType(r,f),f;f.rightNode=this.addCharacterNode(r,s,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let i=this.getBalanceFactor(f);if(i>1&&f.leftNode){if(r.key<f.leftNode.key)return this.rightRotate(f);if(r.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(i<-1&&f.rightNode){if(r.key>f.rightNode.key)return this.leftRotate(f);if(r.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}addTypeNode(r,f,A){if(r.value.typeId!=0){if(f==null)return r;var N=f.leftNode,s=f.rightNode;if(f.key>r.key)f.leftNode=this.addTypeNode(r,N,A);else{if(!(f.key<r.key))return f.key==r.key&&f.key!=0&&f.value.id!=r.value.id&&f.addCurrentNodeType(r,f),f;f.rightNode=this.addTypeNode(r,s,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let i=this.getBalanceFactor(f);if(i>1&&f.leftNode){if(r.key<f.leftNode.key)return this.rightRotate(f);if(r.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(i<-1&&f.rightNode){if(r.key>f.rightNode.key)return this.leftRotate(f);if(r.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}rightRotate(r){if(r){let f=r.leftNode;if(f){let A=f.rightNode;return r.leftNode=A,f.rightNode=r,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}}return r}leftRotate(r){if(r){let f=r.rightNode;if(f){let A=f.leftNode;return f.leftNode=r,r.rightNode=A,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(r.rightNode))+1,f}}return r}getHeight(r){return r?r.height:0}getBalanceFactor(r){return r==null?0:this.getHeight(r.leftNode)-this.getHeight(r.rightNode)}getFromNode(r,f){return f&&(r==f.key?f:r<f.key?this.getFromNode(r,f.leftNode):r>f.key?this.getFromNode(r,f.rightNode):f)}updateNodeSyncStatus(r,f,A){if(A){if(r==A.key){let N=A.value;return N.isSynced=f,A.value=N,A}return r<A.key?this.updateNodeSyncStatus(r,f,A.leftNode):r>A.key?this.updateNodeSyncStatus(r,f,A.rightNode):A}return A}getCharacterFromNode(r,f){return f&&(r==f.key?f:r<f.key?this.getCharacterFromNode(r,f.leftNode):r>f.key?this.getCharacterFromNode(r,f.rightNode):f)}getFromNodeWithCharacterAndType(r,f,A){if(r=`${r}`,A){if(r==A.key){if(r==A.value.characterValue&&f==A.value.typeId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.typeId==f)return A.variants[N]}else{if(r<A.key)return this.getFromNodeWithCharacterAndType(r,f,A.leftNode);if(r>A.key)return this.getFromNodeWithCharacterAndType(r,f,A.rightNode)}return null}return A}getFromNodeWithCharacterAndCategory(r,f,A){if(r=`${r}`,A){if(r==A.key){if(r==A.value.characterValue&&f==A.value.categoryId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.categoryId==f)return A.variants[N]}else{if(r<A.key)return this.getFromNodeWithCharacterAndCategory(r,f,A.leftNode);if(r>A.key)return this.getFromNodeWithCharacterAndCategory(r,f,A.rightNode)}return null}return A}removeNode(r,f){if(r==null)return r;if(r.key>f)return r.leftNode=this.removeNode(r.leftNode,f),r;if(r.key<f)return r.rightNode=this.removeNode(r.rightNode,f),r;if(r.leftNode==null){let N=r.rightNode;return r=null,N}if(r.rightNode==null){let N=r.leftNode;return r=null,N}var A=this.inOrderSuccessor(r.rightNode);return r.value=A.value,r.key=A.key,r.variants=A.variants,r.currentNode=A.currentNode,r.rightNode=this.removeNode(r.rightNode,A.key),r}removeNodeWithVariants(r,f,A){if(r==null)return r;if(r.key>f)return r.leftNode=this.removeNodeWithVariants(r.leftNode,f,A),r;if(r.key<f)return r.rightNode=this.removeNodeWithVariants(r.rightNode,f,A),r;if(r.variants.length>0){if(r.value.id==A){var N=r.variants[0];if(N)return r.value=N.value,r.key=N.key,r.currentNode=N.currentNode,r.variants.splice(0,1),r}else for(let i=0;i<r.variants.length;i++)if(A==r.variants[i].value.id)return r.variants.splice(i,1),r}if(r.leftNode==null){let i=r.rightNode;return r=null,i}if(r.rightNode==null){let i=r.leftNode;return r=null,i}var s=this.inOrderSuccessor(r.rightNode);return r.value=s.value,r.key=s.key,r.variants=s.variants,r.currentNode=s.currentNode,r.rightNode=this.removeNodeWithVariants(r.rightNode,s.key,A),r}countNodeBelow(r){return r==null?0:1+this.countNodeBelow(r.leftNode)+this.countNodeBelow(r.rightNode)}inOrderSuccessor(r){for(;r.leftNode!=null;)r=r.leftNode;return r}}},9736:(fe,q,m)=>{m.d(q,{v:()=>h});var B=m(205),W=m(2515),r=function(k,w,L,x){return new(L||(L=Promise))(function(b,R){function D(U){try{O(x.next(U))}catch(M){R(M)}}function H(U){try{O(x.throw(U))}catch(M){R(M)}}function O(U){var M;U.done?b(U.value):(M=U.value,M instanceof L?M:new L(function(j){j(M)})).then(D,H)}O((x=x.apply(k,[])).next())})};class f{static addNodeToTree(w){if(this.root==null)return this.root=w,this.root;this.root=this.root.addNode(w,this.root,this.root.height)}static addConceptToTree(w){var L=new W.x(w.id,w,null,null);new W.x(w.characterValue,w,null,null),this.addNodeToTree(L)}static waitForDataToLoad(){return r(this,void 0,void 0,function*(){return new Promise((w,L)=>{this.checkFlag(w),setTimeout(()=>{L("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalDataLoaded)return w("done");setTimeout(f.checkFlag,1e3,w)}static getNodeFromTree(w){return r(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(w,this.root):null})}static getCharacterAndTypeFromTree(w,L){return this.root?this.root.getFromNodeWithCharacterAndType(w,L,this.root):this.root}static updateSyncStatus(w){return this.root?this.root.updateNodeSyncStatus(w,!0,this.root):this.root}static removeNodeFromTree(w){return r(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,w))})}}f.root=null;var A=function(k,w,L,x){return new(L||(L=Promise))(function(b,R){function D(U){try{O(x.next(U))}catch(M){R(M)}}function H(U){try{O(x.throw(U))}catch(M){R(M)}}function O(U){var M;U.done?b(U.value):(M=U.value,M instanceof L?M:new L(function(j){j(M)})).then(D,H)}O((x=x.apply(k,[])).next())})};class N{static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((w,L)=>{this.checkFlag(w),setTimeout(()=>{L("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalCharacterLoaded)return w("done");setTimeout(N.checkFlag,1e3,w)}static addNodeToTree(w){return A(this,void 0,void 0,function*(){return this.LocalCharacterRoot==null?(this.LocalCharacterRoot=w,this.LocalCharacterRoot):(this.LocalCharacterRoot=this.LocalCharacterRoot.addCharacterNode(w,this.LocalCharacterRoot,this.LocalCharacterRoot.height),this.LocalCharacterRoot)})}static addConceptToTree(w){if(w.characterValue!=""){var L=new W.x(w.characterValue,w,null,null);this.addNodeToTree(L)}}static getNodeFromTree(w){return this.LocalCharacterRoot?this.LocalCharacterRoot.getCharacterFromNode(w,this.LocalCharacterRoot):this.LocalCharacterRoot}static getCharacterAndTypeFromTree(w,L){return A(this,void 0,void 0,function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndType(w,L,this.LocalCharacterRoot):this.LocalCharacterRoot})}static getCharacterAndCategoryFromTree(w,L){return A(this,void 0,void 0,function*(){return this.LocalCharacterRoot?this.LocalCharacterRoot.getFromNodeWithCharacterAndCategory(w,L,this.LocalCharacterRoot):this.LocalCharacterRoot})}static removeConceptType(w,L){this.LocalCharacterRoot&&(this.LocalCharacterRoot=this.LocalCharacterRoot.removeNodeWithVariants(this.LocalCharacterRoot,w,L))}}N.LocalCharacterRoot=null;var s=function(k,w,L,x){return new(L||(L=Promise))(function(b,R){function D(U){try{O(x.next(U))}catch(M){R(M)}}function H(U){try{O(x.throw(U))}catch(M){R(M)}}function O(U){var M;U.done?b(U.value):(M=U.value,M instanceof L?M:new L(function(j){j(M)})).then(D,H)}O((x=x.apply(k,[])).next())})};class i{static addNodeToTree(w){return s(this,void 0,void 0,function*(){return this.LocalTypeRoot==null?(this.LocalTypeRoot=w,this.LocalTypeRoot):(this.LocalTypeRoot=this.LocalTypeRoot.addTypeNode(w,this.LocalTypeRoot,this.LocalTypeRoot.height),this.LocalTypeRoot)})}static addConceptToTree(w){if(w.typeId!=0){var L=new W.x(w.typeId,w,null,null);this.addNodeToTree(L)}}static removeConceptType(w,L){this.LocalTypeRoot&&(this.LocalTypeRoot=this.LocalTypeRoot.removeNodeWithVariants(this.LocalTypeRoot,w,L))}static getNodeFromTree(w){return this.LocalTypeRoot?this.LocalTypeRoot.getFromNode(w,this.LocalTypeRoot):this.LocalTypeRoot}static getTypeVariantsFromTree(w){var L=this.getNodeFromTree(w),x=[];if(L){x.push(L?.value);for(let b=0;b<L.variants.length;b++)x.push(L.variants[b].value);return x}}static waitForDataToLoad(){return s(this,void 0,void 0,function*(){return new Promise((w,L)=>{this.checkFlag(w),setTimeout(()=>{L("not")},25e3)})})}static checkFlag(w){if(B.B.isLocalTypeLoaded)return w("done");setTimeout(i.checkFlag,1e3,w)}static getTypeVariantsFromTreeWithUserId(w,L){return s(this,void 0,void 0,function*(){var x=[],b=this.getNodeFromTree(w);if(b){console.log("this is the node to type",b),b.value.userId!=L&&b.value.userId!=999||x.push(b?.value);for(let R=0;R<b.variants.length;R++)b.variants[R].value.userId!=L&&b.value.userId!=999||x.push(b.variants[R].value)}return x})}}i.LocalTypeRoot=null;var u=m(6416),v=m(3026),T=m(7820),I=m(4864),S=m(628),d=m(2290),l=m(3278),a=function(k,w,L,x){return new(L||(L=Promise))(function(b,R){function D(U){try{O(x.next(U))}catch(M){R(M)}}function H(U){try{O(x.throw(U))}catch(M){R(M)}}function O(U){var M;U.done?b(U.value):(M=U.value,M instanceof L?M:new L(function(j){j(M)})).then(D,H)}O((x=x.apply(k,[])).next())})};class h{constructor(){this.name="conceptsArray"}static AddConcept(w){w.id!=0&&(f.addConceptToTree(w),N.addConceptToTree(w),i.addConceptToTree(w),this.localconceptsArray.push(w))}static AddPermanentConcept(w){w.id!=0&&(f.removeNodeFromTree(w.ghostId),N.removeConceptType(w.characterValue,w.ghostId),i.removeConceptType(w.typeId,w.ghostId),T.G.addConceptToTree(w),v.I.AddConcept(w),(0,d.AddGhostConcept)(w,w.userId,l.b.sessionId))}static RemoveConcept(w){return a(this,void 0,void 0,function*(){try{w.id!=0&&(f.removeNodeFromTree(w.ghostId),N.removeConceptType(w.characterValue,w.ghostId),i.removeConceptType(w.typeId,w.ghostId))}catch(L){throw L}})}static RemoveConceptById(w){return a(this,void 0,void 0,function*(){try{let L=yield h.GetConcept(w);L.id!=0&&(f.removeNodeFromTree(w),N.removeConceptType(L.characterValue,L.ghostId),i.removeConceptType(L.typeId,L.ghostId),S.H.RemoveConcept(L))}catch(L){throw L}})}static AddConceptToMemory(w){w.id!=0&&(f.addConceptToTree(w),N.addConceptToTree(w),i.addConceptToTree(w))}static GetConcept(w){return a(this,void 0,void 0,function*(){var L=(0,u.u)(),x=yield f.getNodeFromTree(w);if(x?.value){var b=x.value;b&&(L=b)}return L})}static UpdateConceptSyncStatus(w){return a(this,void 0,void 0,function*(){f.updateSyncStatus(w)})}static GetConceptByGhostId(w){return a(this,void 0,void 0,function*(){var L=(0,u.u)(),x=yield T.G.getNodeFromTree(w);if(x?.value){var b=x.value;b&&(L=b)}return L})}static GetConceptByCharacter(w){return a(this,void 0,void 0,function*(){var L=(0,u.u)(),x=N.getNodeFromTree(w);return x&&(L=x.value),L})}static GetConceptByCharacterAndTypeLocal(w,L){return a(this,void 0,void 0,function*(){var x=(0,u.u)(),b=yield N.getCharacterAndTypeFromTree(w,L);return b&&(x=b.value),x})}static GetConceptByCharacterAndCategoryLocal(w,L){return a(this,void 0,void 0,function*(){var x=(0,u.u)(),b=yield N.getCharacterAndCategoryFromTree(w,L);return b&&(x=b.value),x})}static GetConceptsByTypeId(w){let L=[];for(var x=0;x<this.localconceptsArray.length;x++)this.localconceptsArray[x].typeId==w&&L.push(this.localconceptsArray[x]);return L}static GetConceptsByTypeIdAndUser(w,L){return a(this,void 0,void 0,function*(){let x=[];return x=yield i.getTypeVariantsFromTreeWithUserId(w,L),x})}static ClearData(){return a(this,void 0,void 0,function*(){this.localconceptsArray=[],I.G.connectionArray=[]})}getName(){return this.name}}h.localconceptsArray=[]},4864:(fe,q,m)=>{m.d(q,{G:()=>N});var B=m(2155),W=m(8286),r=m(205),f=m(628),A=function(s,i,u,v){return new(u||(u=Promise))(function(T,I){function S(a){try{l(v.next(a))}catch(h){I(h)}}function d(a){try{l(v.throw(a))}catch(h){I(h)}}function l(a){var h;a.done?T(a.value):(h=a.value,h instanceof u?h:new u(function(k){k(h)})).then(S,d)}l((v=v.apply(s,[])).next())})};class N{constructor(){this.name="Connection Array"}static CheckContains(i){for(var u=!1,v=0;v<this.connectionArray.length;v++)this.connectionArray[v].id==i.id&&(u=!0);return u}static AddConnection(i){this.CheckContains(i)&&this.RemoveConnection(i),i.id,this.connectionArray.push(i)}static AddConnectionToMemory(i){this.CheckContains(i)&&this.RemoveConnection(i),this.connectionArray.push(i)}static AddToDictionary(i){this.connectionDictionary[i.id]=i}static RemoveConnection(i){for(var u=0;u<this.connectionArray.length;u++)this.connectionArray[u].id==i.id&&this.connectionArray.splice(u,1);i.id}static RemoveConnectionById(i){for(var u=0;u<this.connectionArray.length;u++)this.connectionArray[u].id==i&&this.connectionArray.splice(u,1);f.H.RemoveConnectionById(i)}static AddPermanentConnection(i){i.id>0&&W.d.AddConnection(function(u){let v=new B.N(0,0,0,0,0,0,0);return v.ofTheConceptId=u.ofTheConceptId,v.toTheConceptId=u.toTheConceptId,v.typeId=u.typeId,v.orderId=u.orderId,v.id=u.id,v}(i))}static GetConnection(i){var u;u=null;for(var v=0;v<this.connectionArray.length;v++)this.connectionArray[v].id==i&&(u=this.connectionArray[v]);return u}static waitForDataToLoad(){return A(this,void 0,void 0,function*(){return new Promise((i,u)=>{this.checkFlag(i),setTimeout(()=>{u("not")},25e3)})})}static checkFlag(i){if(r.B.isLocalConnectionLoaded)return i("done");setTimeout(N.checkFlag,1e3,i)}static GetConnectionsOfCompositionLocal(i){return A(this,void 0,void 0,function*(){var u=[];try{for(var v=0;v<this.connectionArray.length;v++)this.connectionArray[v].typeId==i&&u.push(this.connectionArray[v]);return u}catch{return u}})}static GetConnectionOfCompositionAndTypeLocal(i,u){return A(this,void 0,void 0,function*(){var v=[];try{for(var T=0;T<this.connectionArray.length;T++)this.connectionArray[T].typeId==i&&this.connectionArray[T].ofTheConceptId==u&&v.push(this.connectionArray[T]);return v}catch{return v}})}getName(){return this.name}}N.connectionArray=[],N.connectionDictionary=[]},7820:(fe,q,m)=>{m.d(q,{G:()=>f});var B=m(205),W=m(2515),r=function(A,N,s,i){return new(s||(s=Promise))(function(u,v){function T(d){try{S(i.next(d))}catch(l){v(l)}}function I(d){try{S(i.throw(d))}catch(l){v(l)}}function S(d){var l;d.done?u(d.value):(l=d.value,l instanceof s?l:new s(function(a){a(l)})).then(T,I)}S((i=i.apply(A,[])).next())})};class f{static addNodeToTree(N){if(this.root==null)return this.root=N,this.root;this.root=this.root.addNode(N,this.root,this.root.height)}static addConceptToTree(N){var s=new W.x(N.ghostId,N,null,null);this.addNodeToTree(s)}static waitForDataToLoad(){return r(this,void 0,void 0,function*(){return new Promise((N,s)=>{this.checkFlag(N),setTimeout(()=>{s("not")},25e3)})})}static checkFlag(N){if(B.B.isLocalDataLoaded)return N("done");setTimeout(f.checkFlag,1e3,N)}static getNodeFromTree(N){return r(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(N,this.root):null})}static removeNodeFromTree(N){return r(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,N))})}}f.root=null},5257:(fe,q,m)=>{m.d(q,{R:()=>f});var B=m(9003),W=m(3075),r=function(A,N,s,i){return new(s||(s=Promise))(function(u,v){function T(d){try{S(i.next(d))}catch(l){v(l)}}function I(d){try{S(i.throw(d))}catch(l){v(l)}}function S(d){var l;d.done?u(d.value):(l=d.value,l instanceof s?l:new s(function(a){a(l)})).then(T,I)}S((i=i.apply(A,[])).next())})};class f{static AddConceptId(N){this.localId=N.value,(0,B.kH)("localid",N)}static getConceptId(){return r(this,void 0,void 0,function*(){try{if(this.localId){if(this.ReservedLocalId.length<5){yield(0,W.EO)().then(()=>{let s=this.localId;for(let i=1;i<10;i++){let u=this.localId-i;this.ReservedLocalId.push(u),s=u}this.AddConceptId({id:0,value:s})}).catch(s=>(console.log(" getid: cannot get the id from indexdb"),-Math.floor(1e8*Math.random())));let N=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),N}{let N=this.ReservedLocalId[0];return this.ReservedLocalId.shift(),N}}return yield(0,W.EO)().then(()=>{let N=this.localId;for(let s=1;s<10;s++){let i=this.localId-s;this.ReservedLocalId.push(i),N=i}this.AddConceptId({id:0,value:N})}),this.getConceptId()}catch(N){return console.log(" getid: this is the eror in concept",N),-Math.floor(1e8*Math.random())}})}static AddConnectionId(N){this.localConnectionId=N.value}static getConnectionId(){return r(this,void 0,void 0,function*(){try{if(this.localConnectionId){if(this.ReservedConnectionId.length<5){yield(0,W.xd)().then(()=>{let s=this.localConnectionId;for(let i=1;i<10;i++){let u=this.localConnectionId-i;this.ReservedConnectionId.push(u),s=u}}).catch(s=>(console.log("this is the new event",s),-Math.floor(1e8*Math.random())));let N=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),N}{let N=this.ReservedConnectionId[0];return this.ReservedConnectionId.shift(),N}}return yield(0,W.xd)().then(()=>{let N=this.localConnectionId;for(let s=1;s<10;s++){let i=this.localConnectionId-s;this.ReservedConnectionId.push(i),N=i}this.AddConnectionId({id:1,value:N})}),this.getConnectionId()}catch{return-Math.floor(1e8*Math.random())}})}}f.ReservedLocalId=[],f.ReservedConnectionId=[]},628:(fe,q,m)=>{m.d(q,{H:()=>S});var B=m(9581),W=m(3278),r=m(2290),f=m(1863),A=function(d,l,a,h){return new(a||(a=Promise))(function(k,w){function L(R){try{b(h.next(R))}catch(D){w(D)}}function x(R){try{b(h.throw(R))}catch(D){w(D)}}function b(R){var D;R.done?k(R.value):(D=R.value,D instanceof a?D:new a(function(H){H(D)})).then(L,x)}b((h=h.apply(d,l||[])).next())})};const N=(d,l,...a)=>A(void 0,[d,l,...a],void 0,function*(h,k,w=!0){let L={concepts:[],connections:[]};try{const x=new Headers;let b={concepts:h,connections:k};x.set("Content-Type","application/json"),x.set("Authorization","Bearer "+W.b.BearerAccessToken),x.set("Accept","application/json"),x.set("X-Session-Id",W.b.sessionId.toString()),x.set("Randomizer",B.B.getRandomizer().toString());const R=yield fetch(B.B.CreateGhostConceptApiUrl(w),{method:"POST",headers:x,body:JSON.stringify(b)});if(!R.ok)throw(0,f.ry)(R),new Error(`Error! status: ${R.status}`);const D=yield R.json();return L.concepts=D.concepts,L.connections=D.connections,L}catch(x){throw x instanceof Error?console.log("Create the concept api error message: ",x.message):console.log("Create the concept api unexpected error: ",x),x}});function s(d,l){const a=[];for(let h=0;h<d.length;h+=l){const k=d.slice(h,h+l);a.push(k)}return a}const i=(...d)=>A(void 0,[...d],void 0,function*(l=[]){return yield Promise.all(l.map(a=>{let h=JSON.parse(JSON.stringify(a));return delete h.type,delete h.ofConcept,delete h.toConcept,h}))});var u=m(9003),v=m(9736),T=m(4864),I=function(d,l,a,h){return new(a||(a=Promise))(function(k,w){function L(R){try{b(h.next(R))}catch(D){w(D)}}function x(R){try{b(h.throw(R))}catch(D){w(D)}}function b(R){var D;R.done?k(R.value):(D=R.value,D instanceof a?D:new a(function(H){H(D)})).then(L,x)}b((h=h.apply(d,l||[])).next())})};class S{static CheckContains(l){for(var a=!1,h=0;h<this.conceptsSyncArray.length;h++)this.conceptsSyncArray[h].id==l.id&&(a=!0);return a}static SyncDataDelete(l){for(var a=0;a<this.conceptsSyncArray.length;a++)l==this.conceptsSyncArray[a].id&&this.conceptsSyncArray.splice(a,1);for(a=0;a<this.connectionSyncArray.length;a++)this.connectionSyncArray[a].ofTheConceptId!=l&&this.connectionSyncArray[a].toTheConceptId!=l&&this.connectionSyncArray[a].typeId!=l||this.connectionSyncArray.splice(a,1)}static CheckContainsConnection(l){for(var a=!1,h=0;h<this.connectionSyncArray.length;h++)this.connectionSyncArray[h].id==l.id&&(a=!0);return a}static AddConcept(l){try{let a=!1;S.CheckIfTheConceptIdExists(l.id,this.conceptsSyncArray).id!=0&&(a=!0),a||this.conceptsSyncArray.push(l)}catch(a){throw a}}static RemoveConcept(l){for(var a=0;a<this.conceptsSyncArray.length;a++)this.conceptsSyncArray[a].id==l.id&&this.conceptsSyncArray.splice(a,1)}static SyncDataOnlineWithoutAuth(l,a){return I(this,arguments,void 0,function*(h,k,w=!1){return S.SyncDataOnline(h,k,w)})}static SyncDataOnline(l,a){return I(this,arguments,void 0,function*(h,k,w=!0){let L=performance.now();console.log("syncing...",h,k,"aa: ",this.conceptsSyncArray,this.connectionSyncArray,!!r.serviceWorker,w),setTimeout(()=>{console.log("syncing...",h,k,"aa: ",this.conceptsSyncArray,this.connectionSyncArray,!!r.serviceWorker,w)},5e3);try{if(r.serviceWorker)try{return console.log("syncing in the service worker",h,w),(yield(0,r.sendMessage)("LocalSyncData__SyncDataOnline",{transactionId:h,withAuth:w})).data}catch(U){console.error("LocalSyncData__SyncDataOnline sw error: ",U),(0,r.handleServiceWorkerException)(U)}console.log("syncing in the without service worker syncing",h,w);let x=[],b=[];if(h&&this.transactionCollections.some(U=>U.id==h)){const U=this.transactionCollections.find(M=>M.id==h);if(this.transactionCollections=this.transactionCollections.filter(M=>M.id!=h),this.transactionCollections=this.transactionCollections.filter(M=>new Date(M.createdDate).getTime()>new Date().getTime()-6048e5),!U)return;x=U.data.concepts.slice(),b=U.data.connections.slice()}else Array.isArray(k?.concepts)&&Array.isArray(k?.connections)?(console.log("this is the concepts and connections array",k?.concepts,k?.connections),x=k.concepts.slice(),b=k.connections.slice(),console.log("this is the concepts and connections array",x,b),this.conceptsSyncArray=this.conceptsSyncArray.filter(U=>{const M=k.concepts.some(j=>U.id==j.id||U.ghostId==j.ghostId);return M||console.warn(`Concept not found in sync array: ${U.id||U.ghostId}`),M}),this.connectionSyncArray=this.connectionSyncArray.filter(U=>{const M=k.connections.some(j=>U.id==j.id||U.ghostId==j.ghostId);return M||console.warn(`Connection not found in sync array: ${U.id||U.ghostId}`),M})):(console.warn("Syncing this way has been Depreceted in service worker."),console.info("Only if serive worker is not running"),x=this.conceptsSyncArray.slice()||[],b=this.connectionSyncArray.slice()||[],this.connectionSyncArray=[],this.conceptsSyncArray=[]);console.log("syncing... inside the syncer",w);let R=[];for(let U=0;U<x.length;U++)R.push(x[U]),yield v.v.UpdateConceptSyncStatus(x[U].id);console.log("syncing... inside the syncer 2",w,x),yield this.UpdateConceptListToIncludeRelatedConcepts(b,R);let D=yield function(U,M){return A(this,arguments,void 0,function*(j,$,Y=!0){const X=r.Logger.logfunction("CreateTheGhostConceptApi",[j.length,$.length]);try{let Q={concepts:[],connections:[]};const K=yield i(j),he=yield i($);if(j.length+$.length<=2*1e3){const ae=yield N(K,he,Y);return Array.isArray(ae?.concepts)&&(Q.concepts=[...Q.concepts,...ae.concepts]),Array.isArray(ae?.connections)&&(Q.connections=[...Q.connections,...ae.connections]),r.Logger.logUpdate(X),Q}const ye=s(K,1e3),Ce=s(he,1e3),se=[],Z=[];console.log("This is the with auth in syncing",Y);for(let ae=0;ae<ye.length;ae++){const ue=ye[ae];se.push(N(ue,[],Y))}const ne=yield Promise.all(se);for(let ae=0;ae<ne.length;ae++){const ue=ne[ae];Array.isArray(ue?.concepts)&&(Q.concepts=[...Q.concepts,...ue.concepts]),Array.isArray(ue?.connections)&&(Q.connections=[...Q.connections,...ue.connections])}for(let ae=0;ae<Ce.length;ae++){const ue=Ce[ae];Z.push(N([],ue,Y))}const oe=yield Promise.all(Z);for(let ae=0;ae<oe.length;ae++){const ue=oe[ae];Array.isArray(ue?.concepts)&&(Q.concepts=[...Q.concepts,...ue.concepts]),Array.isArray(ue?.connections)&&(Q.connections=[...Q.connections,...ue.connections])}return r.Logger.logUpdate(X),Q}catch(ee){throw console.log(ee),(0,f.ey)(X,"CreateTheGhostConceptApi",ee),ee}})}(R,b,w);console.log("syncing... inside the syncer 3",w);let H=D.concepts,O=D.connections;for(let U=0;U<H.length;U++)v.v.AddPermanentConcept(H[U]);for(let U=0;U<O.length;U++)T.G.AddPermanentConnection(O[U]);return x}catch(x){throw r.Logger.logError(L,"unknown",void 0,"unknown",void 0,500,x,"SyncDataOnline",[],"unknown",void 0),x}})}static ConvertGhostIdsInConnections(l){var a,h,k;for(let w=0;w<l.length;w++){let L=l[w].ofTheConceptId,x=l[w].toTheConceptId,b=l[w].typeId,R=(a=S.ghostIdMap.get(L))!==null&&a!==void 0?a:L,D=(h=S.ghostIdMap.get(x))!==null&&h!==void 0?h:x,H=(k=S.ghostIdMap.get(b))!==null&&k!==void 0?k:b;l[w].ofTheConceptId=R,l[w].toTheConceptId=D,l[w].typeId=H}}static UpdateConceptListToIncludeRelatedConcepts(l,a){return I(this,void 0,void 0,function*(){for(let h=0;h<l.length;h++){let k=l[h].ofTheConceptId,w=l[h].toTheConceptId,L=l[h].typeId;if(k<0){let x=this.CheckIfTheConceptIdExists(k,a);x.id==0&&(x=yield v.v.GetConceptByGhostId(k),x.id!=0?x.id!=x.ghostId&&(l[h].ofTheConceptId=x.id):(x=yield v.v.GetConcept(k),this.AddConceptIfDoesNotExist(x,a)))}if(w<0){let x=this.CheckIfTheConceptIdExists(w,a);x.id==0&&(x=yield v.v.GetConceptByGhostId(w),x.id!=0?x.id!=x.ghostId&&(l[h].toTheConceptId=x.id):(x=yield v.v.GetConcept(w),this.AddConceptIfDoesNotExist(x,a)))}if(L<0){let x=this.CheckIfTheConceptIdExists(L,a);x.id==0&&(x=yield v.v.GetConceptByGhostId(L),x.id!=0?x.id!=x.ghostId&&(l[h].typeId=x.id):(x=yield v.v.GetConcept(L),this.AddConceptIfDoesNotExist(x,a)))}}})}static AddConceptIfDoesNotExist(l,a=[]){let h=!1;for(let k=0;k<a.length;k++)l.ghostId==a[k].ghostId&&(h=!0);h||a.push(l)}static CheckIfTheConceptIdExists(l,a=[]){let h=(0,r.CreateDefaultLConcept)();for(let k=0;k<a.length;k++)l!=a[k].ghostId&&l!=a[k].id||(h=a[k]);return h}static AddConnection(l){this.connectionSyncArray.push(l)}static RemoveConnection(l){for(var a=0;a<this.connectionSyncArray.length;a++)this.connectionSyncArray[a].id==l.id&&this.connectionSyncArray.splice(a,1)}static RemoveConnectionById(l){for(var a=0;a<this.connectionSyncArray.length;a++)this.connectionSyncArray[a].id==l&&this.connectionSyncArray.splice(a,1)}static syncDataLocalDb(){return I(this,void 0,void 0,function*(){if(this.conceptsSyncArray.length>0){for(let l=0;l<this.conceptsSyncArray.length;l++)(0,u.kH)("localconcept",this.conceptsSyncArray[l]);this.conceptsSyncArray=[]}if(this.connectionSyncArray.length>0){for(let l=0;l<this.connectionSyncArray.length;l++)(0,u.kH)("localconnection",this.connectionSyncArray[l]);this.connectionSyncArray=[]}return"done"})}static initializeTransaction(l){return I(this,void 0,void 0,function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__initializeTransaction",{transactionId:l})).data}catch(a){console.error("LocalSyncData__initializeTransaction sw error: ",a),(0,r.handleServiceWorkerException)(a)}if(this.transactionCollections.some(a=>a.id==l))return;this.transactionCollections.push({id:l,data:{concepts:[],connections:[]},createdDate:new Date().toISOString()})}catch(a){console.log("error in initializeTransaction",a)}})}static markTransactionActions(l,a){return I(this,void 0,void 0,function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__markTransactionActions",{transactionId:l,actions:a})).data}catch(h){console.error("LocalSyncData__markTransactionActions sw error: ",h),(0,r.handleServiceWorkerException)(h)}this.transactionCollections=this.transactionCollections.map(h=>h.id==l?Object.assign(Object.assign({},h),{data:JSON.parse(JSON.stringify(a))}):h),this.conceptsSyncArray=this.conceptsSyncArray.filter(h=>!a.concepts.some(k=>k.id==h.id||k.ghostId==h.id)),this.connectionSyncArray=this.connectionSyncArray.filter(h=>!a.connections.some(k=>k.id==h.id||k.ghostId==h.id))}catch(h){console.log("error in markTransactionActions",h)}})}static rollbackTransaction(l,a){return I(this,void 0,void 0,function*(){try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("LocalSyncData__rollbackTransaction",{transactionId:l,actions:a})).data}catch(h){console.error("LocalSyncData__rollbackTransaction sw error: ",h),(0,r.handleServiceWorkerException)(h)}if(this.transactionCollections.some(h=>h.id==l))return;this.transactionCollections=this.transactionCollections.filter(h=>h.id!=l)}catch(h){console.log("LocalSyncData, roll",h)}})}}S.conceptsSyncArray=[],S.connectionSyncArray=[],S.ghostIdMap=new Map,S.transactionCollections=[]},6731:(fe,q,m)=>{m.d(q,{b:()=>B});class B{constructor(r,f,A,N){this.variants=[],this.height=1,this.key=r,this.value=f,this.leftNode=A,this.rightNode=N,this.currentNode=null}addCurrentNode(r,f){return f==null?f=r:(r.value.typeId!=f.value.typeId&&(f.currentNode=this.addCurrentNode(r,f.currentNode)),f)}addCurrentNodeType(r,f){if(f==null)return r;let A=!1;for(let N=0;N<f.variants.length;N++)f.variants[N].value.id==r.value.id&&(A=!0);return A||f.variants.push(r),f}addNode(r,f,A){if(f==null)return r;let N=f.leftNode,s=f.rightNode;if(f.key>r.key)f.leftNode=this.addNode(r,N,A);else{if(!(f.key<r.key))return f;f.rightNode=this.addNode(r,s,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let i=this.getBalanceFactor(f);if(i>1&&f.leftNode){if(r.key<f.leftNode.key)return this.rightRotate(f);if(r.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(i<-1&&f.rightNode){if(r.key>f.rightNode.key)return this.leftRotate(f);if(r.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}return f}checkIfIdsInNode(r,f,A,N){if(r){if(f.includes(r.key)){A.push(r.value);let s=f.indexOf(r.key);f.splice(s,1)}r.leftNode&&this.checkIfIdsInNode(r.leftNode,f,A,N),r.rightNode&&this.checkIfIdsInNode(r.rightNode,f,A,N)}}addCharacterNode(r,f,A){if(r.value.characterValue!=""){if(f==null)return r;let N=f.leftNode,s=f.rightNode;if(f.key>r.key)f.leftNode=this.addCharacterNode(r,N,A);else{if(!(f.key<r.key))return f.key==r.key&&f.key!=""&&f.value.id!=r.value.id&&f.addCurrentNodeType(r,f),f;f.rightNode=this.addCharacterNode(r,s,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let i=this.getBalanceFactor(f);if(i>1&&f.leftNode){if(r.key<f.leftNode.key)return this.rightRotate(f);if(r.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(i<-1&&f.rightNode){if(r.key>f.rightNode.key)return this.leftRotate(f);if(r.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}addTypeNode(r,f,A){if(r.value.typeId!=0){if(f==null)return console.log("adding the type node to the tree",r),r;let N=f.leftNode,s=f.rightNode;if(f.key>r.key)f.leftNode=this.addTypeNode(r,N,A);else{if(!(f.key<r.key))return console.log("adding the type node to the tree down",r),f.key==r.key&&f.key!=0&&f.value.id!=r.value.id&&f.addCurrentNodeType(r,f),console.log("adding the type node to the tree last",f),f;f.rightNode=this.addTypeNode(r,s,A)}f.height=1+Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode));let i=this.getBalanceFactor(f);if(i>1&&f.leftNode){if(r.key<f.leftNode.key)return this.rightRotate(f);if(r.key>f.leftNode.key)return f.leftNode=this.leftRotate(f.leftNode),this.rightRotate(f)}if(i<-1&&f.rightNode){if(r.key>f.rightNode.key)return this.leftRotate(f);if(r.key<f.rightNode.key)return f.rightNode=this.rightRotate(f.rightNode),this.leftRotate(f)}}return f}rightRotate(r){if(r){let f=r.leftNode;if(f){let A=f.rightNode;return r.leftNode=A,f.rightNode=r,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(f.rightNode))+1,f}}return r}leftRotate(r){if(r){let f=r.rightNode;if(f){let A=f.leftNode;return f.leftNode=r,r.rightNode=A,r.height=Math.max(this.getHeight(r.leftNode),this.getHeight(r.rightNode))+1,f.height=Math.max(this.getHeight(f.leftNode),this.getHeight(r.rightNode))+1,f}}return r}getHeight(r){return r?r.height:0}getBalanceFactor(r){return r==null?0:this.getHeight(r.leftNode)-this.getHeight(r.rightNode)}getFromNode(r,f){return f&&(r==f.key?f:r<f.key?this.getFromNode(r,f.leftNode):r>f.key?this.getFromNode(r,f.rightNode):f)}getCharacterFromNode(r,f){return f&&(r==f.key?f:r<f.key?this.getCharacterFromNode(r,f.leftNode):r>f.key?this.getCharacterFromNode(r,f.rightNode):f)}getCharacterFromNodeUpdated(r,f){var A;return f&&(r==f.key||((A=f.value)===null||A===void 0?void 0:A.typeId)==51?f:r<f.key?this.getCharacterFromNode(r,f.leftNode):r>f.key?this.getCharacterFromNode(r,f.rightNode):f)}getFromNodeWithCharacterAndType(r,f,A){if(r=`${r}`,A){if(r==A.key){if(r==A.value.characterValue&&f==A.value.typeId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.typeId==f)return A.variants[N]}else{if(r<A.key)return this.getFromNodeWithCharacterAndType(r,f,A.leftNode);if(r>A.key)return this.getFromNodeWithCharacterAndType(r,f,A.rightNode)}return null}return A}getFromNodeWithCharacterAndCategory(r,f,A){if(r=`${r}`,A){if(r==A.key){if(r==A.value.characterValue&&f==A.value.categoryId)return A;for(let N=0;N<A.variants.length;N++)if(A.variants[N].value.categoryId==f)return A.variants[N]}else{if(r<A.key)return this.getFromNodeWithCharacterAndCategory(r,f,A.leftNode);if(r>A.key)return this.getFromNodeWithCharacterAndCategory(r,f,A.rightNode)}return null}return A}removeNode(r,f){if(r==null)return r;if(r.key>f)return r.leftNode=this.removeNode(r.leftNode,f),r;if(r.key<f)return r.rightNode=this.removeNode(r.rightNode,f),r;if(r.leftNode==null){let A=r.rightNode;return r=null,A}if(r.rightNode==null){let A=r.leftNode;return r=null,A}{let A=this.inOrderSuccessor(r.rightNode);return r.value=A.value,r.key=A.key,r.variants=A.variants,r.currentNode=A.currentNode,r.rightNode=this.removeNode(r.rightNode,A.key),r}}removeNodeWithVariants(r,f,A){if(r==null)return r;if(r.key>f)return r.leftNode=this.removeNodeWithVariants(r.leftNode,f,A),r;if(r.key<f)return r.rightNode=this.removeNodeWithVariants(r.rightNode,f,A),r;if(r.variants.length>0){if(r.value.id==A){let N=r.variants[0];if(N)return r.value=N.value,r.key=N.key,r.currentNode=N.currentNode,r.variants.splice(0,1),r}else for(let N=0;N<r.variants.length;N++)if(A==r.variants[N].value.id)return r.variants.splice(N,1),r}if(r.leftNode==null){let N=r.rightNode;return r=null,N}if(r.rightNode==null){let N=r.leftNode;return r=null,N}{let N=this.inOrderSuccessor(r.rightNode);return r.value=N.value,r.key=N.key,r.variants=N.variants,r.currentNode=N.currentNode,r.rightNode=this.removeNodeWithVariants(r.rightNode,N.key,A),r}}countNodeBelow(r){return r==null?0:1+this.countNodeBelow(r.leftNode)+this.countNodeBelow(r.rightNode)}inOrderSuccessor(r){for(;r.leftNode!=null;)r=r.leftNode;return r}}},5976:(fe,q,m)=>{m.d(q,{p:()=>s,B:()=>N});var B=m(9581),W=m(3518),r=m(1863),f=m(2290),A=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,[])).next())})};class N{static getId(){return A(this,void 0,void 0,function*(){this.ids.length<5&&(yield function(){var v,T,I,S,d=arguments;return v=this,T=void 0,S=function*(){const l=f.Logger.logfunction("GetReservedIds",d);try{let a=(0,W.Xr)("application/x-www-form-urlencoded");const h=yield fetch(B.B.GetReservedIdUrl(),{method:"GET",headers:a});if(!h.ok)throw(0,r.ry)(h),new Error(`Error! status: ${h.status}`);const k=yield h.json();for(let w=0;w<k.length;w++)N.AddId(k[w]);f.Logger.logUpdate(l)}catch(a){a instanceof Error?console.log("get reserved ids error message: ",a.message):console.log("get reserved ids  unexpected error: ",a),(0,r.Mb)(a,B.B.GetReservedIdUrl()),(0,r.ey)(l,"GetReservedIds",a)}},new((I=void 0)||(I=Promise))(function(l,a){function h(L){try{w(S.next(L))}catch(x){a(x)}}function k(L){try{w(S.throw(L))}catch(x){a(x)}}function w(L){var x;L.done?l(L.value):(x=L.value,x instanceof I?x:new I(function(b){b(x)})).then(h,k)}w((S=S.apply(v,T||[])).next())})}());var u=this.ids[0];return this.ids.shift(),u})}static AddId(u){this.ids.includes(u)||this.ids.push(u)}}N.ids=[];class s{static getId(){return A(this,void 0,void 0,function*(){this.connectionIds.length<5&&(yield function(){var v,T,I,S,d=arguments;return v=this,T=void 0,S=function*(){const l=f.Logger.logfunction("GetReservedConnectionIds",d);try{let a=(0,W.Xr)("application/x-www-form-urlencoded");const h=yield fetch(B.B.GetReservedConnectionIdUrl(),{method:"GET",headers:a});if(!h.ok)throw(0,r.ry)(h),new Error(`Error! status: ${h.status}`);const k=yield h.json();for(let w=0;w<k.length;w++)s.AddId(k[w]);f.Logger.logUpdate(l)}catch(a){a instanceof Error?console.log("get reserved connection ids error message: ",a.message):console.log("get reserved connection ids  unexpected error: ",a),(0,r.Mb)(a,B.B.GetReservedConnectionIdUrl()),(0,r.ey)(l,"GetReservedConnectionIds",a)}},new((I=void 0)||(I=Promise))(function(l,a){function h(L){try{w(S.next(L))}catch(x){a(x)}}function k(L){try{w(S.throw(L))}catch(x){a(x)}}function w(L){var x;L.done?l(L.value):(x=L.value,x instanceof I?x:new I(function(b){b(x)})).then(h,k)}w((S=S.apply(v,T||[])).next())})}());var u=this.connectionIds[0];return this.connectionIds.shift(),u})}static AddId(u){this.connectionIds.includes(u)||this.connectionIds.push(u)}}s.connectionIds=[]},7273:(fe,q,m)=>{m.d(q,{z:()=>W});var B=m(9581);class W{constructor(f,A,N,s){this.url=B.B.BASE_URL,this.message=f,this.ok=A,this.status=N,this.data=s}getMessage(){return this.message}setMessage(f){return this.message=f,this}getStatus(){return this.status}setStatus(f){return this.status=f,this}getData(){return this.data}setData(f){return this.data=f,this}getOk(){return this.ok}setOk(f){return this.ok=f,this}getUrl(){return this.url}setUrl(f){return this.url=f,this}}},3278:(fe,q,m)=>{m.d(q,{b:()=>B});class B{static setSession(r){r&&(B.sessionId=r)}}B.BearerAccessToken="",B.sessionId=998},2299:(fe,q,m)=>{m.d(q,{B:()=>B});class B{constructor(r){this.id=1,this.isOnlineSync=!1,this.isOnlineSync=r}}},442:(fe,q,m)=>{m.d(q,{Y:()=>u});var B=m(1167),W=m(2155),r=m(9581),f=m(3518),A=m(1863),N=m(3026),s=m(8286),i=m(2290);class u{static CheckContains(T){for(var I=!1,S=0;S<this.conceptsSyncArray.length;S++)this.conceptsSyncArray[S].id==T.id&&(I=!0);return I}static SyncDataDelete(T){for(var I=0;I<this.conceptsSyncArray.length;I++)T==this.conceptsSyncArray[I].id&&this.conceptsSyncArray.splice(I,1);for(I=0;I<this.connectionSyncArray.length;I++)this.connectionSyncArray[I].ofTheConceptId!=T&&this.connectionSyncArray[I].toTheConceptId!=T&&this.connectionSyncArray[I].typeId!=T||this.connectionSyncArray.splice(I,1)}static CheckContainsConnection(T){for(var I=!1,S=0;S<this.connectionSyncArray.length;S++)this.connectionSyncArray[S].id==T.id&&(I=!0);return I}static AddConcept(T){this.conceptsSyncArray.push(T)}static RemoveConcept(T){for(var I=0;I<this.conceptsSyncArray.length;I++)this.conceptsSyncArray[I].id==T.id&&this.conceptsSyncArray.splice(I,1)}static AddConnection(T){this.connectionSyncArray.push(T)}static RemoveConnection(T){for(var I=0;I<this.connectionSyncArray.length;I++)this.connectionSyncArray[I].id==T.id&&this.connectionSyncArray.splice(I,1)}static SyncDataOnline(){return T=this,I=void 0,d=function*(){if(i.serviceWorker)try{return(yield(0,i.sendMessage)("SyncData__SyncDataOnline",{})).data}catch(l){console.error("SyncData__SyncDataOnline sw error: ",l),(0,i.handleServiceWorkerException)(l)}for(let l=0;l<this.conceptsSyncArray.length;l++)N.I.AddConcept(this.conceptsSyncArray[l]);for(let l=0;l<this.connectionSyncArray.length;l++)s.d.AddConnection(this.connectionSyncArray[l]);if(this.conceptsSyncArray.length>0){let l=this.conceptsSyncArray.slice();this.conceptsSyncArray=[],(0,B.Y)(l)}if(this.connectionSyncArray.length>0){let l=this.connectionSyncArray.slice();this.connectionSyncArray=[],yield function(a){return h=this,k=void 0,L=function*(){let x=new W.N(0,0,0,0,0,0,0);try{var b=(0,f.Xr)(),R=JSON.stringify(a);const D=yield fetch(r.B.CreateTheConnectionUrl(),{method:"POST",headers:b,body:R});return D.ok?yield D.json():(console.log("Create the connection error message: ",D.status),(0,A.ry)(D)),x}catch(D){throw D instanceof Error?console.log("Create the connection error message: ",D.message):console.log(" Create the connection unexpected error: ",D),D}},new((w=void 0)||(w=Promise))(function(x,b){function R(O){try{H(L.next(O))}catch(U){b(U)}}function D(O){try{H(L.throw(O))}catch(U){b(U)}}function H(O){var U;O.done?x(O.value):(U=O.value,U instanceof w?U:new w(function(M){M(U)})).then(R,D)}H((L=L.apply(h,k||[])).next())});var h,k,w,L}(l)}return"done"},new((S=void 0)||(S=Promise))(function(l,a){function h(L){try{w(d.next(L))}catch(x){a(x)}}function k(L){try{w(d.throw(L))}catch(x){a(x)}}function w(L){var x;L.done?l(L.value):(x=L.value,x instanceof S?x:new S(function(b){b(x)})).then(h,k)}w((d=d.apply(T,I||[])).next())});var T,I,S,d}}u.conceptsSyncArray=[],u.connectionSyncArray=[]},9003:(fe,q,m)=>{m.d(q,{S5:()=>s,kH:()=>u,qI:()=>N});var B=m(1863),W=m(2290),r=function(v,T,I,S){return new(I||(I=Promise))(function(d,l){function a(w){try{k(S.next(w))}catch(L){l(L)}}function h(w){try{k(S.throw(w))}catch(L){l(L)}}function k(w){var L;w.done?d(w.value):(L=w.value,L instanceof I?L:new I(function(x){x(L)})).then(a,h)}k((S=S.apply(v,[])).next())})};let f=10;class A{}function N(v){const T=W.Logger.logfunction("openDatabase",arguments);return new Promise(function(I,S){A.db&&(W.Logger.logUpdate(T),I(A.db));let d=W.BaseUrl.BASE_URL+"_FreeSchemaLocal"+W.BaseUrl.BASE_APPLICATION;const l=indexedDB.open(d,f);l.onupgradeneeded=a=>{var h=a.target.result,k="localconcept",w="localconnection",L="localid";console.log("this is the version upgrade",f),h.objectStoreNames.contains(k)&&h.deleteObjectStore(k),h.objectStoreNames.contains(w)&&h.deleteObjectStore(w),h.objectStoreNames.contains(L)&&h.deleteObjectStore(L),h.objectStoreNames.contains(k)||(h.createObjectStore(k,{keyPath:"id"}).transaction.oncomplete=x=>{}),h.objectStoreNames.contains(w)||(h.createObjectStore(w,{keyPath:"id"}).transaction.oncomplete=x=>{}),h.objectStoreNames.contains(L)||(h.createObjectStore(L,{keyPath:"id"}).transaction.oncomplete=x=>{i(L,{id:0,value:-100}),i(L,{id:1,value:-200}),i(L,{id:3,value:W.BaseUrl.getRandomizer()})}),I(h)},l.onerror=a=>{console.error("Why didn't you allow my web app to use IndexedDB?!",a),indexedDB.deleteDatabase(d),N(v),(0,B.ey)(T,"openDatabase",a),S(a)},l.onsuccess=function(a){var h=a.target;A.db=h.result,W.Logger.logUpdate(T),I(A.db)}})}function s(v){var T=arguments;return r(this,void 0,void 0,function*(){const I=W.Logger.logfunction("getObjectsFromLocalIndexDb",T);return new Promise(function(S,d){N(v).then(l=>{var a=[],h=l.transaction(v,"readwrite").objectStore(v).getAll();h.onsuccess=()=>{const k=h.result;for(var w=0;w<k.length;w++)a.push(k[w]);W.Logger.logUpdate(I),S(a)}}).catch(l=>{let a={status:400,ok:!1,message:"Cannot get objects from database because you cannot open the Local database",data:l};(0,B.ey)(I,"getObjectsFromLocalIndexDb",a),d(a)})})})}function i(v,T){const I=W.Logger.logfunction("storeToDatabase",[v,"localindexdb"]);return new Promise(function(S,d){N(v).then(l=>{const a=l.transaction(v,"readwrite").objectStore(v).add(T);a.onsuccess=h=>{W.Logger.logUpdate(I),S(T)},a.onerror=h=>{let k={status:400,ok:!1,message:"Cannot store to the Local database "+v,data:h,body:T};(0,B.ey)(I,"storeToDatabase",k),d(k)}}).catch(l=>{let a={status:400,ok:!1,message:"Cannot store to database because you cannot open the Local database",data:l};(0,B.ey)(I,"storeToDatabase",a),d(a)})})}function u(v,T){const I=W.Logger.logfunction("UpdateToDatabase",arguments);return new Promise(function(S,d){N(v).then(l=>{const a=l.transaction(v,"readwrite").objectStore(v).put(T);a.onsuccess=h=>{W.Logger.logUpdate(I),S(T)},a.onerror=h=>{let k={status:400,ok:!1,message:"Cannot Update to the Local database"+v,data:h,body:T};(0,B.ey)(I,"UpdateToDatabase",k),d(k)}}).catch(l=>{let a={status:400,ok:!1,message:"Cannot update to database because you cannot open the Local database",data:l};(0,B.ey)(I,"UpdateToDatabase",a),d(a)})})}},3655:(fe,q,m)=>{m.d(q,{El:()=>v,b8:()=>u,kH:()=>i,qI:()=>s,wh:()=>T});var B=m(2299),W=m(9581),r=m(2290),f=m(1863);let A=10;class N{}function s(I){const S=r.Logger.logfunction("openDatabase",[I,"indexdb"]);return new Promise(function(d,l){N.db&&(r.Logger.logUpdate(S),d(N.db));let a=W.B.BASE_URL+"_FreeSchema"+W.B.BASE_APPLICATION;const h=indexedDB.open(a,A);console.log("this is the update version",A,h),h.onupgradeneeded=k=>{let w=k.target.result,L="concept",x="connection",b="settings";console.log("this is the version update for index",A),w.objectStoreNames.contains(L)&&w.deleteObjectStore(L),w.objectStoreNames.contains(x)&&w.deleteObjectStore(x),w.objectStoreNames.contains(b)&&w.deleteObjectStore(b),w.objectStoreNames.contains(L)||(w.createObjectStore(L,{keyPath:"id"}).transaction.oncomplete=R=>{}),w.objectStoreNames.contains(x)||(w.createObjectStore(x,{keyPath:"id"}).transaction.oncomplete=R=>{}),w.objectStoreNames.contains(b)||(w.createObjectStore(b,{keyPath:"id"}).transaction.oncomplete=R=>{}),r.Logger.logUpdate(S),d(w)},h.onerror=k=>{console.error("Why didn't you allow my web app to use IndexedDB?!",k),indexedDB.deleteDatabase(a),s(I),(0,f.ey)(S,"openDatabase",k),l(k)},h.onsuccess=function(k){let w=k.target;N.db=w.result,r.Logger.logUpdate(S),d(N.db)}})}function i(I,S){const d=r.Logger.logfunction("UpdateToDatabase",[I,"indexdb"]);return new Promise(function(l,a){s(I).then(h=>{const k=h.transaction(I,"readwrite").objectStore(I).put(S);k.onsuccess=w=>{r.Logger.logUpdate(d),l(S)},k.onerror=w=>{let L={status:400,ok:!1,message:"Cannot Update to the database"+I,data:w,body:S};(0,f.ey)(d,"UpdateToDatabase",L),a(L)}}).catch(h=>{let k={status:400,ok:!1,message:"Cannot update to database because you cannot open the database",data:h};(0,f.ey)(d,"UpdateToDatabase",k),a(k)})})}function u(){const I=r.Logger.logfunction("GetLastSettingsFromDatabase",["indexdb"]);return new Promise(function(S,d){let l="settings";s(l).then(a=>{let h=a.transaction(l,"readwrite").objectStore(l).getAll();h.onsuccess=()=>{let k=new B.B(!1),w=h.result;for(let L=0;L<w.length;L++)k=w[L];r.Logger.logUpdate(I),S(k)},h.onerror=k=>{(0,f.ey)(I,"GetLastSettingsFromDatabase",k),d(k)}}).catch(a=>{let h={status:400,ok:!1,message:"Cannot get last object from database because you cannot open the database",data:a};(0,f.ey)(I,"GetLastSettingsFromDatabase",h),d(h)})})}function v(I){const S=r.Logger.logfunction("AiUpdateFlag",["indexdb"]);return new Promise(function(d,l){let a="settings";s(a).then(h=>{const k=h.transaction(a,"readwrite").objectStore(a).put(I);k.onsuccess=w=>{r.Logger.logUpdate(S),d(I)},k.onerror=w=>{let L={status:400,ok:!1,message:"Cannot update AI flag",data:w,body:I};(0,f.ey)(S,"AiUpdateFlag",L),l(L)}}).catch(h=>{let k={status:400,ok:!1,message:"Cannot update AI flag because you cannot open the database",data:h};(0,f.ey)(S,"AiUpdateFlag",k),l(k)})})}function T(I,S){const d=r.Logger.logfunction("removeFromDatabase",[I,"indexdb"]);return new Promise(function(l,a){s(I).then(h=>{const k=h.transaction(I,"readwrite").objectStore(I).delete(Number(S));k.onsuccess=function(w){r.Logger.logUpdate(d),l(S)},k.onerror=w=>{let L={status:400,ok:!1,message:"Cannot remove from the database"+I,data:w};(0,f.ey)(d,"removeFromDatabase",L),a(L)}}).catch(h=>{let k={status:400,ok:!1,message:"Cannot remove from the database because you cannot open the database",data:h,body:S};(0,f.ey)(d,"removeFromDatabase",k),a(k)})})}},4485:(fe,q,m)=>{function B(A=[],N){var s,i;let u=[],v=(s=N.type)===null||s===void 0?void 0:s.characterValue;if(v?.startsWith("the_")||(v="the_"+v),Array.isArray(A))for(let T=0;T<A.length;T++){let I=(i=A[T].type)===null||i===void 0?void 0:i.characterValue;I?.startsWith("the_")||(I="the_"+I),N.typeId!=A[T].typeId&&v!=I||u.push(A[T])}return u}function W(A=[],N){let s=[],i=N.typeCharacter;if(i?.startsWith("the_")||(i="the_"+i),Array.isArray(A))for(let u=0;u<A.length;u++){let v=A[u].typeCharacter;v?.startsWith("the_")||(v="the_"+v),N.typeId!=A[u].typeId&&i!=v||s.push(A[u])}return s}function r(A=[],N){let s=[];if(Array.isArray(A)){const i=A.find(v=>v.toTheConceptId==N);i&&s.push(i);const u=A.find(v=>v.ofTheConceptId==N);u&&s.push(u)}return s}function f(A=[],N){let s=[];if(Array.isArray(A)){const i=A.find(v=>v.toTheConceptId==N);i&&s.push(i);const u=A.find(v=>v.ofTheConceptId==N);u&&s.push(u)}return s}m.d(q,{gt:()=>f,nm:()=>W,vo:()=>B,wS:()=>r}),m(2155),m(7282)},9934:(fe,q,m)=>{function B(W,r){return W.indexOf(r)===-1&&W.push(r),W}m.d(q,{A:()=>B})},9700:(fe,q,m)=>{m.d(q,{V:()=>s});var B,W=m(2290),r=m(3278),f=m(1863),A=m(3518),N=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,[])).next())})};class s{static startAutoSync(){this.autoSyncInterval?console.warn("Auto-sync is already running."):(this.nextSyncTime=Date.now()+this.SYNC_INTERVAL_MS,setInterval(()=>{const u=Date.now();this.nextSyncTime&&u>=this.nextSyncTime&&(this.nextSyncTime=u+this.SYNC_INTERVAL_MS,this.sendPackageLogsToServer(),this.sendApplicationLogsToServer())},3e4))}static stopAutoSync(){this.autoSyncInterval!==null&&(clearInterval(this.autoSyncInterval),this.autoSyncInterval=null,this.nextSyncTime=null)}static setLogLevel(u){this.logLevel=u}static shouldLog(u){return this.LOG_LEVELS.indexOf(u)>=this.LOG_LEVELS.indexOf(this.logLevel)}static formatLogData(u,v,T){const I=Object.assign({timestamp:new Date().toISOString(),level:u,message:v},T);return this.packageLogsData.push(I),u=="ERROR"&&(this.sendPackageLogsToServer(),this.sendApplicationLogsToServer()),I}static log(u,v,T){if(this.logPackageActivationStatus)try{this.formatLogData(u,v,T||null)}catch(I){console.error("Error on Logger Log : ",I)}}static logUpdate(u){var v;try{if(!this.logPackageActivationStatus)return{};if(!u)return{};const T=Date.now();u.startTime=(v=u.startTime)!==null&&v!==void 0?v:T;const I=T-u.startTime;u.responseTime=`${I} ms`,!u.serviceWorker==1&&(u.serviceWorker=!1)}catch(T){(0,f.ey)(u,"Logger.logUpdate",T)}}static logfunction(u,...v){if(!this.logPackageActivationStatus)return{};const T=Date.now();let I=v;const S=W.BaseUrl.getRandomizer(),d=r.b.sessionId;let l={startTime:T,functionName:u,functionParameters:I,requestFrom:W.BaseUrl.BASE_APPLICATION,sessionId:d,applicationId:S};return this.formatLogData("INFO","function called",l)}static logError(u,v,T,I,S,d,l,a,h,k,w){try{const L=r.b.sessionId,x={startTime:u,userId:v,operationType:T,requestFrom:I,requestIP:S,responseStatus:d,responseTime:`${(performance.now()-u).toFixed(3)}ms`,responseSize:l?`${JSON.stringify(l).length}`:"0",sessionId:L?.toString(),functionName:a,functionParameters:h,userAgent:k,conceptsUsed:w};this.formatLogData("ERROR",`Information logged for ${a}`,x)}catch{console.error("Error on logError")}}static logApplication(u,v,T){if(this.logApplicationActivationStatus)try{const I={timestamp:new Date().toISOString(),level:u,message:v,data:T||null};this.applicationLogsData.push(I)}catch(I){console.error("Failed to log application activity:",I)}}static sendApplicationLogsToServer(){return N(this,void 0,void 0,function*(){const u=this.applicationLogsData;try{if(u.length===0)return;this.applicationLogsData=[],r.b.BearerAccessToken;const v=50;let T=(0,A.Xr)(),I=0;for(;u.length!=0;){const S=u.slice(0,v),d=yield fetch(W.BaseUrl.PostLogger(),{method:"POST",headers:T,body:JSON.stringify({logType:this.appLogs,logData:S})});d.ok||(yield d.text()),u.splice(0,v),I+=v,I++}}catch{}})}static sendPackageLogsToServer(){return N(this,void 0,void 0,function*(){const u=this.packageLogsData;try{if(u.length===0)return;this.packageLogsData=[];const v=300;let T=0;for(;u.length!=0;){const I=u.slice(0,v);let S=(0,A.Xr)();const d=yield fetch(W.BaseUrl.PostLogger(),{method:"POST",headers:S,body:JSON.stringify({logType:this.mftsccsBrowser,logData:I})});if(!d.ok)return void(yield d.text());u.splice(0,v),T++}}catch{}})}static saveLogToLocalStorage(u,v){try{if(typeof localStorage===void 0)return void console.warn("Local Storage type undefined");{const T=JSON.parse((localStorage==null?void 0:localStorage.getItem(u))||"[]");T.push(v),localStorage?.setItem(u,JSON.stringify(T))}}catch{console.error("Error on saving log in localstorage"),this.log("ERROR","Error while saving log in local storage")}}static clearLogsFromLocalStorage(u){typeof localStorage!==void 0?localStorage?.removeItem(u):console.warn("localStorage is not available")}}B=s,s.logLevel="INFO",s.packageLogsData=[],s.applicationLogsData=[],s.LOG_LEVELS=["DEBUG","INFO","WARNING","ERROR"],s.SYNC_INTERVAL_MS=6e4,s.nextSyncTime=null,s.appLogs="app",s.mftsccsBrowser="mftsccs",s.logApplicationActivationStatus=!1,s.logPackageActivationStatus=!1,s.autoSyncInterval=null,B.startAutoSync()},1412:(fe,q,m)=>{function B(W=[],r=[]){}m.d(q,{e:()=>B})},4698:(fe,q,m)=>{m.d(q,{V:()=>N,w:()=>A});var B=m(7139),W=m(2290),r=m(276),f=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,[])).next())})};function A(i=[]){let u=[];if(i.length>0)for(let v=0;v<i.length;v++){let T=s(i[v]);u.push(T)}return u}function N(i){var u=arguments;return f(this,void 0,void 0,function*(){const v=W.Logger.logfunction("GetConnectionTypeForCount",u);let T={};for(let I=0;I<i.length;I++){let S=yield(0,B.r)(i[I].connectionTypeId);i[I].connectionType=S.characterValue,T[i[I].conceptId]=i[I]}return W.Logger.logUpdate(v),T})}function s(i){const u=i.split("_");if(u.length===3){let v=new r.y;return v.conceptId=Number(u[0]),v.connectionTypeId=Number(u[1]),v.count=Number(u[2]),v}throw new Error("Input string must contain exactly three parts separated by underscores.")}},1863:(fe,q,m)=>{m.d(q,{ER:()=>f,Mb:()=>A,ey:()=>N,ry:()=>r});var B=m(2290),W=m(7273);function r(s){if(B.Logger.log("ERROR",s.statusText,{code:s.status,data:s.statusText}),s.status==401||s.status==406){let i=new W.z(s.statusText,!1,s.status,"");throw i.setUrl(s.url),i}if(s.status==500){let i=new W.z(s.statusText,!1,s.status,"");throw i.setUrl(s.url),i}}function f(s,i={}){if(B.Logger.log("ERROR",i.statusText,{code:s.status,data:s.status}),s.status==401||s.status==406){let u=new W.z(i.statusText,!1,s.status,"");throw u.setUrl(s.url),u}if(s.status==500){let u=new W.z(i.statusText,!1,s.status,"");throw u.setUrl(s.url),u}}function A(s,i=""){if(B.Logger.log("ERROR",s.message,{code:s.status,data:s.stack}),s.status){let u=new W.z(s.message,!1,s.status,s.stack);throw u.setUrl(i),u}{let u=new W.z(s.message,!1,500,s.stack);throw u.setUrl(i),u}}function N(s,i,u){var v;try{if(!s)return void console.error(`Error in ${i}: logData is undefined`);const T=Date.now();s.startTime=(v=s.startTime)!==null&&v!==void 0?v:T,s.responseTime=T-s.startTime+" ms",s.level="ERROR",s.errorMessage=u?.message||"Unknown error occurred",console.error(`Error in function ${i}:`,u)}catch(T){console.error("Failed to handle package function error:",T)}}},1708:(fe,q,m)=>{m.d(q,{Az:()=>v});var B=m(8146),W=m(3026),r=m(9581),f=m(3518),A=m(2290),N=m(1863),s=m(7876),i=function(T,I,S,d){return new(S||(S=Promise))(function(l,a){function h(L){try{w(d.next(L))}catch(x){a(x)}}function k(L){try{w(d.throw(L))}catch(x){a(x)}}function w(L){var x;L.done?l(L.value):(x=L.value,x instanceof S?x:new S(function(b){b(x)})).then(h,k)}w((d=d.apply(T,[])).next())})},u=function(T,I,S,d){return new(S||(S=Promise))(function(l,a){function h(L){try{w(d.next(L))}catch(x){a(x)}}function k(L){try{w(d.throw(L))}catch(x){a(x)}}function w(L){var x;L.done?l(L.value):(x=L.value,x instanceof S?x:new S(function(b){b(x)})).then(h,k)}w((d=d.apply(T,[])).next())})};function v(T){return u(this,void 0,void 0,function*(){const I=A.Logger.logfunction("GetConceptByCharacterAndCategory",T);let S=(0,A.CreateDefaultConcept)();if(T=="the")return S.id=1,S.typeId=5,S.characterValue="the",S;let d=(0,A.SplitStrings)(T);if(d.length>1){let l=1,a=yield v(d[0]);a.id!=0&&(l=a.id),S=yield function(h,k){var w=arguments;return u(this,void 0,void 0,function*(){const L=A.Logger.logfunction("GetConceptByCharacterAndCategoryFromMemory",w);let x=yield A.ConceptsData.GetConceptByCharacterAndCategoryLocal(h,k);return x.id==0&&(x=yield function(b,R){var D=arguments;return i(this,void 0,void 0,function*(){const H=A.Logger.logfunction("GetConceptByCharacterAndCategoryDirectApi",D);let O=(0,A.CreateDefaultConcept)();try{var U=(0,f.Xr)("application/x-www-form-urlencoded");const M=yield fetch(r.B.GetConceptByCharacterAndCategoryDirectUrl(),{method:"POST",headers:U,body:`character_value=${b}&category_id=${R}`});M.ok?(O=yield M.json(),(0,s.K)(O).then(()=>{W.I.AddConcept(O)})):(console.log("This is the concept by category and character error",M.status),(0,N.ry)(M)),A.Logger.logUpdate(H)}catch(M){M instanceof Error?console.log(" This is the concept by category and character error message: ",M.message):console.log(" This is the concept by category and character unexpected error: ",M),(0,N.Mb)(M,r.B.GetConceptByCharacterAndCategoryDirectUrl()),(0,N.ey)(H,"GetConceptByCharacterAndCategoryDirectApi",M)}return O})}(h,k)),A.Logger.logUpdate(L),x})}(T,l)}else d[0]==T&&(S=yield function(l){var a=arguments;return u(this,void 0,void 0,function*(){const h=A.Logger.logfunction("GetConceptByCharacter",a);let k=yield A.ConceptsData.GetConceptByCharacterAndTypeLocal(l,51);return k.id==0&&(k=yield(0,B.Y)(l)),A.Logger.logUpdate(h),k})}(T));return A.Logger.logUpdate(I),S})}},176:(fe,q,m)=>{m.d(q,{F4:()=>f,P6:()=>N,dp:()=>A});var B=m(2155),W=m(7282),r=m(6416);function f(s){var i,u;const v=(0,r.u)();return v.id=s.id,v.ghostId=s.ghostId,v.userId=s.userId,v.accessId=s.accessId,v.categoryId=s.categoryId,v.characterValue=s.characterValue,v.entryTimeStamp=s.entryTimeStamp,v.typeId=s.typeId,v.type=s.type,v.isTemp=!1,v.typeCharacter=(u=(i=s?.type)===null||i===void 0?void 0:i.characterValue)!==null&&u!==void 0?u:"",v}function A(s){const i=(0,W.o)();return i.id=s.id,i.ghostId=s.ghostId,i.userId=s.userId,i.accessId=s.accessId,i.entryTimeStamp=s.entryTimeStamp,i.typeId=s.typeId,i.categoryId=s.categoryId,i}function N(s){const i=new B.N(0,0,0,0,0,0,0);return i.id=s.id,i.ghostId=s.ghostId,i.accessId=s.accessId,i.ofTheConceptId=s.ofTheConceptId,i.toTheConceptId=s.toTheConceptId,i.entryTimeStamp=s.entryTimeStamp,i.typeId=s.typeId,i.isTemp=!1,i}},5020:(fe,q,m)=>{m.d(q,{A:()=>A});var B=m(2290),W=m(3026),r=m(205),f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,[])).next())})};function A(){return f(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let s=0;s<N.length;s++){let i=N[s];W.I.AddConceptToMemory(i)}r.B.isDataLoaded=!0,r.B.isCharacterLoaded=!0,r.B.isTypeLoaded=!0}catch(N){throw yield(0,B.DelayFunctionExecution)(2e3,A()),{message:"Cannot create Binary Tree Concept",ok:!1,status:400,data:N}}})}},7282:(fe,q,m)=>{m.d(q,{Y:()=>r,o:()=>W});var B=m(2615);function W(){let f=r(new Date),A=r(new Date);return new B.j(0,0,0,0,0,"0",0,!1,f,A,"0")}function r(f){const A=f.getMonth()+1,N=f.getDate(),s=f.getFullYear();let i=f.getHours();const u=f.getMinutes(),v=f.getSeconds(),T=i>=12?"PM":"AM";i%=12,i=i||12;const I=S=>S.toString().padStart(2,"0");return`${A}/${N}/${s} ${i}:${I(u)}:${I(v)} ${T}`}},1218:(fe,q,m)=>{m.d(q,{A:()=>N});var B=m(2290),W=m(7282),r=m(1666),f=m(8407),A=function(s,i,u,v){return new(u||(u=Promise))(function(T,I){function S(a){try{l(v.next(a))}catch(h){I(h)}}function d(a){try{l(v.throw(a))}catch(h){I(h)}}function l(a){var h;a.done?T(a.value):(h=a.value,h instanceof u?h:new u(function(k){k(h)})).then(S,d)}l((v=v.apply(s,i||[])).next())})};function N(s){return A(this,arguments,void 0,function*(i,u=null,v=null,T=null,I=null,S=null,d=null){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("CreateTheComposition",{json:i,ofTheConceptId:u,ofTheConceptUserId:v,mainKey:T,userId:I,accessId:S,sessionInformationId:d})).data}catch(L){console.error("CreateTheComposition sw error: ",L),(0,B.handleServiceWorkerException)(L)}let l=I??999,a=S??4,h=d??999,k=T??0,w=(0,W.o)();for(const L in i)if(typeof i[L]!="string"&&typeof i[L]!="number")if(u==null&&v==null){let x=k,b=yield(0,f.A)(L,"",!0,l,a,h);w=b,x=b.id,k=b.id,yield N(i[L],b.id,b.userId,x,I,S,d)}else{let x=u??999,b=v??999,R=k,D=yield(0,f.A)(L,"",!0,l,a,h);w=D,yield(0,r.q)(x,b,D.id,R),yield N(i[L],D.id,D.userId,R,I,S,d)}else{let x=u??999,b=v??10267,R=k,D=yield(0,f.A)(L,i[L].toString(),!1,l,a,h);yield(0,r.q)(x,b,D.id,R)}return w})}},2212:(fe,q,m)=>{m.d(q,{Ay:()=>s,N:()=>i});var B=m(1167),W=m(2615),r=m(5976),f=m(442),A=m(2290),N=function(u,v,T,I){return new(T||(T=Promise))(function(S,d){function l(k){try{h(I.next(k))}catch(w){d(w)}}function a(k){try{h(I.throw(k))}catch(w){d(w)}}function h(k){var w;k.done?S(k.value):(w=k.value,w instanceof T?w:new T(function(L){L(w)})).then(l,a)}h((I=I.apply(u,[])).next())})};function s(u,v,T,I,S,d,l){return N(this,void 0,void 0,function*(){let a=yield r.B.getId(),h=new Date,k=new Date,w=new W.j(a,v,I,T,S,u,d,!0,h,k,l);return w.isTemp=!1,f.Y.AddConcept(w),w})}function i(u,v,T,I,S,d,l){return N(this,void 0,void 0,function*(){let a=yield r.B.getId(),h=new Date,k=new Date,w=new W.j(a,v,I,T,S,u,d,!1,h,k,l);return A.ConceptsData.AddConcept(w),(0,B.Y)([w]),w})}},1666:(fe,q,m)=>{m.d(q,{q:()=>f});var B=m(2155),W=m(442),r=m(1863);function f(A,N,s,i){var u=N,v=new B.N(0,A,s,u,i,1,4);if(A==s)return v.ofTheConceptId=0,v.toTheConceptId=1,v;try{v.isTemp=!0,v.id=Math.floor(1e8*Math.random()),W.Y.AddConnection(v)}catch(T){(0,r.Mb)(T)}return v}},4818:(fe,q,m)=>{m.d(q,{m:()=>v,E:()=>T});var B=m(2290),W=m(1863),r=m(3518),f=function(I,S,d,l){return new(d||(d=Promise))(function(a,h){function k(x){try{L(l.next(x))}catch(b){h(b)}}function w(x){try{L(l.throw(x))}catch(b){h(b)}}function L(x){var b;x.done?a(x.value):(b=x.value,b instanceof d?b:new d(function(R){R(b)})).then(k,w)}L((l=l.apply(I,[])).next())})},A=m(9581),N=function(I,S,d,l){return new(d||(d=Promise))(function(a,h){function k(x){try{L(l.next(x))}catch(b){h(b)}}function w(x){try{L(l.throw(x))}catch(b){h(b)}}function L(x){var b;x.done?a(x.value):(b=x.value,b instanceof d?b:new d(function(R){R(b)})).then(k,w)}L((l=l.apply(I,[])).next())})},s=m(5239),i=m(4864),u=function(I,S,d,l){return new(d||(d=Promise))(function(a,h){function k(x){try{L(l.next(x))}catch(b){h(b)}}function w(x){try{L(l.throw(x))}catch(b){h(b)}}function L(x){var b;x.done?a(x.value):(b=x.value,b instanceof d?b:new d(function(R){R(b)})).then(k,w)}L((l=l.apply(I,[])).next())})};function v(I){var S=arguments;return u(this,void 0,void 0,function*(){const d=B.Logger.logfunction("DeleteConnectionById",S);if(B.serviceWorker)try{return(yield(0,B.sendMessage)("DeleteConnectionById",{id:I})).data}catch(a){console.error("DeleteConnectionById sw error: ",a),(0,B.handleServiceWorkerException)(a)}let l=!0;return I>0?(l=yield function(a){var h=arguments;return N(this,void 0,void 0,function*(){const k=B.Logger.logfunction("DeleteTheConnection",h);let w=!1;try{const L=new FormData;L.append("id",a.toString());let x=(0,r.BZ)();const b=yield fetch(A.B.DeleteTheConnectionUrl(),{method:"POST",headers:x,body:L,redirect:"follow"});B.Logger.logUpdate(k),b.ok?w=(yield b.json()).success:(console.log("Delete connection error status: ",b.status),(0,W.ry)(b)),w&&B.ConnectionData.AddNpConn(a)}catch(L){L instanceof Error?console.log("Delete connection error message: ",L.message):console.log("Delete connection unexpected error: ",L),(0,W.Mb)(L,A.B.DeleteTheConnectionUrl()),(0,W.ey)(k,"DeleteTheConnection",L)}return w})}(I),s.O.removeNodeFromTree(I)):i.G.RemoveConnectionById(I),B.Logger.logUpdate(d),l})}function T(I){var S=arguments;return u(this,void 0,void 0,function*(){const d=B.Logger.logfunction("DeleteConnectionByIdBulk",S);if(B.serviceWorker)try{return(yield(0,B.sendMessage)("DeleteConnectionByIdBulk",{ids:I})).data}catch(a){console.error("DeleteConnectionByIdBulk sw error: ",a),(0,B.handleServiceWorkerException)(a)}let l=yield function(a){var h=arguments;return f(this,void 0,void 0,function*(){const k=B.Logger.logfunction("DeleteTheConnectionBulkApi",h);let w=!1;try{let L=(0,r.BZ)();L.append("Content-Type","application/json");const x=yield fetch(B.BaseUrl.DeleteTheConnectionBulkUrl(),{method:"POST",headers:L,body:JSON.stringify(a)});if(B.Logger.logUpdate(k),x.ok?w=(yield x.json()).success:(console.log("Delete connection Bulk Api error status: ",x.status),(0,W.ry)(x)),w)for(let b=0;b<a.length;b++){let R=a[b];B.ConnectionData.AddNpConn(R)}}catch(L){L instanceof Error?console.log("Delete connection Bulk Api error message: ",L.message):console.log("Delete connection Bulk Api unexpected error: ",L),(0,W.Mb)(L,B.BaseUrl.DeleteTheConnectionUrl()),(0,W.ey)(k,"DeleteTheConnectionBulkApi",L)}return w})}(I);if(l)for(let a=0;a<I.length;a++){let h=I[a];h>0?s.O.removeNodeFromTree(h):i.G.RemoveConnectionById(h)}return B.Logger.logUpdate(d),l})}},2289:(fe,q,m)=>{m.d(q,{$S:()=>i,L0:()=>u,WC:()=>v});var B=m(8675),W=m(6058),r=m(2290),f=m(1863);m(3518);var A=m(1708),N=m(4818),s=function(T,I,S,d){return new(S||(S=Promise))(function(l,a){function h(L){try{w(d.next(L))}catch(x){a(x)}}function k(L){try{w(d.throw(L))}catch(x){a(x)}}function w(L){var x;L.done?l(L.value):(x=L.value,x instanceof S?x:new S(function(b){b(x)})).then(h,k)}w((d=d.apply(T,I||[])).next())})};function i(T,I){var S=arguments;return s(this,void 0,void 0,function*(){const d=r.Logger.logfunction("DeleteConnectionByType",S)||{};if(r.serviceWorker){d.serviceWorker=!0;try{const L=yield(0,r.sendMessage)("DeleteConnectionByType",{id:T,linker:I});return r.Logger.logUpdate(d),L.data}catch(L){console.error("DeleteConnectionByType sw error: ",L),(0,f.ey)(d,"DeleteConnectionByType",L),(0,r.handleServiceWorkerException)(L)}}let l=yield(0,B.l)(T);for(let L=0;L<l.length;L++)r.ConnectionData.AddConnection(l[L]);let a=yield r.ConnectionData.GetConnectionsOfConcept(T),h=yield(0,r.GetConceptByCharacter)(I),k=[];for(let L=0;L<a.length;L++)a[L].typeId==h.id&&k.push(a[L]);let w=!1;for(let L=0;L<k.length;L++)w=yield(0,r.DeleteConnectionById)(k[L].id);return r.Logger.logUpdate(d),w})}function u(T,I){var S=arguments;return s(this,void 0,void 0,function*(){const d=r.Logger.logfunction("DeleteConnectionByTypeBulk",S)||{};if(r.serviceWorker){d.serviceWorker=!0;try{const w=yield(0,r.sendMessage)("DeleteConnectionByTypeBulk",{id:T,linkers:I});return r.Logger.logUpdate(d),w.data}catch(w){console.error("DeleteConnectionByTypeBulk sw error: ",w),(0,f.ey)(d,"DeleteConnectionByTypeBulk",w),(0,r.handleServiceWorkerException)(w)}}let l=yield(0,B.l)(T);for(let w=0;w<l.length;w++)r.ConnectionData.AddConnection(l[w]);let a=yield r.ConnectionData.GetConnectionsOfConcept(T),h=[];for(let w=0;w<I.length;w++){let L=I[w],x=yield(0,A.Az)(L);h.push(x)}let k=[];console.log("this is all the connections for deleting taken",a,h,I);for(let w=0;w<a.length;w++)for(let L=0;L<h.length;L++)a[w].typeId==h[L].id&&k.push(a[w].id);return console.log("these are the to delete",k),r.Logger.logUpdate(d),yield(0,N.E)(k)})}function v(T,I){return s(this,arguments,void 0,function*(S,d,l=!1){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetAllTheConnectionsByTypeAndOfTheConcept",{id:S,linker:d,reverse:l})).data}catch(h){console.error("GetAllTheConnectionsByTypeAndOfTheConcept sw error: ",h),(0,r.handleServiceWorkerException)(h)}let a=[];if(l){let h=yield(0,W.W)(S),k=yield(0,r.MakeTheTypeConceptApi)(d,999);for(let w=0;w<h.length;w++)h[w].typeId==k.id&&a.push(h[w])}else{let h=yield(0,B.l)(S);for(let L=0;L<h.length;L++)r.ConnectionData.AddConnection(h[L]);let k=yield r.ConnectionData.GetConnectionsOfConcept(S),w=yield(0,r.GetConceptByCharacter)(d);for(let L=0;L<k.length;L++)k[L].typeId==w.id&&a.push(k[L])}return a})}},4364:(fe,q,m)=>{m.d(q,{s:()=>f});var B=m(1239),W=m(2290),r=function(A,N,s,i){return new(s||(s=Promise))(function(u,v){function T(d){try{S(i.next(d))}catch(l){v(l)}}function I(d){try{S(i.throw(d))}catch(l){v(l)}}function S(d){var l;d.done?u(d.value):(l=d.value,l instanceof s?l:new s(function(a){a(l)})).then(T,I)}S((i=i.apply(A,N||[])).next())})};function f(){return r(this,arguments,void 0,function*(A=[]){const N=W.Logger.logfunction("FindConceptsFromConnections",[A.length]);let s=[];if(A.length>0){for(let i=0;i<A.length;i++)s.includes(A[i].ofTheConceptId)||s.push(A[i].ofTheConceptId),s.includes(A[i].toTheConceptId)||s.push(A[i].toTheConceptId),s.includes(A[i].typeId)||s.push(A[i].typeId);yield(0,B.r)(s)}W.Logger.logUpdate(N)})}},5284:(fe,q,m)=>{m.d(q,{B:()=>A});var B=m(2290),W=m(8286),r=m(1863),f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,s||[])).next())})};function A(){return f(this,arguments,void 0,function*(N=[]){const s=B.Logger.logfunction("FindConnectionsOfCompositionsBulkInMemory",[N.length])||{};let i=[];try{if(B.serviceWorker){s.serviceWorker=!0;try{const u=yield(0,B.sendMessage)("FindConnectionsOfCompositionsBulkInMemory",{composition_ids:N});return B.Logger.logUpdate(s),u.data}catch(u){console.error("FindConnectionsOfCompositionsBulkInMemory sw error: ",u),(0,r.ey)(s,"FindConnectionsOfCompositionsBulkInMemory",u),(0,B.handleServiceWorkerException)(u)}}for(let u=0;u<N.length;u++){let v=yield W.d.GetConnectionsOfConcept(N[u]);i.push(...v)}return B.Logger.logUpdate(s),i}catch(u){return console.error("FindConnectionsOfCompositionsBulkInMemory error: ",u),(0,r.ey)(s,"FindConnectionsOfCompositionsBulkInMemory",u),i}})}},8939:(fe,q,m)=>{m.d(q,{$N:()=>w,$V:()=>v,Ez:()=>L,JA:()=>h,Mb:()=>S,Nj:()=>I,PT:()=>k,RW:()=>a,XI:()=>l,ay:()=>u,hL:()=>i,kx:()=>d,re:()=>T,yz:()=>x,zN:()=>D});var B=m(7139),W=m(2),r=m(3026),f=m(8286),A=m(2290),N=m(1863),s=function(O,U,M,j){return new(M||(M=Promise))(function($,Y){function X(K){try{Q(j.next(K))}catch(he){Y(he)}}function ee(K){try{Q(j.throw(K))}catch(he){Y(he)}}function Q(K){var he;K.done?$(K.value):(he=K.value,he instanceof M?he:new M(function(ye){ye(he)})).then(X,ee)}Q((j=j.apply(O,U||[])).next())})};function i(O){return s(this,void 0,void 0,function*(){let U={connectionList:[],compositionList:[]};try{if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionById",{id:O})).data}catch(j){console.error("GetCompositionById error sw: ",j),(0,A.handleServiceWorkerException)(j)}let M=yield(0,W.s)(O);U.connectionList=M;for(let j=0;j<U.connectionList.length;j++)U.compositionList.includes(U.connectionList[j].ofTheConceptId)||U.compositionList.push(U.connectionList[j].ofTheConceptId);return U}catch(M){return console.error("GetCompositionById error: ",M),U}})}function u(O,U,M){return s(this,void 0,void 0,function*(){var j,$;let Y={},X=yield r.I.GetConcept(O);X.id==0&&O!=null&&O!=null&&(X=yield(0,B.r)(O));let ee=yield D(O,U,M);return Y[($=(j=X?.type)===null||j===void 0?void 0:j.characterValue)!==null&&$!==void 0?$:""]=ee,Y})}function v(O,U,M){return s(this,void 0,void 0,function*(){var j,$;let Y={},X=yield r.I.GetConcept(O);X.id==0&&O!=null&&O!=null&&(X=yield(0,B.r)(O));let ee=yield D(O,U,M);Y[($=(j=X?.type)===null||j===void 0?void 0:j.characterValue)!==null&&$!==void 0?$:""]=ee;let Q={};return Q.created_at=X.entryTimeStamp,Q.data=Y,Q.id=O,Q})}function T(O,U,M){return s(this,void 0,void 0,function*(){var j,$;let Y={},X=yield r.I.GetConcept(O);X.id==0&&O!=null&&O!=null&&(X=yield(0,B.r)(O));let ee=yield R(X,U,M);return Y[($=(j=X?.type)===null||j===void 0?void 0:j.characterValue)!==null&&$!==void 0?$:""]=ee,Y})}function I(O){return s(this,void 0,void 0,function*(){var U,M;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetComposition",{id:O})).data}catch(Q){console.error("GetComposition error sw: ",Q),(0,A.handleServiceWorkerException)(Q)}let j=[],$={};j=yield(0,W.s)(O);let Y=[];for(let Q=0;Q<j.length;Q++)Y.includes(j[Q].ofTheConceptId)||Y.push(j[Q].ofTheConceptId);let X=yield r.I.GetConcept(O);X.id==0&&O!=null&&O!=null&&(X=yield(0,B.r)(O));let ee=yield D(O,j,Y);return $[(M=(U=X?.type)===null||U===void 0?void 0:U.characterValue)!==null&&M!==void 0?M:""]=ee,$})}function S(O){return s(this,void 0,void 0,function*(){var U,M;let j=[],$={};j=yield(0,W.s)(O);let Y=[];for(let Q=0;Q<j.length;Q++)Y.includes(j[Q].ofTheConceptId)||Y.push(j[Q].ofTheConceptId);let X=yield r.I.GetConcept(O);X.id==0&&O!=null&&O!=null&&(X=yield(0,B.r)(O));let ee=yield H(O,j,Y);return $[(M=(U=X?.type)===null||U===void 0?void 0:U.characterValue)!==null&&M!==void 0?M:""]=ee,$})}function d(O){return s(this,void 0,void 0,function*(){var U,M;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionFromMemory",{id:O})).data}catch(Q){console.error("GetCompositionFromMemory error sw: ",Q),(0,A.handleServiceWorkerException)(Q)}let j=[],$={};j=yield f.d.GetConnectionsOfCompositionLocal(O);let Y=[];for(let Q=0;Q<j.length;Q++)Y.includes(j[Q].ofTheConceptId)||Y.push(j[Q].ofTheConceptId);let X=yield r.I.GetConcept(O);X.id==0&&O!=null&&O!=null&&(X=yield(0,B.r)(O));let ee=yield b(X,j,Y);return $[(M=(U=X?.type)===null||U===void 0?void 0:U.characterValue)!==null&&M!==void 0?M:""]=ee,$})}function l(O){return s(this,void 0,void 0,function*(){var U,M;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionFromMemoryNormal",{id:O})).data}catch(Q){console.error("GetCompositionFromMemoryNormal error sw: ",Q),(0,A.handleServiceWorkerException)(Q)}let j=[],$={};j=yield f.d.GetConnectionsOfCompositionLocal(O);let Y=[];for(let Q=0;Q<j.length;Q++)Y.includes(j[Q].ofTheConceptId)||Y.push(j[Q].ofTheConceptId);let X=yield r.I.GetConcept(O);X.id==0&&O!=null&&O!=null&&(X=yield(0,B.r)(O));let ee=yield R(X,j,Y);return $[(M=(U=X?.type)===null||U===void 0?void 0:U.characterValue)!==null&&M!==void 0?M:""]=ee,$})}function a(O){var U=arguments;return s(this,void 0,void 0,function*(){var M,j;const $=A.Logger.logfunction("GetCompositionWithIdFromMemory",U)||{};if(A.serviceWorker){$.serviceWorker=!0;try{const Q=yield(0,A.sendMessage)("GetCompositionWithIdFromMemory",{id:O});return A.Logger.logUpdate($),Q.data}catch(Q){console.error("GetCompositionWithIdFromMemory error sw: ",Q),(0,N.ey)($,"GetCompositionWithIdFromMemory",Q),(0,A.handleServiceWorkerException)(Q)}}let Y={},X=[],ee={};try{X=yield f.d.GetConnectionsOfCompositionLocal(O);let Q=[];for(let ye=0;ye<X.length;ye++)Q.includes(X[ye].ofTheConceptId)||Q.push(X[ye].ofTheConceptId);let K=yield r.I.GetConcept(O);K.id==0&&O!=null&&O!=null&&(K=yield(0,B.r)(O));let he=yield b(K,X,Q);ee[(j=(M=K?.type)===null||M===void 0?void 0:M.characterValue)!==null&&j!==void 0?j:""]=he,Y.created_at=K.entryTimeStamp,Y.data=ee,Y.id=O}catch(Q){console.log("this is the exception in GetCompositionWithIdFromMemory",O),(0,N.ey)($,"GetCompositionWithIdFromMemory",Q)}return A.Logger.logUpdate($),Y})}function h(O,U){var M=arguments;return s(this,void 0,void 0,function*(){var j,$;const Y=A.Logger.logfunction("GetCompositionFromMemoryWithConnections",M)||{};if(A.serviceWorker){Y.serviceWorker=!0;try{const ye=yield(0,A.sendMessage)("GetCompositionFromMemoryWithConnections",{id:O,connectionList:U});return A.Logger.logUpdate(Y),ye.data}catch(ye){console.error("GetCompositionFromMemoryWithConnections error sw: ",ye),(0,N.ey)(Y,"GetCompositionFromMemoryWithConnections",ye),(0,A.handleServiceWorkerException)(ye)}}let X={},ee=[];for(let ye=0;ye<U.length;ye++)ee.includes(U[ye].ofTheConceptId)||ee.push(U[ye].ofTheConceptId);let Q=yield r.I.GetConcept(O);Q.id==0&&O!=null&&O!=null&&(Q=yield(0,B.r)(O));let K=yield b(Q,U,ee);X[($=(j=Q?.type)===null||j===void 0?void 0:j.characterValue)!==null&&$!==void 0?$:""]=K;let he={};return he.created_at=Q.entryTimeStamp,he.data=X,he.id=O,A.Logger.logUpdate(Y),he})}function k(O,U){return s(this,void 0,void 0,function*(){var M,j;const $=A.Logger.logfunction("GetCompositionWithIdFromMemoryFromConnection",[O])||{};if(A.serviceWorker){$.serviceWorker=!0;try{const he=yield(0,A.sendMessage)("GetCompositionWithIdFromMemory",{id:O});return A.Logger.logUpdate($),he.data}catch(he){console.error("GetCompositionWithIdFromMemory error sw: ",he),(0,N.ey)($,"GetCompositionWithIdFromMemoryFromConnection",he),(0,A.handleServiceWorkerException)(he)}}let Y={},X=[];for(let he=0;he<U.length;he++)X.includes(U[he].ofTheConceptId)||X.push(U[he].ofTheConceptId);let ee=yield r.I.GetConcept(O);ee.id==0&&O!=null&&O!=null&&(ee=yield(0,B.r)(O));let Q=yield b(ee,U,X);Y[(j=(M=ee?.type)===null||M===void 0?void 0:M.characterValue)!==null&&j!==void 0?j:""]=Q;let K={};return K.created_at=ee.entryTimeStamp,K.data=Y,K.id=O,A.Logger.logUpdate($),K})}function w(O){return s(this,void 0,void 0,function*(){var U;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionWithIdFromMemoryNew",{id:O})).data}catch(Q){console.error("GetCompositionWithIdFromMemoryNew error sw: ",Q),(0,A.handleServiceWorkerException)(Q)}let M=[],j={};M=yield f.d.GetConnectionsOfCompositionLocal(O);let $=[];for(let Q=0;Q<M.length;Q++)$.includes(M[Q].ofTheConceptId)||$.push(M[Q].ofTheConceptId);let Y=yield r.I.GetConcept(O);Y.id==0&&O!=null&&O!=null&&(console.log("this concept you cannot find ",O),Y=yield(0,B.r)(O)),new Date().getTime();let X=yield function(Q,K,he){return s(this,arguments,void 0,function*(ye,Ce,se,Z=[]){var ne,oe,ae,ue,ve,Te,Ie,_e;let Se={},xe=ye.id,pe=(new Date().getTime(),(oe=(ne=ye?.type)===null||ne===void 0?void 0:ne.characterValue)!==null&&oe!==void 0?oe:"");if(!se.includes(xe))return{[pe]:ye?.characterValue};if(Z.includes(xe))return"";Z.push(xe);for(let de=0;de<Ce.length;de++){let ge=yield(0,A.GetTheConcept)(Ce[de].ofTheConceptId),me=yield(0,A.GetTheConcept)(Ce[de].toTheConceptId);Ce[de].ofConcept=ge,Ce[de].toConcept=me;let Be=ge.id,ce="the_",Ne=((ue=(ae=me?.type)===null||ae===void 0?void 0:ae.characterValue)!==null&&ue!==void 0?ue:"").replace(ce,"");Se[Be]!=null&&Se[Be]!=null||(Se[Be]={}),Se[Be][Ne]=me.characterValue}let be={};for(let de=0;de<Ce.length;de++){let ge=Ce[de].ofConcept,me=Ce[de].toConcept,Be=(Te=(ve=ge?.type)===null||ve===void 0?void 0:ve.characterValue)!==null&&Te!==void 0?Te:"",ce="the_",Ne=((_e=(Ie=me?.type)===null||Ie===void 0?void 0:Ie.characterValue)!==null&&_e!==void 0?_e:"").replace(ce,"");be[ge.id]!=null&&be[ge.id]!=null||(be[ge.id]={});let Ee=be[ge.id];Ee[Be]!=null&&Ee[Be]!=null||(Ee[Be]={}),Se[Ce[de].ofTheConceptId]!=null&&Se[Ce[de].toTheConceptId]!=null?Ee[Be][Ne]=Se[me.id]:Ee[Be][Ne]=me.characterValue}return be[ye.id]})}(Y,M,$);(U=Y?.type)===null||U===void 0||U.characterValue,j=X;let ee={};return ee.created_at=Y.entryTimeStamp,ee.data=j,ee.id=O,ee})}function L(O){return s(this,void 0,void 0,function*(){var U,M;if(A.serviceWorker)try{return(yield(0,A.sendMessage)("GetCompositionWithIdAndDateFromMemory",{id:O})).data}catch(K){console.error("GetCompositionWithIdAndDateFromMemory error sw: ",K),(0,A.handleServiceWorkerException)(K)}let j=[],$={};j=yield f.d.GetConnectionsOfCompositionLocal(O);let Y=[];for(let K=0;K<j.length;K++)Y.includes(j[K].ofTheConceptId)||Y.push(j[K].ofTheConceptId);let X=yield r.I.GetConcept(O);X.id==0&&O!=null&&O!=null&&(X=yield(0,B.r)(O));let ee=yield D(O,j,Y);$[(M=(U=X?.type)===null||U===void 0?void 0:U.characterValue)!==null&&M!==void 0?M:""]=ee;let Q={};return Q.data=$,Q.id=O,Q.created_at=X.entryTimeStamp,Q})}function x(O){var U=arguments;return s(this,void 0,void 0,function*(){var M,j;const $=A.Logger.logfunction("GetCompositionWithId",U)||{};if(A.serviceWorker){$.serviceWorker=!0;try{const ye=yield(0,A.sendMessage)("GetCompositionWithId",{id:O});return A.Logger.logUpdate($),ye.data}catch(ye){console.error("GetCompositionWithId error sw: ",ye),(0,N.ey)($,"GetCompositionWithId",ye),(0,A.handleServiceWorkerException)(ye)}}let Y=[],X={};Y=yield(0,W.s)(O);let ee=[];for(let ye=0;ye<Y.length;ye++)ee.includes(Y[ye].ofTheConceptId)||ee.push(Y[ye].ofTheConceptId);let Q=yield r.I.GetConcept(O);Q.id==0&&O!=null&&O!=null&&(Q=yield(0,B.r)(O));let K=yield D(O,Y,ee);X[(j=(M=Q?.type)===null||M===void 0?void 0:M.characterValue)!==null&&j!==void 0?j:""]=K;let he={};return he.data=X,he.id=O,A.Logger.logUpdate($),he})}function b(O,U,M){return s(this,arguments,void 0,function*(j,$,Y,X=[]){var ee,Q,K;let he={},ye=[],Ce=j.id;if((ee=j?.type)===null||ee===void 0||ee.characterValue,!Y.includes(Ce))return j?.characterValue;if(X.includes(Ce))return"";X.push(Ce);for(let se=0;se<$.length;se++)if($[se].ofTheConceptId==Ce)if(Ce!=$[se].toTheConceptId){let Z=$[se].toTheConceptId,ne=yield r.I.GetConcept(Z);if(ne!=null&&ne.id!=0||Z==null||Z==null||(ne=yield(0,B.r)(Z)),ne.id!=0&&ne?.type==null){let ue=ne.typeId,ve=yield r.I.GetConcept(ue);ne.type=ve,ve==null&&ue!=null&&ue!=null&&(ve=yield(0,B.r)(ue),ne.type=ve)}let oe="the_",ae=((K=(Q=ne?.type)===null||Q===void 0?void 0:Q.characterValue)!==null&&K!==void 0?K:"").replace(oe,"");if(isNaN(Number(ae))){if(ae){const ue=yield b(ne,$,Y,X);he[ae]=ue}}else{const ue=yield b(ne,$,Y,X);ye[ae]=ue,he=ye}}else console.log("this is the faulty connection ",$[se]);return he})}function R(O,U,M){return s(this,arguments,void 0,function*(j,$,Y,X=[]){var ee,Q,K;const he=A.Logger.logfunction("recursiveFetchConceptNormal",[j]);new Date().getTime();let ye={},Ce=[],se=j.id;if(ye.id=se,(ee=j?.type)===null||ee===void 0||ee.characterValue,!Y.includes(se))return j?.characterValue;if(X.includes(se))return"";X.push(se);for(let Z=0;Z<$.length;Z++)if($[Z].ofTheConceptId==se)if(se!=$[Z].toTheConceptId){let ne=$[Z].toTheConceptId,oe=yield r.I.GetConcept(ne);if(oe!=null&&oe.id!=0||ne==null||ne==null||(oe=yield(0,B.r)(ne)),oe.id!=0&&oe?.type==null){let ve=oe.typeId,Te=yield r.I.GetConcept(ve);oe.type=Te,Te==null&&ve!=null&&ve!=null&&(Te=yield(0,B.r)(ve),oe.type=Te)}let ae="the_",ue=((K=(Q=oe?.type)===null||Q===void 0?void 0:Q.characterValue)!==null&&K!==void 0?K:"").replace(ae,"");if(isNaN(Number(ue))){if(ue){const ve=yield b(oe,$,Y,X);ye[ue]=ve}}else{const ve=yield b(oe,$,Y,X);Ce[ue]=ve,ye=Ce}}else console.log("this is the faulty connection ",$[Z]);return A.Logger.logUpdate(he),ye})}function D(O,U,M){return s(this,arguments,void 0,function*(j,$,Y,X=[]){var ee,Q,K;let he={},ye=[];if(j==0)return null;let Ce=yield r.I.GetConcept(j);if(Ce!=null&&Ce.id!=0||j==null||j==null||(Ce=yield(0,B.r)(j)),Ce.id!=0&&Ce.type==null){let se=Ce.typeId,Z=yield r.I.GetConcept(se);Ce.type=Z,Z==null&&se!=null&&se!=null&&(Z=yield(0,B.r)(se),Ce.type=Z)}if((ee=Ce?.type)===null||ee===void 0||ee.characterValue,!Y.includes(j))return Ce?.characterValue;if(X.includes(j))return"";X.push(j);for(let se=0;se<$.length;se++)if(new Date().getTime(),$[se].ofTheConceptId==j)if(j!=$[se].toTheConceptId){let Z=$[se].toTheConceptId,ne=yield r.I.GetConcept(Z);if(ne!=null&&ne.id!=0||Z==null||Z==null||(ne=yield(0,B.r)(Z)),ne.id!=0&&ne?.type==null){let ue=ne.typeId,ve=yield r.I.GetConcept(ue);ne.type=ve,ve==null&&ue!=null&&ue!=null&&(ve=yield(0,B.r)(ue),ne.type=ve)}let oe="the_",ae=((K=(Q=ne?.type)===null||Q===void 0?void 0:Q.characterValue)!==null&&K!==void 0?K:"").replace(oe,"");if(isNaN(Number(ae))){if(ae){const ue=yield D(Z,$,Y,X);he[ae]=ue}}else{const ue=yield D(Z,$,Y,X);ye[ae]=ue,he=ye}}else console.log("this is the faulty connection ",$[se]);return he})}function H(O,U,M){return s(this,arguments,void 0,function*(j,$,Y,X=[]){var ee,Q,K;let he={},ye=[];if(j==0)return null;let Ce=yield r.I.GetConcept(j);if(Ce!=null&&Ce.id!=0||j==null||j==null||(Ce=yield(0,B.r)(j)),Ce.id!=0&&Ce.type==null){let se=Ce.typeId,Z=yield r.I.GetConcept(se);Ce.type=Z,Z==null&&se!=null&&se!=null&&(Z=yield(0,B.r)(se),Ce.type=Z)}if((ee=Ce?.type)===null||ee===void 0||ee.characterValue,!Y.includes(j))return Ce?.characterValue;if(X.includes(j))return"";X.push(j),he.id=j;for(let se=0;se<$.length;se++)if($[se].ofTheConceptId==j){let Z=$[se].toTheConceptId,ne=yield r.I.GetConcept(Z);if(ne!=null&&ne.id!=0||Z==null||Z==null||(ne=yield(0,B.r)(Z)),ne&&ne?.type==null){let ue=ne.typeId,ve=yield r.I.GetConcept(ue);ne.type=ve,ve==null&&ue!=null&&ue!=null&&(ve=yield(0,B.r)(ue),ne.type=ve)}let oe="the_",ae=((K=(Q=ne?.type)===null||Q===void 0?void 0:Q.characterValue)!==null&&K!==void 0?K:"").replace(oe,"");if(isNaN(Number(ae))){if(ae){const ue=yield H(Z,$,Y);he[ae]=ue}}else{const ue=yield H(Z,$,Y);ye[ae]=ue,he=ye}}return he})}},6687:(fe,q,m)=>{m.d(q,{D:()=>w,MT:()=>k,Nt:()=>I,QL:()=>l,as:()=>S,cw:()=>u,dF:()=>i,hG:()=>d,km:()=>T,nr:()=>h,p8:()=>v,rv:()=>a});var B=m(8642),W=m(7467),r=m(2290),f=m(1863),A=m(5284),N=m(8939),s=function(L,x,b,R){return new(b||(b=Promise))(function(D,H){function O(j){try{M(R.next(j))}catch($){H($)}}function U(j){try{M(R.throw(j))}catch($){H($)}}function M(j){var $;j.done?D(j.value):($=j.value,$ instanceof b?$:new b(function(Y){Y($)})).then(O,U)}M((R=R.apply(L,x||[])).next())})};function i(){return s(this,arguments,void 0,function*(L=[]){yield(0,B.Y)(L);let x=[];for(let b=0;b<L.length;b++){let R=yield(0,N.kx)(L[b]);x.push(R)}return x})}function u(){return s(this,arguments,void 0,function*(L=[]){yield(0,B.Y)(L);let x=[];for(let b=0;b<L.length;b++){let R=yield(0,N.RW)(L[b]);x.push(R)}return x})}function v(){return s(this,arguments,void 0,function*(L=[],x=[]){const b=r.Logger.logfunction("GetCompositionFromConnectionsWithDataId",[L])||{};if(r.serviceWorker){b.serviceWorker=!0;try{const D=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataId",{conceptIds:L,connectionIds:x});return r.Logger.logUpdate(b),D.data}catch(D){console.error("GetCompositionFromConnectionsWithDataId error sw: ",D),(0,f.ey)(b,"GetCompositionFromConnectionsWithDataId",D),(0,r.handleServiceWorkerException)(D)}}let R=[];for(let D=0;D<L.length;D++){let H=yield(0,N.RW)(L[D]);R.push(H)}return r.Logger.logUpdate(b),R})}function T(){var L=arguments;return s(this,arguments,void 0,function*(x=[],b=[]){const R=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdFromConnections",L)||{};if(r.serviceWorker){R.serviceWorker=!0;try{const O=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataIdFromConnections",{conceptIds:x,connectionIds:b});return r.Logger.logUpdate(R),O.data}catch(O){console.error("GetCompositionFromConnectionsWithDataIdFromConnections error sw: ",O),(0,f.ey)(R,"GetCompositionFromConnectionsWithDataIdFromConnections",O),(0,r.handleServiceWorkerException)(O)}}let D=yield(0,W.j)(b),H=[];for(let O=0;O<x.length;O++){let U=yield(0,N.PT)(x[O],D);H.push(U)}return r.Logger.logUpdate(R),H})}function I(){var L=arguments;return s(this,arguments,void 0,function*(x=[],b=[]){const R=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdIndex",L)||{};if(r.serviceWorker){R.serviceWorker=!0;try{const H=yield(0,r.sendMessage)("GetCompositionFromConnectionsWithDataIdIndex",{conceptIds:x,connectionIds:b});return r.Logger.logUpdate(R),H.data}catch(H){console.error("GetCompositionFromConnectionsWithDataIdIndex error sw: ",H),(0,f.ey)(R,"GetCompositionFromConnectionsWithDataIdIndex",H),(0,r.handleServiceWorkerException)(H)}}yield(0,W.j)(b),yield(0,A.B)(x);let D={};for(let H=0;H<x.length;H++){let O=yield(0,N.RW)(x[H]);D[x[H]]=O}return r.Logger.logUpdate(R),D})}function S(){return s(this,arguments,void 0,function*(L=[],x=[]){yield(0,W.j)(x),yield(0,A.B)(L);let b={};for(let R=0;R<L.length;R++){let D=yield(0,N.kx)(L[R]);b[L[R]]=D}return b})}function d(){return s(this,arguments,void 0,function*(L=[],x=[]){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetCompositionFromConnectionsWithIndexFromConnections",{conceptIds:L,connectionIds:x})).data}catch(D){console.error("GetCompositionFromConnectionsWithIndexFromConnections error sw: ",D),(0,r.handleServiceWorkerException)(D)}let b=yield(0,W.j)(x),R=[];for(let D=0;D<L.length;D++){let H=yield(0,N.JA)(L[D],b);R[L[D]]=H}return R})}function l(L){var x=arguments;return s(this,void 0,void 0,function*(){const b=r.Logger.logfunction("GetConnectionDataPrefetch",x)||{};if(r.serviceWorker){b.serviceWorker=!0;try{const M=yield(0,r.sendMessage)("GetConnectionDataPrefetch",{connectionIds:L});return r.Logger.logUpdate(b),M.data}catch(M){console.error("GetConnectionDataPrefetch error sw: ",M),(0,f.ey)(b,"GetConnectionDataPrefetch",M),(0,r.handleServiceWorkerException)(M)}}let R=[],D=[],H={};for(let M=0;M<L.length;M++){let j=yield r.ConnectionData.GetConnection(L[M]);j.id==0?R.push(L[M]):D.push(j)}for(let M=0;M<R.length;M++)H[L[M]]=!1;let O=[],U=yield(0,W.j)(R);D=[...D,...U];for(let M=0;M<D.length;M++)O.push(D[M].ofTheConceptId),O.push(D[M].toTheConceptId),O.push(D[M].typeId);return yield(0,r.GetConceptBulk)(O),r.Logger.logUpdate(b),D})}function a(){var L=arguments;return s(this,arguments,void 0,function*(x=[],b=[]){const R=r.Logger.logfunction("GetCompositionFromConnectionsWithDataIdInObject",L);yield(0,W.j)(b);let D={};for(let H=0;H<x.length;H++){let O=yield(0,N.RW)(x[H]);D[x[H]]=O}return r.Logger.logUpdate(R),D})}function h(){return s(this,arguments,void 0,function*(L=[],x=[]){yield(0,W.j)(x);let b={};for(let R=0;R<L.length;R++){let D=yield(0,N.$N)(L[R]);b[L[R]]=D}return b})}function k(){return s(this,arguments,void 0,function*(L=[],x=[]){yield(0,W.j)(x);let b={};for(let R=0;R<L.length;R++){let D=yield(0,N.kx)(L[R]);b[L[R]]=D}return b})}function w(){return s(this,arguments,void 0,function*(L=[],x=[]){yield(0,W.j)(x);let b={};for(let R=0;R<L.length;R++){let D=yield(0,N.XI)(L[R]);b[L[R]]=D,console.log("this is the normal data",L[R],D)}return b})}},2013:(fe,q,m)=>{m.d(q,{A:()=>N,w:()=>s});var B=m(8146),W=m(2290),r=m(3026),f=m(1863),A=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,[])).next())})};function N(i){var u=arguments;return A(this,void 0,void 0,function*(){const v=W.Logger.logfunction("GetConceptByCharacter",u)||{};if(W.serviceWorker){v.serviceWorker=!0;try{const S=yield(0,W.sendMessage)("GetConceptByCharacter",{characterValue:i});return W.Logger.logUpdate(v),S.data}catch(S){console.error("GetConceptByCharacter sw error: ",S),(0,f.ey)(v,"GetConceptByCharacter",S),(0,W.handleServiceWorkerException)(S)}}let T=yield r.I.GetConceptByCharacter(i),I=`${i}`;return T!=null&&T?.id!=0||!I||(yield(0,B.Y)(i),T=yield r.I.GetConceptByCharacterAndTypeLocal(i,51),T.id==0&&(T=yield r.I.GetConceptByCharacter(i))),W.Logger.logUpdate(v),T})}function s(i){var u=arguments;return A(this,void 0,void 0,function*(){const v=W.Logger.logfunction("GetConceptByCharacterUpdated",u)||{};if(W.serviceWorker){v.serviceWorker=!0;try{const S=yield(0,W.sendMessage)("GetConceptByCharacterUpdated",{characterValue:i});return W.Logger.logUpdate(v),S.data}catch(S){console.error("GetConceptByCharacterUpdated error sw: ",S),(0,f.ey)(v,"GetConceptByCharacterUpdated",S),(0,W.handleServiceWorkerException)(S)}}let T=yield r.I.GetConceptByCharacter(i),I=`${i}`;return T!=null&&T?.id!=0||!I||(yield(0,B.Y)(i),T=yield r.I.GetConceptByCharacter(i)),W.Logger.logUpdate(v),T})}},7887:(fe,q,m)=>{m.d(q,{a:()=>f,p:()=>A});var B=m(8286),W=m(4864),r=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,[])).next())})};function f(){return r(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let s=0;s<N.length;s++)B.d.AddConnectionToMemory(N[s])}catch(N){throw{message:"Cannot create Connection Binary Tree Concept",ok:!1,status:400,data:N}}})}function A(){return r(this,void 0,void 0,function*(){try{let N=[];if(Array.isArray(N))for(let s=0;s<N.length;s++)W.G.AddConnectionToMemory(N[s])}catch(N){throw{message:"Cannot create Local Connection Binary Tree Concept",ok:!1,status:400,data:N}}})}},7876:(fe,q,m)=>{m.d(q,{A:()=>i,K:()=>u});var B=m(1735),W=m(7139),r=m(2290),f=m(3026),A=m(7282),N=function(v,T,I,S){return new(I||(I=Promise))(function(d,l){function a(w){try{k(S.next(w))}catch(L){l(L)}}function h(w){try{k(S.throw(w))}catch(L){l(L)}}function k(w){var L;w.done?d(w.value):(L=w.value,L instanceof I?L:new I(function(x){x(L)})).then(a,h)}k((S=S.apply(v,T||[])).next())})};const s=new Map;function i(v){return N(this,arguments,void 0,function*(T,I=999){let S=performance.now();if(B.J.activateStatus)try{B.J.incrementConcept(T)}catch{console.error("Error adding connection in access tracker"),r.Logger.log("ERROR","Error Adding Connection")}if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetTheConcept",{id:T,userId:I})).data}catch(a){console.error("GetTheConcept sw error: ",a),(0,r.handleServiceWorkerException)(a)}let d=(0,A.o)();if(s.has(T))return s.get(T)||d;const l=N(this,void 0,void 0,function*(){try{if(T<0)return yield r.LocalConceptsData.GetConceptByGhostId(T);if(d=yield f.I.GetConcept(T),(d==null||d.id==0)&&T!=null&&T!=null&&(d=yield(0,W.r)(T)),d.id!=0&&d.type==null&&(yield f.I.GetConcept(d.typeId))==null&&d.typeId!=null&&d.typeId!=null){let a=yield(0,W.r)(d.typeId);d.type=a}return d}catch(a){throw console.error("this is the error in the getting concept",a),r.Logger.logError(S,I,"read","unknown",void 0,500,a,"GetTheConcept",[T,I],"unknown",void 0),a}finally{s.delete(T)}});return s.set(T,l),l})}function u(v){return N(this,void 0,void 0,function*(){if(r.serviceWorker)try{return(yield(0,r.sendMessage)("AddTypeConcept",{concept:v})).data}catch(T){console.error("AddTypeConcept sw error: ",T),(0,r.handleServiceWorkerException)(T)}if(v.type==null){let T=yield f.I.GetConcept(v.typeId);if(T.id==0&&v.typeId!=0&&v.typeId!=999){let I=yield(0,W.r)(v.typeId);v.type=I}else v.type=T}})}},7869:(fe,q,m)=>{m.d(q,{_:()=>S,A:()=>I});var B=m(9581),W=m(3026),r=m(1863),f=m(3518),A=m(2290),N=function(d,l,a,h){return new(a||(a=Promise))(function(k,w){function L(R){try{b(h.next(R))}catch(D){w(D)}}function x(R){try{b(h.throw(R))}catch(D){w(D)}}function b(R){var D;R.done?k(R.value):(D=R.value,D instanceof a?D:new a(function(H){H(D)})).then(L,x)}b((h=h.apply(d,[])).next())})},s=m(2299);class i{}i.isUpdated=!1,i.isOnlineSync=!1;var u=m(3655),v=m(9003),T=function(d,l,a,h){return new(a||(a=Promise))(function(k,w){function L(R){try{b(h.next(R))}catch(D){w(D)}}function x(R){try{b(h.throw(R))}catch(D){w(D)}}function b(R){var D;R.done?k(R.value):(D=R.value,D instanceof a?D:new a(function(H){H(D)})).then(L,x)}b((h=h.apply(d,l||[])).next())})};function I(){return T(this,arguments,void 0,function*(d=!0){try{if(yield(0,u.qI)("concepts"),yield(0,v.qI)("concepts"),d){if((yield(0,u.b8)()).isOnlineSync)return!0;yield function(){return N(this,void 0,void 0,function*(){const l=A.Logger.logfunction("GetAiData");try{const k=new Date().getTime();var a=(0,f.ab)("application/x-www-form-urlencoded");const w=yield fetch(B.B.GetAllAiData(),{method:"GET",headers:a});w.ok||(console.log("Ai Error Message: ","Cannot get response"),(0,r.ry)(w));const L=yield w.json();for(var h=0;h<L.length;h++)W.I.AddConcept(L[h]);S();let x=new Date().getTime()-k;console.log("The time taken is ",x),A.Logger.logUpdate(l)}catch(k){k instanceof Error?console.log("Ai Error Message: ",k.message):console.log("Ai Error Message: ",k),(0,r.Mb)(k,B.B.GetAllAiData())}})}()}return!0}catch(l){return console.log({message:"cannot initlize the AI system",ok:!1,status:400,data:l}),!0}})}function S(){return T(this,void 0,void 0,function*(){i.isOnlineSync=!0;var d=new s.B(i.isOnlineSync);(0,u.El)(d)})}},8095:(fe,q,m)=>{m.d(q,{h:()=>A});var B=m(2290),W=m(9700),r=m(1863),f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,s||[])).next())})};function A(N,s,i){var u=arguments;return f(this,arguments,void 0,function*(v,T,I,S=!1,d={concepts:[],connections:[]}){var l,a,h,k,w,L;const x=W.V.logfunction("CreateConnectionBetweenTwoConceptsLocal",u)||{};let b=performance.now();try{if(B.serviceWorker){x.serviceWorker=!0;try{const U=yield(0,B.sendMessage)("CreateConnectionBetweenTwoConceptsLocal",{ofTheConcept:v,toTheConcept:T,linker:I,both:S,actions:d});return!((a=(l=U?.actions)===null||l===void 0?void 0:l.concepts)===null||a===void 0)&&a.length&&(d.concepts=JSON.parse(JSON.stringify(U.actions.concepts))),!((k=(h=U?.actions)===null||h===void 0?void 0:h.connections)===null||k===void 0)&&k.length&&(d.connections=JSON.parse(JSON.stringify(U.actions.connections))),W.V.logUpdate(x),U.data}catch(U){console.error("CreateConnectionBetweenTwoConceptsLocal sw error: ",U),(0,r.ey)(x,"CreateConnectionBetweenTwoConceptsLocal",U),(0,B.handleServiceWorkerException)(U)}}if(v.userId,S){let U=((w=T.type)===null||w===void 0?void 0:w.characterValue)+"_s_"+I+"_by";var R=yield(0,B.MakeTheInstanceConceptLocal)("connection",U,!1,999,999,999,0,d);yield(0,B.CreateTheConnectionLocal)(T.id,v.id,R.id,1e3,void 0,void 0,d)}let H=((L=v.type)===null||L===void 0?void 0:L.characterValue)+"_s_"+I+"_s";var D=yield(0,B.MakeTheInstanceConceptLocal)("connection",H,!1,999,999,999,void 0,d);let O=yield(0,B.CreateTheConnectionLocal)(v.id,T.id,D.id,1e3,void 0,void 0,d);return W.V.logUpdate(x),O}catch(H){throw W.V.logError(b,v.userId,"create",void 0,void 0,500,H,"CreateConnectionBetweenTwoConceptsLocal",[v,T,I,S],void 0,void 0),(0,r.ey)(x,"CreateConnectionBetweenTwoConceptsLocal",H),H}})}},6416:(fe,q,m)=>{m.d(q,{u:()=>W});var B=m(2615);function W(){let r=new Date,f=new Date;return new B.j(0,0,0,0,0,"0",0,!1,r,f,"0")}},3075:(fe,q,m)=>{m.d(q,{Ay:()=>i,EO:()=>u,xd:()=>v});var B=m(205),W=m(9736),r=m(5257),f=m(9003),A=m(2290),N=m(1863),s=function(T,I,S,d){return new(S||(S=Promise))(function(l,a){function h(L){try{w(d.next(L))}catch(x){a(x)}}function k(L){try{w(d.throw(L))}catch(x){a(x)}}function w(L){var x;L.done?l(L.value):(x=L.value,x instanceof S?x:new S(function(b){b(x)})).then(h,k)}w((d=d.apply(T,[])).next())})};function i(){return s(this,void 0,void 0,function*(){const T=A.Logger.logfunction("CreateLocalBinaryTreeFromIndexDb");try{let I=[];if(Array.isArray(I))for(let S=0;S<I.length;S++){let d=I[S];W.v.AddConceptToMemory(d)}B.B.isLocalDataLoaded=!0,B.B.isLocalTypeLoaded=!0,B.B.isLocalCharacterLoaded=!0,A.Logger.logUpdate(T)}catch(I){yield(0,A.DelayFunctionExecution)(2e3,i());let S={message:"Cannot create local binary tree from index db",data:I,ok:!1,status:400};throw(0,N.ey)(T,"CreateLocalBinaryTreeFromIndexDb",I),S}})}function u(){return s(this,void 0,void 0,function*(){var T;const I=A.Logger.logfunction("PopulateTheLocalConceptsToMemory");try{yield(T=navigator.locks)===null||T===void 0?void 0:T.request("dblock",S=>s(this,void 0,void 0,function*(){let d=yield(0,f.S5)("localid");if(Array.isArray(d)){if(d[0]){let l=d[0].value;if(l)r.R.AddConceptId(d[0]),yield(0,f.kH)("localid",{id:0,value:l-10});else{l=-Math.floor(1e8*Math.random());let a={id:0,value:l},h={id:0,value:l-10};r.R.AddConceptId(a),yield(0,f.kH)("localid",h)}}d[2]}})),A.Logger.logUpdate(I)}catch(S){let d={message:"Cannot populate Local Ids from the Index Db",data:S,ok:!1,status:400};throw(0,N.ey)(I,"PopulateTheLocalConceptsToMemory",S),d}})}function v(){return s(this,void 0,void 0,function*(){var T;const I=A.Logger.logfunction("PopulateTheLocalConnectionToMemory");try{yield(T=navigator.locks)===null||T===void 0?void 0:T.request("dblock",S=>s(this,void 0,void 0,function*(){let d=yield(0,f.S5)("localid");if(Array.isArray(d)){if(d[1]){let l=d[1].value;if(l)r.R.AddConnectionId(d[1]),yield(0,f.kH)("localid",{id:1,value:l-10});else{l=-Math.floor(1e8*Math.random());let a={id:0,value:l},h={id:0,value:l-10};r.R.AddConnectionId(a),yield(0,f.kH)("localid",h)}}d[2]}})),A.Logger.logUpdate(I)}catch(S){let d={message:"Cannot populate Local Ids from the Index Db",data:S,ok:!1,status:400};throw(0,N.ey)(I,"PopulateTheLocalConnectionToMemory",S),d}})}},999:(fe,q,m)=>{m.d(q,{R:()=>s});var B=m(2290),W=m(1863),r=m(6416),f=m(4711),A=m(5868),N=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,u||[])).next())})};function s(i){return N(this,arguments,void 0,function*(u,v=null,T=null,I=null,S=null,d=null,l=null,a=!1,h={concepts:[],connections:[]}){var k,w,L,x;const b=B.Logger.logfunction("CreateTheCompositionLocal")||{};if(B.serviceWorker){b.serviceWorker=!0;try{const M=yield(0,B.sendMessage)("CreateTheCompositionLocal",{json:u,ofTheConceptId:v,ofTheConceptUserId:T,mainKey:I,userId:S,accessId:d,sessionInformationId:l,actions:h});return!((w=(k=M?.actions)===null||k===void 0?void 0:k.concepts)===null||w===void 0)&&w.length&&(h.concepts=JSON.parse(JSON.stringify(M.actions.concepts))),!((x=(L=M?.actions)===null||L===void 0?void 0:L.connections)===null||x===void 0)&&x.length&&(h.connections=JSON.parse(JSON.stringify(M.actions.connections))),B.Logger.logUpdate(b),M.data}catch(M){console.error("CreateTheCompositionLocal error sw: ",M),(0,W.ey)(b,"CreateTheCompositionLocal",M),(0,B.handleServiceWorkerException)(M)}}let R=S??999,D=d??999,H=l??999,O=I??0,U=(0,r.u)();for(const M in u)if(typeof u[M]!="string"&&typeof u[M]!="number")if(v==null&&T==null){let j=O,$=yield(0,A.k)(M,"",!0,R,D,H,void 0,h);U=$,j=$.id,O=$.id,yield s(u[M],$.id,$.userId,j,S,d,l,void 0,h)}else{let j=v??999,$=O,Y=yield(0,A.k)(M,"",!0,R,D,H,void 0,h);yield(0,f.F)(j,Y.id,$,void 0,void 0,void 0,h),yield s(u[M],Y.id,Y.userId,$,S,d,l,void 0,h)}else{let j=v??999,$=O,Y=yield(0,A.k)(M,u[M].toString(),!1,R,D,H,void 0,h);yield(0,f.F)(j,Y.id,$,void 0,void 0,void 0,h)}return B.Logger.logUpdate(b),U})}},3077:(fe,q,m)=>{m.d(q,{A:()=>s});var B=m(2290),W=m(2615),r=m(9736),f=m(5257),A=m(9700),N=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,u||[])).next())})};function s(i,u,v,T,I,S){return N(this,arguments,void 0,function*(d,l,a,h,k,w,L=!1,x=0,b={concepts:[],connections:[]}){var R,D,H,O;let U=performance.now();try{if(B.serviceWorker)try{const ee=yield(0,B.sendMessage)("CreateTheConceptLocal",{referent:d,typecharacter:l,userId:a,categoryId:h,typeId:k,accessId:w,isComposition:L,referentId:x});return!((D=(R=ee?.actions)===null||R===void 0?void 0:R.concepts)===null||D===void 0)&&D.length&&(b.concepts=JSON.parse(JSON.stringify(ee.actions.concepts))),!((O=(H=ee?.actions)===null||H===void 0?void 0:H.connections)===null||O===void 0)&&O.length&&(b.connections=JSON.parse(JSON.stringify(ee.actions.connections))),ee.data}catch(ee){console.error("CreateTheConceptLocal error sw: ",ee),(0,B.handleServiceWorkerException)(ee)}let M=yield f.R.getConceptId(),j=!0,$=new Date,Y=new Date;if(d=="the")return new W.j(1,999,5,5,x,d,w,j,$,Y,l);let X=new W.j(M,a,k,h,x,d,w,j,$,Y,l);return X.isTemp=!0,X.isComposition=L,r.v.AddConcept(X),b.concepts.push(X),X}catch(M){throw A.V.logError(U,a,"create","unknown","unknown",500,void 0,"createTheConceptLocal",[d,l,a,h,k,w,L],void 0),M}})}},4711:(fe,q,m)=>{m.d(q,{F:()=>s,d:()=>i});var B=m(2155),W=m(4864),r=m(5257),f=m(9700),A=m(2290),N=function(u,v,T,I){return new(T||(T=Promise))(function(S,d){function l(k){try{h(I.next(k))}catch(w){d(w)}}function a(k){try{h(I.throw(k))}catch(w){d(w)}}function h(k){var w;k.done?S(k.value):(w=k.value,w instanceof T?w:new T(function(L){L(w)})).then(l,a)}h((I=I.apply(u,v||[])).next())})};function s(u,v,T){return N(this,arguments,void 0,function*(I,S,d,l=1,a="",h=999,k={concepts:[],connections:[]}){var w,L,x,b;let R=performance.now();if(A.serviceWorker)try{const D=yield(0,A.sendMessage)("CreateTheConnectionLocal",{ofTheConceptId:I,toTheConceptId:S,typeId:d,orderId:l,typeString:a,userId:h,actions:k});return!((L=(w=D?.actions)===null||w===void 0?void 0:w.concepts)===null||L===void 0)&&L.length&&(k.concepts=JSON.parse(JSON.stringify(D.actions.concepts))),!((b=(x=D?.actions)===null||x===void 0?void 0:x.connections)===null||b===void 0)&&b.length&&(k.connections=JSON.parse(JSON.stringify(D.actions.connections))),D.data}catch(D){console.log("CreateTheConnectionLocal error sw: ",D),(0,A.handleServiceWorkerException)(D)}try{let D=4,H=yield r.R.getConnectionId(),O=0,U=0,M=0;O=I,U=S,M=d;let j=new B.N(0,0,0,0,0,0,0);return I!=S&&(j=new B.N(H,O,U,h,d,l,D),j.isTemp=!0,j.typeCharacter=a,A.LocalSyncData.AddConnection(j),W.G.AddConnection(j),k.connections.push(j)),j}catch(D){throw f.V.logError(R,h,"create","Unknown","Unknown",500,void 0,"CreateTheConnectionLocal",[I,S,d,l,a,h],"UnknownUserAgent",[]),D}})}function i(u,v,T){return N(this,arguments,void 0,function*(I,S,d,l={concepts:[],connections:[]}){var a,h,k,w;if(A.serviceWorker)try{const b=yield(0,A.sendMessage)("CreateConnection",{ofTheConcept:I,toTheConcept:S,connectionTypeString:d,actions:l});return!((h=(a=b?.actions)===null||a===void 0?void 0:a.concepts)===null||h===void 0)&&h.length&&(l.concepts=JSON.parse(JSON.stringify(b.actions.concepts))),!((w=(k=b?.actions)===null||k===void 0?void 0:k.connections)===null||w===void 0)&&w.length&&(l.connections=JSON.parse(JSON.stringify(b.actions.connections))),b.data}catch(b){console.log("CreateConnection error sw: ",b),(0,A.handleServiceWorkerException)(b)}let L=yield(0,A.MakeTheTypeConceptLocal)(d,999,999,999),x=I.userId;return yield s(I.id,S.id,L.id,1e3,d,x,l)})}},8064:(fe,q,m)=>{m.d(q,{$I:()=>A,Ay:()=>f});var B=m(9736),W=(m(9581),m(3518),m(2290));m(1863);var r=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,[])).next())})};function f(N){return r(this,void 0,void 0,function*(){return yield B.v.GetConceptByCharacterAndTypeLocal(N,51)})}function A(N){return r(this,void 0,void 0,function*(){if(W.serviceWorker)try{return(yield(0,W.sendMessage)("GetConceptByCharacterAndCategoryLocal",{character:N})).data}catch(u){console.error("GetConceptByCharacterAndCategoryLocal error sw: ",u),(0,W.handleServiceWorkerException)(u)}let s=(0,W.CreateDefaultLConcept)();if(N=="the")return s.id=1,s.typeId=5,s.characterValue="the",s;let i=(0,W.SplitStrings)(N);if(i.length>1){let u=1,v=yield A(i[0]);v.id!=0&&(u=v.id),s=yield function(T,I){return r(this,void 0,void 0,function*(){return B.v.GetConceptByCharacterAndCategoryLocal(T,I)})}(N,u)}else i[0]==N&&(s=yield f(N));return s})}},1213:(fe,q,m)=>{m.d(q,{f:()=>N});var B=m(9736),W=m(7820),r=m(2290),f=m(176),A=function(s,i,u,v){return new(u||(u=Promise))(function(T,I){function S(a){try{l(v.next(a))}catch(h){I(h)}}function d(a){try{l(v.throw(a))}catch(h){I(h)}}function l(a){var h;a.done?T(a.value):(h=a.value,h instanceof u?h:new u(function(k){k(h)})).then(S,d)}l((v=v.apply(s,[])).next())})};function N(s){return A(this,void 0,void 0,function*(){let i=performance.now();try{if(r.serviceWorker)try{return(yield(0,r.sendMessage)("GetTheConceptLocal",{id:s})).data}catch(v){console.error("GetTheConceptLocal error sw: ",v),(0,r.handleServiceWorkerException)(v)}let u=(0,r.CreateDefaultLConcept)();if(s<0){if(u=yield B.v.GetConcept(s),u.id==0){let v=yield W.G.getNodeFromTree(s);if(v?.value){let T=v.value;T&&(u=T)}}}else{let v=yield(0,r.GetTheConcept)(s);u=(0,f.F4)(v)}return u}catch(u){throw r.Logger.logError(i,"unknown","read","unknown",void 0,200,void 0,"GetTheConceptLocal",[s],"unknown",void 0),u}})}},9975:(fe,q,m)=>{m.d(q,{A:()=>A});var B=m(2290),W=m(9736),r=m(3077),f=function(N,s,i,u){return new(i||(i=Promise))(function(v,T){function I(l){try{d(u.next(l))}catch(a){T(a)}}function S(l){try{d(u.throw(l))}catch(a){T(a)}}function d(l){var a;l.done?v(l.value):(a=l.value,a instanceof i?a:new i(function(h){h(a)})).then(I,S)}d((u=u.apply(N,s||[])).next())})};function A(N,s,i,u,v){return f(this,arguments,void 0,function*(T,I,S,d,l,a={concepts:[],connections:[]}){var h,k,w,L;if(B.serviceWorker)try{const R=yield(0,B.sendMessage)("MakeTheConceptLocal",{referent:T,typeCharacter:I,userId:S,categoryId:d,typeId:l,actions:a});return!((k=(h=R?.actions)===null||h===void 0?void 0:h.concepts)===null||k===void 0)&&k.length&&(a.concepts=JSON.parse(JSON.stringify(R.actions.concepts))),!((L=(w=R?.actions)===null||w===void 0?void 0:w.connections)===null||L===void 0)&&L.length&&(a.connections=JSON.parse(JSON.stringify(R.actions.connections))),R.data}catch(R){console.error("MakeTheConceptLocal error sw: ",R),(0,B.handleServiceWorkerException)(R)}let x=yield W.v.GetConceptByCharacterAndTypeLocal(T,l),b=x;return I=="the"&&(d=1),b.id==0&&(x=yield(0,r.A)(T,I,S,d,l,4,void 0,null,a),b=x),b})}},5868:(fe,q,m)=>{m.d(q,{k:()=>s});var B=m(3077),W=m(8357),r=m(9736),f=m(2290),A=m(1863),N=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,u||[])).next())})};function s(i,u){var v=arguments;return N(this,arguments,void 0,function*(T,I,S=!1,d,l,a=999,h=0,k={concepts:[],connections:[]}){var w,L,x,b;const R=f.Logger.logfunction("MakeTheInstanceConceptLocal",v)||{};if(f.serviceWorker){R.serviceWorker=!0;try{const D=yield(0,f.sendMessage)("MakeTheInstanceConceptLocal",{type:T,referent:I,composition:S,userId:d,accessId:l,sessionInformationId:a,referentId:h,actions:k});return!((L=(w=D?.actions)===null||w===void 0?void 0:w.concepts)===null||L===void 0)&&L.length&&(k.concepts=JSON.parse(JSON.stringify(D.actions.concepts))),!((b=(x=D?.actions)===null||x===void 0?void 0:x.connections)===null||b===void 0)&&b.length&&(k.connections=JSON.parse(JSON.stringify(D.actions.connections))),f.Logger.logUpdate(R),D.data}catch(D){console.error("MakeTheInstanceConceptLocal error sw: ",D),(0,A.ey)(R,"MakeTheInstanceConceptLocal",D),(0,f.handleServiceWorkerException)(D)}}try{let D,H,O=999,U=4,M=d,j=4,$="",Y=I.length;if($=T.startsWith("the_")?T:"the_"+T,S)D=yield(0,W.$)(T,O,d,d,k),H=yield(0,B.A)(I,T,d,U,D.id,j,!0,h,k);else if(Y>255)D=yield(0,W.$)($,O,M,d,k),H=yield(0,B.A)(I,$,d,U,D.id,j,void 0,void 0,k);else{D=yield(0,W.$)($,O,M,d,k);let X=yield r.v.GetConceptByCharacterAndTypeLocal(I,D.id);H=X,X.id==0&&X.userId==0&&(H=yield(0,B.A)(I,$,d,U,D.id,j,void 0,void 0,k))}return H.type=D,f.LocalSyncData.AddConcept(H),k.concepts.push(H),f.Logger.logUpdate(R),H}catch(D){throw(0,A.ey)(R,"MakeTheInstanceConceptLocal",D),D}})}},8357:(fe,q,m)=>{m.d(q,{$:()=>i});var B=m(3077),W=m(8064),r=m(6467),f=m(9975),A=m(2290),N=m(1863),s=function(u,v,T,I){return new(T||(T=Promise))(function(S,d){function l(k){try{h(I.next(k))}catch(w){d(w)}}function a(k){try{h(I.throw(k))}catch(w){d(w)}}function h(k){var w;k.done?S(k.value):(w=k.value,w instanceof T?w:new T(function(L){L(w)})).then(l,a)}h((I=I.apply(u,v||[])).next())})};function i(u,v,T,I){var S=arguments;return s(this,arguments,void 0,function*(d,l,a,h,k={concepts:[],connections:[]}){var w,L,x,b;const R=A.Logger.logfunction("MakeTheTypeConceptLocal",S)||{};if(A.serviceWorker){R.serviceWorker=!0;try{const H=yield(0,A.sendMessage)("MakeTheTypeConceptLocal",{typeString:d,sessionId:l,sessionUserId:a,userId:h,actions:k});return!((L=(w=H?.actions)===null||w===void 0?void 0:w.concepts)===null||L===void 0)&&L.length&&(k.concepts=JSON.parse(JSON.stringify(H.actions.concepts))),!((b=(x=H?.actions)===null||x===void 0?void 0:x.connections)===null||b===void 0)&&b.length&&(k.connections=JSON.parse(JSON.stringify(H.actions.connections))),A.Logger.logUpdate(R),H.data}catch(H){console.error("MakeTheTypeConceptLocal error sw: ",H),(0,N.ey)(R,"MakeTheTypeConceptLocal",H),(0,A.handleServiceWorkerException)(H)}}let D=yield(0,W.$I)(d);if(D&&(D.id==0||D.userId==0)){let H=(0,r.f)(d);if(H[0]==d)D=yield(0,f.A)(d,"the",h,1,51,k);else{let O=yield i(H[0],l,a,h,k),U=yield i(H[1],l,a,h,k);D=yield(0,B.A)(d,H[1],h,O.id,U.id,4,void 0,null,k)}}return A.Logger.logUpdate(R),D})}},3729:(fe,q,m)=>{m.d(q,{D:()=>T});var B=m(9934),W=m(4485),r=m(2),f=m(7876),A=m(4818),N=m(999),s=m(5868),i=m(2290),u=m(176),v=function(I,S,d,l){return new(d||(d=Promise))(function(a,h){function k(x){try{L(l.next(x))}catch(b){h(b)}}function w(x){try{L(l.throw(x))}catch(b){h(b)}}function L(x){var b;x.done?a(x.value):(b=x.value,b instanceof d?b:new d(function(R){R(b)})).then(k,w)}L((l=l.apply(I,S||[])).next())})};function T(I){return v(this,arguments,void 0,function*(S,d={concepts:[],connections:[]}){var l,a,h,k;if(performance.now(),i.serviceWorker)try{const K=yield(0,i.sendMessage)("UpdateCompositionLocal",{patcherStructure:S,actions:d});return!((a=(l=K?.actions)===null||l===void 0?void 0:l.concepts)===null||a===void 0)&&a.length&&(d.concepts=JSON.parse(JSON.stringify(K.actions.concepts))),!((k=(h=K?.actions)===null||h===void 0?void 0:h.connections)===null||k===void 0)&&k.length&&(d.connections=JSON.parse(JSON.stringify(K.actions.connections))),K.data}catch(K){console.error("UpdateCompositionLocal error sw: ",K),(0,i.handleServiceWorkerException)(K)}const w=S.userId,L=S.sessionId,x=S.accessId;let b=[];const R=[];let D=(0,i.CreateDefaultLConcept)(),H=(0,i.CreateDefaultLConcept)();const O=[],U=S.compositionId,M=S.ofTheCompositionId;let j=[],$=yield(0,r.s)(U);for(let K=0;K<$.length;K++)b.push((0,u.P6)($[K]));const Y=[],X=[];let ee=[];for(let K=0;K<b.length;K++)(0,B.A)(X,b[K].ofTheConceptId),(0,B.A)(Y,b[K].ofTheConceptId),(0,B.A)(Y,b[K].toTheConceptId),ee.push(b[K].ofTheConceptId);for(let K=0;K<Y.length;K++){const he=yield(0,f.A)(Y[K]);U==Y[K]&&(D=(0,u.F4)(he)),M==Y[K]&&(H=(0,u.F4)(he)),R.push((0,u.F4)(he))}const Q=S.patchObject;for(const K in Q){let he=(0,i.CreateDefaultLConcept)();const ye=Q[K];let Ce=D;H.id>0&&(Ce=H),Array.isArray(ye)||typeof ye=="object"?(he=yield(0,s.k)(K,"",!0,D.userId,4,999,void 0,d),yield(0,N.R)(Q[K],he.id,he.userId,D.id,D.userId,4,999,void 0,d)):he=yield(0,s.k)(K,ye,!1,w,x,L,void 0,d);const se=(0,W.nm)(R,he);for(let Z=0;Z<se.length;Z++)if(se[Z].id>0){const ne=(0,W.gt)(b,se[Z].id);j=j.concat(ne),O.push(se[Z])}yield(0,i.CreateTheConnectionLocal)(Ce.id,he.id,D.id,2,void 0,void 0,d),R.push(he)}for(let K=0;K<j.length;K++)yield(0,A.m)(j[K].id);yield i.LocalSyncData.SyncDataOnline(void 0,d)})}},8407:(fe,q,m)=>{m.d(q,{A:()=>I});var B=m(9581),W=m(3518),r=m(1863),f=function(S,d,l,a){return new(l||(l=Promise))(function(h,k){function w(b){try{x(a.next(b))}catch(R){k(R)}}function L(b){try{x(a.throw(b))}catch(R){k(R)}}function x(b){var R;b.done?h(b.value):(R=b.value,R instanceof l?R:new l(function(D){D(R)})).then(w,L)}x((a=a.apply(S,[])).next())})},A=m(4402),N=m(2290),s=function(S,d,l,a){return new(l||(l=Promise))(function(h,k){function w(b){try{x(a.next(b))}catch(R){k(R)}}function L(b){try{x(a.throw(b))}catch(R){k(R)}}function x(b){var R;b.done?h(b.value):(R=b.value,R instanceof l?R:new l(function(D){D(R)})).then(w,L)}x((a=a.apply(S,[])).next())})};class i{constructor(d,l,a,h,k,w,L,x,b,R){this.id=0,this.userId=d,this.data=l,this.securityId=a,this.securityUserId=h,this.accessId=k,this.accessUserId=w,this.sessionId=L,this.sessionUserId=x,this.entryTimestamp=b,this.isNew=R}}var u=m(7282),v=m(2212),T=function(S,d,l,a){return new(l||(l=Promise))(function(h,k){function w(b){try{x(a.next(b))}catch(R){k(R)}}function L(b){try{x(a.throw(b))}catch(R){k(R)}}function x(b){var R;b.done?h(b.value):(R=b.value,R instanceof l?R:new l(function(D){D(R)})).then(w,L)}x((a=a.apply(S,d||[])).next())})};function I(S,d){var l=arguments;return T(this,arguments,void 0,function*(a,h,k=!1,w,L=4,x=999,b=0){const R=N.Logger.logfunction("MakeTheInstanceConcept",l)||{};if(N.serviceWorker){R.serviceWorker=!0;try{const ee=yield(0,N.sendMessage)("MakeTheInstanceConcept",{type:a,referent:h,composition:k,userId:w,passedAccessId:L,passedSessionId:x,referentId:b});return N.Logger.logUpdate(R),ee.data}catch(ee){console.error("MakeTheInstanceConcept sw error: ",ee),(0,r.ey)(R,"MakeTheInstanceConcept",ee),(0,N.handleServiceWorkerException)(ee)}}let D,H=x,O=w,U=w,M=L,j=w,$="",Y=h.length,X=(0,u.o)();if($=a.startsWith("the_")?a:"the_"+a,k)X=yield(0,N.MakeTheTypeConceptApi)(a,w),D=yield(0,v.Ay)(h,w,4,X.id,b,M,a);else if(Y>255)X=yield(0,N.MakeTheTypeConceptApi)($,w),D=yield(0,v.Ay)(h,w,4,X.id,b,M,$),function(ee){f(this,void 0,void 0,function*(){try{var Q=(0,W.Xr)();const K=yield fetch(B.B.CreateTheTextDataUrl(),{method:"POST",headers:Q,body:JSON.stringify(ee)});if(!K.ok)throw(0,r.ry)(K),new Error(`Error! status: ${K.status}`);return yield K.json()}catch(K){throw K instanceof Error?console.log("Create the text error message: ",K.message):console.log("Create the text unexpected error: ",K),K}})}(new i(w,h,999,O,M,j,H,U,Date.now().toString(),!0));else{X=yield(0,N.MakeTheTypeConceptApi)($,w);let ee=yield(0,A.A)(h,X.id);D=ee,ee.id==0&&ee.userId==0&&(D=yield(0,v.N)(h,w,4,X.id,12,M,$),function(Q,K,he,ye){var Ce=arguments;s(this,void 0,void 0,function*(){const se=N.Logger.logfunction("MakeTheNameInBackend",Ce);try{let Z={newConceptId:Q,referent:K,typeId:he,typeUserId:ye},ne=(0,W.Xr)(),oe=JSON.stringify(Z);const ae=yield fetch(B.B.MakeTheNameInBackendUrl(),{method:"POST",headers:ne,body:oe});N.Logger.logUpdate(se),ae.ok||(0,r.ry)(ae)}catch(Z){Z instanceof Error?console.log("make the name in backend error message: ",Z.message):console.log("make the name in backend unexpected error: ",Z),(0,r.Mb)(Z,B.B.MakeTheNameInBackendUrl()),(0,r.ey)(se,"MakeTheNameInBackend",Z)}})}(D.id,`${h}`,X.id,w))}return D.type=X,N.Logger.logUpdate(R),D})}},5312:(fe,q,m)=>{m.d(q,{NK:()=>v,Ve:()=>T,cf:()=>i,vw:()=>I,y8:()=>u});var B=m(2832),W=m(3130),r=m(2290),f=m(1863),A=m(6687),N=m(1320),s=function(S,d,l,a){return new(l||(l=Promise))(function(h,k){function w(b){try{x(a.next(b))}catch(R){k(R)}}function L(b){try{x(a.throw(b))}catch(R){k(R)}}function x(b){var R;b.done?h(b.value):(R=b.value,R instanceof l?R:new l(function(D){D(R)})).then(w,L)}x((a=a.apply(S,d||[])).next())})};function i(S){var d=arguments;return s(this,arguments,void 0,function*(l,a="",h=null,k=W.y0){var w,L,x,b,R,D,H,O;const U=r.Logger.logfunction("SearchLinkMultipleAll",d)||{};try{try{if(r.serviceWorker){U.serviceWorker=!0;const he=yield(0,r.sendMessage)("SearchLinkMultipleAll",{searchQuery:l,token:a,caller:h,format:k});return r.Logger.logUpdate(U),he.data}}catch(he){console.error("SearchLinkMultipleAll error sw: ",he),(0,f.ey)(U,"SearchLinkMultipleAll",he),(0,r.handleServiceWorkerException)(he)}let M=[],j=[],$=[],Y=[],X=l[0].composition,ee={},Q={};h?.isDataLoaded?(ee.compositionIds=(w=h.conceptIds)===null||w===void 0?void 0:w.slice(),ee.internalConnections=(L=h.internalConnections)===null||L===void 0?void 0:L.slice(),ee.linkers=(x=h.linkers)===null||x===void 0?void 0:x.slice(),ee.reverse=(b=h.reverse)===null||b===void 0?void 0:b.slice(),Q=ee,M=Q.compositionIds,$=Q.internalConnections,j=Q.linkers,Y=Q.reverse):(ee=yield(0,B.j)(l,a),h&&(h.conceptIds=(R=ee.compositionIds)===null||R===void 0?void 0:R.slice(),h.internalConnections=(D=ee.internalConnections)===null||D===void 0?void 0:D.slice(),h.linkers=(H=ee.linkers)===null||H===void 0?void 0:H.slice(),h.reverse=(O=ee.reverse)===null||O===void 0?void 0:O.slice(),h.isDataLoaded=!0),Q=ee,M=Q.compositionIds,$=Q.internalConnections,j=Q.linkers,Y=Q.reverse);let K=yield function(he,ye,Ce,se,Z,ne){return s(this,arguments,void 0,function*(oe,ae,ue,ve,Te,Ie,_e=W.y0){try{let Se,xe,pe=yield(0,A.QL)(oe);return _e==W.ZJ?(Se=yield(0,A.MT)(ae,ue),xe=yield I(oe,Se,Te,ve)):_e==W.yv?(Se=yield(0,A.D)(ae,ue),xe=yield I(oe,Se,Te,ve)):_e==100?(Se=yield(0,A.nr)(ae,ue),xe=yield u(pe,Se,Te,ve)):_e==W.SL?xe=yield(0,N._W)(oe,ae,ue,Ie.ofCompositions,ve):(Se=yield(0,A.rv)(ae,ue),xe=yield u(pe,Se,Te,ve)),xe}catch(Se){return void console.log("Error Occured in build layer",Se)}})}(j,M,$,Y,X,l[0],k);return r.Logger.logUpdate(U),K}catch(M){throw console.log("this is the error in the search link multiple",M),(0,f.ey)(U,"SearchLinkMultipleAll",M),M}})}function u(S,d,l){return s(this,arguments,void 0,function*(a,h,k,w=[]){new Date().getTime();let L={},x=[];for(let b=0;b<a.length;b++)x.push(a[b].toTheConceptId),x.push(a[b].ofTheConceptId),x.push(a[b].typeId);a.sort(function(b,R){return R.id-b.id});for(let b=0;b<a.length;b++){let R=!1;if(w.includes(a[b].id)&&(R=!0),R==1){if(h[a[b].ofTheConceptId]&&h[a[b].toTheConceptId]){let D=h[a[b].toTheConceptId],H=yield(0,r.GetTheConcept)(a[b].typeId),O=D?.data,U=Object.keys(O)[0];try{let M=H.characterValue+"_reverse";typeof O=="string"&&(O={}),Array.isArray(O[U][M])||(typeof O[U]=="string"&&(O[U]={}),O[U][M]=[]),O[U][M].push(h[a[b].ofTheConceptId])}catch(M){console.log("this is error",M)}}}else if(h[a[b].ofTheConceptId]&&h[a[b].toTheConceptId]){let D=h[a[b].ofTheConceptId],H=yield(0,r.GetTheConcept)(a[b].typeId),O=D?.data,U=Object.keys(O)[0];try{typeof O=="string"&&(O={}),Array.isArray(O[U][H.characterValue])||(typeof O[U]=="string"&&(O[U]={}),O[U][H.characterValue]=[]),O[U][H.characterValue].push(h[a[b].toTheConceptId])}catch(M){console.log("this is error",M)}}}return L=h[k],L})}function v(S,d,l){return s(this,arguments,void 0,function*(a,h,k,w=[]){let L=[],x=[];for(let b=0;b<a.length;b++)x.push(a[b].toTheConceptId),x.push(a[b].ofTheConceptId),x.push(a[b].typeId);a.sort(function(b,R){return R.id-b.id});for(let b=0;b<a.length;b++){let R=!1;if(w.includes(a[b].id)&&(R=!0),R==1){if(h[a[b].ofTheConceptId]&&h[a[b].toTheConceptId]){let D=h[a[b].toTheConceptId],H=yield(0,r.GetTheConcept)(a[b].typeId),O=Object.keys(D)[0];try{let U=H.characterValue+"_reverse";typeof D=="string"&&(D={}),Array.isArray(D[O][U])||(typeof D[O]=="string"&&(D[O]={}),D[O][U]=[]),D[O][U].push(h[a[b].ofTheConceptId])}catch(U){console.log("this is error",U)}}}else if(h[a[b].ofTheConceptId]&&h[a[b].toTheConceptId]){let D=h[a[b].ofTheConceptId],H=yield(0,r.GetTheConcept)(a[b].typeId),O=Object.keys(D)[0];try{typeof D=="string"&&(D={}),Array.isArray(D[O][H.characterValue])||(typeof D[O]=="string"&&(D[O]={}),D[O][H.characterValue]=[]),D[O][H.characterValue].push(h[a[b].toTheConceptId])}catch(U){console.log("this is error",U)}}}for(let b=0;b<k.length;b++){let R=h[k[b]];R&&L.push(R)}return L})}function T(S,d,l,a){return s(this,arguments,void 0,function*(h,k,w,L,x=[]){new Date().getTime();let b=[],R=[];for(let D=0;D<h.length;D++)R.push(h[D].toTheConceptId),R.push(h[D].ofTheConceptId),R.push(h[D].typeId);h.sort(function(D,H){return H.id-D.id});for(let D=0;D<h.length;D++){let H=!1;if(x.includes(h[D].id)&&(H=!0),H==1){if(k[h[D].ofTheConceptId]&&k[h[D].toTheConceptId]){let O=k[h[D].toTheConceptId],U=yield(0,r.GetTheConcept)(h[D].typeId),M=O?.data,j=Object.keys(M)[0];try{let $=U.characterValue+"_reverse";typeof M=="string"&&(M={}),Array.isArray(M[j][$])||(typeof M[j]=="string"&&(M[j]={}),M[j][$]=[]),M[j][$].push(k[h[D].ofTheConceptId])}catch($){console.log("this is error",$)}}}else if(k[h[D].ofTheConceptId]&&k[h[D].toTheConceptId]){let O=k[h[D].ofTheConceptId],U=yield(0,r.GetTheConcept)(h[D].typeId),M=O?.data,j=Object.keys(M)[0];try{typeof M=="string"&&(M={}),Array.isArray(M[j][U.characterValue])||(typeof M[j]=="string"&&(M[j]={}),M[j][U.characterValue]=[]),M[j][U.characterValue].push(k[h[D].toTheConceptId])}catch($){console.log("this is error",$)}}}for(let D=0;D<L.length;D++){let H=k[L[D]];H&&b.push(H)}return b})}function I(S,d,l){return s(this,arguments,void 0,function*(a,h,k,w=[]){let L={},x=yield(0,r.GetConnectionBulk)(a),b=[];for(let R=0;R<x.length;R++)b.push(x[R].toTheConceptId),b.push(x[R].ofTheConceptId),b.push(x[R].typeId);yield(0,r.GetConceptBulk)(b),x.sort(function(R,D){return D.id-R.id});for(let R=0;R<x.length;R++){let D=!1;if(w.includes(x[R].id)&&(D=!0),D==1){if(h[x[R].ofTheConceptId]&&h[x[R].toTheConceptId]){let H=h[x[R].toTheConceptId],O=yield(0,r.GetTheConcept)(x[R].typeId),U=H,M=Object.keys(U)[0];try{let j=O.characterValue+"_reverse";typeof U=="string"&&(U={}),Array.isArray(U[M][j])||(typeof U[M]=="string"&&(U[M]={}),U[M][j]=[]),U[M][j].push(h[x[R].ofTheConceptId])}catch(j){console.log("this is error",j)}}}else if(h[x[R].ofTheConceptId]&&h[x[R].toTheConceptId]){let H=h[x[R].ofTheConceptId],O=yield(0,r.GetTheConcept)(x[R].typeId),U=H,M=Object.keys(U)[0];try{typeof U=="string"&&(U={}),Array.isArray(U[M][O.characterValue])||(typeof U[M]=="string"&&(U[M]={}),U[M][O.characterValue]=[]),U[M][O.characterValue].push(h[x[R].toTheConceptId])}catch(j){console.log("this is error",j)}}}return L=h[k],L})}},1320:(fe,q,m)=>{m.d(q,{zl:()=>l,b6:()=>k,e$:()=>L,y6:()=>w,rq:()=>x,yV:()=>a,_W:()=>h});var B=m(2290),W=m(6687);function r(b){return b.startsWith("the_")?b.slice(4):b}var f=function(b,R,D,H){return new(D||(D=Promise))(function(O,U){function M(Y){try{$(H.next(Y))}catch(X){U(X)}}function j(Y){try{$(H.throw(Y))}catch(X){U(X)}}function $(Y){var X;Y.done?O(Y.value):(X=Y.value,X instanceof D?X:new D(function(ee){ee(X)})).then(M,j)}$((H=H.apply(b,R||[])).next())})};function A(b,R,D){return f(this,void 0,void 0,function*(){var H,O,U,M,j,$,Y,X;let ee=[];for(let Q=0;Q<b.length;Q++)ee.push(b[Q].toTheConceptId),ee.push(b[Q].ofTheConceptId),ee.push(b[Q].typeId);for(let Q=0;Q<b.length;Q++){let K=!1;D.includes(b[Q].id)&&(K=!0);let he=yield(0,B.GetTheConcept)(b[Q].ofTheConceptId),ye=yield(0,B.GetTheConcept)(b[Q].toTheConceptId);if(K==1&&he.id!=0&&ye.id!=0){let Ce,se=(O=(H=ye.type)===null||H===void 0?void 0:H.characterValue)!==null&&O!==void 0?O:"self";b[Q].toTheConceptId in R?Ce=R[b[Q].toTheConceptId]:(Ce={},Ce[se]={},R[b[Q].toTheConceptId]=Ce);let Z=yield(0,B.GetTheConcept)(b[Q].typeId);try{let ne=(M=(U=he?.type)===null||U===void 0?void 0:U.characterValue)!==null&&M!==void 0?M:"none",oe=he.characterValue;Z.characterValue,Z.characterValue.includes("_s_")&&(he.id in R||(R[he.id]={}),R[he.id][ne]=oe),R[ye.id]={}}catch(ne){console.log("this is error",ne)}}if(he.id!=0&&ye.id!=0){let Ce,se=($=(j=he.type)===null||j===void 0?void 0:j.characterValue)!==null&&$!==void 0?$:"self";b[Q].ofTheConceptId in R?Ce=R[b[Q].ofTheConceptId]:(Ce={},Ce[se]={},R[b[Q].ofTheConceptId]=Ce);let Z=yield(0,B.GetTheConcept)(b[Q].typeId);try{let ne=(X=(Y=ye?.type)===null||Y===void 0?void 0:Y.characterValue)!==null&&X!==void 0?X:"none",oe=ye.characterValue;Z.characterValue.includes("_s_")&&(ye.id in R||(R[ye.id]={}),R[ye.id][ne]=oe),R[he.id]={}}catch(ne){console.log("this is error",ne)}}}return R})}var N=m(5312),s=m(7876),i=function(b,R,D,H){return new(D||(D=Promise))(function(O,U){function M(Y){try{$(H.next(Y))}catch(X){U(X)}}function j(Y){try{$(H.throw(Y))}catch(X){U(X)}}function $(Y){var X;Y.done?O(Y.value):(X=Y.value,X instanceof D?X:new D(function(ee){ee(X)})).then(M,j)}$((H=H.apply(b,R||[])).next())})};function u(b,R,D){if(b in R){let H=R[b];H&&(D[H.connectionType+"_count"]=H.count)}}var v=function(b,R,D,H){return new(D||(D=Promise))(function(O,U){function M(Y){try{$(H.next(Y))}catch(X){U(X)}}function j(Y){try{$(H.throw(Y))}catch(X){U(X)}}function $(Y){var X;Y.done?O(Y.value):(X=Y.value,X instanceof D?X:new D(function(ee){ee(X)})).then(M,j)}$((H=H.apply(b,R||[])).next())})},T=m(4698),I=m(6915),S=function(b,R,D,H){return new(D||(D=Promise))(function(O,U){function M(Y){try{$(H.next(Y))}catch(X){U(X)}}function j(Y){try{$(H.throw(Y))}catch(X){U(X)}}function $(Y){var X;Y.done?O(Y.value):(X=Y.value,X instanceof D?X:new D(function(ee){ee(X)})).then(M,j)}$((H=H.apply(b,R||[])).next())})},d=function(b,R,D,H){return new(D||(D=Promise))(function(O,U){function M(Y){try{$(H.next(Y))}catch(X){U(X)}}function j(Y){try{$(H.throw(Y))}catch(X){U(X)}}function $(Y){var X;Y.done?O(Y.value):(X=Y.value,X instanceof D?X:new D(function(ee){ee(X)})).then(M,j)}$((H=H.apply(b,R||[])).next())})};function l(b,R){return d(this,arguments,void 0,function*(D,H,O=""){let U=yield(0,B.SearchWithTypeAndLinkerApi)(D,H,O),M=U.compositionIds,j=U.internalConnections,$=U.linkers,Y=U.reverse,X=U.mainCompositionIds,ee=yield(0,W.QL)($),Q=yield(0,W.MT)(M,j);return yield(0,N.NK)(ee,Q,X,Y)})}function a(b,R,D,H,O){return d(this,void 0,void 0,function*(){let U=yield(0,W.QL)(b),M=yield(0,W.rv)(R,D);return yield(0,N.Ve)(U,M,R,H,O)})}function h(b,R,D,H,O){return d(this,void 0,void 0,function*(){let U=yield(0,W.QL)(b),M=yield(0,W.D)(R,D);return yield(0,N.NK)(U,M,H,O)})}function k(b,R,D,H,O){return d(this,void 0,void 0,function*(){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnections",{linkers:b,conceptIds:R,mainCompositionIds:D,reverse:H,countInfos:O})).data}catch($){console.error("formatConnections error sw: ",$),(0,B.handleServiceWorkerException)($)}let U=yield(0,W.QL)(b);U=(0,I.X)(U);let M=[];return M=yield A(U,M,H),M=yield function($,Y,X){return f(this,void 0,void 0,function*(){var ee,Q,K,he,ye,Ce,se,Z;let ne=[];for(let oe=0;oe<$.length;oe++)ne.push($[oe].toTheConceptId),ne.push($[oe].ofTheConceptId),ne.push($[oe].typeId);$.sort(function(oe,ae){return ae.id-oe.id});for(let oe=0;oe<$.length;oe++){let ae=!1;X.includes($[oe].id)&&(ae=!0);let ue=yield(0,B.GetTheConcept)($[oe].ofTheConceptId),ve=yield(0,B.GetTheConcept)($[oe].toTheConceptId);if(ae==1&&ue.id!=0&&ve.id!=0){let Te,Ie=(Q=(ee=ve.type)===null||ee===void 0?void 0:ee.characterValue)!==null&&Q!==void 0?Q:"self";$[oe].toTheConceptId in Y?(Te=Y[$[oe].toTheConceptId],Ie in Te||(Te[Ie]={})):(Te={},Te[Ie]={},Y[$[oe].toTheConceptId]=Te);let _e=yield(0,B.GetTheConcept)($[oe].typeId);try{let Se=(he=(K=ue?.type)===null||K===void 0?void 0:K.characterValue)!==null&&he!==void 0?he:"none",xe=ue.characterValue,pe=_e.characterValue;pe==""&&(pe=Se,pe=r(pe));let be={[Se]:xe},de=pe+"_reverse";_e.characterValue.includes("_s_")||(typeof Te[Ie]=="string"&&(Te[Ie]={}),Te[Ie][de]=be)}catch(Se){console.log("this is error",Se)}}if(ue.id!=0&&ve.id!=0){let Te,Ie=(Ce=(ye=ue.type)===null||ye===void 0?void 0:ye.characterValue)!==null&&Ce!==void 0?Ce:"self";$[oe].ofTheConceptId in Y?(Te=Y[$[oe].ofTheConceptId],Ie in Te||(Te[Ie]={})):(Te={},Te[Ie]={},Y[$[oe].ofTheConceptId]=Te);let _e=yield(0,B.GetTheConcept)($[oe].typeId);try{let Se=(Z=(se=ve?.type)===null||se===void 0?void 0:se.characterValue)!==null&&Z!==void 0?Z:"none",xe=ve.characterValue,pe=_e.characterValue,be=(_e.characterValue,!1);pe==""&&(pe=Se,pe=r(pe),be=!0);let de={[Se]:xe};isNaN(Number(pe))?_e.characterValue.includes("_s_")||(typeof Te[Ie]=="string"&&(Te[Ie]={}),Te[Ie][pe]=be?xe:de):(Array.isArray(Te[Ie])||(Te[Ie]=[]),Te[Ie].push(xe))}catch(Se){console.log("this is error",Se)}}}return Y})}(U,M,H),yield function($,Y,X,ee){return f(this,arguments,void 0,function*(Q,K,he,ye,Ce=[]){var se,Z,ne,oe,ae,ue;let ve=[],Te=[];for(let Ie=0;Ie<Q.length;Ie++)Te.push(Q[Ie].toTheConceptId),Te.push(Q[Ie].ofTheConceptId),Te.push(Q[Ie].typeId);Q.sort(function(Ie,_e){return _e.id-Ie.id});for(let Ie=0;Ie<Q.length;Ie++){let _e=!1;Ce.includes(Q[Ie].id)&&(_e=!0);let Se=yield(0,B.GetTheConcept)(Q[Ie].ofTheConceptId),xe=yield(0,B.GetTheConcept)(Q[Ie].toTheConceptId);if(_e==1&&Se.id!=0&&xe.id!=0&&xe.id in K){let pe,be=(Z=(se=xe.type)===null||se===void 0?void 0:se.characterValue)!==null&&Z!==void 0?Z:"self";Q[Ie].toTheConceptId in K?pe=K[Q[Ie].toTheConceptId]:(pe={},pe[be]={},K[Q[Ie].toTheConceptId]=pe);let de=yield(0,B.GetTheConcept)(Q[Ie].typeId);try{let ge=de.characterValue+"_reverse",me=K[Q[Ie].ofTheConceptId];me&&(Array.isArray(pe[be][ge])?pe[be][ge].push(me):de.characterValue.includes("_s_")?(pe[be][ge]=[],pe[be][ge].push(me)):pe[be][ge]=me)}catch(ge){console.log("this is error",ge)}}if(Se.id!=0&&xe.id!=0&&Se.id in K){let pe,be=(oe=(ne=Se.type)===null||ne===void 0?void 0:ne.characterValue)!==null&&oe!==void 0?oe:"self";Q[Ie].ofTheConceptId in K?(pe=K[Q[Ie].ofTheConceptId],typeof pe[be]=="string"&&(pe[be]={})):(pe={},pe[be]={},K[Q[Ie].ofTheConceptId]=pe);let de=!1,ge=(yield(0,B.GetTheConcept)(Q[Ie].typeId)).characterValue;ge==""&&(ge=xe.characterValue,de=!0),ge==""&&(ge=(ue=(ae=xe?.type)===null||ae===void 0?void 0:ae.characterValue)!==null&&ue!==void 0?ue:"");try{let me=K[Q[Ie].toTheConceptId];me&&(Array.isArray(pe[be])?de?pe[be].push(me[ge]):pe[be].push(me):Array.isArray(pe[be][ge])?pe[be][ge].push(me):ge.includes("_s_")?(pe[be][ge]=[],de?pe[be][ge].push(me[ge]):pe[be][ge].push(me)):pe[be][ge]=de?me[ge]:me)}catch(me){console.log("this is error",me)}}}for(let Ie=0;Ie<he.length;Ie++){let _e=K[he[Ie]];_e?(_e.id=he[Ie],ve.push(_e)):(yield B.ConceptsData.GetConcept(he[Ie])).id!=0&&(_e={},_e.id=he[Ie],ve.push(_e))}return ve})}(U,M,D,[],H)})}function w(b,R,D,H,O){return d(this,arguments,void 0,function*(U,M,j,$,Y,X="DESC"){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnectionsJustId",{linkers:U,conceptIds:M,mainCompositionIds:j,reverse:$,countInfos:Y,order:X})).data}catch(ye){console.error("formatConnectionsJustId error sw: ",ye),(0,B.handleServiceWorkerException)(ye)}let ee=yield(0,W.QL)(U),Q=yield(0,T.V)(Y);ee=(0,I.X)(ee,X);let K=[];return K=yield A(ee,K,$),K=yield function(ye,Ce){return i(this,arguments,void 0,function*(se,Z,ne=[]){var oe,ae,ue,ve,Te,Ie,_e,Se;let xe=[];for(let pe=0;pe<se.length;pe++)xe.push(se[pe].toTheConceptId),xe.push(se[pe].ofTheConceptId),xe.push(se[pe].typeId);for(let pe=0;pe<se.length;pe++){let be=!1,de=yield(0,s.A)(se[pe].ofTheConceptId),ge=yield(0,s.A)(se[pe].toTheConceptId);if(ne.includes(se[pe].id)&&(be=!0),be==1&&de.id!=0&&ge.id!=0){let me,Be=yield(0,s.A)(se[pe].typeId),ce=(ae=(oe=ge.type)===null||oe===void 0?void 0:oe.characterValue)!==null&&ae!==void 0?ae:"self";se[pe].toTheConceptId in Z?(me=Z[se[pe].toTheConceptId],ce in me||(me[ce]={})):(me={},me[ce]={},Z[se[pe].toTheConceptId]=me);try{let Ne=(ve=(ue=de?.type)===null||ue===void 0?void 0:ue.characterValue)!==null&&ve!==void 0?ve:"none",Ee=de.characterValue,Ae=Be.characterValue;Ae==""&&(Ae=Ne,Ae=r(Ae));let Le={id:de.id,[Ne]:Ee,created_on:se[pe].entryTimeStamp},Ge=Ae+"_reverse";Ge.includes("_s_")||(typeof me[ce]=="string"&&(me[ce]={}),me[ce][Ge]=Le)}catch(Ne){console.log("this is error",Ne)}}if(de.id!=0&&ge.id!=0){let me,Be=yield(0,s.A)(se[pe].typeId),ce=(Ie=(Te=de.type)===null||Te===void 0?void 0:Te.characterValue)!==null&&Ie!==void 0?Ie:"self";se[pe].ofTheConceptId in Z?(me=Z[se[pe].ofTheConceptId],ce in me||(me[ce]={})):(me={},me[ce]={},Z[se[pe].ofTheConceptId]=me);try{let Ne=(Se=(_e=ge?.type)===null||_e===void 0?void 0:_e.characterValue)!==null&&Se!==void 0?Se:"none",Ee=ge.characterValue,Ae=Be.characterValue,Le=!1;Ae==""&&(Ae=Ne,Ae=r(Ae),Le=!0);let Ge={};Ge[Ne]={id:ge.id,data:Ee,created_on:se[pe].entryTimeStamp},isNaN(Number(Ae))?Ae.includes("_s_")||(typeof me[ce]=="string"&&(me[ce]={}),me[ce][Ae]=Le?Ge[Ne]:Ge):(Array.isArray(me[ce])||(me[ce]=[]),me[ce].push(Ge[Ne]))}catch(Ne){console.log("this is error",Ne)}}}return Z})}(ee,K,$),yield function(ye,Ce,se){return i(this,arguments,void 0,function*(Z,ne,oe,ae=[],ue){var ve,Te,Ie,_e,Se,xe,pe;new Date().getTime();let be=[],de=[];for(let ge=0;ge<Z.length;ge++)de.push(Z[ge].toTheConceptId),de.push(Z[ge].ofTheConceptId),de.push(Z[ge].typeId);for(let ge=0;ge<Z.length;ge++){let me=!1,Be=yield(0,s.A)(Z[ge].ofTheConceptId),ce=yield(0,s.A)(Z[ge].toTheConceptId);if(ae.includes(Z[ge].id)&&(me=!0),me==1&&Be.id!=0&&ce.id!=0&&ce.id in ne){let Ne,Ee=yield(0,s.A)(Z[ge].typeId),Ae=(Te=(ve=ce.type)===null||ve===void 0?void 0:ve.characterValue)!==null&&Te!==void 0?Te:"self";Z[ge].toTheConceptId in ne,Z[ge].toTheConceptId in ne?(Ne=ne[Z[ge].toTheConceptId],typeof Ne[Ae]=="string"&&(Ne[Ae]={})):(Ne={},Ne[Ae]={},ne[Z[ge].toTheConceptId]=Ne);try{if(ne[Z[ge].ofTheConceptId]){let Le=ne[Z[ge].ofTheConceptId];Le&&(Le.id=Be.id,Le.created_on=Be.entryTimeStamp);let Ge=Ee.characterValue+"_reverse";Array.isArray(Ne[Ae][Ge])?Ne[Ae][Ge].push(Le):Ge.includes("_s_")?(Ne[Ae][Ge]=[],Ne[Ae][Ge].push(Le)):Ne[Ae][Ge]=Le}}catch(Le){console.log("this is error",Le)}}if(Be.id!=0&&ce.id!=0&&Be.id in ne){let Ne,Ee=yield(0,s.A)(Z[ge].typeId),Ae=(_e=(Ie=Be.type)===null||Ie===void 0?void 0:Ie.characterValue)!==null&&_e!==void 0?_e:"self";Z[ge].toTheConceptId in ne,Z[ge].ofTheConceptId in ne?(Ne=ne[Z[ge].ofTheConceptId],typeof Ne[Ae]=="string"&&(Ne[Ae]={})):(Ne={},Ne[Ae]={},ne[Z[ge].ofTheConceptId]=Ne),u(Be.id,ue,Ne);let Le=!1,Ge=Ee.characterValue;Ge==""&&(Ge=ce.characterValue,Le=!0),Ge==""&&(Ge=((Se=ce?.type)===null||Se===void 0?void 0:Se.characterValue)||"");try{let Oe=(pe=(xe=ce?.type)===null||xe===void 0?void 0:xe.characterValue)!==null&&pe!==void 0?pe:"none",He=ne[Z[ge].toTheConceptId];if(He){let $e={};$e[Oe]={data:He[Oe],id:ce.id,created_on:Z[ge].entryTimeStamp},Array.isArray(Ne[Ae])?Le?Ne[Ae].push(He[Ge]):Ne[Ae].push(He):Array.isArray(Ne[Ae][Ge])?Ne[Ae][Ge].push($e):Ge.includes("_s_")?(Ne[Ae][Ge]=[],Le?Ne[Ae][Ge].push($e[Oe]):Ne[Ae][Ge].push($e)):Ne[Ae][Ge]=Le?$e[Oe]:$e,u(ce.id,ue,$e)}}catch(Oe){console.log("this is error",Oe)}}}for(let ge=0;ge<oe.length;ge++){let me={};me=ne[oe[ge]],me?me.id=oe[ge]:(yield B.ConceptsData.GetConcept(oe[ge])).id!=0&&(me={},me.id=oe[ge]),be.push(me)}return be})}(ee,K,j,$,Q)})}function L(b,R,D,H,O){return d(this,arguments,void 0,function*(U,M,j,$,Y,X="DESC"){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnectionsDataId",{linkers:U,conceptIds:M,mainCompositionIds:j,reverse:$,countInfos:Y,order:X})).data}catch(ye){console.error("GetConnectionDataPrefetch error sw: ",ye),(0,B.handleServiceWorkerException)(ye)}let ee=yield(0,W.QL)(U),Q=yield(0,T.V)(Y);ee=(0,I.X)(ee,X);let K=[];return K=yield function(ye,Ce){var se=arguments;return v(this,arguments,void 0,function*(Z,ne,oe=[]){var ae,ue,ve,Te,Ie,_e,Se,xe;const pe=B.Logger.logfunction("FormatFunctionData",se);let be=[];for(let de=0;de<Z.length;de++)be.push(Z[de].toTheConceptId),be.push(Z[de].ofTheConceptId),be.push(Z[de].typeId);for(let de=0;de<Z.length;de++){let ge=!1,me=yield(0,B.GetTheConcept)(Z[de].ofTheConceptId),Be=yield(0,B.GetTheConcept)(Z[de].toTheConceptId);if(oe.includes(Z[de].id)&&(ge=!0),ge==1&&me.id!=0&&Be.id!=0){let ce,Ne=yield(0,B.GetTheConcept)(Z[de].typeId),Ee=(ue=(ae=Be.type)===null||ae===void 0?void 0:ae.characterValue)!==null&&ue!==void 0?ue:"self";Z[de].toTheConceptId in ne?ce=ne[Z[de].toTheConceptId]:(ce={},ce[Ee]={},ne[Z[de].toTheConceptId]=ce);try{let Ae=(Te=(ve=me?.type)===null||ve===void 0?void 0:ve.characterValue)!==null&&Te!==void 0?Te:"none",Le=me.characterValue;(Ne.characterValue+"_reverse").includes("_s_")&&(me.id in ne||(ne[me.id]={}),ne[me.id][Ae]=Le),ne[Be.id]={}}catch(Ae){console.log("this is error",Ae)}}if(me.id!=0&&Be.id!=0){let ce,Ne=yield(0,B.GetTheConcept)(Z[de].typeId),Ee=(_e=(Ie=me.type)===null||Ie===void 0?void 0:Ie.characterValue)!==null&&_e!==void 0?_e:"self";Z[de].ofTheConceptId in ne?ce=ne[Z[de].ofTheConceptId]:(ce={},ce[Ee]={},ne[Z[de].ofTheConceptId]=ce);try{let Ae=(xe=(Se=Be?.type)===null||Se===void 0?void 0:Se.characterValue)!==null&&xe!==void 0?xe:"none",Le=Be.characterValue;Ne.characterValue.includes("_s_")&&(Be.id in ne||(ne[Be.id]={}),ne[Be.id][Ae]=Le),ne[me.id]={}}catch(Ae){console.log("this is error",Ae)}}}return B.Logger.logUpdate(pe),ne})}(ee,K,$),K=yield function(ye,Ce){var se=arguments;return v(this,arguments,void 0,function*(Z,ne,oe=[]){var ae,ue,ve,Te,Ie,_e,Se,xe;const pe=B.Logger.logfunction("FormatFunctionDataForData",se);let be=[];for(let de=0;de<Z.length;de++)be.push(Z[de].toTheConceptId),be.push(Z[de].ofTheConceptId),be.push(Z[de].typeId);for(let de=0;de<Z.length;de++){let ge=!1,me=yield(0,B.GetTheConcept)(Z[de].ofTheConceptId),Be=yield(0,B.GetTheConcept)(Z[de].toTheConceptId);if(oe.includes(Z[de].id)&&(ge=!0),ge==1&&me.id!=0&&Be.id!=0){let ce,Ne=yield(0,B.GetTheConcept)(Z[de].typeId),Ee=(ue=(ae=Be.type)===null||ae===void 0?void 0:ae.characterValue)!==null&&ue!==void 0?ue:"self";Z[de].toTheConceptId in ne?(ce=ne[Z[de].toTheConceptId],Ee in ce||(ce[Ee]={})):(ce={},ce[Ee]={},ne[Z[de].toTheConceptId]=ce);try{let Ae=(Te=(ve=me?.type)===null||ve===void 0?void 0:ve.characterValue)!==null&&Te!==void 0?Te:"none",Le=me.characterValue,Ge=Ne.characterValue;Ge==""&&(Ge=Ae,Ge=r(Ge));let Oe={id:me.id,data:{[Ae]:Le}},He=Ge+"_reverse";He.includes("_s_")||(typeof ce[Ee]=="string"&&(ce[Ee]={}),ce[Ee][He]=Oe)}catch(Ae){console.log("this is error",Ae)}}if(me.id!=0&&Be.id!=0){let ce,Ne=yield(0,B.GetTheConcept)(Z[de].typeId),Ee=(_e=(Ie=me.type)===null||Ie===void 0?void 0:Ie.characterValue)!==null&&_e!==void 0?_e:"self";Z[de].ofTheConceptId in ne?(ce=ne[Z[de].ofTheConceptId],Ee in ce||(ce[Ee]={})):(ce={},ce[Ee]={},ne[Z[de].ofTheConceptId]=ce);try{let Ae=(xe=(Se=Be?.type)===null||Se===void 0?void 0:Se.characterValue)!==null&&xe!==void 0?xe:"none",Le=Be.characterValue,Ge=Ne.characterValue,Oe=!1;Ge==""&&(Ge=Ae,Ge=r(Ge),Oe=!0);let He={id:Be.id,data:{[Ae]:Le}};isNaN(Number(Ge))?Ge.includes("_s_")||(typeof ce[Ee]=="string"&&(ce[Ee]={}),ce[Ee][Ge]=He):(Array.isArray(ce[Ee])||(ce[Ee]=[]),ce[Ee].push(He))}catch(Ae){console.log("this is error",Ae)}}}return B.Logger.logUpdate(pe),ne})}(ee,K,$),yield function(ye,Ce,se,Z){var ne=arguments;return v(this,arguments,void 0,function*(oe,ae,ue,ve,Te=[],Ie){var _e,Se,xe,pe,be,de;const ge=B.Logger.logfunction("FormatFromConnectionsAlteredArrayExternal",ne);let me=[],Be=[];for(let ce=0;ce<oe.length;ce++)Be.push(oe[ce].toTheConceptId),Be.push(oe[ce].ofTheConceptId),Be.push(oe[ce].typeId);for(let ce=0;ce<oe.length;ce++){let Ne=!1,Ee=yield(0,B.GetTheConcept)(oe[ce].ofTheConceptId),Ae=yield(0,B.GetTheConcept)(oe[ce].toTheConceptId);if(Te.includes(oe[ce].id)&&(Ne=!0),Ne==1&&Ee.id!=0&&Ae.id!=0&&Ae.id in ae){let Le,Ge=yield(0,B.GetTheConcept)(oe[ce].typeId),Oe=(Se=(_e=Ae.type)===null||_e===void 0?void 0:_e.characterValue)!==null&&Se!==void 0?Se:"self";oe[ce].toTheConceptId in ae,oe[ce].toTheConceptId in ae?(Le=ae[oe[ce].toTheConceptId],typeof Le[Oe]=="string"&&(Le[Oe]={})):(Le={},Le[Oe]={},ae[oe[ce].toTheConceptId]=Le),u(Ae.id,Ie,Le);try{if(ae[oe[ce].ofTheConceptId]){let He={id:Ee.id,data:ae[oe[ce].ofTheConceptId],created_on:oe[ce].entryTimeStamp},$e=Ge.characterValue+"_reverse";Array.isArray(Le[Oe][$e])?Le[Oe][$e].push(He):$e.includes("_s_")?(Le[Oe][$e]=[],Le[Oe][$e].push(He)):Le[Oe][$e]=He}}catch(He){console.log("this is error",He)}}if(Ee.id!=0&&Ae.id!=0&&Ee.id in ae){let Le,Ge=yield(0,B.GetTheConcept)(oe[ce].typeId),Oe=(pe=(xe=Ee.type)===null||xe===void 0?void 0:xe.characterValue)!==null&&pe!==void 0?pe:"self";oe[ce].toTheConceptId in ae,oe[ce].ofTheConceptId in ae?(Le=ae[oe[ce].ofTheConceptId],typeof Le[Oe]=="string"&&(Le[Oe]={})):(Le={},Le[Oe]={},ae[oe[ce].ofTheConceptId]=Le),u(Ee.id,Ie,Le);let He=Ge.characterValue;He==""&&(He=Ae.characterValue),He==""&&(He=((be=Ae?.type)===null||be===void 0?void 0:be.characterValue)||"");try{(de=Ae?.type)===null||de===void 0||de.characterValue;let $e=ae[oe[ce].toTheConceptId];if($e){let Jt={id:Ae.id,data:ae[oe[ce].toTheConceptId],created_on:oe[ce].entryTimeStamp};Array.isArray(Le[Oe])?Le[Oe].push($e):Array.isArray(Le[Oe][He])?Le[Oe][Ge.characterValue].push(Jt):He.includes("_s_")?(Le[Oe][He]=[],Le[Oe][He].push(Jt)):Le[Oe][He]=Jt,u(Ae.id,Ie,Jt)}}catch($e){console.log("this is error",$e)}}}for(let ce=0;ce<ve.length;ce++){let Ne={};Ne.id=ve[ce];let Ee=yield(0,B.GetTheConcept)(Ne.id);Ne.data=ae[ve[ce]],Ne.created_on=Ee.entryTimeStamp,me.push(Ne)}return B.Logger.logUpdate(ge),me})}(ee,K,[],j,$,Q)})}function x(b,R,D,H,O){return d(this,arguments,void 0,function*(U,M,j,$,Y,X="DESC"){if(B.serviceWorker)try{return(yield(0,B.sendMessage)("formatConnectionsV2",{linkers:U,conceptIds:M,mainCompositionIds:j,reverse:$,countInfos:Y,order:X})).data}catch(ye){console.error("formatConnectionsV2 error sw: ",ye),(0,B.handleServiceWorkerException)(ye)}let ee=yield(0,W.QL)(U),Q=yield(0,T.V)(Y);ee=(0,I.X)(ee,X);let K={};return K=yield function(ye){var Ce=arguments;return S(this,arguments,void 0,function*(se,Z={},ne=[]){var oe,ae,ue,ve,Te;const Ie=B.Logger.logfunction("FormatFunctionDataV2",Ce);for(const _e of se){const Se=ne.includes(_e.id),xe=yield(0,B.GetTheConcept)(_e.ofTheConceptId),pe=yield(0,B.GetTheConcept)(_e.toTheConceptId),be=yield(0,B.GetTheConcept)(_e.typeId);if(xe.id===0||pe.id===0)continue;const de=Se?pe:xe,ge=Se?xe:pe,me=(ae=(oe=de.type)===null||oe===void 0?void 0:oe.characterValue)!==null&&ae!==void 0?ae:"self",Be=(ve=(ue=ge.type)===null||ue===void 0?void 0:ue.characterValue)!==null&&ve!==void 0?ve:"none",ce=ge.characterValue;(Te=be.characterValue)===null||Te===void 0||Te.includes("_s_"),Z[de.id]||(Z[de.id]={}),Z[de.id][me]||(Z[de.id][me]={}),Z[ge.id]||(Z[ge.id]={}),Z[ge.id][Be]=ce}return B.Logger.logUpdate(Ie),Z})}(ee,K,$),K=yield function(ye){var Ce=arguments;return S(this,arguments,void 0,function*(se,Z={},ne=[]){var oe,ae,ue,ve,Te;const Ie=B.Logger.logfunction("FormatFunctionDataForDataV2",Ce);for(const _e of se){const Se=ne.includes(_e.id),xe=yield(0,B.GetTheConcept)(_e.ofTheConceptId),pe=yield(0,B.GetTheConcept)(_e.toTheConceptId),be=yield(0,B.GetTheConcept)(_e.typeId);if(xe.id===0||pe.id===0)continue;const de=Se?pe:xe,ge=Se?xe:pe,me=(ae=(oe=de.type)===null||oe===void 0?void 0:oe.characterValue)!==null&&ae!==void 0?ae:"self",Be=(ve=(ue=ge.type)===null||ue===void 0?void 0:ue.characterValue)!==null&&ve!==void 0?ve:"none",ce=ge.characterValue,Ne=(Te=be.characterValue)!==null&&Te!==void 0?Te:"";let Ee=Ne===""?r(Be):Ne;const Ae=Ee.includes("_s_"),Le=!isNaN(Number(Ee)),Ge={id:ge.id,data:{[Be]:ce}};Z[de.id]||(Z[de.id]={}),me in Z[de.id]&&typeof Z[de.id][me]!="string"||(Z[de.id][me]=Le?[]:{});try{if(Ae)continue;Le?Z[de.id][me].push(Ge):Z[de.id][me][Se?`${Ee}_reverse`:Ee]=Ge}catch(Oe){console.error("Error formatting concept data:",Oe)}}return B.Logger.logUpdate(Ie),Z})}(ee,K,$),yield function(ye,Ce,se){var Z=arguments;return S(this,arguments,void 0,function*(ne,oe,ae,ue=[],ve){var Te,Ie,_e;const Se=B.Logger.logfunction("FormatFromConnectionsAlteredArrayExternal",Z),xe=[];for(const pe of ne){const be=ue.includes(pe.id),de=yield(0,B.GetTheConcept)(pe.ofTheConceptId),ge=yield(0,B.GetTheConcept)(pe.toTheConceptId),me=yield(0,B.GetTheConcept)(pe.typeId);if(de.id===0||ge.id===0)continue;const Be=be?ge:de,ce=be?de:ge,Ne=Be.id,Ee=ce.id,Ae=(Ie=(Te=Be.type)===null||Te===void 0?void 0:Te.characterValue)!==null&&Ie!==void 0?Ie:"self",Le=me.characterValue+"_reverse",Ge=me.characterValue||ce.characterValue||((_e=ce.type)===null||_e===void 0?void 0:_e.characterValue)||"";if(oe[Ne]){const Oe=oe[Ne][Ae],He=oe[Ee],$e={id:ce.id,data:He,created_on:pe.entryTimeStamp};u(Ne,ve,oe[Ne]);try{be?Array.isArray(Oe[Le])?Oe[Le].push($e):Oe[Le]=[$e]:Array.isArray(Oe)?Oe.push(He):Array.isArray(Oe[Ge])?Oe[Ge].push($e):Ge.includes("_s_")?(Oe[Ge]=[],Oe[Ge].push($e)):Oe[Ge]=[$e],u(Ee,ve,$e)}catch(Jt){console.error("Error processing connection:",Jt)}}else console.log("This is the error in the source")}for(const pe of ae){const be=yield(0,B.GetTheConcept)(pe);xe.push({id:pe,data:oe[pe],created_on:be.entryTimeStamp})}return B.Logger.logUpdate(Se),xe})}(ee,K,j,$,Q)})}},6915:(fe,q,m)=>{function B(W,r="DESC"){return r=="ASC"?W.sort(function(f,A){return f.id-A.id}):W.sort(function(f,A){return A.id-f.id}),W}m.d(q,{X:()=>B})},3518:(fe,q,m)=>{m.d(q,{BZ:()=>A,Xr:()=>r,ab:()=>f});var B=m(3278),W=m(490);function r(N="application/json",s="application/json"){var i;let u={},v=(i=B.b.sessionId)===null||i===void 0?void 0:i.toString();return u=B.b.BearerAccessToken!=""?{"Content-Type":N,Authorization:"Bearer "+B.b.BearerAccessToken,Accept:s,"X-Session-id":v}:{"Content-Type":N,Accept:s,"X-Session-id":v},u}function f(N="application/json",s="",i="application/json"){var u;s==""&&(s=B.b.BearerAccessToken);let v={},T=(u=B.b.sessionId)===null||u===void 0?void 0:u.toString();return v=s!=""?{"Content-Type":N,Authorization:"Bearer "+s,Accept:i,"X-Session-id":T}:{"Content-Type":N,Accept:i,"X-Session-id":T},v}function A(){var N;let s=B.b.BearerAccessToken,i=(N=B.b.sessionId)===null||N===void 0?void 0:N.toString();if(s==""){let v=(0,W.s)();v.token!=""&&(B.b.BearerAccessToken=v.token,s=v.token)}let u=new Headers;return u.append("Authorization","Bearer "+s),u.append("X-Session-Id",i),u}},6467:(fe,q,m)=>{function B(W){const r=W.lastIndexOf("_");let f=[];return f=r>0?[W.substring(0,r),W.substring(r+1,W.length)]:[W],f}m.d(q,{f:()=>B})},490:(fe,q,m)=>{function B(){var W,r,f,A;let N={entity:0,userConcept:0,userId:0,token:""};try{let s=(localStorage==null?void 0:localStorage.getItem("profile"))||"";if(s){const i=JSON.parse(s);N.entity=(W=i?.entityId)!==null&&W!==void 0?W:0,N.userConcept=(r=i?.userConcept)!==null&&r!==void 0?r:0,N.userId=(f=i?.userId)!==null&&f!==void 0?f:0,N.token=(A=i?.token)!==null&&A!==void 0?A:""}}catch{console.log("This is the exception in getting user details from local storage")}return N}m.d(q,{s:()=>B})},1596:(fe,q,m)=>{m.d(q,{g:()=>f});var B=m(2290),W=m(3278),r=function(A,N,s,i){return new(s||(s=Promise))(function(u,v){function T(d){try{S(i.next(d))}catch(l){v(l)}}function I(d){try{S(i.throw(d))}catch(l){v(l)}}function S(d){var l;d.done?u(d.value):(l=d.value,l instanceof s?l:new s(function(a){a(l)})).then(T,I)}S((i=i.apply(A,[])).next())})};function f(A,N){return r(this,void 0,void 0,function*(){if(typeof self<"u"&&typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope)throw new Error("Cannot switch server from service worker");try{(function(){const s=B.BaseUrl.NODE_CACHE_URL;if(s===B.BaseUrl.BASE_URL)throw new Error("Base Server Down");let i=sessionStorage.getItem("cacheServers");i=JSON.parse(i);const u=i.indexOf(s);if(B.BaseUrl.isNearestCache=!1,i.includes(s)&&u!==-1&&i.splice(u,1),sessionStorage.setItem("cacheServers",JSON.stringify(i)),i.length){const v=i[0];B.BaseUrl.NODE_CACHE_URL=v}else B.BaseUrl.NODE_CACHE_URL=B.BaseUrl.BASE_URL;console.log("before the payload",W.b.sessionId),navigator.serviceWorker&&navigator.serviceWorker.controller&&(0,B.sendMessage)("SESSION_DATA",{type:"SESSION_DATA",data:B.BaseUrl.NODE_CACHE_URL,session:W.b.sessionId})})();try{return yield fetch(`${B.BaseUrl.NODE_CACHE_URL}${N}`,A)}catch{return yield f(A,N)}}catch(s){throw s}})}},4310:(fe,q,m)=>{m.d(q,{Cp:()=>v,ix:()=>I,qj:()=>T});var B=m(2290),W=m(1596),r=m(4698),f=m(1863),A=m(1320),N=m(3518),s=function(S,d,l,a){return new(l||(l=Promise))(function(h,k){function w(b){try{x(a.next(b))}catch(R){k(R)}}function L(b){try{x(a.throw(b))}catch(R){k(R)}}function x(b){var R;b.done?h(b.value):(R=b.value,R instanceof l?R:new l(function(D){D(R)})).then(w,L)}x((a=a.apply(S,[])).next())})};const i=new Map,u=new Map;function v(S){var d=arguments;return s(this,void 0,void 0,function*(){B.Logger.logfunction("BuildWidgetFromId",d);try{if(B.serviceWorker)return(yield(0,B.sendMessage)("BuildWidgetFromId",{id:S})).data}catch(h){console.error("BuildWidgetFromId error sw: ",h),(0,B.handleServiceWorkerException)(h)}let l={};if(i.has(S))return i.get(S)||l;const a=s(this,void 0,void 0,function*(){try{let h=[],k=[],w=[],L=[],x="DESC",b=[],R={},D=(0,N.Xr)("application/json"),H=B.BaseUrl.getWidgetData()+"?id="+S;const O=yield fetch(H,{method:"GET",headers:D});if(!O.ok)return(0,f.ry)(O),console.log("This is the BuildWidgetFromId error",O.status),[];R=yield O.json(),h=R.conceptIds,k=R.linkers,w=R.reverse,L=R.mainCompositionIds,b=R.countinfo;let U=(0,r.w)(b);return l=yield(0,A.e$)(k,h,L,w,U,x),l}catch(h){throw console.log("this is the error in the build widget",h),h}finally{i.delete(S)}});return i.set(S,a),a})}function T(S){var d=arguments;return s(this,void 0,void 0,function*(){B.Logger.logfunction("BuildWidgetFromIdForLatest",d);try{if(B.serviceWorker)return(yield(0,B.sendMessage)("BuildWidgetFromIdForLatest",{id:S})).data}catch(h){console.error("BuildWidgetFromIdForLatest error sw: ",h),(0,B.handleServiceWorkerException)(h)}let l={};if(u.has(S))return u.get(S)||l;const a=s(this,void 0,void 0,function*(){try{let h,k=[],w=[],L=[],x=[],b="DESC",R=[],D={},H=(0,N.Xr)("application/json");try{let U=B.BaseUrl.getLatestWidgetData()+"?id="+S;h=yield fetch(U,{method:"GET",headers:H})}catch{h=yield(0,W.g)({method:"GET",headers:H},"?id="+S)}if(!h.ok)return(0,f.ry)(h),console.log("This is the BuildWidgetFromId error",h.status),[];D=yield h.json(),k=D.conceptIds,w=D.linkers,L=D.reverse,x=D.mainCompositionIds,R=D.countinfo;let O=(0,r.w)(R);return l=yield(0,A.e$)(w,k,x,L,O,b),{data:l,mainId:D.mainId}}catch(h){throw console.log("this is the error in the build widget",h),h}finally{u.delete(S)}});return u.set(S,a),a})}function I(S,d){for(let l=0;l<S.length;l++)if(S[l].id==d)return S[l]}},4287:(fe,q,m)=>{m.d(q,{w:()=>f});var B=m(2290),W=m(3130),r=function(A,N,s,i){return new(s||(s=Promise))(function(u,v){function T(d){try{S(i.next(d))}catch(l){v(l)}}function I(d){try{S(i.throw(d))}catch(l){v(l)}}function S(d){var l;d.done?u(d.value):(l=d.value,l instanceof s?l:new s(function(a){a(l)})).then(T,I)}S((i=i.apply(A,[])).next())})};class f{constructor(){this.subscribers=[],this.mainConcept=0,this.compositionIds=[],this.conceptIds=[],this.internalConnections=[],this.reverse=[],this.linkers=[],this.newIds=[],this.dependency=[],this.isDataLoaded=!1,this.isUpdating=!1,this.fetched=!1,this.format=W.yv,this.eventHandlers={}}listenToEventType(N){if(this.eventHandlers[N])return;const s=i=>r(this,void 0,void 0,function*(){if(!this.isUpdating){this.isUpdating=!0;let u=this;setTimeout(function(){return r(this,void 0,void 0,function*(){let v=i;if(!u.compositionIds.includes(v?.detail)){u.compositionIds.unshift(v?.detail),u.listenToEvent(v?.detail);let T=v?.detail,I=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(T,T);for(let S=0;S<I.length;S++)yield B.ConnectionData.GetConnection(I[S]).then(d=>{d.typeId==u.mainConcept?u.internalConnections.includes(d.id)||u.internalConnections.push(d.id):u.linkers.includes(d.id)||u.linkers.push(d.id),u.conceptIds.includes(d.toTheConceptId)||u.conceptIds.push(d.toTheConceptId),u.compositionIds.includes(d.ofTheConceptId)||u.compositionIds.push(d.ofTheConceptId)})}u.isUpdating=!1,yield u.bind(),u.notify()})},200)}});this.eventHandlers[N]=s,window.addEventListener(`${N}`,s)}listenToEvent(N){if(this.eventHandlers[N])return;const s=i=>r(this,void 0,void 0,function*(){if(!this.isUpdating){this.isUpdating=!0;let u=this;setTimeout(function(){return r(this,void 0,void 0,function*(){let v=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(N,N);for(let T=0;T<v.length;T++)yield B.ConnectionData.GetConnection(v[T]).then(I=>{I.typeId==u.mainConcept?u.internalConnections.includes(I.id)||u.internalConnections.push(I.id):u.linkers.includes(I.id)||u.linkers.push(I.id),u.conceptIds.includes(I.toTheConceptId)||u.conceptIds.push(I.toTheConceptId),u.compositionIds.includes(I.ofTheConceptId)||(u.compositionIds.push(I.ofTheConceptId),u.newIds.includes(I.ofTheConceptId)||u.newIds.push(I.ofTheConceptId))});u.isUpdating=!1,yield u.bind(),u.notify()})},200)}});this.eventHandlers[N]=s,window.addEventListener(`${N}`,s)}removeListenToEvent(N){const s=this.eventHandlers[N];s&&(window.removeEventListener(`${N}`,s),delete this.eventHandlers[N])}listenToEventConnectionType(N,s){window.addEventListener(`${N}`,i=>{if(!this.isUpdating){this.isUpdating=!0;let u=this;setTimeout(function(){return r(this,void 0,void 0,function*(){let v=yield B.ConnectionData.GetConnectionByOfTheConceptAndType(N,N);for(let T=0;T<v.length;T++)v.typeId==s&&(yield B.ConnectionData.GetConnection(v[T]).then(I=>{I.typeId==u.mainConcept?u.internalConnections.includes(I.id)||u.internalConnections.push(I.id):u.linkers.includes(I.id)||u.linkers.push(I.id),u.conceptIds.includes(I.toTheConceptId)||u.conceptIds.push(I.toTheConceptId),u.compositionIds.includes(I.ofTheConceptId)||u.compositionIds.push(I.ofTheConceptId)}));u.isUpdating=!1,yield u.bind(),u.notify()})},200)}})}bind(){return r(this,void 0,void 0,function*(){console.log("this is the old execute data")})}run(){return r(this,void 0,void 0,function*(){console.log("this is non subscriber data")})}update(){return r(this,void 0,void 0,function*(){this.isDataLoaded=!1,yield this.bind(),this.notify()})}subscribe(N){return r(this,void 0,void 0,function*(){return this.subscribers.push(N),yield this.bind(),N(this.data,this)})}execute(){return r(this,void 0,void 0,function*(){return yield this.run()})}unsubscribe(N){return this.subscribers.filter(s=>s!=N),this.subscribers.length}notify(){this.subscribers.map(N=>{N(this.data,this)})}}},5328:(fe,q,m)=>{m.d(q,{d:()=>s});var B=m(2290),W=m(3130),r=m(8939),f=m(4287),A=function(i,u,v,T){return new(v||(v=Promise))(function(I,S){function d(h){try{a(T.next(h))}catch(k){S(k)}}function l(h){try{a(T.throw(h))}catch(k){S(k)}}function a(h){var k;h.done?I(h.value):(k=h.value,k instanceof v?k:new v(function(w){w(k)})).then(d,l)}a((T=T.apply(i,[])).next())})};class N extends f.w{constructor(u,v,T,I,S){super(),this.connections=[],this.data=[],this.mainConcept=u,this.linker=v,this.inpage=T,this.page=I,this.format=S}bind(){return A(this,void 0,void 0,function*(){var u;if(!this.isDataLoaded){let I=yield(0,B.GetTheConcept)(this.mainConcept),S=((u=I.type)===null||u===void 0?void 0:u.characterValue)+"_s_"+this.linker,d=yield(0,B.GetConceptByCharacterAndType)(S,16);if(d.id>0){let l=yield(0,B.GetConnectionOfTheConcept)(d.id,I.id,I.userId,this.inpage,this.page);this.connections=l;for(var v=[],T=0;T<this.connections.length;T++)v.push(this.connections[T].toTheConceptId),this.linkers.push(this.connections[T].id),this.listenToEvent(this.connections[T].toTheConceptId);yield(0,B.GetAllConnectionsOfCompositionBulk)(v)}this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return A(this,void 0,void 0,function*(){this.data=[],this.connections=yield(0,B.GetConnectionBulk)(this.linkers);for(var u=0;u<this.connections.length;u++){let v=this.connections[u].toTheConceptId,T=yield(0,B.GetTheConcept)(v);if(console.log("this is the format",this.format),this.format==W.yv){let I=yield(0,r.RW)(T.id);this.data.push(I)}else if(this.format==W.ZJ){let I=yield(0,r.kx)(T.id);this.data.push(I)}else if(this.format==W.iw){let I=yield(0,B.GetCompositionWithIdAndDateFromMemory)(T.id);this.data.push(I)}else{let I=yield(0,B.GetCompositionWithIdAndDateFromMemory)(T.id);this.data.push(I)}}return this.data})}}function s(i,u,v,T,I=W.yv){return new N(i,u,v,T,I)}},2290:(fe,q,m)=>{m.r(q),m.d(q,{ADMIN:()=>Ri,ALLID:()=>Me.BG,AccessTracker:()=>Nn.J,AddGhostConcept:()=>ki,Anomaly:()=>Qe,BaseUrl:()=>s.B,BinaryTree:()=>Xn.W,BuildWidgetFromId:()=>rn.Cp,BuilderStatefulWidget:()=>bn,Composition:()=>Ln,CompositionBinaryTree:()=>zt,CompositionNode:()=>ro,Concept:()=>Ji.j,ConceptsData:()=>N.I,Connection:()=>ye.N,ConnectionData:()=>Ut.d,CountInfo:()=>lr.y,CreateComposition:()=>ee.A,CreateConnection:()=>Et.d,CreateConnectionBetweenEntityLocal:()=>Ao,CreateConnectionBetweenTwoConcepts:()=>_e,CreateConnectionBetweenTwoConceptsGeneral:()=>xe,CreateConnectionBetweenTwoConceptsLocal:()=>yo.h,CreateData:()=>Hn,CreateDefaultConcept:()=>se.o,CreateDefaultLConcept:()=>lo.u,CreateSession:()=>gi,CreateSessionVisit:()=>vi,CreateTheCompositionLocal:()=>Q.R,CreateTheCompositionWithCache:()=>Sn,CreateTheConnection:()=>Be.q,CreateTheConnectionGeneral:()=>ae,CreateTheConnectionLocal:()=>Et.F,DATAID:()=>Me.y0,DATAIDDATE:()=>Me.iw,DATAV2:()=>Me.pU,DelayFunctionExecution:()=>Ei,DeleteConceptById:()=>Yn,DeleteConceptLocal:()=>Gi,DeleteConnectionById:()=>ue.m,DeleteConnectionByIdBulk:()=>ue.E,DeleteConnectionByType:()=>Cn.$S,DeleteConnectionByTypeBulk:()=>Cn.L0,DeleteUser:()=>Jo,DependencyObserver:()=>qt.w,FilterSearch:()=>On,FormatFromConnections:()=>tn.vw,FormatFromConnectionsAltered:()=>tn.y8,FreeschemaQuery:()=>wt,FreeschemaQueryApi:()=>Pn,GetAllConnectionsOfComposition:()=>X.s,GetAllConnectionsOfCompositionBulk:()=>I.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>Cn.WC,GetComposition:()=>d.Nj,GetCompositionBulk:()=>Ke.dF,GetCompositionBulkWithDataId:()=>Ke.cw,GetCompositionFromConnectionsWithDataId:()=>Ke.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>Ke.km,GetCompositionFromConnectionsWithDataIdInObject:()=>Ke.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>Ke.Nt,GetCompositionFromConnectionsWithIndex:()=>Ke.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>Ke.hG,GetCompositionFromMemoryWithConnections:()=>d.JA,GetCompositionList:()=>k,GetCompositionListAll:()=>w,GetCompositionListAllWithId:()=>L,GetCompositionListListener:()=>Pi,GetCompositionListLocal:()=>$,GetCompositionListLocalWithId:()=>Y,GetCompositionListWithId:()=>x,GetCompositionListWithIdUpdated:()=>b,GetCompositionListener:()=>Oi,GetCompositionLocal:()=>O,GetCompositionLocalWithId:()=>U,GetCompositionWithAllIds:()=>d.Mb,GetCompositionWithCache:()=>hi,GetCompositionWithDataIdBulk:()=>fi,GetCompositionWithDataIdWithCache:()=>so,GetCompositionWithId:()=>d.yz,GetCompositionWithIdAndDateFromMemory:()=>d.Ez,GetConceptBulk:()=>gn.r,GetConceptByCharacter:()=>l.A,GetConceptByCharacterAndCategoryLocal:()=>a.$I,GetConceptByCharacterAndType:()=>ce.A,GetConnectionBetweenTwoConceptsLinker:()=>xi,GetConnectionBulk:()=>Wn.j,GetConnectionById:()=>Qo,GetConnectionDataPrefetch:()=>Ke.QL,GetConnectionOfTheConcept:()=>he,GetConnectionTypeForCount:()=>To.V,GetFreeschemaImage:()=>br,GetFreeschemaImageUrl:()=>Gr,GetImageApi:()=>Go,GetLink:()=>Ee,GetLinkListListener:()=>Hi,GetLinkListener:()=>Vi.d,GetLinkRaw:()=>Ae,GetLinkerConnectionFromConcepts:()=>jo,GetLinkerConnectionToConcepts:()=>Ho,GetRelation:()=>ao,GetRelationLocal:()=>Ai,GetRelationRaw:()=>Ti,GetTheConcept:()=>ve.A,GetTheConceptLocal:()=>ho.f,GetUserGhostId:()=>wi,JUSTDATA:()=>Me.ZJ,LConcept:()=>zi,LConnection:()=>qi,LISTNORMAL:()=>Me.SL,LocalConceptsData:()=>S.v,LocalSyncData:()=>nn.H,LocalTransaction:()=>Io,Logger:()=>re.V,LoginToBackend:()=>oi,MakeTheInstanceConcept:()=>Te.A,MakeTheInstanceConceptLocal:()=>pe.k,MakeTheTimestamp:()=>Xo,MakeTheTypeConceptApi:()=>$e,MakeTheTypeConceptLocal:()=>Le.$,NORMAL:()=>Me.yv,PRIVATE:()=>Di,PUBLIC:()=>Wi,PatcherStructure:()=>Qi,Prototype:()=>Lr,RAW:()=>Me.XZ,RecursiveSearchApi:()=>Yo,RecursiveSearchApiNewRawFullLinker:()=>ei,RecursiveSearchApiRaw:()=>Zn,RecursiveSearchApiRawFullLinker:()=>Ko,RecursiveSearchApiWithInternalConnections:()=>Zo,RecursiveSearchListener:()=>ji,SchemaQuery:()=>sr,SchemaQueryListener:()=>Tn,SearchAllConcepts:()=>li,SearchLinkInternal:()=>_i,SearchLinkInternalAll:()=>bi,SearchLinkMultipleAll:()=>tn.cf,SearchLinkMultipleAllObservable:()=>vo,SearchLinkMultipleApi:()=>f.j,SearchQuery:()=>Kt,SearchStructure:()=>Yi,SearchWithLinker:()=>di,SearchWithTypeAndLinker:()=>Qt.zl,SearchWithTypeAndLinkerApi:()=>go,Selector:()=>dr,SessionData:()=>Xi,Signin:()=>ci,Signup:()=>ii,SignupEntity:()=>ri,SplitStrings:()=>A.f,StatefulWidget:()=>Mn,SyncData:()=>Ce.Y,TrashTheConcept:()=>zo,UpdateComposition:()=>ai,UpdateCompositionLocal:()=>Ni.D,UserBinaryTree:()=>en,Validator:()=>ir,ViewInternalData:()=>fo,ViewInternalDataApi:()=>po,WidgetTree:()=>No,convertFromConceptToLConcept:()=>Un.F4,convertFromLConceptToConcept:()=>Un.dp,convertWidgetTreeToWidget:()=>jn,convertWidgetTreeToWidgetWithWrapper:()=>So,createFormFieldData:()=>rr,createPrototypeLocal:()=>bo,dispatchIdEvent:()=>Rr,getFromDatabaseWithType:()=>ge,getObjectsFromIndexDb:()=>me,getUserDetails:()=>ar.s,getWidgetBulkFromId:()=>Bn,getWidgetFromId:()=>Tr,handleServiceWorkerException:()=>ze,hasActivatedSW:()=>xo,init:()=>xr,orderTheConnections:()=>$i.X,recursiveFetch:()=>d.zN,recursiveFetchNew:()=>vn,removeAllChildren:()=>Lo,renderLatestWidget:()=>Vn,renderPage:()=>yr,renderWidget:()=>gr,searchLinkMultipleListener:()=>Fi,sendEmail:()=>nr,sendMessage:()=>je,serviceWorker:()=>Fe,setHasActivatedSW:()=>Br,storeToDatabase:()=>de,subscribedListeners:()=>Bo,unwrapContainers:()=>_o,updateAccessToken:()=>Eo,uploadAttachment:()=>ti,uploadFile:()=>no,uploadImage:()=>to,uploadImageV2:()=>ni,validDocumentFormats:()=>eo,validImageFormats:()=>Kn});var B={};m.r(B),m.d(B,{ADMIN:()=>Ri,ALLID:()=>Me.BG,AccessTracker:()=>Nn.J,AddGhostConcept:()=>ki,Anomaly:()=>Qe,BaseUrl:()=>s.B,BinaryTree:()=>Xn.W,BuildWidgetFromId:()=>rn.Cp,BuilderStatefulWidget:()=>bn,Composition:()=>Ln,CompositionBinaryTree:()=>zt,CompositionNode:()=>ro,Concept:()=>Ji.j,ConceptsData:()=>N.I,Connection:()=>ye.N,ConnectionData:()=>Ut.d,CountInfo:()=>lr.y,CreateComposition:()=>ee.A,CreateConnection:()=>Et.d,CreateConnectionBetweenEntityLocal:()=>Ao,CreateConnectionBetweenTwoConcepts:()=>_e,CreateConnectionBetweenTwoConceptsGeneral:()=>xe,CreateConnectionBetweenTwoConceptsLocal:()=>yo.h,CreateData:()=>Hn,CreateDefaultConcept:()=>se.o,CreateDefaultLConcept:()=>lo.u,CreateSession:()=>gi,CreateSessionVisit:()=>vi,CreateTheCompositionLocal:()=>Q.R,CreateTheCompositionWithCache:()=>Sn,CreateTheConnection:()=>Be.q,CreateTheConnectionGeneral:()=>ae,CreateTheConnectionLocal:()=>Et.F,DATAID:()=>Me.y0,DATAIDDATE:()=>Me.iw,DATAV2:()=>Me.pU,DelayFunctionExecution:()=>Ei,DeleteConceptById:()=>Yn,DeleteConceptLocal:()=>Gi,DeleteConnectionById:()=>ue.m,DeleteConnectionByIdBulk:()=>ue.E,DeleteConnectionByType:()=>Cn.$S,DeleteConnectionByTypeBulk:()=>Cn.L0,DeleteUser:()=>Jo,DependencyObserver:()=>qt.w,FilterSearch:()=>On,FormatFromConnections:()=>tn.vw,FormatFromConnectionsAltered:()=>tn.y8,FreeschemaQuery:()=>wt,FreeschemaQueryApi:()=>Pn,GetAllConnectionsOfComposition:()=>X.s,GetAllConnectionsOfCompositionBulk:()=>I.Y,GetAllTheConnectionsByTypeAndOfTheConcept:()=>Cn.WC,GetComposition:()=>d.Nj,GetCompositionBulk:()=>Ke.dF,GetCompositionBulkWithDataId:()=>Ke.cw,GetCompositionFromConnectionsWithDataId:()=>Ke.p8,GetCompositionFromConnectionsWithDataIdFromConnections:()=>Ke.km,GetCompositionFromConnectionsWithDataIdInObject:()=>Ke.rv,GetCompositionFromConnectionsWithDataIdIndex:()=>Ke.Nt,GetCompositionFromConnectionsWithIndex:()=>Ke.as,GetCompositionFromConnectionsWithIndexFromConnections:()=>Ke.hG,GetCompositionFromMemoryWithConnections:()=>d.JA,GetCompositionList:()=>k,GetCompositionListAll:()=>w,GetCompositionListAllWithId:()=>L,GetCompositionListListener:()=>Pi,GetCompositionListLocal:()=>$,GetCompositionListLocalWithId:()=>Y,GetCompositionListWithId:()=>x,GetCompositionListWithIdUpdated:()=>b,GetCompositionListener:()=>Oi,GetCompositionLocal:()=>O,GetCompositionLocalWithId:()=>U,GetCompositionWithAllIds:()=>d.Mb,GetCompositionWithCache:()=>hi,GetCompositionWithDataIdBulk:()=>fi,GetCompositionWithDataIdWithCache:()=>so,GetCompositionWithId:()=>d.yz,GetCompositionWithIdAndDateFromMemory:()=>d.Ez,GetConceptBulk:()=>gn.r,GetConceptByCharacter:()=>l.A,GetConceptByCharacterAndCategoryLocal:()=>a.$I,GetConceptByCharacterAndType:()=>ce.A,GetConnectionBetweenTwoConceptsLinker:()=>xi,GetConnectionBulk:()=>Wn.j,GetConnectionById:()=>Qo,GetConnectionDataPrefetch:()=>Ke.QL,GetConnectionOfTheConcept:()=>he,GetConnectionTypeForCount:()=>To.V,GetFreeschemaImage:()=>br,GetFreeschemaImageUrl:()=>Gr,GetImageApi:()=>Go,GetLink:()=>Ee,GetLinkListListener:()=>Hi,GetLinkListener:()=>Vi.d,GetLinkRaw:()=>Ae,GetLinkerConnectionFromConcepts:()=>jo,GetLinkerConnectionToConcepts:()=>Ho,GetRelation:()=>ao,GetRelationLocal:()=>Ai,GetRelationRaw:()=>Ti,GetTheConcept:()=>ve.A,GetTheConceptLocal:()=>ho.f,GetUserGhostId:()=>wi,JUSTDATA:()=>Me.ZJ,LConcept:()=>zi,LConnection:()=>qi,LISTNORMAL:()=>Me.SL,LocalConceptsData:()=>S.v,LocalSyncData:()=>nn.H,LocalTransaction:()=>Io,Logger:()=>re.V,LoginToBackend:()=>oi,MakeTheInstanceConcept:()=>Te.A,MakeTheInstanceConceptLocal:()=>pe.k,MakeTheTimestamp:()=>Xo,MakeTheTypeConceptApi:()=>$e,MakeTheTypeConceptLocal:()=>Le.$,NORMAL:()=>Me.yv,PRIVATE:()=>Di,PUBLIC:()=>Wi,PatcherStructure:()=>Qi,Prototype:()=>Lr,RAW:()=>Me.XZ,RecursiveSearchApi:()=>Yo,RecursiveSearchApiNewRawFullLinker:()=>ei,RecursiveSearchApiRaw:()=>Zn,RecursiveSearchApiRawFullLinker:()=>Ko,RecursiveSearchApiWithInternalConnections:()=>Zo,RecursiveSearchListener:()=>ji,SchemaQuery:()=>sr,SchemaQueryListener:()=>Tn,SearchAllConcepts:()=>li,SearchLinkInternal:()=>_i,SearchLinkInternalAll:()=>bi,SearchLinkMultipleAll:()=>tn.cf,SearchLinkMultipleAllObservable:()=>vo,SearchLinkMultipleApi:()=>f.j,SearchQuery:()=>Kt,SearchStructure:()=>Yi,SearchWithLinker:()=>di,SearchWithTypeAndLinker:()=>Qt.zl,SearchWithTypeAndLinkerApi:()=>go,Selector:()=>dr,SessionData:()=>Xi,Signin:()=>ci,Signup:()=>ii,SignupEntity:()=>ri,SplitStrings:()=>A.f,StatefulWidget:()=>Mn,SyncData:()=>Ce.Y,TrashTheConcept:()=>zo,UpdateComposition:()=>ai,UpdateCompositionLocal:()=>Ni.D,UserBinaryTree:()=>en,Validator:()=>ir,ViewInternalData:()=>fo,ViewInternalDataApi:()=>po,WidgetTree:()=>No,convertFromConceptToLConcept:()=>Un.F4,convertFromLConceptToConcept:()=>Un.dp,convertWidgetTreeToWidget:()=>jn,convertWidgetTreeToWidgetWithWrapper:()=>So,createFormFieldData:()=>rr,createPrototypeLocal:()=>bo,dispatchIdEvent:()=>Rr,getFromDatabaseWithType:()=>ge,getObjectsFromIndexDb:()=>me,getUserDetails:()=>ar.s,getWidgetBulkFromId:()=>Bn,getWidgetFromId:()=>Tr,handleServiceWorkerException:()=>ze,hasActivatedSW:()=>xo,init:()=>xr,orderTheConnections:()=>$i.X,recursiveFetch:()=>d.zN,recursiveFetchNew:()=>vn,removeAllChildren:()=>Lo,renderLatestWidget:()=>Vn,renderPage:()=>yr,renderWidget:()=>gr,searchLinkMultipleListener:()=>Fi,sendEmail:()=>nr,sendMessage:()=>je,serviceWorker:()=>Fe,setHasActivatedSW:()=>Br,storeToDatabase:()=>de,subscribedListeners:()=>Bo,unwrapContainers:()=>_o,updateAccessToken:()=>Eo,uploadAttachment:()=>ti,uploadFile:()=>no,uploadImage:()=>to,uploadImageV2:()=>ni,validDocumentFormats:()=>eo,validImageFormats:()=>Kn});var W=m(5020),r=m(205),f=m(2832),A=m(6467),N=m(3026),s=m(9581),i=m(3518),u=m(1863),v=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function T(_,o){var e=arguments;return v(this,void 0,void 0,function*(){const n=re.V.logfunction("GetAllConceptsByType",e);try{var p=new URLSearchParams;p.append("type",_),p.append("user_id",o.toString());var y=(0,i.Xr)("application/x-www-form-urlencoded");const E=yield fetch(s.B.GetAllConceptsByTypeUrl(),{method:"POST",headers:y,body:p});if(E.ok){const g=yield E.json();for(var C=0;C<g.length;C++)N.I.AddConcept(g[C])}else console.log("GetAllConceptsByType error",E.status),(0,u.ry)(E)}catch(E){E instanceof Error?console.log("GetAllConceptsByType error message: ",E.message):console.log("GetAllConceptsByType unexpected error: ",E),(0,u.Mb)(E,s.B.GetAllConceptsByTypeUrl()),(0,u.ey)(n,"GetAllConceptsByType",E)}})}var I=m(8642),S=m(9736),d=m(8939),l=m(2013),a=m(8064),h=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function k(_,o){var e=arguments;return h(this,arguments,void 0,function*(n,p,y=10,C=1){const E=re.V.logfunction("GetCompositionList",e)||{};if(Fe){E.serviceWorker=!0;try{const t=yield je("GetCompositionList",{compositionName:n,userId:p,inpage:y,page:C});return re.V.logUpdate(E),t.data}catch(t){console.error("GetCompositionList sw error: ",t),(0,u.ey)(E,"GetCompositionList",t),ze(t)}}let g=yield(0,l.A)(n),c=[];if(g){yield T(n,p);let t=yield N.I.GetConceptsByTypeIdAndUser(g.id,p),G=y*(C-1),F=[];for(let V=G;V<G+y;V++)t[V]&&F.push(t[V].id);yield(0,I.Y)(F);for(let V=G;V<G+y;V++)if(t[V]){let P=yield(0,d.kx)(t[V].id);c.push(P)}}return re.V.logUpdate(E),c})}function w(_,o){return h(this,arguments,void 0,function*(e,n,p=10,y=1){let C=$(e,n),E=k(e,n),g=[];return Promise.race([C,E]).then(c=>{console.log("Promise result",c),g.push(...c)}).catch(c=>{console.log("error in handling",c)}),E.then(c=>{console.log("This is the second promise result",c),g.push(...c)}),g})}function L(_,o){return h(this,arguments,void 0,function*(e,n,p=10,y=1){if(Fe)try{return(yield je("GetCompositionListAllWithId",{compositionName:e,userId:n,inpage:p,page:y})).data}catch(V){console.error("GetCompositionListAllWithId sw error: ",V),ze(V)}let C=yield(0,a.Ay)(e),E=yield(0,l.A)(e),g=[],c=[],t=[],G=[];C.id!=0&&(c=yield S.v.GetConceptsByTypeIdAndUser(C.id,n)),E.id!=0&&(yield T(e,n),G=yield N.I.GetConceptsByTypeIdAndUser(E.id,n),g=G);for(let V=0;V<c.length;V++){let P=!1;for(let z=0;z<G.length;z++)c[V].ghostId==G[z].ghostId&&(P=!0);P||t.push(c[V])}console.log("This is the all list",t);let F=[];return F=yield function(V,P){return h(this,arguments,void 0,function*(z,te,le=10,ke=1){let ie=[],we=le*(ke-1),De=[],Pe=te.length;for(let Je=we;Je<we+le-Pe;Je++)z[Je]&&De.push(z[Je].id);for(let Je=0;Je<te.length;Je++){let qe=yield U(te[Je].id);ie.push(qe)}yield(0,I.Y)(De);for(let Je=we;Je<we+le-Pe;Je++)if(z[Je]){let qe=yield(0,d.RW)(z[Je].id);ie.push(qe)}return ie})}(g,t,p,y),F})}function x(_,o){return h(this,arguments,void 0,function*(e,n,p=10,y=1){if(Fe)try{return(yield je("GetCompositionListWithId",{compositionName:e,userId:n,inpage:p,page:y})).data}catch(g){console.error("GetCompositionListWithId sw error: ",g),ze(g)}let C=yield(0,l.A)(e),E=[];if(C){yield T(e,n);let g=yield N.I.GetConceptsByTypeIdAndUser(C.id,n),c=p*(y-1),t=[];for(let G=c;G<c+p;G++)g[G]&&t.push(g[G].id);yield(0,I.Y)(t);for(let G=c;G<c+p;G++)if(g[G]){let F=yield(0,d.RW)(g[G].id);E.push(F)}}return E})}function b(_,o){return h(this,arguments,void 0,function*(e,n,p=10,y=1){let C=yield(0,l.w)(e),E=[];if(C){yield T(e,n);let g=yield N.I.GetConceptsByTypeIdAndUser(C.id,n),c=p*(y-1),t=[];for(let G=c;G<c+p;G++)g[G]&&t.push(g[G].id);yield(0,I.Y)(t);for(let G=c;G<c+p;G++)if(g[G]){let F=yield(0,d.RW)(g[G].id);E.push(F)}}return E})}var R=m(4864),D=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})},H=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function O(_){return H(this,void 0,void 0,function*(){var o,e;try{if(Fe)try{return(yield je("GetCompositionLocal",{id:_})).data}catch(g){console.error("GetCompositionLocal error sw: ",g),ze(g)}let n=[],p={};n=yield R.G.GetConnectionsOfCompositionLocal(_);let y=[];for(let g=0;g<n.length;g++)y.includes(n[g].ofTheConceptId)||y.push(n[g].ofTheConceptId);let C=yield S.v.GetConcept(_);if(C.id==0){let g=yield function(c){var t=arguments;return D(this,void 0,void 0,function*(){const G=re.V.logfunction("TranslateLocalToReal",t);let F=(0,se.o)();try{var V=(0,i.ab)("application/x-www-form-urlencoded");const P=yield fetch(s.B.GetRealConceptById(),{method:"POST",headers:V,body:`id=${c}`});if(P.ok)return F=yield P.json(),F.id>0&&N.I.AddConcept(F),F;console.log("Error in Getting Translating concept Error",P.status),(0,u.ry)(P),re.V.logUpdate(G)}catch(P){P instanceof Error?console.log("Error in Getting Translating concept error message: ",P):console.log("Error in Getting Translating concept unexpected error: ",P),(0,u.Mb)(P,s.B.GetRealConceptById()),(0,u.ey)(G,"TranslateLocalToReal",P)}return F})}(_);if(g.id>0)return yield(0,d.Nj)(g.id)}let E=yield M(_,n,y);return p[(e=(o=C?.type)===null||o===void 0?void 0:o.characterValue)!==null&&e!==void 0?e:"top"]=E,p}catch(n){throw n}})}function U(_){return H(this,void 0,void 0,function*(){var o,e;try{if(Fe)try{return(yield je("GetCompositionLocalWithId",{id:_})).data}catch(g){console.error("GetCompositionLocalWithId error sw: ",g),ze(g)}let n=[],p={},y={};n=yield R.G.GetConnectionsOfCompositionLocal(_);let C=[];for(let g=0;g<n.length;g++)C.includes(n[g].ofTheConceptId)||C.push(n[g].ofTheConceptId);let E=yield S.v.GetConcept(_);if(E.id!=0){let g=yield M(_,n,C);p[(e=(o=E?.type)===null||o===void 0?void 0:o.characterValue)!==null&&e!==void 0?e:"top"]=g}return y.data=p,y.id=_,y}catch(n){throw n}})}function M(_,o,e){return H(this,arguments,void 0,function*(n,p,y,C=[]){var E,g,c;let t={},G=[],F=yield S.v.GetConcept(n);if(F.id!=0&&F.type==null){let V=F.typeId,P=yield S.v.GetConcept(V);F.type=P}if((E=F?.type)===null||E===void 0||E.characterValue,!y.includes(n))return F?.characterValue;if(C.includes(n))return"";C.push(n);for(let V=0;V<p.length;V++)if(p[V].ofTheConceptId==n){let P=p[V].toTheConceptId,z=yield S.v.GetConcept(P);if(z.id!=0&&z?.type==null){let ke=z.typeId,ie=yield S.v.GetConcept(ke);z.type=ie}let te="the_",le=((c=(g=z?.type)===null||g===void 0?void 0:g.characterValue)!==null&&c!==void 0?c:"top").replace(te,"");if(isNaN(Number(le))){if(le){const ke=yield M(P,p,y);t[le]=ke}}else{const ke=yield M(P,p,y);G[le]=ke,t=G}}return t})}var j=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function $(_,o){return j(this,void 0,void 0,function*(){if(Fe)try{return(yield je("GetCompositionListLocal",{compositionName:_,userId:o})).data}catch(e){console.error("GetCompositionListLocal error sw: ",e),ze(e)}try{let e=yield(0,a.Ay)(_),n=[];if(e.id!=0){let p=yield S.v.GetConceptsByTypeIdAndUser(e.id,o);for(let y=0;y<p.length;y++){let C=yield O(p[y].id);n.push(C)}}return n}catch(e){throw e}})}function Y(_,o){return j(this,void 0,void 0,function*(){if(Fe)try{return(yield je("GetCompositionListLocalWithId",{compositionName:_,userId:o})).data}catch(e){console.error("GetCompositionListLocalWithId error sw: ",e),ze(e)}try{let e=yield(0,a.Ay)(_),n=[];if(e.id!=0){let p=yield S.v.GetConceptsByTypeIdAndUser(e.id,o);for(let y=0;y<p.length;y++){let C=yield U(p[y].id);n.push(C)}}return n}catch(e){throw e}})}var X=m(2),ee=m(1218),Q=m(999),K=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function he(_,o,e){var n=arguments;return K(this,arguments,void 0,function*(p,y,C,E=10,g=1){const c=re.V.logfunction("GetConnectionOfTheConcept",n)||{};let t=[];try{if(Fe){c.serviceWorker=!0;try{const P=yield je("GetConnectionOfTheConcept",{typeId:p,ofTheConceptId:y,userId:C,inpage:E,page:g});return re.V.logUpdate(c),P.data}catch(P){console.error("GetConnectionOfTheConcept sw error: ",P),(0,u.ey)(c,"GetConnectionOfTheConcept",P),ze(P)}}let G=new URLSearchParams;G.append("typeId",`${p}`),G.append("ofTheConceptId",`${y}`),G.append("userId",`${C}`),G.append("inpage",`${E}`),G.append("page",`${g}`);let F=(0,i.Xr)("application/x-www-form-urlencoded");const V=yield fetch(s.B.GetAllConnectionsOfConceptUrl(),{method:"POST",headers:F,body:G});return V.ok?t=yield V.json():((0,u.ey)(c,"GetConnectionOfTheConcept",V.status),(0,u.ry)(V),console.log("Get connection of concept error",V.status)),re.V.logUpdate(c),t}catch(G){G instanceof Error?console.log("Get connection of concept  error message: ",G.message):console.log("Get connection of concept unexpected error: ",G),(0,u.Mb)(G,s.B.GetAllConnectionsOfConceptUrl()),(0,u.ey)(c,"GetConnectionOfTheConcept",G)}})}var ye=m(2155),Ce=m(442),se=m(7282),Z=m(5976),ne=m(7273),oe=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function ae(_,o,e,n){return oe(this,arguments,void 0,function*(p,y,C,E,g=1,c=4){if(p>0&&C>0){var t=y,G=yield Z.p.getId(),F=new ye.N(G,p,C,t,E,g,c);return p==C?(F.ofTheConceptId=0,F.toTheConceptId=1,F):(F.toUpdate=!0,F.isTemp=!1,Ce.Y.AddConnection(F),F)}throw new ne.z("cannot create connection because id are negative ",!1,400,"")})}var ue=m(4818),ve=m(7876),Te=m(8407),Ie=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function _e(_,o,e){return Ie(this,arguments,void 0,function*(n,p,y,C=!1,E=!1){var g,c;if(Fe)try{return(yield je("CreateConnectionBetweenTwoConcepts",{ofTheConcept:n,toTheConcept:p,linker:y,both:C,count:E})).data}catch(z){console.error("CreateConnectionBetweenTwoConcepts sw error: ",z),ze(z)}let t=n.userId;if(C){let z=y+"_by",te=((g=p.type)===null||g===void 0?void 0:g.characterValue)+"_s_"+z;E&&(yield Se(z,p,t));let le=yield(0,Te.A)("connection",te,!1,999,999,999),ke=new ye.N(0,p.id,n.id,t,le.id,1e3,4);Ce.Y.AddConnection(ke)}let G=y+"_s",F=((c=n.type)===null||c===void 0?void 0:c.characterValue)+"_s_"+G;E&&(yield Se(G,n,t));let V=yield(0,Te.A)("connection",F,!1,999,999,999),P=new ye.N(0,n.id,p.id,t,V.id,1e3,4);return Ce.Y.AddConnection(P),P})}function Se(_,o){return Ie(this,arguments,void 0,function*(e,n,p=null){var y;let C=n,E=p??n.userId,g=e+"_count",c=((y=n.type)===null||y===void 0?void 0:y.characterValue)+"_s_"+g,t=yield(0,Te.A)("connection",c,!1,E,4,999),G=yield he(t.id,n.id,E,10,1),F=[],V=(0,se.o)();for(let z=0;z<G.length;z++){let te=yield(0,ve.A)(G[z].toTheConceptId);F.push(te)}if(F.length<1)V=yield(0,Te.A)("count","1",!1,E,4,999);else{let z=F[0],te=0;try{te=Number(z.characterValue)}catch{te=0}te+=1,V=yield(0,Te.A)("count",te.toString(),!1,E,4,999);for(let le=0;le<G.length;le++)(0,ue.m)(G[le].id)}let P=new ye.N(0,C.id,V.id,C.userId,t.id,1e3,4);yield Ce.Y.AddConnection(P)})}function xe(_,o,e){return Ie(this,arguments,void 0,function*(n,p,y,C=!1,E=!1){var g,c;let t=n.userId;if(C){let P=y+"_by",z=((g=p.type)===null||g===void 0?void 0:g.characterValue)+"_s_"+P;E&&(yield Se(P,p,t));let te=yield(0,Te.A)("connection",z,!1,999,999,999),le=new ye.N(0,p.id,n.id,t,te.id,1e3,4);Ce.Y.AddConnection(le)}let G=y+"_s",F=((c=n.type)===null||c===void 0?void 0:c.characterValue)+"_s_"+G;E&&(yield Se(G,n,t));let V=yield(0,Te.A)("connection",F,!1,999,999,999);return yield ae(n.id,n.userId,p.id,V.id,1e3,4)})}var pe=m(5868),be=(m(3655),function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})});function de(_,o){const e=re.V.logfunction("storeToDatabase",[_,"noindexdb"]);re.V.logUpdate(e)}function ge(_,o,e){return be(this,void 0,void 0,function*(){const n=re.V.logfunction("getFromDatabaseWithType",[_,"noindexdb"]);re.V.logUpdate(n)})}function me(_){return be(this,void 0,void 0,function*(){const o=re.V.logfunction("getObjectsFromIndexDb",[_,"noindexdb"]);re.V.logUpdate(o)})}var Be=m(1666),ce=m(4402),Ne=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function Ee(_,o){var e=arguments;return Ne(this,arguments,void 0,function*(n,p,y=10,C=1){var E;const g=re.V.logfunction("GetLink",e)||{};if(Fe){g.serviceWorker=!0;try{const V=yield je("GetLink",{id:n,linker:p,inpage:y,page:C});return re.V.logUpdate(g),V.data}catch(V){console.error("GetLink sw error: ",V),(0,u.ey)(g,"GetLink",V),ze(V)}}let c=[],t=yield(0,ve.A)(n),G=((E=t.type)===null||E===void 0?void 0:E.characterValue)+"_s_"+p,F=yield(0,ce.A)(G,16);if(F.id>0){let V=yield he(F.id,t.id,t.userId,y,C),P=[];for(let z=0;z<V.length;z++)P.push(V[z].toTheConceptId);yield(0,I.Y)(P);for(let z=0;z<V.length;z++){let te=V[z].toTheConceptId,le=yield(0,ve.A)(te),ke=yield(0,d.Ez)(le.id);c.push(ke)}}return re.V.logUpdate(g),c})}function Ae(_,o){var e=arguments;return Ne(this,arguments,void 0,function*(n,p,y=10,C=1){var E;const g=re.V.logfunction("GetLinkRaw",e);let c=[],t=yield(0,ve.A)(n),G=((E=t.type)===null||E===void 0?void 0:E.characterValue)+"_s_"+p,F=yield(0,ce.A)(G,16);if(F.id>0){let V=yield he(F.id,t.id,t.userId,y,C),P=[];for(let z=0;z<V.length;z++)P.push(V[z].toTheConceptId);for(let z=0;z<V.length;z++){let te=V[z].toTheConceptId,le=yield(0,ve.A)(te);c.push(le)}}return re.V.logUpdate(g),c})}var Le=m(8357),Ge=m(1708),Oe=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};const He=new Map;function $e(_,o){var e=arguments;return Oe(this,void 0,void 0,function*(){const n=re.V.logfunction("MakeTheTypeConceptApi",e);let p=(0,se.o)();if(He.has(_))return He.get(_)||p;const y=Oe(this,void 0,void 0,function*(){try{if(p=yield(0,Ge.Az)(_),p.id==0||p.typeId==4){let C=(0,i.Xr)("application/x-www-form-urlencoded");const E=yield fetch(s.B.MakeTheTypeConceptUrl(),{method:"POST",headers:C,body:`type=${_}`});if(!E.ok)throw(0,u.ry)(E),new Error(`Error! status: ${E.status}`);p=yield E.json(),re.V.logUpdate(n)}}catch(C){C instanceof Error?console.log("Make The Type Concept Api error : ",C.message):console.log("Make The Type Concept Api error : ",C),(0,u.Mb)(C,s.B.MakeTheTypeConceptUrl()),(0,u.ey)(n,"MakeTheTypeConceptApi",C)}finally{He.delete(_)}return p});return He.set(_,y),y})}var Jt=m(8675),Or=m(6058),Vo=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function jo(_){var o=arguments;return Vo(this,void 0,void 0,function*(){const e=re.V.logfunction("GetLinkerConnectionFromConcepts",o);let n=yield(0,Jt.l)(_);for(let p=0;p<n.length;p++){let y=n[p],C=y.typeId,E=yield(0,ve.A)(C);y.type=E}return re.V.logUpdate(e),n})}function Ho(_){var o=arguments;return Vo(this,void 0,void 0,function*(){const e=re.V.logfunction("GetLinkerConnectionToConcepts",o);let n=yield(0,Or.W)(_);for(let p=0;p<n.length;p++){let y=n[p],C=y.typeId,E=yield(0,ve.A)(C);y.type=E}return re.V.logUpdate(e),n})}var Mr=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})},Pr=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})},Vr=m(6963),Xn=m(2202),jr=m(5457),Hr=m(991),$o=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function Yn(_){var o=arguments;return $o(this,void 0,void 0,function*(){const e=re.V.logfunction("DeleteConceptById",o);if(Fe)try{return(yield je("DeleteConceptById",{id:_})).data}catch(C){console.error("DeleteConceptById sw error: ",C),ze(C)}if(_>0){var n=yield N.I.GetConcept(_);if(n.id>0){var p=n.typeId,y=n.characterValue;yield jr.c.removeTypeConcept(p,_),yield Vr.f.removeNodeByCharacter(y,_),yield function(C){var E=arguments;return Pr(this,void 0,void 0,function*(){let g=!1;const c=re.V.logfunction("DeleteTheConcept",E);try{const t=new FormData;t.append("id",C.toString());let G=(0,i.BZ)();const F=yield fetch(s.B.DeleteConceptUrl(),{method:"POST",headers:G,body:t});F.ok?g=(yield F.json()).success:(console.log("Delete concept error",F.status),(0,u.ry)(F)),g&&N.I.AddNpc(C),re.V.logUpdate(c)}catch(t){t instanceof Error?console.log("Delete concept error message: ",t.message):console.log("Delete concept unexpected error: ",t),(0,u.Mb)(t,s.B.DeleteConceptUrl()),(0,u.ey)(c,"DeleteTheConcept",t)}return g})}(_),yield Xn.W.removeNodeFromTree(_),yield Hr.H.removeNodeFromTree(_)}}else S.v.RemoveConceptById(_);re.V.logUpdate(e)})}function Jo(_){return $o(this,void 0,void 0,function*(){if(Fe)try{return(yield je("DeleteUser",{id:_})).data}catch(o){console.error("DeleteUser sw error: ",o),ze(o)}_>0?function(o){var e=arguments;Mr(this,void 0,void 0,function*(){const n=re.V.logfunction("DeleteUserInBackend",e);try{var p=(0,i.ab)("application/json","");let y=s.B.DeleteUserUrl();y=y+"?conceptId="+o+"&apiKey=freeschema";const C=yield fetch(y,{method:"POST",headers:p});if(C.ok){let E=yield C.json(),g=Number(E.data);return console.log("this is the delete email concept",g),Yn(g),re.V.logUpdate(n),g}throw(0,u.ry)(C),new Error(`Delete composition Error! status: ${C.status}`)}catch(y){y instanceof Error?console.log("Delete composition error message: ",y.message):console.log("Delete composition unexpected error: ",y),(0,u.Mb)(y,s.B.DeleteConceptUrl()),(0,u.ey)(n,"DeleteUserInBackend",y)}})}(_):S.v.RemoveConceptById(_)})}var $r=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function zo(_,o){return $r(this,void 0,void 0,function*(){try{const e=new Headers;e.append("Authorization","Bearer "+o);const n=new FormData;n.append("id",_.toString());const p=yield fetch(s.B.DeleteConceptUrl(),{method:"POST",body:n,headers:e});if(!p.ok)throw(0,u.ry)(p),new Error(`Delete composition Error! status: ${p.status}`)}catch(e){e instanceof Error?console.log("Delete composition error message: ",e.message):console.log("Delete composition unexpected error: ",e),(0,u.Mb)(e,s.B.DeleteConceptUrl())}})}var Nn=m(1735),Ut=m(8286),Jr=m(1596),Ze=m(3278),qo=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})},zr=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function Qo(_){var o=arguments;return zr(this,void 0,void 0,function*(){const e=re.V.logfunction("GetConnectionById",o);if(console.log("AccessTracker activation status from GetConnectionById"),Nn.J.activateStatus===!0)try{Nn.J.incrementConnection(_)}catch{console.error("Error adding connection in access tracker"),re.V.log("ERROR","Error Adding Connection")}if(Fe)try{return(yield je("GetConnectionById",{id:_})).data}catch(p){console.error("GetConnectionById sw error: ",p),ze(p)}let n=yield Ut.d.GetConnection(_);return n!=null&&n.id!=0||_==null||_==null||(n=yield function(p){var y=arguments;return qo(this,void 0,void 0,function*(){const C=re.V.logfunction("GetConnection",y);let E=yield Ut.d.GetConnection(p);try{if(E.id!=0)return E;{const g=new FormData;g.append("id",p.toString());const c={method:"POST",headers:{Authorization:"Bearer "+Ze.b.BearerAccessToken},body:g};let t;try{t=yield fetch(s.B.GetConnectionUrl(),c)}catch{t=yield(0,Jr.g)(c,"/api/get-connection-by-id")}return yield function(G,F){return qo(this,void 0,void 0,function*(){G.ok?(F=yield G.json(),Ut.d.AddConnection(F)):((0,u.ry)(G),console.log("Get Connection Error",G.status))})}(t,E),re.V.logUpdate(C),E}}catch(g){g instanceof Error?console.log("Get Connection error message: ",g.message):console.log("Get Connection unexpected error: ",g),(0,u.Mb)(g,s.B.GetConnectionUrl()),(0,u.ey)(C,"GetConnection",g)}})}(_)),re.V.logUpdate(e),n})}var qr=m(2212),Qr=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})},Xr=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function Xo(_,o,e){return Xr(this,arguments,void 0,function*(n,p,y,C=4,E=999){const g=re.V.logfunction("MakeTheTimestamp")||{};if(Fe){g.serviceWorker=!0;try{const P=yield je("MakeTheTimestamp",{type:n,referent:p,userId:y,accessId:C,sessionInformationId:E});return re.V.logUpdate(g),P.data}catch(P){console.error("MakeTheTimestamp sw error: ",P),(0,u.ey)(g,"MakeTheTimestamp",P),ze(P)}}let c,t="",G=n.startsWith("the_"),F=(0,se.o)();return t=G?n:"the_"+n,F=yield $e(t,y),c=yield function(P,z,te,le,ke,ie,we){return Qr(this,void 0,void 0,function*(){let De=yield(0,ce.A)(P,le),Pe=De;return Pe.id==0&&(De=yield(0,qr.Ay)(P,z,4,le,0,ie,we),Pe=De),Pe})}(p,y,0,F.id,0,C,t),re.V.logUpdate(g),c})}class Kt{constructor(){this.composition=0,this.type="",this.linker="",this.inpage=10,this.page=1,this.listLinkers=[],this.fullLinkers=[],this.textSearch="",this.logic="or",this.reverse=!1,this.doFilter=!1,this.filterSearches=[],this.selectors=[],this.ofCompositions=[]}}var Ke=m(6687),An=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function Yo(){var _=arguments;return An(this,arguments,void 0,function*(o=0,e=[],n="",p=[]){const y=re.V.logfunction("RecursiveSearchApi",_)||{};let C=[];try{if(Fe){y.serviceWorker=!0;try{const G=yield je("RecursiveSearchApi",{composition:o,listLinkers:e,textSearch:n,fullLinkers:p});return re.V.logUpdate(y),G.data}catch(G){console.error("RecursiveSearchApi sw error: ",G),(0,u.ey)(y,"RecursiveSearchApi",G),ze(G)}}let E=new Kt;E.composition=o,E.listLinkers=e,E.fullLinkers=p,E.textSearch=n;let g=JSON.stringify(E),c=(0,i.Xr)();const t=yield fetch(s.B.RecursiveSearchUrl(),{method:"POST",headers:c,body:g});if(t.ok){const G=yield t.json();let F=G.compositionIds,V=G.internalConnections;G.externalConnections,C=yield(0,Ke.p8)(F,V)}else console.log("recursive search error ",t.status),(0,u.ey)(y,"RecursiveSearchApi",t.status),(0,u.ry)(t);re.V.logUpdate(y)}catch(E){E instanceof Error?console.log("recursive search error message: ",E.message):console.log("recursive search unexpected error: ",E),(0,u.ey)(y,"RecursiveSearchApi",E),(0,u.Mb)(E,s.B.RecursiveSearchUrl())}return C})}function Zo(){var _=arguments;return An(this,arguments,void 0,function*(o=0,e=[],n=""){const p=re.V.logfunction("RecursiveSearchApiWithInternalConnections",_)||{};let y=[];try{if(Fe){p.serviceWorker=!0;try{const t=yield je("RecursiveSearchApiWithInternalConnections",{composition:o,listLinkers:e,textSearch:n});return re.V.logUpdate(p),t.data}catch(t){console.error("RecursiveSearchApiWithInternalConnections sw error: ",t),(0,u.ey)(p,"RecursiveSearchApiWithInternalConnections",t),ze(t)}}let C=new Kt;C.composition=o,C.listLinkers=e,C.textSearch=n;let E=JSON.stringify(C),g=(0,i.Xr)();const c=yield fetch(s.B.RecursiveSearchUrl(),{method:"POST",headers:g,body:E});if(c.ok){const t=yield c.json();let G=t.compositionIds,F=t.internalConnections;t.externalConnections,y=yield(0,Ke.km)(G,F),re.V.logUpdate(p)}else console.log("recursive search error ",c.status),(0,u.ey)(p,"GetCompositionConnectionsBetweenTwoConcepts",c.status),(0,u.ry)(c)}catch(C){C instanceof Error?console.log("recursive search error message: ",C.message):console.log("recursive search unexpected error: ",C),(0,u.ey)(p,"GetCompositionConnectionsBetweenTwoConcepts",C),(0,u.Mb)(C,s.B.RecursiveSearchUrl())}return y})}function Zn(){var _=arguments;return An(this,arguments,void 0,function*(o=0,e=[],n="",p=[]){const y=re.V.logfunction("RecursiveSearchApiRaw",_)||{};try{if(Fe){y.serviceWorker=!0;try{const t=yield je("RecursiveSearchApiRaw",{composition:o,listLinkers:e,textSearch:n,fullLinkers:p});return re.V.logUpdate(y),t.data}catch(t){console.error("RecursiveSearchApiRaw sw error: ",t),(0,u.ey)(y,"RecursiveSearchApiRaw",t),ze(t)}}let C=new Kt;C.composition=o,C.listLinkers=e,C.textSearch=n,C.fullLinkers=p;let E=JSON.stringify(C),g=(0,i.Xr)();const c=yield fetch(s.B.RecursiveSearchUrl(),{method:"POST",headers:g,body:E});if(c.ok){const t=yield c.json();return t.compositionIds,t.internalConnections,t.externalConnections,re.V.logUpdate(y),t}return console.log("recursive search error ",c.status),(0,u.ey)(y,"RecursiveSearchApiRaw",c.status),(0,u.ry)(c),re.V.logUpdate(y),[]}catch(C){C instanceof Error?console.log("recursive search error message: ",C.message):console.log("recursive search unexpected error: ",C),(0,u.ey)(y,"RecursiveSearchApiRaw",C),(0,u.Mb)(C,s.B.RecursiveSearchUrl())}})}function Ko(){var _=arguments;return An(this,arguments,void 0,function*(o=0,e=[],n=""){const p=re.V.logfunction("RecursiveSearchApiRawFullLinker",_)||{};try{if(Fe){p.serviceWorker=!0;try{const c=yield je("RecursiveSearchApiRawFullLinker",{composition:o,fullLinkers:e,textSearch:n});return re.V.logUpdate(p),c.data}catch(c){console.error("RecursiveSearchApiRawFullLinker sw error: ",c),(0,u.ey)(p,"RecursiveSearchApiRawFullLinker",c),ze(c)}}let y=new Kt;y.composition=o,y.fullLinkers=e,y.textSearch=n;let C=JSON.stringify(y),E=(0,i.Xr)();const g=yield fetch(s.B.RecursiveSearchUrl(),{method:"POST",headers:E,body:C});if(g.ok){const c=yield g.json();return c.compositionIds,c.internalConnections,c.externalConnections,re.V.logUpdate(p),c}return console.log("recursive search error ",g.status),(0,u.ey)(p,"RecursiveSearchApiRawFullLinker",g.status),(0,u.ry)(g),re.V.logUpdate(p),[]}catch(y){y instanceof Error?console.log("recursive search error message: ",y.message):console.log("recursive search unexpected error: ",y),(0,u.Mb)(y,s.B.RecursiveSearchUrl()),(0,u.ey)(p,"RecursiveSearchApiRawFullLinker",y)}})}function ei(){var _=arguments;return An(this,arguments,void 0,function*(o=0,e=[],n=""){const p=re.V.logfunction("RecursiveSearchApiRawFullLinker",_)||{};try{if(Fe)try{p.serviceWorker=!0;const c=yield je("RecursiveSearchApiNewRawFullLinker",{composition:o,fullLinkers:e,textSearch:n});return re.V.logUpdate(p),c.data}catch(c){console.error("RecursiveSearchApiNewRawFullLinker sw error: ",c),(0,u.ey)(p,"RecursiveSearchApiNewRawFullLinker",c),ze(c)}let y=new Kt;y.composition=o,y.fullLinkers=e,y.textSearch=n;let C=JSON.stringify(y),E=(0,i.Xr)();const g=yield fetch(s.B.RecursiveSearchUrl(),{method:"POST",headers:E,body:C});if(g.ok){const c=yield g.json();return c.compositionIds,c.internalConnections,c.externalConnections,re.V.logUpdate(p),c}return console.log("recursive search error ",g.status),(0,u.ey)(p,"RecursiveSearchApiNewRawFullLinker",g.status),(0,u.ry)(g),re.V.logUpdate(p),[]}catch(y){y instanceof Error?console.log("recursive search error message: ",y.message):console.log("recursive search unexpected error: ",y),(0,u.Mb)(y,s.B.RecursiveSearchUrl()),(0,u.ey)(p,"RecursiveSearchApiNewRawFullLinker",y)}})}var Dn=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};const Kn=["image/jpeg","image/jpg","image/png","image/webp"],eo=["application/msword","application/vnd.ms-excel","application/vnd.ms-powerpoint","text/plain","application/pdf"];function ti(_,o){return Dn(this,void 0,void 0,function*(){const e=re.V.logfunction("uploadAttachment");try{console.log("File Type",_.type);const n=new FormData;let p;if(eo.includes(_.type))n.append("file",_,_.name),p=yield no(n,o);else{if(!Kn.includes(_.type))return{message:"Invalid File Format",success:!1};n.append("image",_,_.name),p=yield to(n,o)}return p?.data?(re.V.logUpdate(e),{message:"Upload Success",success:!0,url:p.data}):{message:"File Upload Failed",success:!1}}catch(n){throw console.error(n),(0,u.ey)(e,"uploadAttachment",n),n}})}function to(_){return Dn(this,arguments,void 0,function*(o,e=""){const n=re.V.logfunction("uploadImage");try{const p=yield fetch(s.B.uploadImageUrl(),{method:"POST",body:o,headers:{Authorization:`Bearer ${e}`}});if(!p.ok){const y=p.headers.get("content-type");y&&y.includes("text/plain")&&console.info(p?.text());const C=yield p?.text();return console.error(`${p.status} ${C}`),re.V.logUpdate(n),null}return yield p.json()}catch(p){return console.error(p),(0,u.ey)(n,"uploadImage",p),null}})}function ni(_){return Dn(this,arguments,void 0,function*(o,e=""){const n=re.V.logfunction("uploadImageV2");try{const p=yield fetch(s.B.uploadImageUrlWithSmall(),{method:"POST",body:o,headers:{Authorization:`Bearer ${e}`}});if(!p.ok){const y=p.headers.get("content-type");y&&y.includes("text/plain")&&console.info(p?.text());const C=yield p?.text();return console.error(`${p.status} ${C}`),re.V.logUpdate(n),null}return yield p.json()}catch(p){return console.error(p),(0,u.ey)(n,"uploadImageV2",p),null}})}function no(_){return Dn(this,arguments,void 0,function*(o,e=""){const n=re.V.logfunction("uploadFile");try{const p=yield fetch(s.B.uploadFileUrl(),{method:"POST",body:o,headers:{Authorization:`Bearer ${e}`}});if(!p.ok){const y=p.headers.get("content-type");y&&y.includes("text/plain")&&console.info(p.text());const C=yield p.text();return console.error(`${p.status} ${C}`),null}return re.V.logUpdate(n),yield p.json()}catch(p){return console.error(p),(0,u.ey)(n,"uploadFile",p),null}})}var gn=m(1239),Wn=m(7467),Yr=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function oi(_,o){var e=arguments;return Yr(this,arguments,void 0,function*(n,p,y="boomconsole.com"){const C=re.V.logfunction("LoginToBackend",e);try{let E={email:n,password:p,application:y},g=new Headers;g.append("Content-Type","application/json");let c=JSON.stringify(E);const t=yield fetch(s.B.LoginUrl(),{method:"POST",headers:g,body:c}),G=yield t.json();if(t.ok)return Ze.b.BearerAccessToken=G.data.token,re.V.logUpdate(C),G;console.log("Login tsccs error message: ",t.status),(0,u.ER)(t,G)}catch(E){E instanceof Error?console.log("Login tsccs error message: ",E.message):console.log(" Login tsccs  unexpected error: ",E),(0,u.Mb)(E,s.B.LoginUrl()),(0,u.ey)(C,"LoginToBackend",E)}})}var oo=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function ii(_){return oo(this,void 0,void 0,function*(){return yield function(){return oo(this,arguments,void 0,function*(e="",n={}){let p={message:"success",status:!1,statusCode:200,data:"cannot signup"};try{const y=yield fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(n)}),C=yield y.json();return y.ok?p={message:"success",status:!0,statusCode:200,data:C}:(0,u.ER)(y,C),p}catch(y){console.log("Signup Error: ",y),(0,u.Mb)(y,e)}})}(s.B.SignupUrl(),_)})}function ri(_){return oo(this,void 0,void 0,function*(){const o=s.B.NODE_URL,e=yield fetch(`${o}/api/v1/entity/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});if(e.ok)return e.json();throw e.status===404?new Error("404, Not found"):e.status===500?new Error("500, internal server error"):new Error(e.status)})}var Zr=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function ci(_){return Zr(this,void 0,void 0,function*(){const o=JSON.stringify({email:_.email,password:_.password});let e={message:"success",status:!1,statusCode:200,data:""};const n=new Headers;n.append("Content-Type","application/json");const p=s.B.LoginUrl();try{const y=yield fetch(p,{method:"POST",headers:n,body:o,redirect:"follow"}),C=yield y.json();return y.ok?e={message:"success",status:!0,statusCode:200,data:C?.data}:(0,u.ER)(y,C),e}catch(y){console.log("Sign in api error",y),(0,u.Mb)(y,p)}})}var io=m(9934),Fn=m(4485);function Kr(_=[],o){Array.isArray(_)&&_.splice(_.findIndex(function(e){return e.id===o.id}),1)}function ec(_=[],o){Array.isArray(_)&&_.splice(_.findIndex(function(e){return e.id===o.id}),1)}class ro{constructor(o,e,n,p){this.expiryTime=new Date(Date.now()+6e5),this.height=1,this.key=o,this.value=e,this.leftNode=n,this.rightNode=p}isValid(){const o=new Date(Date.now());return!(this.expiryTime<o&&(zt.removeNodeFromTree(this.key),1))}saveToCache(o){this.value.cached=o}addNode(o,e,n){if(e==null)return o;const p=e.leftNode,y=e.rightNode;if(e.key>o.key)e.leftNode=this.addNode(o,p,n);else{if(!(e.key<o.key))return this.isValid(),o;e.rightNode=this.addNode(o,y,n)}e.height=1+Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode));const C=this.getBalanceFactor(e);if(C>1&&e.leftNode){if(o.key<e.leftNode.key)return this.rightRotate(e);if(o.key>e.leftNode.key)return e.leftNode=this.leftRotate(e.leftNode),this.rightRotate(e)}if(C<-1&&e.rightNode){if(o.key>e.rightNode.key)return this.leftRotate(e);if(o.key<e.rightNode.key)return e.rightNode=this.rightRotate(e.rightNode),this.leftRotate(e)}return this.isValid(),e}rightRotate(o){if(o){const e=o.leftNode;if(e){const n=e.rightNode;return o.leftNode=n,e.rightNode=o,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,e}}return o}leftRotate(o){if(o){const e=o.rightNode;if(e){const n=e.leftNode;return e.leftNode=o,o.rightNode=n,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(o.rightNode))+1,e}}return o}getHeight(o){return o?o.height:0}getBalanceFactor(o){return o==null?0:this.getHeight(o.leftNode)-this.getHeight(o.rightNode)}getFromNode(o,e){return e&&(o==e.key&&e.isValid()?e:o<e.key?this.getFromNode(o,e.leftNode):o>e.key?this.getFromNode(o,e.rightNode):e)}removeNode(o,e){if(o==null)return o;if(o.key>e)return o.leftNode=this.removeNode(o.leftNode,e),o;if(o.key<e)return o.rightNode=this.removeNode(o.rightNode,e),o;if(o.leftNode==null){const n=o.rightNode;return o=null,n}if(o.rightNode==null){const n=o.leftNode;return o=null,n}{const n=this.inOrderSuccessor(o.rightNode);return o.value=n.value,o.key=n.key,o.rightNode=this.removeNode(o.rightNode,n.key),o}}countNodeBelow(o){return o==null?0:1+this.countNodeBelow(o.leftNode)+this.countNodeBelow(o.rightNode)}inOrderSuccessor(o){for(;o.leftNode!=null;)o=o.leftNode;return o}}var si=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};class zt{static addNodeToTree(o){if(this.root==null)return this.root=o,this.root;this.root=this.root.addNode(o,this.root,this.root.height)}static addCompositionToTree(o){const e=new ro(o.id,o,null,null);this.addNodeToTree(e)}static getNodeFromTree(o){return si(this,void 0,void 0,function*(){return this.root?this.root.getFromNode(o,this.root):null})}static removeNodeFromTree(o){return si(this,void 0,void 0,function*(){this.root&&(this.root=this.root.removeNode(this.root,o))})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}zt.root=null;var tc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function vn(_,o,e,n){return tc(this,arguments,void 0,function*(p,y,C,E,g=[]){var c,t;let G={};const F=[];if(p==0)return"";let V=co(C,p);if(V!=null&&V.id!=0||p==null||p==null||(V=yield(0,ve.A)(p)),V.id!=0&&V.type==null){const P=V.typeId;let z=co(C,P);V.type=z,z==null&&P!=null&&P!=null&&(z=yield(0,ve.A)(P),V.type=z)}if(!E.includes(p))return V?.characterValue;if(g.includes(p))return"";g.push(p);for(let P=0;P<y.length;P++)if(y[P].ofTheConceptId==p){const z=y[P].toTheConceptId;if(E.includes(p)){let te=co(C,z);if(te!=null&&te.id!=0||z==null||z==null||(te=yield(0,ve.A)(z)),te.id!=0&&te?.type==null){const ie=te.typeId;let we=yield N.I.GetConcept(ie);te.type=we,we==null&&ie!=null&&ie!=null&&(we=yield(0,ve.A)(ie),te.type=we)}const le="the_",ke=((t=(c=te?.type)===null||c===void 0?void 0:c.characterValue)!==null&&t!==void 0?t:"").replace(le,"");if(isNaN(Number(ke))){if(ke){const ie=yield vn(z,y,C,E,g);G[ke]=ie}}else{const ie=yield vn(z,y,C,E,g);F[ke]=ie,G=F}}}return G})}function co(_,o){let e=(0,se.o)();for(let n=0;n<_.length;n++)if(o==_[n].id)return e=_[n],e;return e}class Ln{constructor(){this.id=0,this.mainConcept=(0,se.o)(),this.connections=[],this.concepts=[],this.subcompositions=[],this.cached={}}updateCache(){return o=this,e=void 0,p=function*(){if(this.mainConcept.id==0)for(let y=0;y<this.concepts.length;y++)this.concepts[y].id==this.id&&(this.mainConcept=this.concepts[y]);this.cached=yield vn(this.id,this.connections,this.concepts,this.subcompositions,[])},new((n=void 0)||(n=Promise))(function(y,C){function E(t){try{c(p.next(t))}catch(G){C(G)}}function g(t){try{c(p.throw(t))}catch(G){C(G)}}function c(t){var G;t.done?y(t.value):(G=t.value,G instanceof n?G:new n(function(F){F(G)})).then(E,g)}c((p=p.apply(o,e||[])).next())});var o,e,n,p}UpdateAcrossDistributedSystem(){var o,e;try{this.id!=0&&(e=(o=this.id)===null||o===void 0?void 0:o.toString(),s.B.MQTT_CONNECTION&&s.B.MQTT_CONNECTION.publish("compositionUpdate",e))}catch(n){console.log("Error while publishing message",n)}}isUpdating(){this.UpdateAcrossDistributedSystem()}GetDataCache(){var o,e,n;const p={};p[(n=(e=(o=this.mainConcept)===null||o===void 0?void 0:o.type)===null||e===void 0?void 0:e.characterValue)!==null&&n!==void 0?n:""]=this.cached;const y={};return y.data=p,y.id=this.id,y}}var nc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function Sn(_){return nc(this,arguments,void 0,function*(o,e=null,n=null,p=null,y=null,C=null,E=null,g=null){const c=y??999,t=C??4,G=E??999;let F=p??0,V=(0,se.o)();g==null&&(g=new Ln);for(const P in o)if(typeof o[P]=="object"||Array.isArray(o[P])){const z=yield(0,Te.A)(P,"",!0,c,t,G);if(e==null&&n==null){let te=F;V=z,te=z.id,F=z.id,g.concepts.push(z),g.id=z.id,yield Sn(o[P],z.id,z.userId,te,y,C,E,g)}else{const te=e??999,le=n??999,ke=F;V=z,g.concepts.push(z);const ie=yield(0,Be.q)(te,le,z.id,ke);g.connections.push(ie),yield Sn(o[P],z.id,z.userId,ke,y,C,E,g)}o[P]!=null&&o[P]!=null&&g.subcompositions.push(z.id)}else{const z=e??999,te=n??999,le=F,ke=yield(0,Te.A)(P,o[P],!1,c,t,G);g.concepts.push(ke);const ie=yield(0,Be.q)(z,te,ke.id,le);g.connections.push(ie)}return V})}var oc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function ai(_){return oc(this,void 0,void 0,function*(){const o=re.V.logfunction("UpdateComposition")||{};if(Fe){o.serviceWorker=!0;try{const ie=yield je("UpdateComposition",{patcherStructure:_});return re.V.logUpdate(o),ie.data}catch(ie){console.error("UpdateComposition sw error: ",ie),(0,u.ey)(o,"UpdateComposition",ie),ze(ie)}}const e=_.userId,n=_.sessionId,p=_.accessId;let y=[];const C=[];let E=(0,se.o)(),g=(0,se.o)();const c=[];let t=_.compositionId;const G=_.ofTheCompositionId;let F=[];if(t<0){let ie=yield(0,ve.A)(t,e);if(!(ie.id>0))return null;t=ie.id}y=yield(0,X.s)(t);const V=[],P=new Ln,z=[];P.id=t,P.isUpdating();let te=[];for(let ie=0;ie<y.length;ie++)(0,io.A)(z,y[ie].ofTheConceptId),(0,io.A)(V,y[ie].ofTheConceptId),(0,io.A)(V,y[ie].toTheConceptId),te.push(y[ie].ofTheConceptId);P.subcompositions=z,P.connections=y;for(let ie=0;ie<V.length;ie++){const we=yield(0,ve.A)(V[ie]);t==V[ie]&&(E=we),G==V[ie]&&(g=we),C.push(we)}const le=_.patchObject;for(const ie in le){let we=(0,se.o)();const De=le[ie];let Pe=E;if(g.id>0&&(Pe=g),Array.isArray(De)||typeof De=="object"){we=yield(0,Te.A)(ie,"",!0,E.userId,4,999),P.subcompositions.push(we.id);const qe=(0,Fn.vo)(C,we);for(let Ye=0;Ye<qe.length;Ye++)if(qe[Ye].id>0){const rt=(0,Fn.wS)(P.connections,qe[Ye].id);F=F.concat(rt),c.push(qe[Ye])}yield Sn(le[ie],we.id,we.userId,E.id,E.userId,4,999,P)}else{we=yield(0,Te.A)(ie,De,!1,e,p,n);const qe=(0,Fn.vo)(C,we);for(let Ye=0;Ye<qe.length;Ye++)if(qe[Ye].id>0){const rt=(0,Fn.wS)(P.connections,qe[Ye].id);F=F.concat(rt),c.push(qe[Ye])}}const Je=(0,Be.q)(Pe.id,Pe.userId,we.id,E.id);C.push(we),P.connections.push(Je)}for(let ie=0;ie<F.length;ie++)ec(P.connections,F[ie]),(0,ue.m)(F[ie].id);for(let ie=0;ie<c.length;ie++)Kr(C,c[ie]);P.concepts=P.concepts.concat(C),P.mainConcept=E,P.id=E.id,yield P.updateCache(),zt.addCompositionToTree(P),Ce.Y.SyncDataOnline();let ke=P.GetDataCache();return re.V.logUpdate(o),ke})}var ic=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function li(_,o,e,n){return ic(this,arguments,void 0,function*(p,y,C,E,g=10,c=1){var t=(0,i.ab)("application/x-www-form-urlencoded",E),G=new URLSearchParams;G.append("type",p),G.append("search",y),G.append("composition",C),G.append("inpage",g.toString()),G.append("page",c.toString());const F=s.B.SearchCompositionsUrl()+"?"+G.toString();try{const V=yield fetch(F,{method:"GET",headers:t});return V.ok?yield V.json():((0,u.ry)(V),[])}catch(V){console.log("This is the searching error",V),(0,u.Mb)(V,F)}})}var rc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function di(_){return rc(this,arguments,void 0,function*(o,e=""){var n=(0,i.ab)("application/json",e);const p=s.B.SearchLinkMultipleAll(),y=JSON.stringify(o);try{const C=yield fetch(p,{method:"POST",headers:n,body:y});return C.ok?yield C.json():(console.log("This is the searching error",C.status),(0,u.ry)(C),[])}catch(C){console.log("This is the searching error",C),(0,u.Mb)(C,p)}})}var ui=m(7139),_n=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function hi(_){return _n(this,arguments,void 0,function*(o,e=[]){var n,p;let y=[];const C=[];let E={},g={};const c=yield zt.getNodeFromTree(o),t=[];let G=yield N.I.GetConcept(o);if(G.id==0&&o!=null&&o!=null&&(G=yield(0,ui.r)(o)),c==null){let F=[];F=e.length>0?pi(o,e):yield(0,X.s)(o),y=F;for(let P=0;P<y.length;P++)t.includes(y[P].ofTheConceptId)||(t.push(y[P].ofTheConceptId),C.push(y[P].ofTheConceptId)),C.includes(y[P].toTheConceptId)||C.push(y[P].toTheConceptId);yi(G,y,C,t);let V=[];g=yield(0,d.zN)(o,y,t,V),E[(p=(n=G?.type)===null||n===void 0?void 0:n.characterValue)!==null&&p!==void 0?p:""]=g}else g=c.value.GetDataCache(),E=g;return G.id==0?"":E})}function pi(_,o){const e=[];for(let n=0;n<o.length;n++)o[n].typeId==_&&e.push(o[n]);return e}function so(_){return _n(this,arguments,void 0,function*(o,e=[]){var n,p;let y={},C=[];const E=[];let g;const c={},t=yield zt.getNodeFromTree(o),G=[];let F=yield N.I.GetConcept(o);if(F.id==0&&o!=null&&o!=null&&(F=yield(0,ui.r)(o)),t==null){let V=[];V=e.length>0?pi(o,e):yield(0,X.s)(o),C=V;for(let P=0;P<C.length;P++)G.includes(C[P].ofTheConceptId)||(G.push(C[P].ofTheConceptId),E.push(C[P].ofTheConceptId)),E.includes(C[P].toTheConceptId)||E.push(C[P].toTheConceptId);yi(F,C,E,G),g=yield(0,d.zN)(o,C,G),c[(p=(n=F?.type)===null||n===void 0?void 0:n.characterValue)!==null&&p!==void 0?p:""]=g,y.created_at=F.entryTimeStamp,y.data=c,y.id=o}else g=t.value.GetDataCache(),y=g;return F.id==0?"":y})}function fi(_,o){return _n(this,void 0,void 0,function*(){let e=[];const n=[];e=yield(0,Wn.j)(o);for(let p=0;p<_.length;p++){const y=yield so(_[p],e);y&&n.push(y)}return n})}function yi(_,o,e,n){return _n(this,void 0,void 0,function*(){const p=new Ln,y=yield function(E){return _n(this,void 0,void 0,function*(){let g=[];const c=[];for(let t=0;t<E?.length;t++){const G=yield N.I.GetConcept(E[t]);G.id==0?c.push(E[t]):g.push(G)}return c?.length==0||(g=yield(0,gn.I)(c)),g})}(e);p.connections=o,p.concepts=y,p.id=_.id,p.subcompositions=n,p.mainConcept=_;const C=yield vn(_.id,o,y,n,[]);p.cached=C,zt.addCompositionToTree(p)})}var cc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function gi(_){return cc(this,void 0,void 0,function*(){try{var o=(0,i.Xr)();const e=JSON.stringify(_),n=yield fetch(s.B.CreateSessionId(),{method:"POST",headers:o,body:e});return n.ok?n.json():(console.log("Creating session failed",yield n.json()),(0,u.ry)(n),null)}catch(e){console.log("Creating session failed",e),(0,u.Mb)(e,s.B.CreateSessionId())}})}var sc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function vi(_,o){return sc(this,void 0,void 0,function*(){try{var e=(0,i.Xr)("application/x-www-form-urlencoded");const n=new URLSearchParams;n.append("sessionId",_.toString()),n.append("url",o);const p=yield fetch(s.B.CreateSessionVisitUrl(),{method:"POST",headers:e,body:n});return p.ok?p.json():(console.log("Creating session url failed",yield p.json()),(0,u.ry)(p),null)}catch(n){console.log("Creating session url failed",n),(0,u.Mb)(n,s.B.CreateSessionVisitUrl())}})}var ac=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function mi(_,o,e){return ac(this,arguments,void 0,function*(n,p,y,C=10,E=1){let g=[];try{var c=new URLSearchParams;c.append("typeId",`${n}`),c.append("toTheConceptId",`${p}`),c.append("userId",`${y}`),c.append("inpage",`${C}`),c.append("page",`${E}`);var t=(0,i.Xr)("application/x-www-form-urlencoded");const G=yield fetch(s.B.GetAllConnectionsToConceptUrl(),{method:"POST",headers:t,body:c});return G.ok?g=yield G.json():(console.log("Get connection of concept error",G.status),(0,u.ry)(G)),g}catch(G){throw G instanceof Error?console.log("Get connection of concept  error message: ",G.message):console.log("Get connection of concept unexpected error: ",G),G}})}var Ci=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function ao(_,o){var e=arguments;return Ci(this,arguments,void 0,function*(n,p,y=10,C=1,E=!1){const g=re.V.logfunction("GetRelation",e)||{};if(Fe){g.serviceWorker=!0;try{const P=yield je("GetRelation",{id:n,relation:p,inpage:y,page:C,reverse:E});return re.V.logUpdate(g),P.data}catch(P){console.error("GetRelation error sw: ",P),(0,u.ey)(g,"GetRelation",P),ze(P)}}let c=[],t=yield(0,ve.A)(n),G=yield(0,Ge.Az)(p),F=[];if(G.id>0)if(E){F=yield mi(G.id,t.id,t.userId,y,C);let P=[];for(var V=0;V<F.length;V++)P.push(F[V].ofTheConceptId);yield(0,I.Y)(P);for(let z=0;z<F.length;z++){let te=F[z].ofTheConceptId,le=yield(0,ve.A)(te),ke=yield(0,d.Ez)(le.id);c.push(ke)}}else{F=yield he(G.id,t.id,t.userId,y,C);let P=[];for(let z=0;z<F.length;z++)P.push(F[z].toTheConceptId);yield(0,I.Y)(P);for(let z=0;z<F.length;z++){let te=F[z].toTheConceptId,le=yield(0,ve.A)(te),ke=yield(0,d.Ez)(le.id);c.push(ke)}}return re.V.logUpdate(g),c})}function Ti(_,o){var e=arguments;return Ci(this,arguments,void 0,function*(n,p,y=10,C=1,E=!1){const g=re.V.logfunction("GetRelationRaw",e)||{};if(Fe){g.serviceWorker=!0;try{const z=yield je("GetRelationRaw",{id:n,relation:p,inpage:y,page:C,reverse:E});return re.V.logUpdate(g),z.data}catch(z){console.error("GetRelationRaw error sw: ",z),(0,u.ey)(g,"GetRelationRaw",z),ze(z)}}let c=[],t=yield(0,ve.A)(n),G=yield(0,Ge.Az)(p),F=[],V=[];if(G.id>0){if(E){F=yield mi(G.id,t.id,t.userId,y,C);for(var P=0;P<F.length;P++)V.push(F[P].ofTheConceptId)}else{F=yield he(G.id,t.id,t.userId,y,C);for(let z=0;z<F.length;z++)V.push(F[z].toTheConceptId)}c=yield(0,gn.r)(V)}return re.V.logUpdate(g),c})}var lo=m(6416),Et=m(4711);class lc{constructor(o,e,n,p){this.value=[],this.height=1,this.key=o,this.value.push(e),this.leftNode=n,this.rightNode=p}addNode(o,e,n){if(e==null)return o;var p=e.leftNode,y=e.rightNode;if(e.key>o.key)e.leftNode=this.addNode(o,p,n);else{if(!(e.key<o.key))return e.value.push(...o.value),e;e.rightNode=this.addNode(o,y,n)}e.height=1+Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode));let C=this.getBalanceFactor(e);if(C>1&&e.leftNode){if(o.key<e.leftNode.key)return this.rightRotate(e);if(o.key>e.leftNode.key)return e.leftNode=this.leftRotate(e.leftNode),this.rightRotate(e)}if(C<-1&&e.rightNode){if(o.key>e.rightNode.key)return this.leftRotate(e);if(o.key<e.rightNode.key)return e.rightNode=this.rightRotate(e.rightNode),this.leftRotate(e)}return e}rightRotate(o){if(o){let e=o.leftNode;if(e){let n=e.rightNode;return o.leftNode=n,e.rightNode=o,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(e.rightNode))+1,e}}return o}leftRotate(o){if(o){let e=o.rightNode;if(e){let n=e.leftNode;return e.leftNode=o,o.rightNode=n,o.height=Math.max(this.getHeight(o.leftNode),this.getHeight(o.rightNode))+1,e.height=Math.max(this.getHeight(e.leftNode),this.getHeight(o.rightNode))+1,e}}return o}getHeight(o){return o?o.height:0}getBalanceFactor(o){return o==null?0:this.getHeight(o.leftNode)-this.getHeight(o.rightNode)}getFromNode(o,e){return e&&(o==e.key?e:o<e.key?this.getFromNode(o,e.leftNode):o>e.key?this.getFromNode(o,e.rightNode):e)}removeNode(o,e){if(o==null)return o;if(o.key>e)return o.leftNode=this.removeNode(o.leftNode,e),o;if(o.key<e)return o.rightNode=this.removeNode(o.rightNode,e),o;if(o.leftNode==null){let p=o.rightNode;return o=null,p}if(o.rightNode==null){let p=o.leftNode;return o=null,p}var n=this.inOrderSuccessor(o.rightNode);return o.value=n.value,o.key=n.key,o.rightNode=this.removeNode(o.rightNode,n.key),o}countNodeBelow(o){return o==null?0:1+this.countNodeBelow(o.leftNode)+this.countNodeBelow(o.rightNode)}inOrderSuccessor(o){for(;o.leftNode!=null;)o=o.leftNode;return o}}var uo=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};class en{static compositeKey(o,e){return("0000"+o.toString(16).toUpperCase()).slice(-4)+("0000"+e.toString(16).toUpperCase()).slice(-4)}static addNodeToTree(o){if(this.root==null)return this.root=o,this.root;this.root=this.root.addNode(o,this.root,this.root.height)}static waitForDataToLoad(){return uo(this,void 0,void 0,function*(){return new Promise((o,e)=>{this.checkFlag(o),setTimeout(()=>{e("not")},25e3)})})}static checkFlag(o){if(r.B.isDataLoaded)return o("done");setTimeout(en.checkFlag,1e3,o)}static addConceptToTree(o,e,n=999){let p=this.compositeKey(e,n);var y=new lc(p,o,null,null);this.addNodeToTree(y)}static getNodeFromTree(o,e){return uo(this,void 0,void 0,function*(){let n=this.compositeKey(o,e);return this.root?this.root.getFromNode(n,this.root):null})}static removeNodeFromTree(o){return uo(this,arguments,void 0,function*(e,n=999){if(this.root){let p=this.compositeKey(e,n);this.root=this.root.removeNode(this.root,p)}})}static countNumberOfNodes(){return this.root?this.root.countNodeBelow(this.root):0}}en.root=null;var Ii=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function wi(_,o){return Ii(this,arguments,void 0,function*(e,n,p=999){let y=yield en.getNodeFromTree(e,p),C=(0,lo.u)();if(y)for(let E=0;E<y.value.length;E++){let g=y.value[E];g.ghostId==n&&(C=g)}return C})}function ki(_,o){return Ii(this,arguments,void 0,function*(e,n,p=999){en.addConceptToTree(e,n,p)})}var tn=m(5312),ho=m(1213),Ni=m(3729),dc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})},uc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function Ai(_,o,e){return uc(this,void 0,void 0,function*(){try{if(Fe)try{return(yield je("GetRelationLocal",{id:_,relation:o,userId:e})).data}catch(C){console.error("GetRelationLocal error sw: ",C),ze(C)}let n=yield(0,a.$I)(o),p=[];n.id!=0&&(p=yield function(C,E){return dc(this,void 0,void 0,function*(){try{return yield R.G.GetConnectionOfCompositionAndTypeLocal(E,C)}catch(g){throw g}})}(_,n.id));let y=[];for(let C=0;C<p.length;C++){let E=yield O(p[C].toTheConceptId);y.push(E)}return y}catch(n){throw n}})}var hc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function po(_){return hc(this,void 0,void 0,function*(){let o=[];try{var e=(0,i.Xr)();const n=yield fetch(s.B.ViewInternalDataUrl(),{method:"POST",headers:e,body:JSON.stringify(_)});if(n.ok){let p=yield n.json(),y={};for(let C=0;C<p.length;C++){let E=p[C].concepts;o=p[C].connections;let g=p[C].id;(0,gn.r)(E),y[g]=o}return y}return console.log("View Internal Data error",n.status),(0,u.ry)(n),o}catch(n){throw n instanceof Error?console.log(" This is the view internal data error message: ",n.message):console.log(" This is the view internal data unexpected error: ",n),n}})}var pc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function fo(_){return pc(this,void 0,void 0,function*(){var o;try{let e=yield po(_),n=[];for(let p=0;p<_.length;p++){let y=_[p],C=e[y];if(y&&C){let E=[],g={};for(let t=0;t<C.length;t++)E.includes(C[t].ofTheConceptId)||E.push(C[t].ofTheConceptId);let c=yield(0,d.zN)(y,C,E);g.data=c,g.id=y,n.push(g)}else{let E={};E.id=y;let g=yield(0,ve.A)(y),c={};g.type&&(c[(o=g?.type)===null||o===void 0?void 0:o.characterValue]=g.characterValue,E.data=c,n.push(E))}}return n}catch(e){throw e}})}var Un=m(176),Li=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})},Si=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function _i(_){return Si(this,arguments,void 0,function*(o,e=""){try{let n=yield function(p){return Li(this,arguments,void 0,function*(y,C=""){var E=(0,i.ab)("application/json",C);let g=s.B.SearchInternalWithAuthenticatedCcsUrl();g=g+"?composition="+y.composition+"&search="+y.search+"&internalComposition="+y.internalComposition+"&type="+y.type+"&inpage="+y.inpage+"&page="+y.page;try{const c=yield fetch(g,{method:"GET",headers:E});return c.ok?yield c.json():(console.log("This is the searching internal error",c.status),(0,u.ry)(c),[])}catch(c){console.log("This is the searching internal error",c),(0,u.Mb)(c,g)}})}(o,e);return yield fo(n)}catch(n){throw n}})}function bi(_){return Si(this,arguments,void 0,function*(o,e=""){try{return yield function(n){return Li(this,void 0,void 0,function*(){var p=(0,i.ab)("application/json","");let y=s.B.SearchInternalWithCcsUrl();y=y+"?composition="+n.composition+"&search="+n.search+"&internalComposition="+n.internalComposition+"&type="+n.type+"&inpage="+n.inpage+"&page="+n.page;try{const C=yield fetch(y,{method:"GET",headers:p});return C.ok?yield C.json():(console.log("This is the searching internal error",C.status),(0,u.ry)(C),[])}catch(C){console.log("This is the searching internal error",C),(0,u.Mb)(C,y)}})}(o)}catch(n){throw n}})}var yo=m(8095),fc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function Gi(_){return fc(this,void 0,void 0,function*(){if(Fe)try{return(yield je("DeleteConceptLocal",{id:_})).data}catch(e){console.error("DeleteConceptLocal error sw: ",e),ze(e)}let o=yield(0,ho.f)(_);S.v.RemoveConcept(o)})}var Bi=m(2803),yc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function xi(_,o,e,n){return yc(this,arguments,void 0,function*(p,y,C,E,g=!0){var c,t;const G=re.V.logfunction("GetConnectionBetweenTwoConceptsLinker")||{};if(Fe){G.serviceWorker=!0;try{const P=yield je("GetConnectionBetweenTwoConceptsLinker",{ofTheConcept:p,toTheConcept:y,linker:C,fullLinker:E,forward:g});return re.V.logUpdate(G),P.data}catch(P){console.error("GetConnectionBetweenTwoConceptsLinker sw error: ",P),(0,u.ey)(G,"GetConnectionBetweenTwoConceptsLinker",P),ze(P)}}let F=(0,se.o)();if(C!=""){let P="";P=g?((c=p.type)===null||c===void 0?void 0:c.characterValue)+"_s_"+C+"_s":((t=y.type)===null||t===void 0?void 0:t.characterValue)+"_s_"+C+"_by",F=yield(0,Te.A)("connection",P,!1,999)}E!=""&&(F=yield $e(E,999));let V=[];return V=g?yield(0,Bi.x)(p.id,y.id,F.id):yield(0,Bi.x)(y.id,p.id,F.id),re.V.logUpdate(G),V})}function Ei(_,o){return new Promise((e,n)=>{setTimeout(()=>{e(o)},_)})}var Me=m(3130);const Ri=3,Di=4,Wi=5;var gc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function go(_,o){return gc(this,arguments,void 0,function*(e,n,p=""){let y=s.B.SearchAllTypeWithLinker(e.auth);var C=(0,i.ab)("application/json",p);y=y+"?search="+e.search+"&type="+e.type+"&inpage="+e.inpage+"&page="+e.page;const E=JSON.stringify(n);try{const g=yield fetch(y,{method:"POST",headers:C,body:E});return g.ok?yield g.json():((0,u.ry)(g),console.log("This is the searching multiple error",g.status),[])}catch(g){console.log("This is the searching SearchWithTypeAndLinker error",g),(0,u.Mb)(g,y)}})}var qt=m(4287);class vo extends qt.w{constructor(o,e,n=Me.y0){super(),this.searchQuery=[],this.format=Me.y0,this.searchQuery=o,this.format=n}bind(){return o=this,e=void 0,p=function*(){return this.data=yield(0,tn.cf)(this.searchQuery,"",this,this.format),this.mainConcept=this.searchQuery[0].composition,this.listenToEvent(this.mainConcept),console.log("this is the data",this.data),this.data},new((n=void 0)||(n=Promise))(function(y,C){function E(t){try{c(p.next(t))}catch(G){C(G)}}function g(t){try{c(p.throw(t))}catch(G){C(G)}}function c(t){var G;t.done?y(t.value):(G=t.value,G instanceof n?G:new n(function(F){F(G)})).then(E,g)}c((p=p.apply(o,e||[])).next())});var o,e,n,p}}function Fi(_,o,e=Me.y0){return new vo(_,o??"",e)}var Ui=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};class vc extends qt.w{constructor(o,e=Me.ZJ){super(),this.id=o,this.format=e}bind(){return Ui(this,void 0,void 0,function*(){if(!this.isDataLoaded){let o=yield(0,d.hL)(this.id);this.mainConcept=this.id,this.compositionIds=o.compositionList;let e=o.connectionList;for(let n=0;n<e.length;n++)this.internalConnections.push(e[n].id);this.isDataLoaded=!0,this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return Ui(this,void 0,void 0,function*(){let o=[],e=this.internalConnections;for(let n=0;n<e.length;n++)o.push(yield Ut.d.GetConnection(e[n]));return this.format==Me.ZJ?this.data=yield(0,d.ay)(this.mainConcept,o,this.compositionIds):this.format==Me.y0?this.data=yield(0,d.$V)(this.mainConcept,o,this.compositionIds):this.format==Me.yv?this.data=yield(0,d.re)(this.mainConcept,o,this.compositionIds):this.data=yield(0,d.ay)(this.mainConcept,o,this.compositionIds),this.data})}}function Oi(_,o=Me.ZJ){return new vc(_,o)}var Mi=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};class mc extends qt.w{constructor(o,e,n,p,y){super(),this.data=[],this.startPage=0,this.compositionName=o,this.userId=e,this.inpage=n,this.page=p,this.format=y}bind(){return Mi(this,void 0,void 0,function*(){if(!this.isDataLoaded){var o=yield(0,l.A)(this.compositionName);if(o){yield T(this.compositionName,this.userId);let p=yield N.I.GetConceptsByTypeIdAndUser(o.id,this.userId);for(var e=this.inpage*(this.page-1),n=e;n<e+this.inpage;n++)p[n]&&this.compositionIds.push(p[n].id)}yield(0,I.Y)(this.compositionIds),this.isDataLoaded=!0,this.listenToEventType(o.id);for(let p=0;p<this.compositionIds.length;p++)this.listenToEvent(this.compositionIds[p])}return yield this.build()})}build(){return Mi(this,void 0,void 0,function*(){if(this.data=[],this.format==Me.ZJ){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,d.kx)(this.compositionIds[o]);this.data.push(e)}}else if(this.format==Me.y0){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,d.RW)(this.compositionIds[o]);this.data.push(e)}}else if(this.format==Me.yv){for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,d.XI)(this.compositionIds[o]);this.data.push(e)}}else for(let o=this.startPage;o<this.startPage+this.inpage;o++)if(this.compositionIds[o]){let e=yield(0,d.kx)(this.compositionIds[o]);this.data.push(e)}return this.data})}}function Pi(_,o,e,n,p=Me.ZJ){return new mc(_,o,e,n,p)}var Qt=m(1320),Vi=m(5328),mo=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};class Cc extends qt.w{constructor(o,e,n="",p){super(),this.searchText="",this.connections=[],this.externalConnectionIds=[],this.data=[],this.mainConcept=o,this.searchLinkers=e,this.textSearch=n,p&&(this.format=p)}listenToEvent(o){window.addEventListener(`${o}`,e=>{if(!this.isUpdating){this.isUpdating=!0;let n=this;setTimeout(function(){return mo(this,void 0,void 0,function*(){let p=yield Ut.d.GetConnectionByOfTheConceptAndType(o,o);for(let y=0;y<p.length;y++)yield Ut.d.GetConnection(p[y]).then(C=>{C.typeId==n.mainConcept?n.internalConnections.includes(C.id)||n.internalConnections.push(C.id):n.linkers.includes(C.id)||n.linkers.push(C.id),n.conceptIds.includes(C.toTheConceptId)||n.conceptIds.push(C.toTheConceptId),n.compositionIds.includes(C.ofTheConceptId)||n.compositionIds.push(C.ofTheConceptId),n.compositionIds.includes(C.toTheConceptId)||n.compositionIds.push(C.toTheConceptId)});n.isUpdating=!1,yield n.bind(),n.notify()})},200)}})}bind(){return mo(this,void 0,void 0,function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;const o=yield Zn(this.mainConcept,this.searchLinkers,this.textSearch);this.compositionIds=o.compositionIds||[],this.internalConnections=o.internalConnections||[],this.externalConnectionIds=o.externalConnections||[],this.linkers=this.externalConnectionIds,this.connections=yield(0,Wn.j)(this.externalConnectionIds);for(let e=0;e<this.compositionIds.length;e++)this.listenToEvent(this.compositionIds[e]);this.listenToEvent(this.mainConcept)}return yield this.build()})}build(){return mo(this,void 0,void 0,function*(){return this.externalConnectionIds=this.linkers,this.format&&this.format==Me.XZ?this.data={compositionIds:this.compositionIds,internalConnections:this.internalConnections,externalConnections:this.externalConnectionIds}:this.data=yield(0,Ke.p8)(this.compositionIds,this.internalConnections),this.data})}}function ji(_,o,e="",n){return new Cc(_,o,e,n)}var Co=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};class Tc extends qt.w{constructor(o,e,n,p=Me.y0){super(),this.searchQuery=[],this.format=Me.y0,this.mainCompositionIds=[],this.searchCharacter="",this.token="",this.searchStructure=o,this.searchQuery=e,this.searchQuery[0].type=o.composition,this.searchCharacter=o.composition,this.format=p,this.token=Ze.b.BearerAccessToken}listenToEventType(o){window.addEventListener(`${o}`,e=>{if(!this.isUpdating){this.isUpdating=!0;let n=this;setTimeout(function(){return Co(this,void 0,void 0,function*(){let p=e;n.mainCompositionIds.includes(p?.detail)||(n.mainCompositionIds.unshift(p?.detail),n.conceptIds.push(p?.detail),n.listenToEvent(p?.detail),Ut.d.GetConnectionsOfConcept(p?.detail).then(y=>{for(let C=0;C<y.length;C++)n.linkers.push(y[C].id)})),n.isUpdating=!1,yield n.bind(),n.notify()})},200)}})}bind(){return Co(this,void 0,void 0,function*(){if(!this.isDataLoaded){this.isDataLoaded=!0;var o=yield(0,l.A)(this.searchCharacter);let e=yield go(this.searchStructure,this.searchQuery,this.token);this.conceptIds=e.compositionIds,this.internalConnections=e.internalConnections,this.linkers=e.linkers,this.reverse=e.reverse,this.mainCompositionIds=e.mainCompositionIds,this.listenToEventType(o.id);for(let n=0;n<this.mainCompositionIds.length;n++)this.listenToEvent(this.mainCompositionIds[n])}return yield this.build()})}build(){return Co(this,void 0,void 0,function*(){return yield(0,gn.r)(this.conceptIds),this.format==Me.y0?this.data=yield(0,Qt.yV)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse):this.data=yield(0,Qt._W)(this.linkers,this.conceptIds,this.internalConnections,this.mainCompositionIds,this.reverse),this.data})}}function Hi(_,o,e,n=Me.y0){return new Tc(_,o,e,n)}var To=m(4698),$i=m(6915),Ji=m(2615);class zi{constructor(o,e,n,p,y,C,E,g=!1,c,t,G){this.structureType="lconcept",this.isComposition=!1,this.isTemp=!1,this.isSynced=!1,this.applicationId=s.B.getRandomizer(),this.id=o,this.userId=e,this.typeId=n,this.ghostId=o,this.categoryId=p,this.characterValue=C,this.accessId=y,this.type=null,this.isNew=g,this.typeCharacter=E,this.entryTimeStamp=c,this.updatedTimeStamp=t,this.isSynced=!1,this.referentId=G}getType(){console.log(this.typeId)}}class qi{constructor(o,e,n,p,y,C){this.isTemp=!1,this.applicationId=s.B.getRandomizer(),this.type=(0,se.o)(),this.id=o,this.ofTheConceptId=e,this.toTheConceptId=n,this.typeId=p,this.ghostId=o,this.orderId=y,this.typeCharacter="",this.accessId=C,this.typeCharacter="",this.entryTimeStamp=(0,se.Y)(new Date),this.terminationDateTime=new Date,this.localSyncTime=new Date}}class Qi{constructor(){this.compositionId=0,this.userId=999,this.sessionId=999,this.accessId=4,this.ofTheCompositionId=0,this.patchObject={}}}class Xi{constructor(){this.id="0",this.remote_address="",this.server_port="",this.server_address="",this.server_name="",this.server_software="",this.http_user_agent="",this.self="",this.port="",this.userId="",this.email=""}}var nn=m(628);class On{constructor(){this.type="",this.search="",this.logicoperator="=",this.index=0,this.composition=!0,this.name="",this.operateon=""}}class Yi{constructor(){this.type="",this.search="",this.composition="",this.internalComposition="",this.userId=999,this.inpage=10,this.page=1,this.auth=!0}}var Zi=m(7887),Ki=m(3075),Ic=m(7869),er=m(9635),re=m(9700);class wc{static initialize(){try{console.warn("Initialized Application Monitoring for tracking errors..."),this.initGlobalErrorHandlers(),this.logCatchError(),this.logErrorEvent(),this.logUnhandledError(),this.logUserInteractions(),this.logNetworkRequests(),this.logRouteChanges(),this.logPerformanceMetrics(),this.logWebSocketEvents()}catch(o){console.error("Error during Application Monitoring initialization:",o)}}static initGlobalErrorHandlers(){try{if(console.log("this is the window",window),typeof window===void 0)return;const o=Ze.b.sessionId||"unknown";window.onerror=(e,n,p,y,C)=>{const E={message:e,source:n,lineno:p,colno:y,stack:C?.stack||"undefined",requestFrom:s.B.BASE_APPLICATION,sessionId:o};re.V.logApplication("ERROR","Runtime Error",E),re.V.log("ERROR","Runtime Error",E)},window.onunhandledrejection=e=>{re.V.logApplication("ERROR","Unhandled Promise Rejection",{message:e.reason?e.reason.message:e.reason,stack:e.reason?e.reason.stack:null,requestFrom:s.B.BASE_APPLICATION,sessionId:o}),re.V.log("ERROR","Unhandled Promise Rejection",{message:e.reason?e.reason.message:e.reason,stack:e.reason?e.reason.stack:null,requestFrom:s.B.BASE_APPLICATION,sessionId:o})}}catch(o){console.warn("Failed to initialize global error handlers:",o)}}static logCatchError(){try{const o=console.error;console.log("Inside originalConsoleError...");const e=Ze.b.sessionId||"unknown";console.error=function(...n){const p="Console Error",y={arguments:n.map(C=>tr(C)),requestFrom:s.B.BASE_APPLICATION,sessionId:e};re.V.logApplication("ERROR",p,y),re.V.log("ERROR",p,y),o.apply(console,n)}}catch(o){console.warn("Failed to override console.error:",o)}}static logErrorEvent(){try{window.addEventListener("error",o=>{var e;console.log("Inside error event...");const n=Ze.b.sessionId||"unknown",p={error:((e=o.error)===null||e===void 0?void 0:e.message)||o.message,source:o.filename,line:o.lineno,column:o.colno,stack:o.error?tr(o.error.stack):void 0,requestFrom:s.B.BASE_APPLICATION,sessionId:n},y="Unhandled Error";re.V.logApplication("ERROR",y,p),re.V.log("ERROR",y,p)})}catch(o){console.warn("Failed to add error event listener:",o)}}static logUnhandledError(){try{window.addEventListener("unhandledrejection",o=>{var e,n;console.log("Inside unhandledrejection...");const p=Ze.b.sessionId||"unknown",y={reason:((e=o.reason)===null||e===void 0?void 0:e.message)||String(o.reason),stack:((n=o.reason)===null||n===void 0?void 0:n.stack)||"No stack trace available",requestFrom:s.B.BASE_APPLICATION,sessionId:p};re.V.logApplication("ERROR","Unhandled Promise Rejection",y),re.V.log("ERROR","Unhandled Promise Rejection",y)})}catch(o){console.warn("Failed to add unhandled rejection event listener:",o)}}static logUserInteractions(){document.addEventListener("click",o=>{var e;const n=Ze.b.sessionId||"unknown",p=o.target,y={element:p.tagName,id:p.id,classes:p.className,text:(e=p.innerText)===null||e===void 0?void 0:e.slice(0,50),requestFrom:s.B.BASE_APPLICATION,sessionId:n};re.V.logApplication("INFO","User Click",y)}),document.addEventListener("input",o=>{const e=o.target;Ze.b.sessionId,e.tagName,e.id,e.value,s.B.BASE_APPLICATION}),document.addEventListener("scroll",()=>{Ze.b.sessionId,s.B.BASE_APPLICATION})}static logNetworkRequests(){try{if(typeof window===void 0)return;const o=Ze.b.sessionId||"unknown",e=window?.fetch;if(!e)throw new Error("Original fetch is not available.");const n=[s.B.PostLogger(),s.B.PostPrefetchConceptConnections()];window.fetch=(...p)=>{return y=this,C=void 0,g=function*(){const[c,t]=p,G=c instanceof Request?c.url:c instanceof URL?c.toString():c;if(n.includes(G))return console.log("Ignored URLs detected : ",G),e(...p);let F={request:{type:"REQUEST",message:"Network Request",method:t?.method||"GET",url:G,body:t?.body,requestFrom:s.B.BASE_APPLICATION,sessionId:o}};try{const V=yield e(...p);return F.response={type:"RESPONSE",message:"Network Response",url:G,status:V.status,requestFrom:s.B.BASE_APPLICATION,sessionId:o},V}catch(V){throw F.response={type:"ERROR",message:"Network Request Failed",url:G,error:V instanceof Error?V.message:String(V),requestFrom:s.B.BASE_APPLICATION,sessionId:o},re.V.logApplication("ERROR","Failed Network Request",F),new Error(`Network request failed for ${G}: ${V.message}`)}},new((E=void 0)||(E=Promise))(function(c,t){function G(P){try{V(g.next(P))}catch(z){t(z)}}function F(P){try{V(g.throw(P))}catch(z){t(z)}}function V(P){var z;P.done?c(P.value):(z=P.value,z instanceof E?z:new E(function(te){te(z)})).then(G,F)}V((g=g.apply(y,C||[])).next())});var y,C,E,g}}catch(o){console.warn("Failed to override network requests:",o)}}static logPerformanceMetrics(){typeof window!==void 0&&window?.addEventListener("load",()=>{const o=performance.timing;Ze.b.sessionId,o.loadEventEnd,o.navigationStart,o.domContentLoadedEventEnd,o.navigationStart,s.B.BASE_APPLICATION})}static logRouteChanges(){const o=history.pushState,e=Ze.b.sessionId||"unknown";history.pushState=function(...n){var p;const y={url:(p=n[2])===null||p===void 0?void 0:p.toString(),requestFrom:s.B.BASE_APPLICATION,sessionId:e};return re.V.logApplication("INFO","Route Change",y),o.apply(this,n)},window?.addEventListener("popstate",()=>{const n={url:location.href,requestFrom:s.B.BASE_APPLICATION,sessionId:e};re.V.logApplication("INFO","Route Changed (Back/Forward)",n)})}static logWebSocketEvents(){if(typeof window===void 0)return;const o=Ze.b.sessionId||"unknown",e=WebSocket;window.WebSocket=class extends e{constructor(n,p){super(n,p);const y={url:n.toString(),requestFrom:s.B.BASE_APPLICATION,sessionId:o};re.V.logApplication("INFO","WebSocket Open",y),this.addEventListener("message",C=>{const E={url:n,data:C.data,requestFrom:s.B.BASE_APPLICATION,sessionId:o};re.V.logApplication("INFO","WebSocket Message",E)}),this.addEventListener("error",C=>{const E={url:n,error:C instanceof Error?C.message:String(C),requestFrom:s.B.BASE_APPLICATION,sessionId:o};re.V.logApplication("ERROR","WebSocket Error",E)}),this.addEventListener("close",()=>{const C={url:n,requestFrom:s.B.BASE_APPLICATION,sessionId:o};re.V.logApplication("INFO","WebSocket Closed",C)})}}}}function tr(_){try{return JSON.stringify(_,(o,e)=>e&&typeof e=="object"&&e instanceof Error?{message:e.message,stack:e.stack}:e)}catch{return"Error while serializing value"}}const nr=(_,o,...e)=>{return n=void 0,p=[_,o,...e],C=function*(E,g,c=!1){try{let t=s.B.sendMail();c&&(t=s.B.sendBulkMail());const G=yield fetch(t,{method:"POST",body:E instanceof FormData?E:JSON.stringify(E),headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}}),F=G.headers.get("content-type");if(!G.ok){const P=yield G.json();return console.info(`${G.status} ${P}`),null}const V=yield G.json();return F&&F.includes("text/plain")?yield G.text():V}catch(t){return console.error(t),null}},new((y=void 0)||(y=Promise))(function(E,g){function c(F){try{G(C.next(F))}catch(V){g(V)}}function t(F){try{G(C.throw(F))}catch(V){g(V)}}function G(F){var V;F.done?E(F.value):(V=F.value,V instanceof y?V:new y(function(P){P(V)})).then(c,t)}G((C=C.apply(n,p||[])).next())});var n,p,y,C};class kc{constructor(){this.inDevelopment=!1,this.subscribers=[]}notify(o=null){this.subscribers.map(e=>{e(o||this.data)})}dataChange(o){this.subscribers.push(o)}}class Nc extends kc{constructor(){super(...arguments),this.element=null,this.elementIdentifier=0,this.widgetMounted=!1}getComponent(){return this.element}getElementById(o){let e=this.getComponent(),n=document.body;if(e){let p=e.querySelector("#"+o);if(p)return n=p,n}return null}createWidgetWrapperIdentifier(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier.toString()}}class Mn extends Nc{constructor(){super(...arguments),this.html="",this.css="",this.js="",this.state={},this.previousState={},this.childWidgets=[],this.childWidgetElement=[],this.widgetState={},this.parentElement=""}querySelector(o){return this.element?this.element.querySelector(o):null}querySelectorAll(o){return this.element?this.element.querySelectorAll(o):null}getElement(){return this.element}setTitle(o){document.title=o}getHtml(){return this.html}UpdateChildData(o,e){let n=e;n.data=o,n.render(),n.update()}update(){}setState(o){this.previousState=Object.assign({},this),this.data=o,this.state=Object.assign({},this),this.hasStateChanged()&&(this.notify(),this.render())}setStateProperty(o){this.previousState=Object.assign({},this),Object.assign(this,o),this.state=Object.assign({},this),this.hasStateChanged()&&(this.notify(),this.render())}hasStateChanged(){return!this.isPropertyEqual(this.state,this.previousState)}isPropertyEqual(o,e){if(o===e)return!0;if(typeof o!="object"||typeof e!="object"||o===null||e===null)return!1;const n=Object.keys(o),p=Object.keys(e);if(n.length!==p.length)return!1;for(let y of n){if(!p.includes(y))return!1;for(let C of p)if(y==C&&y!="state"&&y!="previousState"&&o[y]!=e[y])return!1}return!0}loadChildWidgets(){this.childWidgets.map(o=>{let e=this.getElementById(o.parentElement);e&&(e.innerHTML=""),o.mount(e)})}render(){this.element&&(this.element.innerHTML=this.getHtml()),this.loadChildWidgets(),this.after_render()}getElementByClassName(o){let e=this.getComponent();return e?e?.querySelectorAll("."+o):[]}mount_child(){}mount(o){return e=this,n=void 0,y=function*(){o&&(this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier(),this.element.innerHTML=this.getHtml(),this.element.classList.add("mftsccs-marking-rendered"),o.appendChild(this.element),this.parentElement=o.id,this.before_render(),this.mount_child(),this.widgetMounted=!0)},new((p=void 0)||(p=Promise))(function(C,E){function g(G){try{t(y.next(G))}catch(F){E(F)}}function c(G){try{t(y.throw(G))}catch(F){E(F)}}function t(G){var F;G.done?C(G.value):(F=G.value,F instanceof p?F:new p(function(V){V(F)})).then(g,c)}t((y=y.apply(e,n||[])).next())});var e,n,p,y}before_render(){this.render()}after_render(){console.log("this is calling the after render",this)}renderChildWidgets(){function o(e){var n;e&&((n=e.childWidgets)===null||n===void 0||n.forEach(p=>{o(p)}),e.render())}console.log("this is the render child widget",this),this.childWidgets.forEach(e=>{o(e)})}setWidgetState(o,e){this.widgetState[o]=e,function n(p){p&&Array.isArray(p.childWidgets)&&p.childWidgets.forEach(y=>{y.widgetState=Object.assign(Object.assign({},y.widgetState),p.widgetState),n(y)})}(this),this.renderChildWidgets()}getWidgetState(o,e){return Object.keys.length&&this.widgetState[o]?this.widgetState[o]:e}}var on=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};class bn extends Mn{constructor(){super(...arguments),this.childComponents=[],this.componentMounted=!1,this.oldHtml=null,this.phonebooks=[],this.childrenData={},this.childWidgets=[],this.typeValueList=[],this.widgetType="the_element_name",this.parentConceptList=[],this.customFunctions=[]}getUserId(){return on(this,void 0,void 0,function*(){const o=yield new Promise(e=>{let n=(localStorage==null?void 0:localStorage.getItem("profile"))||"";n?e(JSON.parse(n)):e()});return o?.userId})}getTypeValueList(){return on(this,arguments,void 0,function*(o=""){return new Promise(e=>on(this,void 0,void 0,function*(){const n=(o=this.widgetType)==null?void 0:o.match(/^[a-z0-9]+_[a-z0-9]+/i),p=n?n[0]:"",y=o?.match(/^([a-z0-9]+).*_([a-z0-9]+)$/i),C=y?`${y[1]}_${y[2]}`:"";let E=[],g=new On;g.type=C,g.search="1",g.logicoperator=">",g.name="emailfilter",g.operateon="entityEmail",g.composition=!1,E.push(g);let c=new wt;c.typeConnection=o,c.name="entityEmail";let t=new wt;t.type=p,t.filterLogic="( emailfilter )",t.filters=E,t.name="top",t.inpage=100,t.freeschemaQueries=[c],t.outputFormat=Me.y0,Tn(t,"").subscribe(G=>{if(G?.length){const F=G?.map(V=>{var P,z,te,le,ke,ie,we;const De=(le=(te=(z=(P=V.data)===null||P===void 0?void 0:P[p])===null||z===void 0?void 0:z[o])===null||te===void 0?void 0:te.data)===null||le===void 0?void 0:le[C];return{id:(we=(ie=(ke=V.data)===null||ke===void 0?void 0:ke[p])===null||ie===void 0?void 0:ie[o])===null||we===void 0?void 0:we.id,name:De,text:De}});return this.typeValueList=F,e(F),F}})}))})}setTitle(o){document.title=o}getHtml(){return this.html}createRandomNumber(){return this.elementIdentifier=1e4*Math.random(),this.elementIdentifier}mount_child(){return on(this,void 0,void 0,function*(){try{new Function("tsccs",`
        return (async function() {
          ${this.mountChildWidgetsFunction}
        }).call(this);
      `).bind(this)(B)}catch(o){throw console.log("This is the error in the mount child",o),o}})}setProperty(o){return on(this,void 0,void 0,function*(){return this.widgetType=o,this.getTypeValueList(this.widgetType).then(()=>{var e,n,p;(e=this.element)===null||e===void 0||e.setAttribute("data-type-value",this.widgetType),(p=(n=this.element)===null||n===void 0?void 0:n.parentElement)===null||p===void 0||p.setAttribute("data-type-value",this.widgetType),this.render()}),this})}createTypeEditor(o){(function(e,n){if(e){const p=document.querySelector("#widget-properties #widget-type"),y=p?.querySelectorAll("input");y?.forEach(t=>{t?.remove()});const C=e.target.closest(".added-widget-container"),E=e.target.closest("div");C?C?.getAttribute("data-type-value"):E&&E?.getAttribute("data-type-value");const g=document.createElement("input");g.setAttribute("type","text"),g.setAttribute("name","input-widgetTypeValue"),g.setAttribute("of",n.elementIdentifier.toString()),g.setAttribute("class","form-control"),g.setAttribute("id","widgetType"),g.setAttribute("onchange","updateWidgetTypeValue(event)"),n.widgetType?g.value=n.widgetType:g.setAttribute("placeholder","e.g. the_entity");let c=n;g.addEventListener("change",function(t){var G,F,V;const P=(G=t?.target)===null||G===void 0?void 0:G.value;c.widgetType=P,c.before_render(),c.loadChildWidgets(),(V=(F=c.element)===null||F===void 0?void 0:F.parentElement)===null||V===void 0||V.setAttribute("data-type-value",c.widgetType)}),p?.appendChild(g)}})(o,this)}mount(o){return on(this,void 0,void 0,function*(){if(o){this.element=document.createElement("div"),this.element.id=this.createWidgetWrapperIdentifier();let e=this;this.inDevelopment?(this.element.onclick=function(n){n.preventDefault(),e.createTypeEditor(n)},this.element.className="mftsccs-marking-element"):this.element.classList.add("mftsccs-marking-rendered"),this.element.innerHTML=this.getHtml(),o?.setAttribute("data-type-value",e.widgetType),o.appendChild(this.element),this.parentElement=o.id,this.componentMounted==0||this.widgetMounted==0?(this.render_custom_functions(),this.before_render(),this.mount_child(),this.widgetMounted=!0,this.componentMounted=!0):this.render(),this.childWidgetElement=this.getElementByClassName("added-widget-container")}})}render_custom_functions(){var o;const e=(o=this.customFunctions)===null||o===void 0?void 0:o.map(n=>n?.code).join("");try{new Function("tsccs",`
          return (async function() {
            ${e}
          }).call(this);
        `).bind(this)(B)}catch(n){throw console.error("This is the error in the render_custom_functions",n),n}}before_render(){try{new Function("tsccs",`
        return (async function() {
          ${this.componentDidMountFunction}
        }).call(this);
      `).bind(this)(B)}catch(o){throw console.log("This is the error in the before render",o),o}}after_render(){try{new Function("tsccs",`
        return (async function() {
          ${this.addEventFunction}
        }).call(this);
      `).bind(this)(B)}catch(o){throw console.log("This is the error in the after render",o),o}}CreateConnectionBetweenEntityLocal(o,e,n){return on(this,void 0,void 0,function*(){var p;const y=o.userId,C=((p=o.type)===null||p===void 0?void 0:p.characterValue)+"_"+n,E=yield(0,Le.$)(C,999,999,y);return yield(0,Et.F)(o.id,e.id,E.id,1e3),"connection created"})}}var Ac=m(3077),gt=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};class Io{constructor(){this.actions={concepts:[],connections:[]},this.success=!0,this.transactionId=Math.random().toString().substring(5)}initialize(){return gt(this,void 0,void 0,function*(){yield nn.H.initializeTransaction(this.transactionId)})}commitTransaction(){return gt(this,void 0,void 0,function*(){if(!this.success)throw Error("Query Transaction Expired");yield nn.H.SyncDataOnline(this.transactionId),this.actions={concepts:[],connections:[]},this.success=!1})}commitTransactionWithoutAuth(){return gt(this,void 0,void 0,function*(){if(!this.success)throw Error("Query Transaction Expired");yield nn.H.SyncDataOnlineWithoutAuth(this.transactionId),this.actions={concepts:[],connections:[]},this.success=!1})}rollbackTransaction(){return gt(this,void 0,void 0,function*(){this.success=!1,this.actions={concepts:[],connections:[]},yield nn.H.rollbackTransaction(this.transactionId,this.actions)})}markAction(){return gt(this,void 0,void 0,function*(){yield nn.H.markTransactionActions(this.transactionId,this.actions)})}MakeTheInstanceConceptLocal(o,e){return gt(this,arguments,void 0,function*(n,p,y=!1,C,E,g=999,c=0){try{if(!this.success)throw Error("Query Transaction Expired");const t=yield(0,pe.k)(n,p,y,C,E,g,c,this.actions);return yield this.markAction(),t}catch(t){throw console.log(t),this.success=!1,t}})}MakeTheTypeConceptLocal(o,e,n,p){return gt(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const y=yield(0,Le.$)(o,e,n,p,this.actions);return yield this.markAction(),y}catch(y){throw console.log(y),this.success=!1,y}})}CreateTheConceptLocal(o,e,n,p,y,C){return gt(this,arguments,void 0,function*(E,g,c,t,G,F,V=!1,P=0,z={concepts:[],connections:[]}){try{if(!this.success)throw Error("Query Transaction Expired");const te=yield(0,Ac.A)(E,g,c,t,G,F,V,P,this.actions);return yield this.markAction(),te}catch(te){throw console.log(te),this.success=!1,te}})}CreateConnectionBetweenTwoConceptsLocal(o,e,n){return gt(this,arguments,void 0,function*(p,y,C,E=!1){try{if(!this.success)throw Error("Query Transaction Expired");const g=yield(0,yo.h)(p,y,C,E,this.actions);return yield this.markAction(),g}catch(g){throw console.log(g),this.success=!1,g}})}CreateTheConnectionLocal(o,e,n){return gt(this,arguments,void 0,function*(p,y,C,E=1,g="",c=999){try{if(!this.success)throw Error("Query Transaction Expired");const t=yield(0,Et.F)(p,y,C,E,g,c,this.actions);return yield this.markAction(),t}catch(t){throw console.log(t),this.success=!1,t}})}CreateConnection(o,e,n){return gt(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const p=yield(0,Et.d)(o,e,n,this.actions);return yield this.markAction(),p}catch(p){throw console.log(p),this.success=!1,p}})}CreateConnectionBetweenEntityLocal(o,e,n){return gt(this,void 0,void 0,function*(){try{if(!this.success)throw Error("Query Transaction Expired");const p=yield Ao(o,e,n,this.actions);return yield this.markAction(),p}catch(p){throw console.log(p),this.success=!1,p}})}CreateTheCompositionLocal(o){return gt(this,arguments,void 0,function*(e,n=null,p=null,y=null,C=null,E=null,g=null,c=!1){try{if(!this.success)throw Error("Query Transaction Expired");const t=yield(0,Q.R)(e,n,p,y,C,E,g,c,this.actions);return yield this.markAction(),t}catch(t){throw console.log(t),this.success=!1,t}})}}const or={number:/^\d+(\.\d+)?$/,text:/^[\s\S]*$/,textOnly:/^[A-Za-z\s]+$/,email:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,document:/\.(pdf|docx?|pptx?|xlsx?)$/i,sound:/\.(mp3|wav|ogg|flac)$/i,image:/\.(jpg|jpeg|png|gif|bmp|svg|webp)$/i,video:/\.(mp4|avi|mov|mkv|flv|webm)$/i,url:/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,date:/^\d{4}-\d{2}-\d{2}$/,time:/^(?:[01]\d|2[0-3]):[0-5]\d$/,password:/^.{6,}$/,ipaddress:/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([0-9a-fA-F]{1,4}:){7}([0-9a-fA-F]{1,4})$/,uuid:/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/};var mn=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};class Qe{constructor(){Qe.cacheInitialized||Qe.initializeAnomalyParameters()}static initializeAnomalyParameters(){return mn(this,void 0,void 0,function*(){try{yield Qe.getAnomalyParameters(),Qe.refreshCache(),Qe.cacheInitialized=!0}catch(o){console.error("Error during anomaly parameter initialization:",o)}})}static getAnomalyParameters(){return mn(this,void 0,void 0,function*(){const o=Date.now();if(Qe.anomalyParamsCache&&o-Qe.lastFetchedTime<Qe.cacheExpiryThreshold)return console.log("Returning cached anomaly parameters"),Qe.anomalyParamsCache;try{return yield Qe.fetchAnomalyParameters()}catch(e){throw console.error("Error fetching anomaly parameters:",e),e}})}static fetchAnomalyParameters(){return mn(this,void 0,void 0,function*(){try{const o=yield fetch("https://devai.freeschema.com/v1/get-frontend-anomaly-parameters",{method:"GET",headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error("Failed to fetch anomaly parameters");const e=yield o.json();return Qe.anomalyParamsCache=e.data,Qe.lastFetchedTime=Date.now(),e.data}catch(o){throw console.error("API Fetch Error:",o),o}})}static refreshCache(){return mn(this,void 0,void 0,function*(){try{Date.now()-Qe.lastFetchedTime>Qe.cacheExpiryThreshold&&(yield Qe.getAnomalyParameters())}catch(o){console.error("Error refreshing anomaly parameters cache:",o)}})}detectDataType(o){for(const[e,n]of Object.entries(or))if(n.test(o))return e;return null}checkConceptAnomaly(o,e){return mn(this,void 0,void 0,function*(){const n=[];try{if(!e)return n.push("Null value"),{valid:!1,warnings:n};const p=Qe.anomalyParamsCache;o.startsWith("the_")||(o=`the_${o}`);const y=p[o];if(console.log("Concept Details : ",y),!y)return console.warn(`No concept details found for type: ${o}`),n.push(`No concept details found for type: ${o}`),{valid:!1,warnings:n};const C=e.length,{min_length:E,max_length:g,data_types:c}=y,t=C>=E&&C<=g,G=this.detectDataType(e),F=c.includes(G);return t||n.push(`Length of '${e}' is outside the allowed range (min: ${E}, max: ${g}). Current length: ${C}.`),F||n.push(`Type mismatch for '${e}'. Expected types: ${c.join(", ")}, detected type: ${G}.`),t&&F&&n.push(`Concept ${o} is valid. Length: ${C}, Type: ${G}`),{valid:t&&F,warnings:n}}catch(p){return console.error(`Error checking anomaly for ${o} with value ${e}:`,p),{valid:!1,warnings:n}}})}static checkAnomalyInBulk(o){return mn(this,void 0,void 0,function*(){Qe.cacheInitialized||(yield Qe.initializeAnomalyParameters());try{const e={};for(const[n,p]of Object.entries(o)){const y=p.value,{valid:C,warnings:E}=yield new Qe().checkConceptAnomaly(n,y);e[n]={valid:C,warnings:E}}return e}catch(e){throw console.error("Bulk Anomaly Check Error:",e),e}})}static getExportedFunction(){console.log("Main : ",B);const o=Object.keys(B);return console.log("The exported List : ",o),o}static getFunctionaAnomalyParameters(){}}Qe.anomalyParamsCache=null,Qe.cacheInitialized=!1,Qe.lastFetchedTime=0,Qe.cacheExpiryThreshold=6e5;var wo=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};class ir{checkUniqueness(o,e){return wo(this,void 0,void 0,function*(){const n=re.V.logfunction("checkUniqueness");o.startsWith("the_")||(o="the_"+o);let p=(yield $e(o,999)).id,y=yield(0,ce.A)(e,p);return console.log("This is the concept for validator",y),!(y.id>0||(re.V.logUpdate(n),0))})}validateField(o){return wo(this,void 0,void 0,function*(){var e;const n=re.V.logfunction("validateField");try{performance.now();const p={},{name:y,value:C,type:E,dataType:g,pattern:c,conceptType:t,maxLength:G,minLength:F,minValue:V,maxValue:P,accept:z,file:te,required:le,isUnique:ke}=o;if(console.log(`Validation is happening on : 
`,o),!le||C!==null&&C!==""||(p.required=`The field ${y} is required.`),g&&C){let ie=or[g];ie&&C!==""&&!ie.test(C)&&(p.dataType=`Invalid value for ${g}`)}if(c&&C){const ie=typeof c=="string"?new RegExp(c):c;C===""||ie.test(C)||(p.pattern="Pattern doesn't match with value")}if(C&&G!=null&&C.length>G&&(p.maxLength=`Length exceeds the maximum length of ${G}`),C&&F!=null&&C.length<F&&(p.minLength=`Length must be at least ${F} characters long`),V!=null&&C&&!isNaN(Number(C))&&Number(C)<V&&(p.minValue=`Value must be greater than or equal to ${V}`),P!=null&&C&&!isNaN(Number(C))&&Number(C)>P&&(p.maxValue=`Value must be less than or equal to ${P}`),te&&E&&z){const ie=z.split(",").map(De=>De.trim().toLowerCase()),we=(e=te.name.split(".").pop())===null||e===void 0?void 0:e.toLowerCase();we&&!ie.includes(we)&&(p.accept=`File must be a valid file type: ${ie.join(", ")}`)}return t&&ke&&C&&((yield this.checkUniqueness(t,C))||(p.unique="Value is not unique")),re.V.logUpdate(n),console.log("Before Validation Result : ",p),p}catch(p){throw(0,u.ey)(n,"Validator.validateField",p),p}})}validateForm(o){return wo(this,void 0,void 0,function*(){const e=re.V.logfunction("validateForm");try{performance.now();const n={};for(const p in o){const y=yield this.validateField(o[p]);Object.keys(y).length>0&&(n[p]=y)}return re.V.logUpdate(e),n}catch(n){throw(0,u.ey)(e,"Validator.validateForm",n),n}})}validate(o){const e=re.V.logfunction("validate");try{let n={};return this.validateField(o).then(p=>{Object.keys(p).length>0?(n.status=!1,n.details=p):n.status=!0}),console.error("Error on validate object"),re.V.logUpdate(e),n}catch(n){(0,u.ey)(e,"Validator.validate",n)}}}const rr=_=>{var o;const e=document.getElementsByName(_)[0];if(!e)return console.warn(`Element with NAME "${_}" not found.`),{name:null,value:null,type:null,dataType:null,pattern:null,conceptType:null,maxLength:null,minLength:null,minValue:null,maxValue:null,accept:null,file:null,required:!1,isUnique:!0};const n=e.hasAttribute("required")||e.getAttribute("data-required")==="true",p=e.hasAttribute("isUnique")&&e.getAttribute("isUnique")==="true";return{name:e.name,value:e.value,type:e.type,dataType:e.getAttribute("data-type"),pattern:e.getAttribute("data-pattern"),conceptType:e.getAttribute("concept-type"),maxLength:e.getAttribute("maxlength")?parseInt(e.getAttribute("maxlength")):null,minLength:e.getAttribute("minlength")?parseInt(e.getAttribute("minlength")):null,minValue:e.getAttribute("min")?parseInt(e.getAttribute("min")):null,maxValue:e.getAttribute("max")?parseInt(e.getAttribute("max")):null,accept:e.getAttribute("accept")||null,file:e.type==="file"&&((o=e.files)===null||o===void 0?void 0:o[0])||null,required:n,isUnique:p}};var Cn=m(2289);class wt{constructor(){this.type="",this.inpage=10,this.page=1,this.concepts=[],this.conceptIds=[],this.selectors=[],this.freeschemaQueries=[],this.filters=[],this.filterLogic="",this.typeConnection="",this.order="DESC",this.outputFormat=Me.yv,this.name="",this.filterAncestor="",this.reverse=!1,this.limit=!1,this.isSecure=!1,this.includeInFilter=!1,this.isOldConnectionType=!1}}var Lc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function Pn(_){var o=arguments;return Lc(this,arguments,void 0,function*(e,n=""){const p=re.V.logfunction("FreeschemaQueryApi",o);var y=(0,i.ab)("application/json",n);const C=s.B.FreeschemaQueryUrl(),E=JSON.stringify(e);try{const g=yield fetch(C,{method:"POST",headers:y,body:E});return g.ok?yield g.json():((0,u.ry)(g),console.log("This is the freeschema query error",g.status),[])}catch(g){console.log("This is the freeschema query error others",g),(0,u.Mb)(g,C),(0,u.ey)(p,"FreeschemaQueryApi",g)}})}var ko=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};class cr extends qt.w{constructor(o,e){super(),this.query=new wt,this.countInfoStrings=[],this.order="DESC",this.totalCount=0,this.query=o,this.format=o.outputFormat,this.order=o.order}run(){return ko(this,void 0,void 0,function*(){var o,e;this.query.outputFormat=Me.BG,this.compositionIds=[];let n=yield Pn(this.query,"");return this.conceptIds=n.conceptIds,this.internalConnections=(o=n.internalConnections)!==null&&o!==void 0?o:[],this.linkers=(e=n.linkers)!==null&&e!==void 0?e:[],this.reverse=n.reverse,this.compositionIds=n.mainCompositionIds,this.totalCount=n.mainCount,this.countInfoStrings=n.countinfo,yield this.build()})}bind(){return ko(this,void 0,void 0,function*(){var o,e;if(this.compositionIds.length>0)for(let p=0;p<this.compositionIds.length;p++)this.removeListenToEvent(this.compositionIds[p]);if(this.isDataLoaded)for(let p=0;p<this.compositionIds.length;p++)this.listenToEvent(this.compositionIds[p]);else{this.query.outputFormat=Me.BG,this.compositionIds=[];let p=yield Pn(this.query,"");this.conceptIds=p.conceptIds,this.internalConnections=(o=p.internalConnections)!==null&&o!==void 0?o:[],this.linkers=(e=p.linkers)!==null&&e!==void 0?e:[],this.reverse=p.reverse,this.compositionIds=p.mainCompositionIds,this.totalCount=p.mainCount,this.countInfoStrings=p.countinfo}let n=yield this.build();if(!this.isDataLoaded){this.isDataLoaded=!0;for(let p=0;p<this.compositionIds.length;p++)this.listenToEvent(this.compositionIds[p]);if(this.query.type!=""){let p=yield $e(this.query.type,999);p.id>0&&this.listenToEventType(p.id)}}for(let p=0;p<this.newIds.length;p++)this.listenToEvent(this.newIds[p]);return this.newIds=[],n})}build(){return ko(this,void 0,void 0,function*(){re.V.logfunction("build",["schemaquery",this.compositionIds]);let o=(0,To.w)(this.countInfoStrings);return this.format==Me.y0?this.data=yield(0,Qt.e$)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o,this.order):this.format==Me.ZJ?this.data=yield(0,Qt.y6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o,this.order):this.format==Me.pU?this.data=yield(0,Qt.rq)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o,this.order):this.format==Me.XZ?(console.log("this is the raw format"),this.data={},this.data.linkers=this.linkers,this.data.conceptIds=this.conceptIds,this.data.compositionIds=this.compositionIds,this.data.reverse=this.reverse,this.data.countInfos=o,this.data.order=this.order):this.data=yield(0,Qt.b6)(this.linkers,this.conceptIds,this.compositionIds,this.reverse,o),this.data})}}function Tn(_,o){return new cr(_,o)}function sr(_,o){return new cr(_,o).execute()}class No{constructor(){this.id=0,this.name="",this.html="",this.css="",this.js="",this.library={css:[],js:[]},this.assistant={id:"",input:"",type:""},this.timestamp="",this.widgetId=0,this.type="",this.clean="",this.after_render="",this.before_render="",this.custom_functions=[],this.update="",this.origin=0,this.version=0,this.mount_child="",this.children=[],this.wrapper="0",this.widget=new bn}}var Sc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function Ao(_,o,e){return Sc(this,arguments,void 0,function*(n,p,y,C={concepts:[],connections:[]}){var E,g,c,t,G;const F=re.V.logfunction("CreateConnectionBetweenEntityLocal",[n.id,p.id,y]);if(Fe)try{const te=yield je("CreateConnectionBetweenEntityLocal",{concept1Data:n,concept2Data:p,linker:y,actions:C});return!((g=(E=te?.actions)===null||E===void 0?void 0:E.concepts)===null||g===void 0)&&g.length&&(C.concepts=JSON.parse(JSON.stringify(te.actions.concepts))),!((t=(c=te?.actions)===null||c===void 0?void 0:c.connections)===null||t===void 0)&&t.length&&(C.connections=JSON.parse(JSON.stringify(te.actions.connections))),te.data}catch(te){console.log("CreateConnectionBetweenEntityLocal error sw: ",te),ze(te)}const V=n.userId,P=((G=n.type)===null||G===void 0?void 0:G.characterValue)+"_"+y,z=yield(0,Le.$)(P,999,999,V,C);console.log(yield(0,Et.F)(n.id,p.id,z.id,1e3,void 0,void 0,C)),re.V.logUpdate(F)})}var rn=m(4310);function Lo(_){for(;_.firstChild;)_.removeChild(_.firstChild)}var ar=m(490),lr=m(276);class dr extends Mn{constructor(o,e,n,p="",y=10){super(),this.inpage=10,this.selector=e,this.mainType=o,this.filterType=p,this.inpage=y,this.parentDomElement=n,this.mount(this.parentDomElement)}before_render(){this.render()}addFilter(o){if(o!=""){let e=new On;e.search=o,e.type=this.filterType,e.logicoperator="like",e.operateon="selector",e.name="selector_filter";let n="( selector_filter )";this.query.filters=[e],this.query.filterLogic=n}else this.query.filters=[],this.query.filterLogic="";console.log("this is the filters",this.query)}after_render(){let o=this.getElementById("selector"),e=this.getElementById("search-bar"),n=this;e.onchange=()=>{n.addFilter(e.value),n.mainDetails.update()};let p=new wt;p.type=this.mainType,p.inpage=this.inpage;let y=new wt;y.typeConnection=this.selector,y.name="selector",p.freeschemaQueries=[y],this.query=p,Tn(this.query,"").subscribe((C,E)=>{let g={};this.mainDetails=E;for(let c=0;c<C.length;c++){let t=C[c],G=t.id,F=t[this.mainType];if(console.log("this is the selected data myItem",F,C[c],this.mainType,t),F){let V=F[this.selector];if(V){const P=Object.values(V)[0];g[G]=P}}}Lo(o);for(const[c,t]of Object.entries(g)){const G=document.createElement("option");G.value=c,G.textContent=t,o.appendChild(G)}console.log("this is the output from selector",C)})}getHtml(){const o=document.createElement("style");return o.textContent=`
.search-select-wrapper {
  width: 300px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-family: Arial, sans-serif;
}

#search-bar {
  padding: 8px;
  font-size: 14px;
  border: 1px solid #ccc;
  border-radius: 6px;
}

#selector {
  padding: 6px;
  font-size: 14px;
  border: 1px solid #ccc;
  border-radius: 6px;
}
`,document.head.prepend(o),this.html=`
        <div class="search-select-wrapper">
        <input type="text" placeholder="Select or type..." id='search-bar'>
        <select id='selector'>
        </div>`,this.html}}const _c=`
/* CKEditor content styles */
.ck-content {
  /* Container styles */
  max-width: 100%;
  margin: 0 auto;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
  line-height: 1.5;
  padding: 0.75rem;
  background: #fff;
  color: #333;
  border: 1px solid #ccced1;
}

/* Headings */
.ck-content h1, .ck-content h2, .ck-content h3, 
.ck-content h4, .ck-content h5, .ck-content h6 {
  font-weight: 700;
  line-height: 1.2;
  margin: 1em 0 0.5em;
}

.ck-content h1 { font-size: 2.5em; }
.ck-content h2 { font-size: 2em; }
.ck-content h3 { font-size: 1.75em; }
.ck-content h4 { font-size: 1.5em; }
.ck-content h5 { font-size: 1.25em; }
.ck-content h6 { font-size: 1em; }

/* Paragraphs and spacing */
.ck-content p {
  margin: 1em 0;
  line-height: 1.6;
}

/* Links */
.ck-content a {
  color: #1a73e8;
  text-decoration: none;
}

.ck-content a:hover {
  text-decoration: underline;
}

/* Lists */
.ck-content ul,
.ck-content ol {
  padding-left: 2em;
  margin: 1em 0;
}

.ck-content ul {
  list-style: disc;
}

.ck-content ol {
  list-style: decimal;
}

.ck-content li {
  margin: 0.5em 0;
}

/* Blockquotes */
.ck-content blockquote {
  margin: 1em 0;
  padding-left: 1em;
  border-left: 5px solid #ccc;
  font-style: italic;
  color: #666;
}

/* Code blocks */
.ck-content pre {
  background: #f5f5f5;
  border: 1px solid #ddd;
  border-radius: 4px;
  padding: 1em;
  margin: 1em 0;
  overflow-x: auto;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.ck-content code {
  background: #f5f5f5;
  padding: 0.2em 0.4em;
  border-radius: 3px;
  font-size: 0.9em;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

/* Tables */
.ck-content table {
  border-collapse: collapse;
  width: 100%;
  margin: 1em 0;
}

.ck-content table th,
.ck-content table td {
  border: 1px solid #ddd;
  padding: 0.75em;
  text-align: left;
}

.ck-content table th {
  background: #f5f5f5;
  font-weight: bold;
}

/* Images */
.ck-content img {
  max-width: 100%;
  height: auto;
  margin: 1em 0;
}

.ck-content figure {
  margin: 1em 0;
  text-align: center;
}

.ck-content figure img {
  margin: 0;
}

.ck-content figcaption {
  color: #666;
  font-size: 0.9em;
  margin-top: 0.5em;
}

/* Dark mode */
/*
@media (prefers-color-scheme: dark) {
  .ck-content {
    background: #1a1a1a;
    color: #e0e0e0;
  }

  .ck-content a {
    color: #64b5f6;
  }

  .ck-content blockquote {
    border-left-color: #404040;
    color: #b0b0b0;
  }

  .ck-content pre,
  .ck-content code {
    background: #2d2d2d;
    border-color: #404040;
  }

  .ck-content table th,
  .ck-content table td {
    border-color: #404040;
  }

  .ck-content table th {
    background: #2d2d2d;
  }

  .ck-content figcaption {
    color: #b0b0b0;
  }
}
*/

/* CUSTOM DOCUMENTATION CSS */

#documentation-preview {
  border: 1px solid #ccc;
  padding: 1rem;
}

#documentation-preview h3 {
  font-size: 1.5rem;
  margin-bottom: 1rem;
}

.pre-wrapper {
  background: #f2f5f9;
  border: 1px solid #cecece;
  display: block;
  padding: 1rem;
  border-radius: 0.25rem;
  margin-top: 1rem;
  margin-bottom: 1rem;
}

.pre-wrapper pre {
  margin: 0;
  color: #e87aa2;
}

.widget-doc-section pre {
  background-color: transparent;
}

.widget-doc-section p {
  margin: 0;
}

.widget-doc-section code {
  color: #e87aa2;
  font-size: 0.875rem;
}

.mv-3 {
  margin-top: 1rem;
  margin-bottom: 1rem;
}

.pv-3 {
  padding-top: 1rem;
  padding-bottom: 1rem;
}

  .widget-documentation-heading {
    background-color: #6e757d;
    color: #eee;
    font-size: 1.5rem;
    padding: 0.5rem 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .widget-documentation-heading h4 {
    margin-bottom: 0;
  }

  .close-documentation-button {
    border: none;
    outline: none;
    background-color: transparent;
    line-height: 0;
    margin: 0;
    padding: 0;
    cursor: pointer;
  }

  .close-documentation-button:hover,
  .close-documentation-button:focus  {
    background-color: transparent;
  }

  .documentation-creator {
    text-align: right;
    color: #666;
    margin: 0;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
  }

  .documentation-creator span {
    font-style: italic;
  }

  .documentation-attachments {
    display: flex;
    flex-wrap: wrap;
  }

  .documentation-attachments img {
    width: 25%;
    height: auto;
    border: 1px solid #ccc;
    padding: 0.25rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
  }

  .documentation-attachments iframe {
    width: 50%;
    border: 1px solid #ccc;
    padding: 0.25rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
  }

  .widget-documentation-footer {
    text-align: right;
    margin-top: 1rem;
  }

  .widget-documentation-footer button {
    border-radius: 0;
    border: none;
    padding: 0.5rem 1.5rem;
    text-align: center;
    background: #6e757d;
    color: #eee;
  }

  #widget-details {
    position: absolute;
    right: 0px;
    top: 0px;
    z-index: 9999;
  }

  #widget-details button {
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 0 0 0 0.25rem;
    height: auto;
    width: auto;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  #widget-details button:hover, 
  #widget-details button:focus {
    opacity: 0.75;
  }

  #widget-details button span {
    pointer-events: none;
    font-size: 1rem;
  }

  #widget-details button svg {
    pointer-events: none;
    width: 16px;
    height: 16px;
    fill: #999;
  }

  #widget-documentation-preview-modal {
    border: none;
  }

  @media (min-width: 768px) {
    #widget-documentation-preview-modal {
      flex: 0 0 auto;
      width: 66.66666667%;
    }
  }

`,Xt={PAGE_COMP_NAME:"page",WIDGET_COMP_NAME:"widget",PROJECT_COMP_NAME:"project"};var ur=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function Gn(_){const o=document.getElementById("fspage-properties");if(!o)return;let e=o?.textContent;e=e?e.replace(new RegExp(_,"g"),""):"",o.textContent=e}function hr(_,o){let e=document.querySelector(`meta[name="${_}"]`);e||(e=document.createElement("meta"),e.setAttribute("name",_),document.head.appendChild(e)),e.setAttribute("content",o)}var pr=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function fr(_){return pr(this,void 0,void 0,function*(){var o,e,n,p;!((e=(o=_?.library)===null||o===void 0?void 0:o.css)===null||e===void 0)&&e.length&&function(y){var C;const E=(C=y?.library)===null||C===void 0?void 0:C.css,g=`vde-css-${y?.origin?y?.origin:y?.widgetId}`;(function(c){const t=`link.${c}`,G=document.querySelectorAll(t);G?.length&&G?.forEach(F=>{F.remove()})})(g),E?.length&&E?.sort((c,t)=>Number(c?.order)-Number(t?.order)),E?.forEach(c=>{const t=document.createElement("link");t.classList.add(g),t.setAttribute("rel","stylesheet"),t.setAttribute("href",c.url),document.head.appendChild(t)})}(_),!((p=(n=_?.library)===null||n===void 0?void 0:n.js)===null||p===void 0)&&p.length&&(yield function(y){return pr(this,void 0,void 0,function*(){var C;const E=(C=y?.library)===null||C===void 0?void 0:C.js,g=`vde-js-${y?.origin?y?.origin:y?.widgetId}`;if(function(c){const t=`script.${c}`,G=document.querySelectorAll(t);G?.length&&G?.forEach(F=>{F.remove()})}(g),E?.length){E.sort((c,t)=>Number(c?.order)-Number(t?.order));for(const c of E)c?.url?document.querySelector(`script[src="${c.url}"]`)?console.log("Library already loaded:",c.url):yield new Promise((t,G)=>{const F=document.createElement("script");F.classList.add(g),F.setAttribute("type","text/javascript"),F.setAttribute("src",c.url),F.setAttribute("crossorigin","anonymous"),F.onload=()=>{t()},F.onerror=V=>{console.error("Failed to load script:",c.url,V),G(new Error(`Failed to load script: ${c.url}`))},document.head.appendChild(F)}):console.warn("Skipping library with invalid URL:",c);console.log("All JavaScript libraries loaded successfully")}})}(_))})}var it=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function yr(_,o,e,n){return it(this,void 0,void 0,function*(){var p;const y=yield ao(_,"the_page_body"),C=new wt;C.conceptIds=[_],C.inpage=100,C.outputFormat=Me.y0,C.selectors=["the_page_body","the_page_title","the_page_slug","the_page_font_family","the_page_font_size","the_page_width","the_page_type","the_page_meta_title","the_page_meta_description","the_page_meta_keywords"],Tn(C,"").subscribe(g=>it(this,void 0,void 0,function*(){var c,t;console.log("SchemaQueryListener data -->",g),yield function(G){return ur(this,void 0,void 0,function*(){var F,V,P,z,te,le,ke,ie,we,De,Pe,Je,qe,Ye;[{key:"meta_title",value:(V=(F=G?.[`the_${Xt.PAGE_COMP_NAME}_meta_title`])===null||F===void 0?void 0:F.data)===null||V===void 0?void 0:V.the_meta_title},{key:"meta_description",value:(z=(P=G?.[`the_${Xt.PAGE_COMP_NAME}_meta_description`])===null||P===void 0?void 0:P.data)===null||z===void 0?void 0:z.the_meta_description},{key:"meta_keywords",value:(le=(te=G?.[`the_${Xt.PAGE_COMP_NAME}_meta_keywords`])===null||te===void 0?void 0:te.data)===null||le===void 0?void 0:le.the_meta_keywords},{key:"width",value:(ie=(ke=G?.[`the_${Xt.PAGE_COMP_NAME}_width`])===null||ke===void 0?void 0:ke.data)===null||ie===void 0?void 0:ie.the_width},{key:"font_size",value:(De=(we=G?.[`the_${Xt.PAGE_COMP_NAME}_font_size`])===null||we===void 0?void 0:we.data)===null||De===void 0?void 0:De.the_font_size},{key:"font_family",value:(Je=(Pe=G?.[`the_${Xt.PAGE_COMP_NAME}_font_family`])===null||Pe===void 0?void 0:Pe.data)===null||Je===void 0?void 0:Je.the_font_family},{key:"type",value:(Ye=(qe=G?.[`the_${Xt.PAGE_COMP_NAME}_type`])===null||qe===void 0?void 0:qe.data)===null||Ye===void 0?void 0:Ye.the_type}].forEach(rt=>{rt.value&&function(vt,tt){ur(this,void 0,void 0,function*(){const Mt=document.getElementById("fspage-properties")||function(){const kt=document.createElement("style");return kt.id="fspage-properties",document.head.appendChild(kt),kt}();let mt="";switch(vt){case"width":Gn(".fspage { width: [^;]+ !important; }"),mt=tt?`.fspage { width: ${tt} !important; }`:"";break;case"font_size":Gn(".fspage { font-size: [^;]+; }"),mt=tt?`.fspage { font-size: ${tt}px; }`:"";break;case"font_family":Gn(".fspage { font-family: [^;]+; }"),mt=tt?`.fspage { font-family: ${tt}; }`:"";break;case"type":Gn(".fspage { width: 1200px; margin: 0 auto; }"),Gn(".fspage { width: 100%; padding: 0; }"),mt=tt==="fixed"?".fspage { width: 1200px; margin: 0 auto; }":tt==="fluid"?".fspage { width: 100%; padding: 0; }":"";break;case"meta_title":document.title=tt;break;case"meta_keywords":hr(vt.replace("meta_",""),tt);break;case"meta_description":return void hr(vt.replace("meta_",""),tt)}Mt.textContent+=mt})}(rt.key,rt.value)})})}((t=(c=g?.[0])===null||c===void 0?void 0:c.data)===null||t===void 0?void 0:t[`the_${Xt.PAGE_COMP_NAME}`])})),document.getElementById("app").classList.add("fspage");const E=document.head.querySelectorAll("style#mystyleid");Array.from(E).forEach(g=>g.remove()),!((p=y?.[0])===null||p===void 0)&&p.id?yield Vn(y[0].id,o,e,n):o.innerHTML="<h4>Invalid or Page doesn't exist</h4>"})}function Vn(_,o,e,n){return it(this,void 0,void 0,function*(){try{let p=yield(0,rn.qj)(_),y=p.mainId,C=p.data;const E=yield Cr(C,y);return yield vr(y,E,o,e,n)}catch(p){console.error(`Error Caught Rendering Widget: ${p}`),o.textContent=`Error: ${p.message}`}})}function gr(_,o,e,n){return it(this,void 0,void 0,function*(){try{const p=yield(0,rn.Cp)(_);return yield vr(_,p,o,e,n)}catch(p){console.error(`Error Caught Rendering Widget: ${p}`)}})}function vr(_,o,e,n){return it(this,arguments,void 0,function*(p,y,C,E,g=!0){const c=yield Bn(p,[],y);if(!c.name)return void(C.innerHTML="<h4>Invalid or Widget doesn't exist</h4>");const t=C;yield fr(c);const G=yield jn(c,t,void 0,E),F=Array.from({length:32},()=>"abcdef"[Math.floor(6*Math.random())]).join("");C.classList.add(`${F}`),C.style.position="relative";const V=document.createElement("style");V.id="mystyleid",V.innerHTML=`
  .${F} {
    ${c.css+G.css+_c} 
  }
`,c.children.length&&c?.children.forEach(z=>{var te;const le=z?.library;(!((te=le?.css)===null||te===void 0)&&te.length||le?.js.length)&&fr(z)}),document.head.appendChild(V);const P=document.createElement("script");if(P.innerHTML=c.js,t.appendChild(P),g){const z=document.createElement("div");z.id="widget-details",z.innerHTML="",z.innerHTML=`
        <button class="widget-documentation-btn" widget-id="${c?.origin||c?.widgetId}" class="d-flex align-items-center gap-1" title="Documentation">
          <svg xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 441 512.02"><path d="M324.87 279.77c32.01 0 61.01 13.01 82.03 34.02 21.09 21 34.1 50.05 34.1 82.1 0 32.06-13.01 61.11-34.02 82.11l-1.32 1.22c-20.92 20.29-49.41 32.8-80.79 32.8-32.06 0-61.1-13.01-82.1-34.02-21.01-21-34.02-50.05-34.02-82.11s13.01-61.1 34.02-82.1c21-21.01 50.04-34.02 82.1-34.02zM243.11 38.08v54.18c.99 12.93 5.5 23.09 13.42 29.85 8.2 7.01 20.46 10.94 36.69 11.23l37.92-.04-88.03-95.22zm91.21 120.49-41.3-.04c-22.49-.35-40.21-6.4-52.9-17.24-13.23-11.31-20.68-27.35-22.19-47.23l-.11-1.74V25.29H62.87c-10.34 0-19.75 4.23-26.55 11.03-6.8 6.8-11.03 16.21-11.03 26.55v336.49c0 10.3 4.25 19.71 11.06 26.52 6.8 6.8 16.22 11.05 26.52 11.05h119.41c2.54 8.79 5.87 17.25 9.92 25.29H62.87c-17.28 0-33.02-7.08-44.41-18.46C7.08 432.37 0 416.64 0 399.36V62.87c0-17.26 7.08-32.98 18.45-44.36C29.89 7.08 45.61 0 62.87 0h173.88c4.11 0 7.76 1.96 10.07 5l109.39 118.34c2.24 2.43 3.34 5.49 3.34 8.55l.03 119.72c-8.18-1.97-16.62-3.25-25.26-3.79v-89.25zm-229.76 54.49c-6.98 0-12.64-5.66-12.64-12.64 0-6.99 5.66-12.65 12.64-12.65h150.49c6.98 0 12.65 5.66 12.65 12.65 0 6.98-5.67 12.64-12.65 12.64H104.56zm0 72.3c-6.98 0-12.64-5.66-12.64-12.65 0-6.98 5.66-12.64 12.64-12.64h142.52c3.71 0 7.05 1.6 9.37 4.15a149.03 149.03 0 0 0-30.54 21.14H104.56zm0 72.3c-6.98 0-12.64-5.66-12.64-12.65 0-6.98 5.66-12.64 12.64-12.64h86.2c-3.82 8.05-6.95 16.51-9.29 25.29h-76.91zm239.61-18.85c7.41 7.43 4.68 18.9-3.05 25.23-7.46 6.01-20.97 8.92-28.68 1.83-7.77-7.23-4.68-18.87 2.76-25.24 7.18-6.05 21.39-9.37 28.97-1.82zm-43.88 95h6.34v-41.33H294.6c0-16.37 30.05-5.74 52.18-11.32v52.65h8.37v17.58h-54.86v-17.58z"/></svg>
        </button>
      `,t.appendChild(z);const te=document.createElement("dialog");te.id="widget-documentation-preview-modal",te.className="col-md-8",te.innerHTML="",te.innerHTML=`
        <div class="widget-documentation-heading">
          <h4>Documentation</h4>
          <button class="close-documentation-button document-preview-close-button" title="Close">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e8eaed"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>
          </button>
        </div>

        <!-- <div id="documentation-preview" class="ck-content"></div> -->
        <div id="documentation-view" class="ck-content"></div>

        <div class="widget-documentation-footer">
          <button class="document-preview-close-button">Close</button>
        </div>
      `,t.appendChild(te);const le=t.querySelectorAll(".widget-documentation-btn");le?.forEach(ie=>{ie.addEventListener("click",we=>{const De=we?.target;(function(Pe){it(this,void 0,void 0,function*(){console.log("openDocumentationPreviewModal widgetId",Pe);const Je=new wt;Je.typeConnection="the_widget_documentation",Je.name="documentationText",Je.selectors=["the_documentation_text"];const qe=new wt;qe.typeConnection="the_widget_s_documentation",qe.name="documentationBlank",qe.selectors=["the_documentation_text","the_documentation_content","the_documentation_language","the_documentation_doc_title","the_documentation_folder","the_documentation_creator_email","the_documentation_created_by","the_documentation_content","the_documentation_type","the_documentation_s_doc_url","the_documentation_s_image_url","the_documentation_s_video_link","the_documentation_auth_type","the_documentation_bearer_token","the_documentation_method","the_documentation_method_url","the_documentation_username","the_documentation_password","the_documentation_s_json_list","the_documentation_api_script","the_documentation_api_body","the_documentation_code_editor","the_documentation_return"];const Ye=new wt;Ye.typeConnection="the_documentation_s_json_list",Ye.name="documentationJSON",Ye.selectors=["the_json_list_key","the_json_list_value"],qe.freeschemaQueries=[Ye];const rt=new wt;rt.conceptIds=[Pe],rt.freeschemaQueries=[Je,qe],rt.inpage=100,rt.outputFormat=Me.y0,yield Tn(rt,"").subscribe(vt=>it(this,void 0,void 0,function*(){var tt,Mt,mt,kt,sn,an,ln,dn,un,hn,pn;let fn;console.log("widget documentation preview data ->",vt);const wn=((dn=(ln=(an=(sn=(kt=(mt=(Mt=(tt=vt?.[0])===null||tt===void 0?void 0:tt.data)===null||Mt===void 0?void 0:Mt.the_widget)===null||mt===void 0?void 0:mt.the_widget_documentation)===null||kt===void 0?void 0:kt.data)===null||sn===void 0?void 0:sn.the_documentation)===null||an===void 0?void 0:an.the_documentation_text)===null||ln===void 0?void 0:ln.data)===null||dn===void 0?void 0:dn.the_text)||"";wn&&(fn=wn);const Yt=(pn=(hn=(un=vt?.[0])===null||un===void 0?void 0:un.data)===null||hn===void 0?void 0:hn.the_widget)===null||pn===void 0?void 0:pn.the_widget_s_documentation;Yt?.length&&(fn=Yt?.map(Zt=>{var Pt,lt,Ue,Nt,At,Lt,St,Dt,yt,_t,ct,bt,Gt,Bt,xt,Vt,jt,Ht,Ve,st,We,ft,dt,En,Rn,Wt,kn,Xe,at,nt,ot;const Re=(Pt=Zt?.data)===null||Pt===void 0?void 0:Pt.the_documentation,ut=(Ue=(lt=Re?.the_documentation_type)===null||lt===void 0?void 0:lt.data)===null||Ue===void 0?void 0:Ue.the_type,Tt=(At=(Nt=Re?.the_documentation_content)===null||Nt===void 0?void 0:Nt.data)===null||At===void 0?void 0:At.the_content,It=(St=(Lt=Re?.the_documentation_creator_email)===null||Lt===void 0?void 0:Lt.data)===null||St===void 0?void 0:St.the_creator_email,ht=(yt=(Dt=Re?.the_documentation_doc_title)===null||Dt===void 0?void 0:Dt.data)===null||yt===void 0?void 0:yt.the_doc_title,Wc=(ct=(_t=Re?.the_documentation_method)===null||_t===void 0?void 0:_t.data)===null||ct===void 0?void 0:ct.the_method,Fc=(Gt=(bt=Re?.the_documentation_method_url)===null||bt===void 0?void 0:bt.data)===null||Gt===void 0?void 0:Gt.the_method_url,Uc=(xt=(Bt=Re?.the_documentation_bearer_token)===null||Bt===void 0?void 0:Bt.data)===null||xt===void 0?void 0:xt.the_bearer_token,Oc=(jt=(Vt=Re?.the_documentation_username)===null||Vt===void 0?void 0:Vt.data)===null||jt===void 0?void 0:jt.the_username,Mc=(Ve=(Ht=Re?.the_documentation_password)===null||Ht===void 0?void 0:Ht.data)===null||Ve===void 0?void 0:Ve.the_password,Pc=(We=(st=Re?.the_documentation_auth_type)===null||st===void 0?void 0:st.data)===null||We===void 0?void 0:We.the_auth_type,Jn=Re?.the_documentation_s_json_list,Vc=(dt=(ft=Re?.the_documentation_api_script)===null||ft===void 0?void 0:ft.data)===null||dt===void 0?void 0:dt.the_api_script,jc=(Rn=(En=Re?.the_documentation_api_body)===null||En===void 0?void 0:En.data)===null||Rn===void 0?void 0:Rn.the_api_body,Hc=(kn=(Wt=Re?.the_documentation_language)===null||Wt===void 0?void 0:Wt.data)===null||kn===void 0?void 0:kn.the_language,$c=(at=(Xe=Re?.the_documentation_return)===null||Xe===void 0?void 0:Xe.data)===null||at===void 0?void 0:at.the_return,Jc=(ot=(nt=Re?.the_documentation_code_editor)===null||nt===void 0?void 0:nt.data)===null||ot===void 0?void 0:ot.the_code_editor,zn=Re?.the_documentation_s_doc_url,qn=Re?.the_documentation_s_image_url,Qn=Re?.the_documentation_s_video_link;let $t={type:ut,content:Tt,creatorEmail:It,title:ht};if(ut==="blank")$t=Object.assign({},$t);else if(ut==="api"){const Ft=[];Jn?.length&&Jn?.forEach(pt=>{var Ro,Do,Wo,Fo,Uo,Oo,Mo,Po;Ft.push({key:(Fo=(Wo=(Do=(Ro=pt?.data)===null||Ro===void 0?void 0:Ro.the_json_list)===null||Do===void 0?void 0:Do.the_json_list_key)===null||Wo===void 0?void 0:Wo.data)===null||Fo===void 0?void 0:Fo.the_key,value:(Po=(Mo=(Oo=(Uo=pt?.data)===null||Uo===void 0?void 0:Uo.the_json_list)===null||Oo===void 0?void 0:Oo.the_json_list_value)===null||Mo===void 0?void 0:Mo.data)===null||Po===void 0?void 0:Po.the_value})}),$t=Object.assign(Object.assign({},$t),{method:Wc,methodURL:Fc,authType:Pc,username:Oc,password:Mc,bearerToken:Uc,json:Ft,script:Vc,body:jc})}else ut==="function"&&($t=Object.assign(Object.assign({},$t),{language:Hc,return:$c,codeEditor:Jc}));const Dr=[],Wr=[],Fr=[];return qn?.length&&qn?.forEach(Ft=>{var pt;Dr.push((pt=Ft?.data)===null||pt===void 0?void 0:pt.the_image_url)}),Qn?.length&&Qn?.forEach(Ft=>{var pt;Wr.push((pt=Ft?.data)===null||pt===void 0?void 0:pt.the_video_link)}),zn?.length&&zn?.forEach(Ft=>{var pt;Fr.push((pt=Ft.data)===null||pt===void 0?void 0:pt.the_doc_url)}),$t=Object.assign(Object.assign({},$t),{imageList:Dr,linkList:Fr,videoList:Wr}),$t})),yield function(){return it(this,void 0,void 0,function*(){document.getElementById("widget-documentation-preview-modal").showModal()})}(),function(Ct,Zt){it(this,void 0,void 0,function*(){const Pt=document.getElementById("documentation-view");if(s.B.DOCUMENTATION_WIDGET!=0)return void(yield Vn(s.B.DOCUMENTATION_WIDGET,Pt,{currentWidgetId:Zt}));const lt=document.getElementById("documentation-preview");lt.innerHTML="",Ct&&Ct?.length&&typeof Ct!="string"?Ct?.forEach(Ue=>{var Nt,At,Lt,St;const Dt=document.createElement("h3");let yt="";switch(Ue?.type){case"api":yt="API";break;case"function":yt="Functions and Classes";break;case"imgAndLink":yt="Images and Links";break;default:yt=""}Dt.innerHTML=`
        ${Ue?.title} ${yt?"("+yt+")":""}
      `,lt?.appendChild(Dt);const _t=document.createElement("div");_t.classList.add("widget-doc-content"),Ue?.content&&(_t.innerHTML=Ue.content,lt?.appendChild(_t));const ct=document.createElement("div");if(ct.classList.add("widget-doc-section"),Ue.type==="api"){let Ve="";Ve=Ue.authType==="basicAuth"?`
            <p>username: <code>${Ue?.username}</code></p>
            <p>password: <code>${Ue?.password}</code></p>
          `:Ue.authType==="bearerToken"?`
          <h6>Token: <code>${Ue?.bearerToken}</code></h6>
          `:"None";const st=Ue.json.map(dt=>`${dt?.key}: ${dt?.value}`).join(", "),We=document.createElement("pre");We.textContent=st,ct.innerHTML=`
          <div class="pv-3">
            <h6>Method Type: <code>${Ue?.method.toUpperCase()}</code></h6>
            <h6>Endpoint: <code>${Ue?.methodURL}</code></h6>
          </div>
          <div class="pv-3">
            <h6>Auth Type: <code>${((Nt=Ue?.authType)===null||Nt===void 0?void 0:Nt.toUpperCase())||""}</code></h6>
            ${Ve}
          </div>
          <div class="pv-3">
            <h6>JSON</h6>
            <code class="pre-wrapper" id="json-list-pre"></code>
          </div>
          <div class="pv-3">
            <h6>Body</h6>
            ${Ue.body}
          </div>
          <div class="pv-3">
            <h6>Scripts</h6>
            ${Ue.script}
          </div>
        `;const ft=ct.querySelector("#json-list-pre");ft&&(ft.appendChild(We),ft.removeAttribute("id"))}else if(Ue.type==="function"){const Ve=document.createElement("pre");Ve.textContent=Ue?.codeEditor;const st=document.createElement("pre");st.textContent=Ue?.return,ct.innerHTML=`
          <div class="mv-3">
            <h6>Parameter</h6>
            <p>Language: ${Ue?.language}</p>
            <code class="pre-wrapper" id="editor-pre"></pre></code>
            <h6>Returns</h6>
            <code class="pre-wrapper" id="return-pre"></code>
          </div>
        `;const We=ct.querySelector("#editor-pre");We&&(We.appendChild(Ve),We.removeAttribute("id"));const ft=ct.querySelector("#return-pre");ft&&(ft.appendChild(st),ft.removeAttribute("id"))}const bt=document.createElement("div");bt.classList.add("mv-3");const Gt=(At=Ue?.linkList)===null||At===void 0?void 0:At.map(Ve=>`
            <p>${Ve}</p>
          `).join(""),Bt=(Lt=Ue?.imageList)===null||Lt===void 0?void 0:Lt.map(Ve=>`
          <img src="${Ve}">
        `).join(""),xt=(St=Ue?.videoList)===null||St===void 0?void 0:St.map(Ve=>`
            <iframe width="560" height="315" src="${Ve}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        `).join(""),Vt=Gt?.length?`
          <div class="mv-3">
          <h6>Web links</h6>
          ${Gt}
          </div>
        `:"",jt=Bt?.length?`
          <h6>Attachments</h6>
          <div class="documentation-attachments">
            ${Bt}
          </div>
        `:"",Ht=xt?.length?`
            <h6>Videos</h6>
            <div class="documentation-attachments">
              ${xt}
            </div>
            `:"";bt.innerHTML=`
        <div class="mv-3">
          ${Vt}
          ${jt}
          ${Ht}
        </div>
        <p class="documentation-creator">- added by: <span>${Ue?.creatorEmail}</span></p>
      `,ct?.appendChild(bt),lt?.appendChild(ct)}):Ct!==void 0&&(lt.innerHTML=Ct)})}(fn,Pe)}))})})(De?.getAttribute("widget-id"))})});const ke=t.querySelectorAll(".document-preview-close-button");ke?.forEach(ie=>{ie.addEventListener("click",()=>{(function(){it(this,void 0,void 0,function*(){const we=document.getElementById("widget-documentation-preview-modal"),De=we?.querySelector("form");De?.reset(),we?.close()})})()})})}return t.querySelectorAll(".wb-initial-empty").forEach(z=>{z.classList.remove("wb-initial-empty")}),document.querySelectorAll('[onclick="widgetSelected(event)"]').forEach(z=>{z.removeAttribute("onclick")}),G})}function mr(_,o){return it(this,void 0,void 0,function*(){var e,n,p,y,C,E,g,c,t,G,F,V;const P=(n=(e=_?.data)===null||e===void 0?void 0:e.the_widget)===null||n===void 0?void 0:n.the_widget_s_child;if(o.push(_),P&&P.length)for(let z=0;z<P.length;z++){const te=P[z];let le=(c=(g=(E=(C=(y=(p=te?.data.the_child_widget)===null||p===void 0?void 0:p.the_child_widget_info)===null||y===void 0?void 0:y.data)===null||C===void 0?void 0:C.the_widget)===null||E===void 0?void 0:E.the_widget_origin)===null||g===void 0?void 0:g.data)===null||c===void 0?void 0:c.the_origin;const ke=!!(!((F=(G=(t=te?.data)===null||t===void 0?void 0:t.the_child_widget)===null||G===void 0?void 0:G.the_child_widget_use_latest)===null||F===void 0)&&F.data);le=Number(le)||!1;let ie=null;if(ke&&le){const we=yield(0,rn.qj)(le);ie=((V=we?.data)===null||V===void 0?void 0:V[0])||[],ie.useLatest=!0,te.data.the_child_widget.the_child_widget_info=ie}te.data.the_child_widget.the_child_widget_info.sChildId=te.id,yield mr(te.data.the_child_widget.the_child_widget_info,o)}})}function Cr(_,o){return it(this,void 0,void 0,function*(){const e=[],n=[..._];try{const p=n.find(y=>y.id===o);yield mr(p,e)}catch(p){console.error("convert to real bulk error",p)}return e})}function Tr(_){return it(this,arguments,void 0,function*(o,e=[],n=""){let p=yield(0,rn.Cp)(o);const y=yield Cr(p,o);return yield Bn(o,[],y)})}function Bn(_){return it(this,arguments,void 0,function*(o,e=[],n,p=""){var y,C,E,g,c,t,G,F,V,P,z,te,le,ke,ie,we,De,Pe,Je,qe,Ye,rt,vt,tt,Mt,mt,kt,sn,an,ln,dn,un,hn,pn,fn,wn,Yt,Ct,Zt,Pt,lt,Ue,Nt,At,Lt,St,Dt,yt,_t,ct,bt,Gt,Bt,xt,Vt,jt,Ht;try{const Ve=new No,st=(0,rn.ix)(n,o);console.log("getWidgetBulkFromId output ->",st),e.push(o);const We=(y=st?.data)===null||y===void 0?void 0:y.the_widget;Ve.name=(E=(C=We?.the_widget_name)===null||C===void 0?void 0:C.data)===null||E===void 0?void 0:E.the_name,Ve.html=(c=(g=We?.the_widget_html)===null||g===void 0?void 0:g.data)===null||c===void 0?void 0:c.the_html,Ve.css=(G=(t=We?.the_widget_css)===null||t===void 0?void 0:t.data)===null||G===void 0?void 0:G.the_css,Ve.js=(V=(F=We?.the_widget_js)===null||F===void 0?void 0:F.data)===null||V===void 0?void 0:V.the_js,Ve.origin=Number(((z=(P=We?.the_widget_origin)===null||P===void 0?void 0:P.data)===null||z===void 0?void 0:z.the_origin)||((le=(te=We?.the_widget_origin)===null||te===void 0?void 0:te.data)===null||le===void 0?void 0:le.the_originid)),Ve.version=(ie=(ke=We?.the_widget_version)===null||ke===void 0?void 0:ke.data)===null||ie===void 0?void 0:ie.the_version,Ve.clean=(De=(we=We?.the_widget_clean)===null||we===void 0?void 0:we.data)===null||De===void 0?void 0:De.the_clean,Ve.timestamp=(Je=(Pe=We?.the_widget_timestamp)===null||Pe===void 0?void 0:Pe.data)===null||Je===void 0?void 0:Je.the_timestamp,Ve.id=st?.id;const ft=(Ye=(qe=We?.the_widget_type)===null||qe===void 0?void 0:qe.data)===null||Ye===void 0?void 0:Ye.the_type;Ve.type=ft=="null"||ft==null?"the_element_name":ft,Ve.after_render=(vt=(rt=We?.the_widget_after_render)===null||rt===void 0?void 0:rt.data)===null||vt===void 0?void 0:vt.the_after_render,Ve.before_render=(Mt=(tt=We?.the_widget_before_render)===null||tt===void 0?void 0:tt.data)===null||Mt===void 0?void 0:Mt.the_before_render,Ve.update=(kt=(mt=We?.the_widget_update)===null||mt===void 0?void 0:mt.data)===null||kt===void 0?void 0:kt.the_update,Ve.widgetId=o,Ve.mount_child=(an=(sn=We?.the_widget_mount_child)===null||sn===void 0?void 0:sn.data)===null||an===void 0?void 0:an.the_mount_child;const dt=We?.the_widget_s_child;st.useLatest&&(Ve.useLatest=!0),st.sChildId&&(Ve.sChildId=st.sChildId);const En=(ln=We?.the_widget_s_css_library)===null||ln===void 0?void 0:ln.map(Xe=>{var at,nt,ot,Re,ut,Tt,It,ht;return{order:(Re=(ot=(nt=(at=Xe?.data)===null||at===void 0?void 0:at.the_css_library)===null||nt===void 0?void 0:nt.the_css_library_order)===null||ot===void 0?void 0:ot.data)===null||Re===void 0?void 0:Re.the_order,url:(ht=(It=(Tt=(ut=Xe?.data)===null||ut===void 0?void 0:ut.the_css_library)===null||Tt===void 0?void 0:Tt.the_css_library_url)===null||It===void 0?void 0:It.data)===null||ht===void 0?void 0:ht.the_url}}),Rn=(dn=We?.the_widget_s_js_library)===null||dn===void 0?void 0:dn.map(Xe=>{var at,nt,ot,Re,ut,Tt,It,ht;return{order:(Re=(ot=(nt=(at=Xe?.data)===null||at===void 0?void 0:at.the_js_library)===null||nt===void 0?void 0:nt.the_js_library_order)===null||ot===void 0?void 0:ot.data)===null||Re===void 0?void 0:Re.the_order,url:(ht=(It=(Tt=(ut=Xe?.data)===null||ut===void 0?void 0:ut.the_js_library)===null||Tt===void 0?void 0:Tt.the_js_library_url)===null||It===void 0?void 0:It.data)===null||ht===void 0?void 0:ht.the_url}});Ve.library={css:En||[],js:Rn||[]};const Wt=(hn=(un=We?.the_widget_assistant)===null||un===void 0?void 0:un.data)===null||hn===void 0?void 0:hn.the_assistant;Ve.assistant={id:(fn=(pn=Wt?.the_assistant_id)===null||pn===void 0?void 0:pn.data)===null||fn===void 0?void 0:fn.the_id,input:(Yt=(wn=Wt?.the_assistant_input)===null||wn===void 0?void 0:wn.data)===null||Yt===void 0?void 0:Yt.the_input,type:(Zt=(Ct=Wt?.the_assistant_type)===null||Ct===void 0?void 0:Ct.data)===null||Zt===void 0?void 0:Zt.the_type};const kn=(Pt=We?.the_widget_s_custom_function)===null||Pt===void 0?void 0:Pt.map(Xe=>{var at,nt,ot,Re,ut,Tt,It;const ht=(at=Xe?.data)===null||at===void 0?void 0:at.the_custom_function;return{id:Xe?.id,name:(ot=(nt=ht?.the_custom_function_name)===null||nt===void 0?void 0:nt.data)===null||ot===void 0?void 0:ot.the_name,slug:(ut=(Re=ht?.the_custom_function_slug)===null||Re===void 0?void 0:Re.data)===null||ut===void 0?void 0:ut.the_slug,code:(It=(Tt=ht?.the_custom_function_code)===null||Tt===void 0?void 0:Tt.data)===null||It===void 0?void 0:It.the_code}});if(console.log("customFunctionList -> ",kn),Ve.custom_functions=kn,dt?.length)for(let Xe=0;Xe<dt.length;Xe++){const at=((Nt=(Ue=(lt=dt[Xe])===null||lt===void 0?void 0:lt.data.the_child_widget)===null||Ue===void 0?void 0:Ue.the_child_widget_info)===null||Nt===void 0?void 0:Nt.id)||((Dt=(St=(Lt=(At=dt[Xe])===null||At===void 0?void 0:At.data.the_child_widget)===null||Lt===void 0?void 0:Lt.the_child_widget_parent)===null||St===void 0?void 0:St.data)===null||Dt===void 0?void 0:Dt.the_parent),nt=yield Bn(at,e,n,p),ot=(Gt=(bt=(ct=(_t=(yt=dt[Xe])===null||yt===void 0?void 0:yt.data)===null||_t===void 0?void 0:_t.the_child_widget)===null||ct===void 0?void 0:ct.the_child_widget_type)===null||bt===void 0?void 0:bt.data)===null||Gt===void 0?void 0:Gt.the_type,Re=(Ht=(jt=(Vt=(xt=(Bt=dt[Xe])===null||Bt===void 0?void 0:Bt.data)===null||xt===void 0?void 0:xt.the_child_widget)===null||Vt===void 0?void 0:Vt.the_child_widget_wrapper)===null||jt===void 0?void 0:jt.data)===null||Ht===void 0?void 0:Ht.the_wrapper;nt.type=ot=="null"||ot==null?"the_element_name":ot,nt.wrapper=Re,Ve.children.push(nt)}return Ve}catch(Ve){throw Ve instanceof Error&&console.error("error converting bulkwidget to widget tree",Ve.message),Ve}})}function jn(_,o){return it(this,arguments,void 0,function*(e,n,p=!0,y,C,E=null){var g,c;const t=new bn;t.html=e.html,E&&(t.parentWidget=Ir(E)),t.widgetType=e.type,t.componentDidMountFunction=e.before_render,t.addEventFunction=e.after_render,t.mountChildWidgetsFunction=e.mount_child,t.widgetState=Object.assign({},C),t.customFunctions=e.custom_functions,y&&(t.data=y),n.innerHTML="";const G=n;if(G&&(yield t.mount(G),e.widget=t,e.children.length>0&&((g=t.childWidgetElement)===null||g===void 0?void 0:g.length)>0))for(let F=0;F<((c=e.children)===null||c===void 0?void 0:c.length);F++){const V=e.children[F];for(let P=0;P<t.childWidgetElement.length;P++){const z=t.childWidgetElement[P];if(V.wrapper===z.id){const te=wr(V);V.html=`<div id="${V.wrapper}">${V.html}</div>`;const le=yield jn(te,z,!1,t.data,t.widgetState,t);t.childWidgets.push(le),t.css=t.css+le.css+`#${z.id} { ${V.css} }`,le.dataChange(ke=>{var ie;const we=(ie=ke?.type)===null||ie===void 0?void 0:ie.characterValue;we&&(t.childrenData[we]=ke)})}}}return console.log("newWidget ->",t,e),yield _o(n,".widget_container"),t})}function Ir(_){const o={};for(const[e,n]of Object.entries(_))typeof n=="object"&&n!==null&&Array.isArray(n)||(o[e]=n);return o}function So(_,o){return it(this,arguments,void 0,function*(e,n,p=!0,y,C,E=null){var g,c;let t=new bn;t.html=e.html,E&&(t.parentWidget=Ir(E)),t.widgetState=Object.assign({},y),t.widgetType=e.type,t.componentDidMountFunction=e.before_render,t.addEventFunction=e.after_render,t.mountChildWidgetsFunction=e.mount_child,t.customFunctions=e.custom_functions,t.inDevelopment=C!==!1,n.innerHTML="";let G=n;if(G&&(yield t.mount(G),e.widget=t,e.children.length>0&&((g=t.childWidgetElement)===null||g===void 0?void 0:g.length)>0))for(let F=0;F<((c=e.children)===null||c===void 0?void 0:c.length);F++){let V=e.children[F];for(let P=0;P<t.childWidgetElement.length;P++){let z=t.childWidgetElement[P];if(V.wrapper===z.id){const te=wr(V),le=yield So(te,z,!1,t.widgetState,C,t);t.childWidgets.push(le),t.css=t.css+le.css+`#${z.id} { ${V.css} }`,le.dataChange(ke=>{var ie;console.log("This is the data change in child",ke);let we=(ie=ke?.type)===null||ie===void 0?void 0:ie.characterValue;we&&(t.childrenData[we]=ke),console.log("new child data",t.childrenData)})}}}return console.log("newWidget ->",t,e),t})}function wr(_){return _.html=_.html.replace(/<[^>]*\bclass=["'][^"']*\bwidget_container\b[^"']*["'][^>]*>/g,o=>o.replace(/\bwidget_container\b/g,"").trim()),_.html=_.html.replace(/<[^>]*\bdraggable=["'][^"']*\btrue\b[^"']*["'][^>]*>/g,o=>o.replace(/\btrue\b/g,"false").trim()),_.html=_.html.replace(/<[^>]*\bclass=["'][^"']*\bhover-element\b[^"']*["'][^>]*>/g,o=>o.replace(/\bhover-element\b/g,"").trim()),_.html=_.html.replace(/<[^>]*\bclass=["'][^"']*\bwb-block\b[^"']*["'][^>]*>/g,o=>o.replace(/\bwb-block\b/g,"").trim()),_.html=_.html.replace(/<[^>]*onclick="widgetSelected\(event\)"\s*,?\s*ondragover="_dragService\.dragOverWidgetElement\(event\)"\s*,?\s*ondrop="_dragService\.dropWidgetElement\(event\)"\s*,?\s*ondragstart="_dragService\.dragStartWidgetElement\(event\)"\s*,?\s*ondragend="_dragService\.dragEndWidgetElement\(event\)"[^>]*>/g,o=>o.replace(/onclick="widgetSelected\(event\)"/g,'onclick=""').replace(/ondragover="_dragService\.dragOverWidgetElement\(event\)"/g,'ondragover=""').replace(/ondrop="_dragService\.dropWidgetElement\(event\)"/g,'ondrop=""').replace(/ondragstart="_dragService\.dragStartWidgetElement\(event\)"/g,'ondragstart=""').replace(/ondragend="_dragService\.dragEndWidgetElement\(event\)"/g,'ondragend=""').trim()),_.html=_.html.replace(/<[^>]*\bondragstart=["'][^"']*\b_dragService\.onWidgetDragStart\(event\)\b[^"']*["'][^>]*>/g,o=>o.replace(/\b_dragService\.onWidgetDragStart\(event\)\b/g,"").trim()),_}function bc(_,o){return it(this,void 0,void 0,function*(){return _&&_.nodeType===1&&_.querySelectorAll(o).forEach(e=>{for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.remove()}),_})}function _o(_,o){return it(this,void 0,void 0,function*(){const e=_.querySelectorAll(o);for(const n of e){const p=n.parentElement;if(p){for(;n.firstChild;){const y=yield bc(n.firstChild,o);p.insertBefore(y,n)}p.removeChild(n)}}})}var Gc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function Hn(_){return Gc(this,arguments,void 0,function*(o,e=null,n="",p={concepts:[],connections:[]}){var y,C,E,g;if(Fe)try{const F=yield je("CreateData",{json:o,ofConcept:e,typeConcept:n,actions:p});return!((C=(y=F?.actions)===null||y===void 0?void 0:y.concepts)===null||C===void 0)&&C.length&&(p.concepts=JSON.parse(JSON.stringify(F.actions.concepts))),!((g=(E=F?.actions)===null||E===void 0?void 0:E.connections)===null||g===void 0)&&g.length&&(p.connections=JSON.parse(JSON.stringify(F.actions.connections))),F.data}catch(F){console.error("CreateTheComposition sw error: ",F),ze(F)}let c=999,t=999,G=(0,se.o)();for(const F in o){let V=Bc(F);if(typeof o[F]!="string"&&typeof o[F]!="number")if(e==null||e.id==0)G=yield(0,pe.k)(V,"",!0,c,4,t,void 0,p),Array.isArray(o[F])&&(V=kr(V)),yield Hn(o[F],G,V,p);else{Array.isArray(o[F])&&(V=Nr(V));let P=Nr(F),z=yield(0,pe.k)(V,"",!0,c,4,t,void 0,p);G=z;let te=Ar(n,P),le=yield(0,Le.$)(te,t,c,c,p);yield(0,Et.F)(e.id,z.id,le.id,1e3,le.characterValue,c,p),Array.isArray(o[F])&&(V=kr(V)),yield Hn(o[F],z,V,p)}else{let P=Ar(n,F),z=yield(0,Le.$)(P,t,c,c,p),te=yield(0,pe.k)(F,o[F].toString(),!1,c,4,t,void 0,p);console.log("this is the type concept in down",z,te),e!=null&&(yield(0,Et.F)(e.id,te.id,z.id,1e3,P,c,p))}}return G})}function Bc(_){return _.startsWith("the_")?_:"the_"+_}function kr(_){return _.endsWith("_s")?_:_+"_s"}function Nr(_){return _.replace(/_s$/,"")}const xc=_=>/^[+-]?\d+(\.\d+)?$/.test(_);function Ar(_,o){return xc(o)?_+"_":_+"_"+function(e){return e.startsWith("the_")?e.slice(4):e}(o)}class Lr{constructor(){this.prototype="",this.required=[],this.optional=[],this.field="string",this.childPrototypes=[],this.isCompositional=!1,this.options=[],this.isQueryType=!1,this.querySelector=null,this.concepts=[],this.connections=[],this.addedConcepts=[],this.addedConnections=[]}}function Rt(_,o){if(Array.isArray(_)&&Array.isArray(o))for(let e=0;e<o.length;e++)_.push(o[e]);return _}var cn=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function bo(_){return cn(this,arguments,void 0,function*(o,e=null){let n=[],p=[],y=[],C=(0,se.o)();try{e==null&&(e=new Io,yield e.initialize());let E=[];if(o.isCompositional){if(C=yield function(t,G,F,V){return cn(this,void 0,void 0,function*(){let P=(0,se.o)(),z=yield V.MakeTheInstanceConceptLocal("the_composition","",!0,999,999,999),te=yield V.MakeTheTypeConceptLocal("the_composition_type",999,999,999),le=yield V.MakeTheTypeConceptLocal(t,999,999,999),ke=yield V.CreateTheConnectionLocal(z.id,le.id,te.id,1e3,"the_composition_type");return P=z,G.push(te),G.push(le),F.push(ke),P})}(o.prototype,n,p,e),o.isQueryType){let t=yield function(F,V,P){return cn(this,void 0,void 0,function*(){let z=[],te=[],le="the_composition_filter_type",ke="the_composition_selector",ie=yield P.MakeTheTypeConceptLocal(le,999,999,999),we=yield P.MakeTheTypeConceptLocal(ke,999,999,999);if(F!=null){let De=yield P.MakeTheTypeConceptLocal(F.selector,999,999,999);z.push(De);let Pe=yield P.MakeTheTypeConceptLocal(F.filterType,999,999,999);z.push(De),z.push(Pe);let Je=yield P.CreateTheConnectionLocal(V.id,De.id,we.id,1e3,ke,999);te.push(Je);let qe=yield P.CreateTheConnectionLocal(V.id,Pe.id,ie.id,1e3,le,999);te.push(qe)}return{concepts:z,connections:te}})}(o.querySelector,C,e),G=t.concepts;Rt(y,t.connections),Rt(n,G)}if(o.options.length>0){let t=yield function(F,V,P){return cn(this,void 0,void 0,function*(){let z=[],te=[],le="the_composition_s_option",ke=yield P.MakeTheTypeConceptLocal(le,999,999,999);for(let ie=0;ie<F.length;ie++){let we=F[ie].type,De=F[ie].value,Pe=yield P.MakeTheInstanceConceptLocal(we,De,!1,999,999,999);z.push(Pe);let Je=yield P.CreateTheConnectionLocal(V.id,Pe.id,ke.id,1e3,le,999);te.push(Je)}return{concepts:z,connections:te}})}(o.options,C,e),G=t.concepts;Rt(y,t.connections),Rt(n,G)}}else C=yield function(t,G){return cn(this,void 0,void 0,function*(){let F=yield(0,ve.A)(5124),V=yield G.MakeTheTypeConceptLocal(t,999,999,999);return yield function(z,te,le,ke){return cn(this,void 0,void 0,function*(){let ie=yield ke.CreateTheConceptLocal("",te.characterValue,999,z.id,te.id,4,!1);return ie.characterValue=te.characterValue,ie.typeCharacter=te.characterValue,ie.isComposition=!0,ie.type=te,ie})}(F,V,0,G)})}(o.prototype,e),y=yield _r(o.required,C,n,e,!0),E=yield _r(o.optional,C,n,e),n.push(C);let g=Sr(C,!0,!0),c=yield e.MakeTheTypeConceptLocal(g,999,999,999);if(n.push(c),o.childPrototypes.length>0)for(let t=0;t<o.childPrototypes.length;t++){let G=yield bo(o.childPrototypes[t]),F=G.mainConcept,V=G.connections,P=G.concepts,z=yield e.CreateTheConnectionLocal(C.id,F.id,c.id,1e3,g,999);y.push(z),Rt(y,V),Rt(n,P),n.push(F)}Rt(y,E),Rt(y,p),Rt(n,o.addedConcepts),Rt(y,o.addedConnections),o.concepts=n,o.connections=y,console.log("this is the connections",y)}catch{e?.rollbackTransaction()}return{concepts:n,connections:y,mainConcept:C}})}function Sr(_,o=!0,e=!1){var n;let p="the_prototype_of_"+((n=_.type)===null||n===void 0?void 0:n.characterValue);return p+=o?"_requires":"_optional",e&&(p+="_the_composition"),p}function _r(_,o,e,n){return cn(this,arguments,void 0,function*(p,y,C,E,g=!1,c=!1){let t=[],G=[],F=Sr(y,g,c),V=yield E.MakeTheTypeConceptLocal(F,999,999,999);C.push(V);for(let P=0;P<p.length;P++){let z=yield E.MakeTheTypeConceptLocal(p[P],999,999,999);t.push(z)}for(let P=0;P<t.length;P++){let z=yield E.CreateTheConnectionLocal(y.id,t[P].id,V.id,1e3,F,999);G.push(z)}for(let P=0;P<t.length;P++)C.push(t[P]);return G})}var Ec=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,[])).next())})};function Go(_){return Ec(this,void 0,void 0,function*(){let o;try{const e=yield fetch(s.B.GetCachedImage(_),{method:"GET"});return e.ok?o=e.body:(console.log("Error in Getting Image",e.status),(0,u.ry)(e)),o}catch(e){throw e instanceof Error?console.log("Error in Getting Local concept by character value error message: ",e):console.log("Error in Getting Local concept by character value unexpected error: ",e),o}})}var Rc=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};function br(_){return Rc(this,arguments,void 0,function*(o,e="normal"){let n,p=o.split("/").pop();if(e=="small"){let y=p?.split(".");y&&(p=y[0]+"_small."+y[1])}return p&&(n=yield Go(p)),n})}function Gr(_,o="normal"){let e=_;try{if(_){let n=_.split("/").pop();if(o=="small"){let p=n?.split(".");p&&(n=p[0]+"_small."+p[1])}n&&(e=s.B.GetCachedImage(n))}}catch{console.log("This url has error",_)}return e}var Fe,et=function(_,o,e,n){return new(e||(e=Promise))(function(p,y){function C(c){try{g(n.next(c))}catch(t){y(t)}}function E(c){try{g(n.throw(c))}catch(t){y(t)}}function g(c){var t;c.done?p(c.value):(t=c.value,t instanceof e?t:new e(function(G){G(t)})).then(C,E)}g((n=n.apply(_,o||[])).next())})};const Dc=Date.now().toString(36)+Math.random().toString(36).substring(2);let Bo=[],Ot=[],xo=!1;function Br(_){xo=_}function Eo(_="",o){Ze.b.BearerAccessToken=_,Fe&&je("updateAccessToken",{accessToken:_,session:Ze.b.sessionId})}function xr(){return et(this,arguments,void 0,function*(_="",o="",e="",n="",p=!0,y="",C=void 0,E={},g={}){var c;try{s.B.BASE_URL=_,s.B.AI_URL=o,s.B.NODE_URL=n,s.B.BASE_APPLICATION=y,s.B.LOG_SERVER=(c=g.logserver)!==null&&c!==void 0?c:"https://logdev.freeschema.com",console.log("setting the logserver",s.B.LOG_SERVER,g.logserver),Eo(e);let t=Math.floor(1e8*Math.random());s.B.setRandomizer(t);const G={logApplication:!1,logPackage:!1,accessTracker:!1,isTest:!1};if(s.B.FLAGS=G,s.B.FLAGS=Object.assign(Object.assign({},G),E),function(F){const V=re.V.logfunction("initializeFlags",arguments);try{return F.logApplication&&(wc.initialize(),re.V.logApplicationActivationStatus=!0,console.warn("Application log started.")),F.logPackage&&(re.V.logPackageActivationStatus=!0,console.warn("Package log started.")),F.accessTracker&&(Nn.J.activateStatus=!0,console.warn("Access Tracker Activated.")),F.isTest&&(r.B.isDataLoaded=!0,r.B.isCharacterLoaded=!0,r.B.isTypeLoaded=!0,r.B.isLocalDataLoaded=!0,r.B.isLocalTypeLoaded=!0,r.B.isLocalCharacterLoaded=!0,r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0,r.B.isLocalConnectionLoaded=!0),re.V.logUpdate(V),F}catch(P){throw(0,u.ey)(V,"initializeFlags",P),P}}(s.B.FLAGS),!("serviceWorker"in navigator))return yield xn(),void console.warn("Service Worker not supported in this browser.");if(yield function(){return et(this,void 0,void 0,function*(){var F;let V=sessionStorage.getItem("cacheServers"),P=sessionStorage.getItem("config"),z=(F=sessionStorage.getItem("session"))!==null&&F!==void 0?F:"999",te=parseInt(z);V!==void 0&&V!=="undefined"||(s.B.NODE_CACHE_URL=s.B.BASE_URL),V=JSON.parse(V);const le=JSON.parse(P);V&&le&&le.documentationWidget&&te!=999?(Array.isArray(V)&&V.length?s.B.NODE_CACHE_URL=V[0]:s.B.NODE_CACHE_URL=s.B.BASE_URL,Ze.b.setSession(te),s.B.DOCUMENTATION_WIDGET=le.documentationWidget):yield function(){return et(this,void 0,void 0,function*(){var ke,ie;let we;try{let De=(ie=(ke=window?.location)===null||ke===void 0?void 0:ke.hostname)!==null&&ie!==void 0?ie:"boomconsole";if(we=yield fetch(s.B.getAppConfig()+"?application="+De,{method:"POST"}),!we.ok)throw new Error("Failed to sync data to the server.");const Pe=yield we.json();Pe.success&&(sessionStorage.setItem("cacheServers",JSON.stringify(Pe.servers)),sessionStorage.setItem("config",JSON.stringify(Pe.config)),sessionStorage.setItem("session",Pe.session),Ze.b.setSession(Pe.session),Pe.servers?s.B.NODE_CACHE_URL=Pe.servers[0]:s.B.NODE_CACHE_URL=s.B.BASE_URL,Pe.config&&(s.B.DOCUMENTATION_WIDGET=Pe.config.documentationWidget))}catch(De){console.error("error getting app config from server",De.message)}})}(),console.log("before the payload in app",Ze.b.sessionId),navigator.serviceWorker&&navigator.serviceWorker.controller&&je("SESSION_DATA",{type:"SESSION_DATA",data:s.B.NODE_CACHE_URL,session:Ze.b.sessionId})})}(),function(){navigator.serviceWorker.addEventListener("message",F=>et(this,void 0,void 0,function*(){var V,P,z,te;try{if(F.data&&F.data.type==="API_401"){const{requestDetails:le}=F.data,ke={method:le.method,headers:new Headers(le.headers),body:le.body},ie=yield fetch(le.url,ke),we=yield ie?.json();(P=(V=navigator?.serviceWorker)===null||V===void 0?void 0:V.controller)===null||P===void 0||P.postMessage({type:"API_RESPONSE",messageId:F.data.messageId,response:new Response(we,{status:ie.status,statusText:ie.statusText,headers:ie.headers})})}}catch(le){console.error("Error during listenPostMessage",le),(te=(z=navigator?.serviceWorker)===null||z===void 0?void 0:z.controller)===null||te===void 0||te.postMessage({type:"API_RESPONSE",messageId:F.data.messageId})}}))}(),function(){er.x.addEventListener("message",F=>et(this,void 0,void 0,function*(){const{type:V,payload:P}=F.data;if(!V)return;let z={success:!1,data:void 0};Er[V]?yield Er[V](P):console.warn(`Unable to handle "${V}" case in BC service worker`)}))}(),C&&C.activate&&C.manual)yield new Promise((F,V)=>{navigator.serviceWorker.ready.then(P=>et(this,void 0,void 0,function*(){console.log("registraions ready",P),Fe=P.active,yield In(),F("done")})).catch(P=>{console.error("Error: Ready service worker",P),V(P)}).finally(()=>console.log("Finally service worker ready done")),setTimeout(()=>V("Timeout ready"),3e4)});else if(C&&C?.activate)try{console.log("service worker initialiing"),yield function(F){var V=arguments;return et(this,void 0,void 0,function*(){const P=re.V.logfunction("handleRegisterServiceWorker",V);yield new Promise((z,te)=>{var le,ke;let ie=!1;navigator.serviceWorker.register((le=F.pathToSW)!==null&&le!==void 0?le:"./serviceWorker.bundle.js",{scope:(ke=F.scope)!==null&&ke!==void 0?ke:"/"}).then(we=>et(this,void 0,void 0,function*(){console.log("Service Worker registered:",we),setInterval(()=>{Ot.length&&$n()},2e3),console.log("update listen start"),we.onupdatefound=()=>{const De=we.installing;console.log("new worker",De),De&&(De.onstatechange=()=>et(this,void 0,void 0,function*(){console.warn("on state change triggered",De.state,navigator.serviceWorker.controller),De.state==="installing"&&(console.log("Service Worker installing"),Fe=void 0),De.state!=="activated"&&De.state!=="redundant"||!navigator.serviceWorker.controller||(Fe=De,console.log("New Service Worker is active",we),setTimeout(()=>{console.log("Message Processed after some time"),$n()},5e3),yield In(),ie=!0,$n(),z())}))},we.addEventListener("controllerchange",()=>et(this,void 0,void 0,function*(){console.warn("controller change triggered",navigator.serviceWorker.controller),navigator.serviceWorker.controller&&(Fe=navigator.serviceWorker.controller,console.warn("Service worker has been activated; controller change"),yield In())})),(we.installing||we.waiting||we.active)&&we.addEventListener("statechange",De=>et(this,void 0,void 0,function*(){var Pe;((Pe=De?.target)===null||Pe===void 0?void 0:Pe.state)==="activating"&&(Fe=navigator.serviceWorker.controller,console.warn("Service Worker is activating statechange"),yield In())})),we.active?(console.log("active sw"),Fe=we.active,yield In(),$n(),z()):setTimeout(()=>{ie||te("Not Completed Initialization")},1e4)})).catch(we=>et(this,void 0,void 0,function*(){yield xn(),te(we),console.error("Service Worker registration failed:",we),(0,u.ey)(P,"handleRegisterServiceWorker",we)}))})})}(C)}catch(F){yield xn(),console.error("Unable to start service worker",F)}else yield xn(),console.warn("Service Worker not activated");return!0}catch(t){yield xn(),console.warn("Cannot initialize the system",t)}})}function je(_,o){return et(this,arguments,void 0,function*(e,n,p=0){let y=!1;const C=Math.random().toString(36).substring(2);n.messageId=C,n.TABID=Dc;const E=JSON.parse(JSON.stringify(n));let g;return e!="checkProcess"&&p==0&&(g=setInterval(()=>et(this,void 0,void 0,function*(){if(!y&&!(yield function(c,t){return et(this,void 0,void 0,function*(){var G;try{const F=yield je("checkProcess",{checkMessageId:c});if(console.log("check interval data res for type ",t,c,F.data),(G=F?.data)===null||G===void 0?void 0:G.processing)return!0}catch(F){return console.error("error on checing executing process",t,c,F),!1}})}(C,e))&&(clearInterval(g),!y)){if(console.log("Failed to handle type "+e+" message not found "+C,"retrying: ",p==0,e),p==0&&e!="checkProcess")return console.log("retrying ",e,C),yield je(e,n,p+1);console.log("Failed to handle type "+e+" "+C)}}),2e3)),new Promise((c,t)=>{if(navigator.serviceWorker.controller||Fe||console.log("",navigator.serviceWorker.controller,Fe,e),navigator.serviceWorker.controller||Fe){const G=F=>{var V,P,z,te,le,ke;((V=F?.data)===null||V===void 0?void 0:V.messageId)==C&&(y=!0,clearInterval(g),F.data.success||(((P=F?.data)===null||P===void 0?void 0:P.status)==401?t((0,u.ry)(new Response("Unauthorized",{status:401,statusText:(z=F?.data)===null||z===void 0?void 0:z.statusText}))):((te=F?.data)===null||te===void 0?void 0:te.status)==500?t((0,u.Mb)(new Response("Internal Server Error",{status:500,statusText:(le=F?.data)===null||le===void 0?void 0:le.statusText}))):(console.error("Error in the response from worker:",F),t(`Failed to handle action ${e} ${JSON.stringify(n)}, Response: ${JSON.stringify(F.data)}`))),!((ke=F.data)===null||ke===void 0)&&ke.actions&&(n.actions=JSON.parse(JSON.stringify(F.data.actions))),c(F.data),navigator.serviceWorker.removeEventListener("message",G))};if(navigator.serviceWorker.addEventListener("message",G),navigator.serviceWorker.controller)e!="checkProcess"&&console.log("sent to sw",e,C),navigator.serviceWorker.controller.postMessage({type:e,payload:E});else if(Fe){console.warn(`controller not found but serviceWorker is available. messageId: ${C}, type: ${e}`);try{Fe.postMessage({type:e,payload:E})}catch(F){console.log("Retrying again on catch service worker",F),Fe.postMessage({type:e,payload:E})}}else console.warn(`Service Worker hasn't loaded yet. messageId: ${C}, type: ${e}`),console.info("ready",navigator.serviceWorker.ready),setTimeout(()=>{console.warn(`Re-Trying after certain time. messageId: ${C}, type: ${e}`),Fe?(console.info("This is triggered "),Fe?.postMessage({type:e,payload:n})):(console.log("not ready",e),clearInterval(g),t("Service worker not ready"))},3e4);setTimeout(()=>{clearInterval(g),t(`No response from service worker after timeout: ${e}`),navigator.serviceWorker.removeEventListener("message",G)},21e4)}else Ot.push({message:{type:e,payload:E}}),e=="init"&&(clearInterval(g),c(null))})})}const Er={GetLinkListener:_=>et(void 0,void 0,void 0,function*(){const o=Bo.find(e=>e.listenerId==_.listenerId);return o?.callback(_.data),{success:!0}}),dispatchEvent:_=>et(void 0,void 0,void 0,function*(){if(Fe){let o=new CustomEvent(_.id||"",_.data);dispatchEvent(o)}return{success:!0}}),checkInit:_=>et(void 0,void 0,void 0,function*(){return console.log("service worker init 0"),navigator.serviceWorker.controller&&(console.log("service worker init 1"),Fe=navigator.serviceWorker.controller),yield In(),{success:!0}})};function xn(){return et(this,void 0,void 0,function*(){yield(0,Ic.A)();const _=new Date().getTime();yield(0,W.A)().then(()=>{let o=new Date().getTime()-_;console.log("The time taken to prepare concept  data is  ",o)}).catch(o=>{throw o}),yield(0,Ki.Ay)().then(()=>{let o=new Date().getTime()-_;console.log("The time taken to prepare local concept  ",o)}).catch(o=>{throw o}),yield(0,Zi.p)().then(()=>{r.B.isLocalConnectionLoaded=!0}).catch(o=>{throw o}),yield(0,Ki.xd)().catch(o=>{throw console.log("This is the error in populating binary tree"),o}),yield(0,Zi.a)().then(()=>{r.B.isConnectionLoaded=!0,r.B.isConnectionTypeLoaded=!0;let o=new Date().getTime()-_;console.log("The time taken to prepare connections  ",o)}).catch(o=>{throw o})})}function Rr(_,o={}){if(Fe||typeof window<"u"){let e=new CustomEvent(`${_}`,o);dispatchEvent(e)}else er.x.postMessage({type:"dispatchEvent",payload:{id:_,data:o}})}function $n(){return et(this,void 0,void 0,function*(){console.log("message queue",Ot);const _=Ot.find(o=>{var e;return((e=o?.message)===null||e===void 0?void 0:e.type)=="init"});if(_){console.log("Processing Init Queue poped",_?.type,_);const o=Ot.indexOf(_);o>-1&&Ot.splice(o,1),yield je(_?.type,_?.payload)}for(console.log("message queue while",Ot);Ot.length>0;){const{message:o,resolve:e,reject:n}=Ot.shift();console.log("Queue poped",o.type,o),yield je(o.type,o.payload)}})}const ze=_=>{if(_ instanceof ne.z)throw console.error("FreeSchemaResponse Error",_),_;console.error("Service Worker Error",_)};function In(){return et(this,void 0,void 0,function*(){yield je("init",{url:s.B.BASE_URL,aiurl:s.B.AI_URL,accessToken:Ze.b.BearerAccessToken,nodeUrl:s.B.NODE_URL,enableAi:!1,applicationName:s.B.BASE_APPLICATION,flags:s.B.FLAGS})})}}},Ur={};function yn(fe){var q=Ur[fe];if(q!==void 0)return q.exports;var m=Ur[fe]={exports:{}};return zc[fe](m,m.exports,yn),m.exports}yn.d=(fe,q)=>{for(var m in q)yn.o(q,m)&&!yn.o(fe,m)&&Object.defineProperty(fe,m,{enumerable:!0,get:q[m]})},yn.o=(fe,q)=>Object.prototype.hasOwnProperty.call(fe,q),yn.r=fe=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(fe,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(fe,"__esModule",{value:!0})};var J=yn(2290),qc=J.ADMIN,Qc=J.ALLID,Xc=J.AccessTracker,Yc=J.AddGhostConcept,Zc=J.Anomaly,Kc=J.BaseUrl,es=J.BinaryTree,ts=J.BuildWidgetFromId,ns=J.BuilderStatefulWidget,os=J.Composition,is=J.CompositionBinaryTree,rs=J.CompositionNode,cs=J.Concept,ss=J.ConceptsData,as=J.Connection,ls=J.ConnectionData,ds=J.CountInfo,us=J.CreateComposition,hs=J.CreateConnection,ps=J.CreateConnectionBetweenEntityLocal,fs=J.CreateConnectionBetweenTwoConcepts,ys=J.CreateConnectionBetweenTwoConceptsGeneral,gs=J.CreateConnectionBetweenTwoConceptsLocal,vs=J.CreateData,ms=J.CreateDefaultConcept,Cs=J.CreateDefaultLConcept,Ts=J.CreateSession,Is=J.CreateSessionVisit,ws=J.CreateTheCompositionLocal,ks=J.CreateTheCompositionWithCache,Ns=J.CreateTheConnection,As=J.CreateTheConnectionGeneral,Ls=J.CreateTheConnectionLocal,Ss=J.DATAID,_s=J.DATAIDDATE,bs=J.DATAV2,Gs=J.DelayFunctionExecution,Bs=J.DeleteConceptById,xs=J.DeleteConceptLocal,Es=J.DeleteConnectionById,Rs=J.DeleteConnectionByIdBulk,Ds=J.DeleteConnectionByType,Ws=J.DeleteConnectionByTypeBulk,Fs=J.DeleteUser,Us=J.DependencyObserver,Os=J.FilterSearch,Ms=J.FormatFromConnections,Ps=J.FormatFromConnectionsAltered,Vs=J.FreeschemaQuery,js=J.FreeschemaQueryApi,Hs=J.GetAllConnectionsOfComposition,$s=J.GetAllConnectionsOfCompositionBulk,Js=J.GetAllTheConnectionsByTypeAndOfTheConcept,zs=J.GetComposition,qs=J.GetCompositionBulk,Qs=J.GetCompositionBulkWithDataId,Xs=J.GetCompositionFromConnectionsWithDataId,Ys=J.GetCompositionFromConnectionsWithDataIdFromConnections,Zs=J.GetCompositionFromConnectionsWithDataIdInObject,Ks=J.GetCompositionFromConnectionsWithDataIdIndex,ea=J.GetCompositionFromConnectionsWithIndex,ta=J.GetCompositionFromConnectionsWithIndexFromConnections,na=J.GetCompositionFromMemoryWithConnections,oa=J.GetCompositionList,ia=J.GetCompositionListAll,ra=J.GetCompositionListAllWithId,ca=J.GetCompositionListListener,sa=J.GetCompositionListLocal,aa=J.GetCompositionListLocalWithId,la=J.GetCompositionListWithId,da=J.GetCompositionListWithIdUpdated,ua=J.GetCompositionListener,ha=J.GetCompositionLocal,pa=J.GetCompositionLocalWithId,fa=J.GetCompositionWithAllIds,ya=J.GetCompositionWithCache,ga=J.GetCompositionWithDataIdBulk,va=J.GetCompositionWithDataIdWithCache,ma=J.GetCompositionWithId,Ca=J.GetCompositionWithIdAndDateFromMemory,Ta=J.GetConceptBulk,Ia=J.GetConceptByCharacter,wa=J.GetConceptByCharacterAndCategoryLocal,ka=J.GetConceptByCharacterAndType,Na=J.GetConnectionBetweenTwoConceptsLinker,Aa=J.GetConnectionBulk,La=J.GetConnectionById,Sa=J.GetConnectionDataPrefetch,_a=J.GetConnectionOfTheConcept,ba=J.GetConnectionTypeForCount,Ga=J.GetFreeschemaImage,Ba=J.GetFreeschemaImageUrl,xa=J.GetImageApi,Ea=J.GetLink,Ra=J.GetLinkListListener,Da=J.GetLinkListener,Wa=J.GetLinkRaw,Fa=J.GetLinkerConnectionFromConcepts,Ua=J.GetLinkerConnectionToConcepts,Oa=J.GetRelation,Ma=J.GetRelationLocal,Pa=J.GetRelationRaw,Va=J.GetTheConcept,ja=J.GetTheConceptLocal,Ha=J.GetUserGhostId,$a=J.JUSTDATA,Ja=J.LConcept,za=J.LConnection,qa=J.LISTNORMAL,Qa=J.LocalConceptsData,Xa=J.LocalSyncData,Ya=J.LocalTransaction,Za=J.Logger,Ka=J.LoginToBackend,el=J.MakeTheInstanceConcept,tl=J.MakeTheInstanceConceptLocal,nl=J.MakeTheTimestamp,ol=J.MakeTheTypeConceptApi,il=J.MakeTheTypeConceptLocal,rl=J.NORMAL,cl=J.PRIVATE,sl=J.PUBLIC,al=J.PatcherStructure,ll=J.Prototype,dl=J.RAW,ul=J.RecursiveSearchApi,hl=J.RecursiveSearchApiNewRawFullLinker,pl=J.RecursiveSearchApiRaw,fl=J.RecursiveSearchApiRawFullLinker,yl=J.RecursiveSearchApiWithInternalConnections,gl=J.RecursiveSearchListener,vl=J.SchemaQuery,ml=J.SchemaQueryListener,Cl=J.SearchAllConcepts,Tl=J.SearchLinkInternal,Il=J.SearchLinkInternalAll,wl=J.SearchLinkMultipleAll,kl=J.SearchLinkMultipleAllObservable,Nl=J.SearchLinkMultipleApi,Al=J.SearchQuery,Ll=J.SearchStructure,Sl=J.SearchWithLinker,_l=J.SearchWithTypeAndLinker,bl=J.SearchWithTypeAndLinkerApi,Gl=J.Selector,Bl=J.SessionData,xl=J.Signin,El=J.Signup,Rl=J.SignupEntity,Dl=J.SplitStrings,Wl=J.StatefulWidget,Fl=J.SyncData,Ul=J.TrashTheConcept,Ol=J.UpdateComposition,Ml=J.UpdateCompositionLocal,Pl=J.UserBinaryTree,Vl=J.Validator,jl=J.ViewInternalData,Hl=J.ViewInternalDataApi,$l=J.WidgetTree,Jl=J.convertFromConceptToLConcept,zl=J.convertFromLConceptToConcept,ql=J.convertWidgetTreeToWidget,Ql=J.convertWidgetTreeToWidgetWithWrapper,Xl=J.createFormFieldData,Yl=J.createPrototypeLocal,Zl=J.dispatchIdEvent,Kl=J.getFromDatabaseWithType,ed=J.getObjectsFromIndexDb,td=J.getUserDetails,nd=J.getWidgetBulkFromId,od=J.getWidgetFromId,id=J.handleServiceWorkerException,rd=J.hasActivatedSW,cd=J.init,sd=J.orderTheConnections,ad=J.recursiveFetch,ld=J.recursiveFetchNew,dd=J.removeAllChildren,ud=J.renderLatestWidget,hd=J.renderPage,pd=J.renderWidget,fd=J.searchLinkMultipleListener,yd=J.sendEmail,gd=J.sendMessage,vd=J.serviceWorker,md=J.setHasActivatedSW,Cd=J.storeToDatabase,Td=J.subscribedListeners,Id=J.unwrapContainers,wd=J.updateAccessToken,kd=J.uploadAttachment,Nd=J.uploadFile,Ad=J.uploadImage,Ld=J.uploadImageV2,Sd=J.validDocumentFormats,_d=J.validImageFormats;const bd=Object.freeze(Object.defineProperty({__proto__:null,ADMIN:qc,ALLID:Qc,AccessTracker:Xc,AddGhostConcept:Yc,Anomaly:Zc,BaseUrl:Kc,BinaryTree:es,BuildWidgetFromId:ts,BuilderStatefulWidget:ns,Composition:os,CompositionBinaryTree:is,CompositionNode:rs,Concept:cs,ConceptsData:ss,Connection:as,ConnectionData:ls,CountInfo:ds,CreateComposition:us,CreateConnection:hs,CreateConnectionBetweenEntityLocal:ps,CreateConnectionBetweenTwoConcepts:fs,CreateConnectionBetweenTwoConceptsGeneral:ys,CreateConnectionBetweenTwoConceptsLocal:gs,CreateData:vs,CreateDefaultConcept:ms,CreateDefaultLConcept:Cs,CreateSession:Ts,CreateSessionVisit:Is,CreateTheCompositionLocal:ws,CreateTheCompositionWithCache:ks,CreateTheConnection:Ns,CreateTheConnectionGeneral:As,CreateTheConnectionLocal:Ls,DATAID:Ss,DATAIDDATE:_s,DATAV2:bs,DelayFunctionExecution:Gs,DeleteConceptById:Bs,DeleteConceptLocal:xs,DeleteConnectionById:Es,DeleteConnectionByIdBulk:Rs,DeleteConnectionByType:Ds,DeleteConnectionByTypeBulk:Ws,DeleteUser:Fs,DependencyObserver:Us,FilterSearch:Os,FormatFromConnections:Ms,FormatFromConnectionsAltered:Ps,FreeschemaQuery:Vs,FreeschemaQueryApi:js,GetAllConnectionsOfComposition:Hs,GetAllConnectionsOfCompositionBulk:$s,GetAllTheConnectionsByTypeAndOfTheConcept:Js,GetComposition:zs,GetCompositionBulk:qs,GetCompositionBulkWithDataId:Qs,GetCompositionFromConnectionsWithDataId:Xs,GetCompositionFromConnectionsWithDataIdFromConnections:Ys,GetCompositionFromConnectionsWithDataIdInObject:Zs,GetCompositionFromConnectionsWithDataIdIndex:Ks,GetCompositionFromConnectionsWithIndex:ea,GetCompositionFromConnectionsWithIndexFromConnections:ta,GetCompositionFromMemoryWithConnections:na,GetCompositionList:oa,GetCompositionListAll:ia,GetCompositionListAllWithId:ra,GetCompositionListListener:ca,GetCompositionListLocal:sa,GetCompositionListLocalWithId:aa,GetCompositionListWithId:la,GetCompositionListWithIdUpdated:da,GetCompositionListener:ua,GetCompositionLocal:ha,GetCompositionLocalWithId:pa,GetCompositionWithAllIds:fa,GetCompositionWithCache:ya,GetCompositionWithDataIdBulk:ga,GetCompositionWithDataIdWithCache:va,GetCompositionWithId:ma,GetCompositionWithIdAndDateFromMemory:Ca,GetConceptBulk:Ta,GetConceptByCharacter:Ia,GetConceptByCharacterAndCategoryLocal:wa,GetConceptByCharacterAndType:ka,GetConnectionBetweenTwoConceptsLinker:Na,GetConnectionBulk:Aa,GetConnectionById:La,GetConnectionDataPrefetch:Sa,GetConnectionOfTheConcept:_a,GetConnectionTypeForCount:ba,GetFreeschemaImage:Ga,GetFreeschemaImageUrl:Ba,GetImageApi:xa,GetLink:Ea,GetLinkListListener:Ra,GetLinkListener:Da,GetLinkRaw:Wa,GetLinkerConnectionFromConcepts:Fa,GetLinkerConnectionToConcepts:Ua,GetRelation:Oa,GetRelationLocal:Ma,GetRelationRaw:Pa,GetTheConcept:Va,GetTheConceptLocal:ja,GetUserGhostId:Ha,JUSTDATA:$a,LConcept:Ja,LConnection:za,LISTNORMAL:qa,LocalConceptsData:Qa,LocalSyncData:Xa,LocalTransaction:Ya,Logger:Za,LoginToBackend:Ka,MakeTheInstanceConcept:el,MakeTheInstanceConceptLocal:tl,MakeTheTimestamp:nl,MakeTheTypeConceptApi:ol,MakeTheTypeConceptLocal:il,NORMAL:rl,PRIVATE:cl,PUBLIC:sl,PatcherStructure:al,Prototype:ll,RAW:dl,RecursiveSearchApi:ul,RecursiveSearchApiNewRawFullLinker:hl,RecursiveSearchApiRaw:pl,RecursiveSearchApiRawFullLinker:fl,RecursiveSearchApiWithInternalConnections:yl,RecursiveSearchListener:gl,SchemaQuery:vl,SchemaQueryListener:ml,SearchAllConcepts:Cl,SearchLinkInternal:Tl,SearchLinkInternalAll:Il,SearchLinkMultipleAll:wl,SearchLinkMultipleAllObservable:kl,SearchLinkMultipleApi:Nl,SearchQuery:Al,SearchStructure:Ll,SearchWithLinker:Sl,SearchWithTypeAndLinker:_l,SearchWithTypeAndLinkerApi:bl,Selector:Gl,SessionData:Bl,Signin:xl,Signup:El,SignupEntity:Rl,SplitStrings:Dl,StatefulWidget:Wl,SyncData:Fl,TrashTheConcept:Ul,UpdateComposition:Ol,UpdateCompositionLocal:Ml,UserBinaryTree:Pl,Validator:Vl,ViewInternalData:jl,ViewInternalDataApi:Hl,WidgetTree:$l,convertFromConceptToLConcept:Jl,convertFromLConceptToConcept:zl,convertWidgetTreeToWidget:ql,convertWidgetTreeToWidgetWithWrapper:Ql,createFormFieldData:Xl,createPrototypeLocal:Yl,dispatchIdEvent:Zl,getFromDatabaseWithType:Kl,getObjectsFromIndexDb:ed,getUserDetails:td,getWidgetBulkFromId:nd,getWidgetFromId:od,handleServiceWorkerException:id,hasActivatedSW:rd,init:cd,orderTheConnections:sd,recursiveFetch:ad,recursiveFetchNew:ld,removeAllChildren:dd,renderLatestWidget:ud,renderPage:hd,renderWidget:pd,searchLinkMultipleListener:fd,sendEmail:yd,sendMessage:gd,serviceWorker:vd,setHasActivatedSW:md,storeToDatabase:Cd,subscribedListeners:Td,unwrapContainers:Id,updateAccessToken:wd,uploadAttachment:kd,uploadFile:Nd,uploadImage:Ad,uploadImageV2:Ld,validDocumentFormats:Sd,validImageFormats:_d},Symbol.toStringTag,{value:"Module"}));export{Ds as $,fd as A,ql as B,ad as C,Al as D,wd as E,Ss as F,Rl as H,ud as I,Wl as J,ja as K,fl as N,Bs as P,Os as Q,Na as R,vl as S,xs as V,Ls as W,Vs as Z,ml as _,Va as a,Aa as b,ra as c,ws as d,Xa as e,il as f,$l as g,tl as h,od as i,Ql as j,Es as k,Kc as l,ps as m,Js as n,Oa as o,hs as p,el as q,Vl as r,Ya as s,bd as t,ns as u,$a as v,cd as w,wl as x,rl as y,zs as z};
